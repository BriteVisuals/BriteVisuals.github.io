(window.webpackJsonp=window.webpackJsonp||[]).push([[9,1,4],{1006:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(222)),a=u(n(186)),o=n(255),r=n(188),s=u(n(1007)),l=u(n(179));u(n(178));function u(e){return e&&e.__esModule?e:{default:e}}var d={isReceivingItem:l.default.isEditPost()||l.default.isEditDraft(),isOpen:l.default.isEditPost()||l.default.isEditDraft(),addingItem:!0,item:s.default.initState,drafts:[],isOnLine:navigator.onLine},c=function(e){return e.title!==e.itemType?e:(0,a.default)({},e,{title:void 0})};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1];switch(t.type){case o.SET_IS_OPEN:var n=e.item;return!t.isOpen&&e.defaultMentions&&(n=(0,a.default)({},n,e.defaultMentions)),(0,a.default)({},e,{isOpen:t.isOpen,item:(0,s.default)(n,t)});case o.DELETING_DRAFT:return(0,a.default)({},e,{drafts:e.drafts.filter(function(e){return e.itemID!==t.itemID})});case o.ADDING_ITEM:return(0,a.default)({},e,{isAddingItem:t.isAddingItem,drafts:e.drafts.filter(function(e){return e.itemID!==t.item.itemID})});case o.ADDED_ITEM:return(0,a.default)({},e,{isOpen:!1,isAddingItem:!1});case o.RECEIVE_ITEM:return(0,a.default)({},e,{isReceivingItem:!1,item:(0,s.default)(t.item,t)});case r.SET_ACTION_ERROR:return(0,a.default)({},e,{actionError:t.error});case o.GOT_DRAFTS:return(0,a.default)({},e,{drafts:t.drafts.map(function(e){return c(e)})});case o.SET_DRAFT_STATUS:return(0,a.default)({},e,{drafts:e.drafts.map(function(e){return e.itemID===t.itemID?(0,a.default)({},e,{draftSaveStatus:t.draftSaveStatus}):e}),item:(0,s.default)(e.item,t)});case o.SAVED_DRAFT:return(0,a.default)({},e,{drafts:[(0,a.default)(t.streamDraft,{tempItemID:t.tempItemID})].concat((0,i.default)((e.drafts||[]).filter(function(e){return null!=e.itemID&&e.itemID!==t.streamDraft.itemID}))),item:t.tempItemID===e.item.tempItemID?(0,s.default)(e.item,t):e.item});case o.OPEN_DRAFT:return(0,a.default)({},e,{isOpen:!0,item:(0,s.default)(e.item,(0,a.default)(t,{draft:e.drafts.find(function(e){return e.itemID===t.itemID})}))});case o.SET_IS_ONLINE:return(0,a.default)({},e,{isOnLine:t.isOnLine,item:!t.isOnLine&&e.item.itemID?(0,s.default)(e.item,(0,a.default)(t,{draft:e.drafts.find(function(t){return t.itemID===e.item.itemID})})):e.item,isOpen:!(!t.isOnLine&&!e.item.itemID)&&e.isOpen});case o.GOT_DEFAULT_MENTIONS:return(0,a.default)({},e,{defaultMentions:{hashtags:t.tags.filter(function(e){return"Hashtag"===e.entityType}).map(function(e){return{hashtag:e.entityID,isDefault:!0,deleted:0}}),mentions:t.tags.filter(function(e){return"Hashtag"!==e.entityType}).map(function(e){return(0,a.default)({},e,{isDefault:!0,deleted:0,hasProfile:1})})},item:(0,s.default)(e.item,t)});default:return(0,a.default)({},e,{item:(0,s.default)(e.item,t)})}}},1007:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initState=void 0;var i=s(n(186)),a=n(255),o=s(n(179)),r=n(208);function s(e){return e&&e.__esModule?e:{default:e}}var l=t.initState={mentions:[],hashtags:[],title:null,jsonContent:null,draftSaveStatus:r.draftSaveStatuses.idle};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments[1];switch(t.type){case a.ADDED_TAG:if(t.tag.hashtag){var n=o.default.findTag(e.hashtags,t.tag);if(null==n)return(0,i.default)({},e,{hashtags:e.hashtags.concat(t.tag)});if(n.deleted)return(0,i.default)({},e,{hashtags:e.hashtags.map(function(e){return e.hashtag!==t.tag.hashtag?e:t.tag})})}else{var s=o.default.findTag(e.mentions,t.tag);if(null==s)return(0,i.default)({},e,{mentions:e.mentions.concat(t.tag)});if(s.deleted)return(0,i.default)({},e,{mentions:e.mentions.map(function(e){return e.entityType===t.tag.entityType&&e.entityID===t.tag.entityID?t.tag:e})})}return e;case a.DELETED_TAG:return t.tag.hashtag?(0,i.default)({},e,{hashtags:e.hashtags.map(function(e){return e.hashtag===t.tag.hashtag?(0,i.default)({},e,{deleted:!0}):e})}):(0,i.default)({},e,{mentions:e.mentions.map(function(e){return e.entityType===t.tag.entityType&&e.entityID==t.tag.entityID?(0,i.default)({},e,{deleted:!0}):e})});case a.GOT_DEFAULT_MENTIONS:return(0,i.default)({},e,{hashtags:e.hashtags.filter(function(e){return!e.isDefault}).concat(t.tags.filter(function(e){return"Hashtag"===e.entityType}).map(function(e){return{hashtag:e.entityID,isDefault:!0,deleted:!1}})),mentions:e.mentions.filter(function(e){return!e.isDefault}).concat(t.tags.filter(function(e){return"Hashtag"!==e.entityType}).map(function(e){return(0,i.default)({},e,{isDefault:!0,deleted:!1,hasProfile:!0})}))});case a.SET_IS_OPEN:return(0,i.default)({},l,{tempItemID:Date.now(),isDraft:!0,hashtags:e.hashtags.filter(function(e){return e.isDefault}),mentions:e.mentions.filter(function(e){return e.isDefault})});case a.RECEIVE_ITEM:return(0,i.default)({},l,e);case a.SET_DRAFT_STATUS:return(0,i.default)({},e,{draftSaveStatus:t.draftSaveStatus});case a.SAVED_DRAFT:return(0,i.default)({},e,{itemID:t.streamDraft.itemID,editCount:t.streamDraft.editCount,draftSaveStatus:r.draftSaveStatuses.saved,subitems:t.streamDraft.subitems});case a.OPEN_DRAFT:case a.SET_IS_ONLINE:return(0,i.default)({},l,t.draft);default:return e}}},1008:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(255),r=n(1009),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{isOpen:e.isOpen,isReceivingItem:e.isReceivingItem,author:e.item&&e.item.author?e.item.author:currentEmployee,drafts:e.drafts,isOnLine:e.isOnLine}},function(e){return{setIsOnLine:function(t){e((0,o.setIsOnLine)(t))}}})(s.default)},1009:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(181)),a=y(n(182)),o=y(n(183)),r=y(n(184)),s=y(n(185)),l=n(177),u=y(l),d=y(n(180)),c=y(n(179)),f=y(n(269)),m=y(n(228)),p=y(n(1010)),h=y(n(1012)),g=y(n(1014)),v=n(189);function y(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.updateOnlineStatus=n.updateOnlineStatus.bind(n),window.addEventListener("online",n.updateOnlineStatus),window.addEventListener("offline",n.updateOnlineStatus),n.state={},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"updateOnlineStatus",value:function(e){this.props.setIsOnLine(navigator.onLine)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("online",this.updateOnlineStatus),window.removeEventListener("offline",this.updateOnlineStatus)}},{key:"componentDidCatch",value:function(e,t){(0,v.logError)(e),this.setState({error:e})}},{key:"render",value:function(){var e=this.props,t=e.isReceivingItem,n=e.isOpen,i=e.author;return t?u.default.createElement("div",{style:{position:"relative"}},u.default.createElement(m.default,{style:{top:350}})):u.default.createElement("div",null,u.default.createElement(g.default,{boxIsOpen:n}),!n&&[u.default.createElement(f.default,{style:{display:"block",float:"left",marginRight:10},enabled:null!=i&&"Y"===i.showInCompanyDirectory&&null!=i.employeeID&&"0"!==i.employeeID,href:c.default.getResourceUrl("Employee",i.employeeID),key:"author"},u.default.createElement("img",{className:"ka_circular",style:{width:50,marginLeft:15},src:c.default.getImageURL("Employee",i?i.primaryImageID:null,50)})),u.default.createElement(p.default,{key:"closedEditor"})],n&&u.default.createElement(h.default,null))}}]),t}(l.Component);E.propTypes={isOpen:d.default.bool,author:d.default.object},t.default=E},1010:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(255),r=n(1011),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{isOnLine:e.isOnLine}},function(e){return{onOpen:function(){e((0,o.setIsOpen)(!0))}}})(s.default)},1011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),a=p(n(182)),o=p(n(183)),r=p(n(184)),s=p(n(185)),l=n(177),u=p(l),d=p(n(180)),c=p(n(179)),f=p(n(329)),m=n(214);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={warnOffline:!1,warnBrokenUser:!1},n.onClick=n.onClick.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentWillReceiveProps",value:function(e){this.state.warnOffline&&e.isOnLine&&this.setState({warnOffline:!1})}},{key:"onClick",value:function(){c.default.isUserBroken()?null===document.querySelector(".ka_outageBannerContainer.nondismissible")&&this.setState({warnBrokenUser:!0}):this.props.isOnLine?this.props.onOpen():null===document.querySelector(".ka_outageBannerContainer.nondismissible")&&this.setState({warnOffline:!0})}},{key:"render",value:function(){var e=this,t=this.props.onOpen;return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"bbl ka_shareSomething closed",onDragEnter:this.props.isOnLine?t:void 0},u.default.createElement("div",{style:{height:20,paddingTop:9,cursor:"text"},onClick:this.onClick},"Share Something")),this.state.warnOffline&&u.default.createElement(f.default,{onClose:function(){return e.setState({warnOffline:!1})}},m.OUTAGE_BANNERS.notPosting.message),this.state.warnBrokenUser&&u.default.createElement(f.default,{onClose:function(){return e.setState({warnBrokenUser:!1})}},m.OUTAGE_BANNERS.brokenUser.message))}}]),t}(l.Component);h.propTypes={onOpen:d.default.func.isRequired},t.default=h},1012:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(255),r=n(188),s=n(1013),l=(i=s)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{item:e.item,isAddingItem:e.isAddingItem,isOnLine:e.isOnLine}},function(e){return{onClose:function(){return e((0,o.setIsOpen)(!1))},submitItem:function(t){return e((0,o.submitItem)(t))},submitDraft:function(t){return e((0,o.submitDraft)(t))},deleteOpenDraft:function(){e((0,o.deleteOpenDraft)()),e((0,o.getDefaultMentions)())},setDraftStatus:function(t){return e((0,o.setDraftStatus)(t))},addTag:function(t){return e((0,o.addTag)(t))},deleteTag:function(t){return e((0,o.deleteTag)(t))},setActionError:function(t){return e((0,r.setActionError)(t))}}})(l.default)},1013:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=N(n(552)),a=N(n(186)),o=N(n(181)),r=N(n(182)),s=N(n(183)),l=N(n(184)),u=N(n(185)),d=n(177),c=N(d),f=N(n(180)),m=N(n(478)),p=N(n(474)),h=n(223),g=n(220),v=N(n(179)),y=n(279),E=N(n(475)),_=N(n(477)),k=N(n(203)),I=N(n(245)),S=N(n(246)),T=n(214),b=N(n(244)),C=n(209),D=n(476),M=N(D),w=n(208),P=N(n(329)),L=N(n(473)),O=N(n(472)),A=n(189);function N(e){return e&&e.__esModule?e:{default:e}}if(null==R)var R=n(179).static_images;var x=function(e){function t(e){(0,r.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.submitClicked=n.submitClicked.bind(n),n.onTitleEditorChange=n.onTitleEditorChange.bind(n),n.onBodyEditorChange=n.onBodyEditorChange.bind(n),n.onUploadStart=n.onUploadStart.bind(n),n.onUploadEnd=n.onUploadEnd.bind(n),n.onCancel=n.onCancel.bind(n),n.setMaxBodyHeight=n.setMaxBodyHeight.bind(n),n.onLinkPeek=n.onLinkPeek.bind(n),n.onEditLink=n.onEditLink.bind(n),n.onRemoveLink=n.onRemoveLink.bind(n),n.renderLinkDialog=n.renderLinkDialog.bind(n),n.setupDraftSaveTimer=n.setupDraftSaveTimer.bind(n),n.cancelDraftSaveTimer=n.cancelDraftSaveTimer.bind(n),n.submitDraft=n.submitDraft.bind(n),n.loadNewStreamItem=n.loadNewStreamItem.bind(n),n.isOnLine=n.isOnLine.bind(n),n.titleEditorRefHandler=n.titleEditorRefHandler.bind(n),n.bodyEditorRefHandler=n.bodyEditorRefHandler.bind(n),n.addTag=n.addTag.bind(n),n.deleteTag=n.deleteTag.bind(n),n.state={titleEditorState:(0,h.newEditorState)(),bodyEditorState:(0,h.newEditorState)(n.onLinkPeek),fileUploads:[],fileUploadFailures:[],videoUploadFailures:[],videosProcessing:[],showUploadFailures:!1,maxBodyHeight:315,subject:null,draftIsDirty:!1,shareMenuOpen:!1},n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"titleEditorRefHandler",value:function(e){this.titleEditor=e}},{key:"bodyEditorRefHandler",value:function(e){this.bodyEditor=e}},{key:"submitClicked",value:function(){if(!(this.props.item&&this.props.item.draftSaveStatus===w.draftSaveStatuses.saving||this.state.videosProcessing.length>0))try{var e=0;if(e+=this.props.item.hashtags.filter(function(e){return!e.deleted}).length,e+=this.props.item.mentions.filter(function(e){return!e.deleted}).length,this.state.fileUploads.length>0)this.setState({submitAfterFileUpload:!0});else if(0==e)this.setState({alert:T.ALERT_MISSING_TAGS});else if(this.titleEditor.getText()){var t=this.bodyEditor.getJson();this.props.item&&(0,h.populateMissingCollectionIDsInContent)(t,this.props.item.subitems),this.cancelDraftSaveTimer(),this.props.submitItem((0,a.default)({},this.props.item,{title:this.titleEditor.getEntitizedText(),jsonContent:t,draftJsContent:(0,h.removeDataUrlsFromRawContent)((0,g.convertToRaw)(this.state.bodyEditorState.getCurrentContent()))}))}else this.setState({alert:T.ALERT_MISSING_TITLE})}catch(e){(0,A.logError)(e,this.props.item),this.props.setActionError(e)}}},{key:"populateSubject",value:function(e){if(e.subjectType&&e.subjectID||e.author){var t=(0,y.getSubject)(e.subjectType,e.subjectID,e.author,e.mentions),n=t.entityType,i=v.default.getEntityID(t),a=t.primaryImageID||t.entityImageID,o=c.default.createElement("img",{className:"imgSubjectImage"+("Employee"===n?" ka_circular":""),src:(0,y.getSubjectImageUrl)(a,n)}),r=v.default.getEntityName(t);"Employee"==n&&i.toLowerCase()==currentEmployee.employeeID.toLowerCase()||this.setState({subject:c.default.createElement("div",{className:"ka_shareAuthor"},o,r,c.default.createElement("span",{className:"ka_streamDate ka_streamItemDate"},e.promoted?"PROMOTED":v.default.formatDateTimeStamp(e.dateStamp)))})}}},{key:"populateTitle",value:function(e){var t=(0,h.formattedContentToContentState)(e.title,e.author,e.mentions,e.hashtags);null!=t&&this.onTitleEditorChange(g.EditorState.createWithContent(t,(0,h.getDecorator)(this.onLinkPeek)))}},{key:"populateBodyFromDraftContent",value:function(e){null!=e&&("string"==typeof e&&(e=JSON.parse(e)),this.onBodyEditorChange(g.EditorState.createWithContent((0,g.convertFromRaw)(e),(0,h.getDecorator)(this.onLinkPeek))),window.setTimeout(this.bodyEditor.focus,0))}},{key:"populateBodyFromFormattedContent",value:function(e){this.onBodyEditorChange(this.appendSubItemsToBodyState(this.getBodyStateFromFormattedContent(e),e)),window.setTimeout(this.bodyEditor.focus,0)}},{key:"getBodyStateFromFormattedContent",value:function(e){var t=(0,h.formattedContentToContentState)(e.formattedContent,e.author,e.mentions,e.hashtags);return null!=t?g.EditorState.createWithContent(t,(0,h.getDecorator)(this.onLinkPeek)):null}},{key:"appendSubItemsToBodyState",value:function(e,t){var n=this;return t.subitems&&t.subitems.filter(function(e){return!e.deleted}).forEach(function(t){if(null!=e){var i=e.getCurrentContent(),a=i.getLastBlock();i=g.Modifier.splitBlock(i,new g.SelectionState({anchorKey:a.getKey(),anchorOffset:a.getText().length,focusKey:a.getKey(),focusOffset:a.getText().length})),e=g.EditorState.createWithContent(i,(0,h.getDecorator)(n.onLinkPeek))}var o=(e=e||n.state.bodyEditorState).getCurrentContent();o.createEntity("StreamCollection","IMMUTABLE",{collection:t}),e=g.EditorState.moveSelectionToEnd(e),e=g.AtomicBlockUtils.insertAtomicBlock(e,o.getLastCreatedEntityKey()," ")}),e}},{key:"onTitleEditorChange",value:function(e){this.props.item.isDraft&&!this.state.draftIsDirty&&(0,h.didTextChange)(this.state.titleEditorState,e)&&this.setState({draftIsDirty:!0}),this.setState({titleEditorState:e}),(v.default.isEditPost()||v.default.isEditDraft())&&(document.title=e.getCurrentContent().getPlainText()||"Edit Post")}},{key:"onBodyEditorChange",value:function(e){this.props.item.isDraft&&!this.state.draftIsDirty&&(0,h.didTextChange)(this.state.bodyEditorState,e)&&this.setState({draftIsDirty:!0}),this.setState({bodyEditorState:e})}},{key:"onUploadStart",value:function(e){0===this.state.fileUploads.length&&(0,h.addConfirmLeave)(),this.setState({fileUploads:this.state.fileUploads.concat(e.name)}),this.props.setDraftStatus(w.draftSaveStatuses.blocked)}},{key:"onUploadEnd",value:function(e,t){if(t)this.props.item.isDraft&&this.submitDraft();else{var n=this.state.fileUploads.filter(function(t){return t!==e.name});this.setState({fileUploads:n});var i=this.state.fileUploadFailures,a=this.state.videoUploadFailures;e.status===b.default.FAILED&&(0===e.type.indexOf("video/")?a.push(e):i.push(e)),(i.length>0||a.length>0)&&this.setState({showUploadFailures:!0}),0===n.length?((0,h.removeConfirmLeave)(),0===i.length&&0===a.length&&(this.state.submitAfterFileUpload?this.submitClicked():this.props.item.isDraft&&this.submitDraft())):this.setState({fileUploadFailures:i,videoUploadFailures:a})}}},{key:"onUploadProgress",value:function(e,t){void 0!==e&&console.log(e+"%")}},{key:"onCancel",value:function(e){v.default.isEditPost()?window.history.back():this.props.onClose&&(this.props.item.isDraft&&null!=this.props.item.itemID?this.setState({confirmClose:!0}):this.props.onClose(e))}},{key:"setMaxBodyHeight",value:function(){this.setState({maxBodyHeight:Math.max(document.documentElement.clientHeight-330,315)})}},{key:"componentWillMount",value:function(){this.setMaxBodyHeight()}},{key:"componentDidMount",value:function(){"0"!=currentEmployee.employeeID&&this.props.item.isDraft&&this.setupDraftSaveTimer(),window.addEventListener("resize",this.setMaxBodyHeight),this.loadNewStreamItem(this.props.item)}},{key:"loadNewStreamItem",value:function(e){try{this.populateTitle(e),e.draftJsContent?this.populateBodyFromDraftContent(e.draftJsContent):(e.formattedContent||e.subitems&&e.subitems.length>0)&&this.populateBodyFromFormattedContent(e),this.setState({draftIsDirty:!1})}catch(t){(0,A.logError)(t,e),this.props.setActionError(t)}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setMaxBodyHeight),this.cancelDraftSaveTimer(),(0,h.removeConfirmLeave)()}},{key:"componentWillReceiveProps",value:function(e){U(this.props.item,e.item)?!e.isOnLine&&this.props.isOnLine&&(this.setState({fileUploads:[]}),this.loadNewStreamItem(e.item)):this.loadNewStreamItem(e.item)}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.props.item.draftSaveStatus!==w.draftSaveStatuses.saved&&this.props.item.draftSaveStatus!==w.draftSaveStatuses.failed||window.setTimeout(function(){n.props.item.draftSaveStatus!==w.draftSaveStatuses.saved&&n.props.item.draftSaveStatus!==w.draftSaveStatuses.failed||n.props.setDraftStatus(w.draftSaveStatuses.idle)},5e3)}},{key:"onLinkPeek",value:function(e){this.setState({linkPeek:e})}},{key:"onEditLink",value:function(){this.setState({isLinkDialogOpen:!0,linkPeek:null})}},{key:"onRemoveLink",value:function(){var e=this,t=(0,h.tryGetLinkSelection)(this.state.bodyEditorState);if(null!=t){var n=g.RichUtils.toggleLink(this.state.bodyEditorState,t,null),i=n.getSelection();n=g.EditorState.acceptSelection(n,i.merge({anchorOffset:i.getFocusOffset()})),this.onBodyEditorChange(n)}this.setState({linkPeek:null}),window.setTimeout(function(){return e.bodyEditor.focus()},0)}},{key:"setupDraftSaveTimer",value:function(){var e=this;this.setState({draftIsDirty:!1}),this.draftSaveTimer=window.setInterval(function(){e.state.draftIsDirty&&e.submitDraft()},3e3)}},{key:"cancelDraftSaveTimer",value:function(){window.clearInterval(this.draftSaveTimer),delete this.draftSaveTimer}},{key:"submitDraft",value:function(){if(this.props.item.draftSaveStatus!==w.draftSaveStatuses.saving){var e=this.titleEditor.getEntitizedText(),t=this.bodyEditor.getJson();this.props.item&&(0,h.populateMissingCollectionIDsInContent)(t,this.props.item.subitems);var n=(0,h.removeDataUrlsFromRawContent)((0,h.removeBrokenAtomicBlocksFromRawContent)((0,g.convertToRaw)(this.state.bodyEditorState.getCurrentContent())));-1===(0,i.default)(n).indexOf("dataUrl")&&this.props.submitDraft((0,a.default)({},this.props.item,{title:e,jsonContent:t,draftJsContent:n})),this.setState({draftIsDirty:!1})}}},{key:"isOnLine",value:function(){return this.props.isOnLine}},{key:"addTag",value:function(e){var t=this;this.props.addTag(e),"0"!=currentEmployee.employeeID&&this.props.item.isDraft&&window.setTimeout(function(){return t.submitDraft()},0)}},{key:"deleteTag",value:function(e){var t=this;this.props.deleteTag(e),"0"!=currentEmployee.employeeID&&this.props.item.isDraft&&window.setTimeout(function(){return t.submitDraft()},0)}},{key:"render",value:function(){var e=this,t=this.state.subject?{top:86}:null,n=this.isOnLine()&&!this.props.isAddingItem&&0===this.state.fileUploads.length&&0===this.state.videosProcessing.length&&(!this.props.item||this.props.item.draftSaveStatus!==w.draftSaveStatuses.saving),i=this.isOnLine()&&0===this.state.fileUploads.length&&this.props.item.draftSaveStatus!==w.draftSaveStatuses.saving,o=!this.props.isAddingItem&&0===this.state.fileUploads.length&&this.props.item.draftSaveStatus!==w.draftSaveStatuses.saving,r=this.props.isAddingItem||this.state.submitAfterFileUpload;return c.default.createElement("div",{className:"bbl ka_shareSomething ka_stream",style:{width:"auto",marginLeft:15}},this.state.subject,c.default.createElement("div",{className:"ka_shareTitle"},c.default.createElement(p.default,{ref:this.titleEditorRefHandler,placeholder:"Title",editorState:this.state.titleEditorState,onChange:this.onTitleEditorChange,hideX:!0,addTag:this.props.addTag,deleteTag:this.props.deleteTag,stripPastedStyles:!0,disableRichText:!0,disableLineBreaks:!0,maxChars:C.INT_TITLE_MAX_CHARS,maxCharsAlert:T.ALERT_TITLE_LENGTH,readOnly:!this.isOnLine()})),c.default.createElement("div",{className:"ka_cancelShareX",style:(0,a.default)({display:"block"},t),onClick:this.isOnLine()?this.onCancel:void 0},c.default.createElement("img",{src:"/_layouts/15/images/KAWebParts/X.png",title:"Cancel"})),c.default.createElement("div",{className:"ka_shareBody"},c.default.createElement(p.default,{ref:this.bodyEditorRefHandler,placeholder:"Body",editorState:this.state.bodyEditorState,onChange:this.onBodyEditorChange,hideX:!0,addTag:this.props.addTag,deleteTag:this.props.deleteTag,style:{overflow:"auto",maxHeight:this.state.maxBodyHeight},maxChars:C.INT_BODY_MAX_CHARS,maxCharsAlert:T.ALERT_BODY_LENGTH,onEditLink:this.onEditLink,imageSize:{width:C.INT_STREAM_IMAGE_WIDTH,height:C.INT_STREAM_IMAGE_HEIGHT},uploadProps:{apiUrl:apiUrl,getToken:v.default.getToken,getUploadHeader:function(){return{Authorization:"Bearer "+v.default.getToken()}},onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd,videoProcessingStarted:function(t){return e.setState({videosProcessing:e.state.videosProcessing.concat(t)})},videoProcessingEnded:function(t){return e.setState({videosProcessing:e.state.videosProcessing.filter(function(e){return e!==t})})}},readOnly:!this.isOnLine()}),c.default.createElement(L.default,{linkPeek:this.state.linkPeek,onEdit:this.onEditLink,onRemove:this.onRemoveLink,onClose:function(){return e.setState({linkPeek:null})}})),c.default.createElement(m.default,{mentions:this.props.item.mentions,hashtags:this.props.item.hashtags,addTag:this.addTag,deleteTag:this.deleteTag}),c.default.createElement("div",{className:"ka_shareFooter"},c.default.createElement(O.default,{editorState:this.state.bodyEditorState,onToggleInlineStyle:function(t){e.onBodyEditorChange(g.RichUtils.toggleInlineStyle(e.state.bodyEditorState,t)),e.props.item.isDraft&&!e.state.draftIsDirty&&e.setState({draftIsDirty:!0})},onToggleBlockType:function(t){e.onBodyEditorChange(g.RichUtils.toggleBlockType(e.state.bodyEditorState,t)),e.props.item.isDraft&&!e.state.draftIsDirty&&e.setState({draftIsDirty:!0}),window.setTimeout(function(){return e.bodyEditor.focus()},0)},onImageAttach:function(t){return e.bodyEditor.onSelectFiles(e.state.bodyEditorState.getSelection(),t)},onVideoAttach:function(t){return e.bodyEditor.onSelectFiles(e.state.bodyEditorState.getSelection(),t)},onDocumentAttach:function(t){return e.bodyEditor.onSelectFiles(e.state.bodyEditorState.getSelection(),t)},onEditLink:this.onEditLink,onBrowseSPDocuments:function(){return e.setState({isDocBrowserOpen:!0})},onClose:this.onCancel,readOnly:!this.isOnLine()}),c.default.createElement("span",{className:"ka_draftStatusMsg"},v.default.draftSaveStatusText(this.props.item.draftSaveStatus,this.state.draftIsDirty,this.isOnLine(),this.state.fileUploads.length>0)),c.default.createElement("div",{className:"ka_button ka_shareButton"+(this.state.shareMenuOpen?" light":"")+(n?"":" disabled"),onClick:n?this.submitClicked:null},r?"Loading...":this.props.item.isDraft?"Share":"Update"),this.props.item.isDraft&&c.default.createElement("div",{style:{position:"relative",marginLeft:4}},c.default.createElement("div",{className:"ka_button"+(this.state.shareMenuOpen?" hovered":"")+(i?"":" disabled"),style:{padding:"0 2px"},onClick:i?function(){return e.setState({shareMenuOpen:!e.state.shareMenuOpen})}:void 0},i?c.default.createElement("img",{src:R.more_caret_dk_grey_14}):c.default.createElement("img",{src:R.more_caret_lt_grey_14})),c.default.createElement("div",{className:"ka_shareMenu ka_editCommentOptions"+(o?"":" disabled")},this.state.shareMenuOpen&&c.default.createElement(k.default,{onClose:function(){return e.setState({shareMenuOpen:!1})}},c.default.createElement("div",null,c.default.createElement("span",{onClick:o?function(){e.submitDraft(),e.props.onClose()}:null,style:{paddingLeft:15,paddingRight:15}},"Save as Draft"),c.default.createElement("div",{className:"KAEditor-tri center"},c.default.createElement("div",null))))))),this.state.isLinkDialogOpen&&this.renderLinkDialog(),this.state.isDocBrowserOpen&&c.default.createElement(_.default,{onChooseFile:function(t){e.bodyEditor.insertAtomicBlock((0,h.adjustTargetBasedOnCursor)(e.state.bodyEditorState.getSelection(),e.state.bodyEditorState.getCurrentContent()),t,t.collectionType,null,!0),e.setState({isDocBrowserOpen:!1}),e.props.item.isDraft&&!e.state.draftIsDirty&&e.setState({draftIsDirty:!0})},onClose:function(){return e.setState({isDocBrowserOpen:!1})}}),this.state.confirmClose&&c.default.createElement(M.default,{title:"Delete Draft",message:"Are you sure you want to delete this draft?",onClose:function(){return e.setState({confirmClose:!1})},optionArray:[(0,D.dialogOption)("Cancel",function(){return e.setState({confirmClose:!1})}),(0,D.dialogOption)("Save Draft",function(){e.submitDraft(),e.props.onClose()},this.state.fileUploads.length>0||this.props.isAddingItem),(0,D.dialogOption)("Delete Draft",this.props.deleteOpenDraft,!1,!0)]}),this.state.alert&&c.default.createElement(I.default,{onClose:function(){return e.setState({alert:null})},title:this.state.alert.title,message:this.state.alert.message}),this.state.showUploadFailures&&c.default.createElement(S.default,{onClose:function(){return e.setState({showUploadFailures:!1,fileUploadFailures:[],videoUploadFailures:[]})},fileAlerts:{fileUploadFailures:this.state.fileUploadFailures,videoUploadFailures:this.state.videoUploadFailures}}),!this.isOnLine()&&c.default.createElement(P.default,null,T.OUTAGE_BANNERS.isEditing.message))}},{key:"renderLinkDialog",value:function(){var e=this,t=(0,h.selectLink)(this.state.bodyEditorState);return c.default.createElement(E.default,{text:(0,h.getTextSelection)(t," "),url:(0,h.getSelectedLinkUrl)(t),onCreate:function(n,i){e.onBodyEditorChange((0,h.insertLink)(t,n,i)),e.setState({isLinkDialogOpen:!1}),e.props.item.isDraft&&!e.state.draftIsDirty&&e.setState({draftIsDirty:!0}),window.setTimeout(function(){return e.bodyEditor.focus()},0)},onClose:function(){e.setState({isLinkDialogOpen:!1}),window.setTimeout(function(){return e.bodyEditor.focus()},0)}})}}]),t}(d.Component),U=function(e,t){return!e.item&&t.tempItemID&&e.tempItemID===t.tempItemID||e.itemID===t.itemID&&e.tempItemID===t.tempItemID};x.propTypes={item:f.default.object.isRequired,onClose:f.default.func.isRequired,submitItem:f.default.func.isRequired,submitDraft:f.default.func.isRequired,addTag:f.default.func.isRequired,deleteTag:f.default.func.isRequired,isAddingItem:f.default.bool,setActionError:f.default.func.isRequired},t.default=x},1014:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(255),r=n(1015),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{drafts:e.drafts}},function(e){return{deleteOldDraft:function(t){e((0,o.deleteOldDraft)(t))},openDraft:function(t){e((0,o.openDraft)(t))}}})(s.default)},1015:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),a=p(n(182)),o=p(n(183)),r=p(n(184)),s=p(n(185)),l=n(177),u=p(l),d=n(179),c=p(d),f=p(n(203)),m=p(n(242));function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={listingDrafts:!1,hoveredDraft:-1,menuDraft:-1,listExpanded:!1},n.rowEnter=n.rowEnter.bind(n),n.rowLeave=n.rowLeave.bind(n),n.renderDate=n.renderDate.bind(n),n.toggleRowMenu=n.toggleRowMenu.bind(n),n.openDraft=n.openDraft.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"rowEnter",value:function(e){this.setState({hoveredDraft:e})}},{key:"rowLeave",value:function(e){this.state.hoveredDraft===e&&this.setState({hoveredDraft:-1})}},{key:"toggleRowMenu",value:function(e){this.state.menuDraft!==e?this.setState({menuDraft:e}):this.setState({menuDraft:-1})}},{key:"renderDate",value:function(e,t){var n=this;return this.state.hoveredDraft===e||this.state.menuDraft===e?u.default.createElement("td",{className:"ka_draftDate",style:{cursor:"pointer"},onClick:function(){return n.toggleRowMenu(e)}},u.default.createElement("div",{className:"ka_editCommentOptions"},u.default.createElement("img",{src:d.static_images.ellipsis}),this.state.menuDraft===e&&this.renderMenu(e))):u.default.createElement("td",{className:"ka_draftDate"},c.default.formatDateTimeStamp(t))}},{key:"renderMenu",value:function(e){var t=this;return u.default.createElement(f.default,{onClose:function(){return t.toggleRowMenu(e)}},u.default.createElement("div",null,u.default.createElement("span",{onClick:function(){t.openDraft(e)}},"Edit Draft"),u.default.createElement("span",{onClick:function(){return t.setState({confirmDeleteDraft:e})}},"Delete Draft"),u.default.createElement("div",{className:"KAEditor-tri center"},u.default.createElement("div",null))))}},{key:"openDraft",value:function(e){this.props.openDraft(e),this.setState({listingDrafts:!1,listExpanded:!1})}},{key:"componentWillReceiveProps",value:function(e){this.props.drafts.length>0&&0===e.drafts.length&&this.setState({listingDrafts:!1})}},{key:"render",value:function(){var e=this;if(c.default.isEditPost()||c.default.isEditDraft())return u.default.createElement("div",{className:"ka_savedDrafts",style:{cursor:"default"}},u.default.createElement("img",{src:d.static_images.pencil_black_24,style:{marginRight:5}}),u.default.createElement("span",{style:{textDecoration:"none"}},"Edit ",c.default.isEditDraft()?"Draft":"Post"));var t=this.props,n=t.drafts,i=t.boxIsOpen;return n.length>0||i?u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"ka_savedDrafts",onClick:n.length>0?function(){return e.setState({listingDrafts:!e.state.listingDrafts,listExpanded:!1})}:void 0},u.default.createElement("span",null,"Drafts"),u.default.createElement("span",{className:"ka_draftCount"},n.length)),this.state.listingDrafts&&n.length>0&&u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"ka_draftList"},u.default.createElement("tbody",null,(this.state.listExpanded?n:n.slice(0,3)).map(function(t){return u.default.createElement("tr",{className:"ka_draft",key:t.itemID,onMouseEnter:function(){return e.rowEnter(t.itemID)},onMouseLeave:function(){return e.rowLeave(t.itemID)}},u.default.createElement("td",{className:"ka_draftHeadshot"},u.default.createElement("img",{className:"ka_circular",src:c.default.getImageURL("Employee",currentEmployee.primaryImageID,25,25,!0)})),u.default.createElement("td",{className:"ka_draftTitle",onClick:function(){return e.openDraft(t.itemID)}},c.default.replaceInlineTagsWithText(t.title,t.mentions)||"Untitled"),e.renderDate(t.itemID,t.modDate))}))),!this.state.listExpanded&&n.length>3&&u.default.createElement("span",{className:"linkActive moreDrafts",onClick:function(){return e.setState({listExpanded:!0})}},n.length-3," More ",u.default.createElement("img",{src:d.static_images.more_caret_cyan_14}))),this.state.confirmDeleteDraft&&u.default.createElement(m.default,{title:"Delete Draft",message:"Are you sure you want to delete this draft?",confirmText:"Delete Draft",denyText:"Cancel",onConfirm:function(){e.props.deleteOldDraft(e.state.confirmDeleteDraft),e.setState({confirmDeleteDraft:null})},onDeny:function(){return e.setState({confirmDeleteDraft:null})},onClose:function(){return e.setState({confirmDeleteDraft:null})},redConfirm:!0})):null}}]),t}(u.default.Component);t.default=h},1016:function(e,t,n){},1017:function(e,t,n){},173:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadShareSomething=void 0;var i=g(n(177)),a=n(187),o=n(198),r=n(569),s=g(n(577)),l=n(578),u=n(255),d=g(n(1006)),c=g(n(1008)),f=g(n(179)),m=g(n(563)),p=g(n(204)),h=n(189);function g(e){return e&&e.__esModule?e:{default:e}}n(330),n(568),n(1016),p.default.msie&&n(1017);t.loadShareSomething=function(e){(0,l.createLogger)();var t=(0,r.compose)((0,r.applyMiddleware)(s.default))(r.createStore)(d.default);f.default.validateToken(function(){f.default.isEditPost()||f.default.isEditDraft()?t.dispatch((0,u.fetchItem)((0,h.getQueryStringValue)("ItemID"))):(t.dispatch((0,u.getDrafts)()),t.dispatch((0,u.getDefaultMentions)()))}),f.default.setupTokenCheckTimer(),(0,a.render)(i.default.createElement(o.Provider,{store:t},i.default.createElement("div",{style:{width:593}},i.default.createElement(m.default,null),i.default.createElement(c.default,null))),e)}},179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileBlackList=t.static_images=t.imgRoot=void 0;var i=d(n(222)),a=d(n(186)),o=d(n(191)),r=d(n(204)),s=n(211),l=n(208),u=n(189);function d(e){return e&&e.__esModule?e:{default:e}}var c={stopBubble:function(e){(e=e||window.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0},getResourceUrl:function(e,t,n){n=void 0!==n&&n;var i=e;"Project"===e&&n&&(i="Opportunity");var a=void 0;return"undefined"==typeof urlTemplates?"ka-synthesis://"+e+"/"+("Hashtag"===e?encodeURIComponent(t):t):("StreamItem"==e?a=urlTemplates.threadUrl+"?ItemID="+t:"Hashtag"==e?a=urlTemplates.topicUrl+"?Hashtag="+encodeURIComponent(t):"Community"==e?void 0!==urlTemplates.communityUrls?a=urlTemplates.communityUrls[t]:console.warn("communityUrls not part of urlTemplates. Check MasterPage version."):a=urlTemplates[i.toLowerCase()+"ProfileUrl"]+"?"+e+"="+encodeURIComponent(t),a)},getImageURL:function(e,t,n,i,a,o){o=void 0!==o&&o;var r=e;"Project"===e&&o&&(r="Opportunity"),a=null==a||a;var s=p;if("Document"===e||"SharepointListItem"===e)null!=f[t.toLowerCase()]?s+=f[t.toLowerCase()]+"_"+n+".png":s+="generic_"+n+".png";else if(null!=t&&""!=t&&"00000000-0000-0000-0000-000000000000"!=t){if("undefined"==typeof urlTemplates)return apiBaseUrl+"media/"+t+"/data/"+n+"w"+i+"h"+(a?"_fxd":"");s=urlTemplates.imageProxyUrl+"?id="+t+"&size="+n+"w"+(i||n)+"h"+(a?"_fxd":"")}else null!=m[e]?s+=m[e]:s="/_layouts/15/Images/MediaProxy/Entities/"+r+"_"+n+".png";return s},getGifURL:function(e){return"undefined"==typeof urlTemplates?apiBaseUrl+"media/"+e+"/data/anim":urlTemplates.imageProxyUrl+"?id="+e+"&size=anim&dl=1"},separate:function(e,t){return 0===e.length?[]:e.slice(1).reduce(function(e,n,i){return e.concat([t,n])},[e[0]])},getLikeStatus:function(e){return null!=e&&e.filter(function(e){return(e.author?e.author.employeeID.toLowerCase():e.authorID.toLowerCase())===employeeID.toLowerCase()}).length>0},entityRegex:/{([^\{]*)\|([^\{\}\|]*)\}/g,replaceInlineTagsWithLink:function(e,t,n,i){return n=n||[],null==e?null:e.replace(this.entityRegex,function(e,a,o){if("Hashtag"===a){if(null==i)return o;var r=i.find(function(e){return e.hashtag.toLowerCase()===o.toLowerCase()});return r&&!r.deleted?"<a href='"+c.getResourceUrl(a,o)+"' class='ka_hashtag_link' entityType='"+a+"' entityID='"+o+"'>"+(r.hashtag||e)+"</a>":r?r.hashtag:o}if("Employee"===a){var s=void 0;if(Array.isArray(t)?s=t.find(function(e){return e.employeeID.toLowerCase()==o.toLowerCase()}):null!=t&&t.employeeID.toLowerCase()===o.toLowerCase()&&(s=t),null!=s)return"Y"!==s.showInCompanyDirectory||s.deleted?s.fullName:"<a href='"+c.getResourceUrl(a,o)+"' class='ka_mention_link' entityType='"+a+"' entityID='"+o+"'>"+(s.fullName||e)+"</a>"}var l=n.find(function(e){return e.entityType===a&&("string"==typeof e.entityID?e.entityID.toLowerCase()===o.toLowerCase():e.entityID===o)});return l&&l.hasProfile?"<a href='"+c.getResourceUrl(a,o,l.isOpportunity)+"' class='ka_mention_link' entityType='"+a+"' entityID='"+o+"'>"+(l.entityName||e)+"</a>":l&&l.entityName||e})},replaceInlineTagsWithText:function(e,t){return null==e?null:e.replace(this.entityRegex,function(e,n,i){if("Hashtag"===n)return i;if(null==t)return e;var a=t.find(function(e){return e.entityType===n&&e.entityID.toLowerCase()===i.toLowerCase()});return a?a.entityName:e})},blogImgRegex:/<img[^>]+src="([^"\s]+media\/proxy.ashx\?id=([a-zA-Z0-9-]+)&[amp;]*size=([0-9hw]+))"[^>]*>/g,replaceBlogImageUrls:function(e){return null==e?null:e.replace(this.blogImgRegex,function(e,t,n,i){return e.replace(t,apiBaseUrl+"media/"+n+"/data/"+i)})},getTagForLink:function(e,t,n,i,a,o){var r={entityType:e,entityID:t,entityName:e,hasProfile:!0,isOpportunity:!1};if("Hashtag"===e){if(r.entityName=t,null!=a){var s=a.find(function(e){return e.hashtag===t});null!=s&&(r.hasProfile=s.availableTopic||r.hasProfile)}}else if("Employee"===e&&null!=n&&t==n.employeeID)r.entityName=n.fullName,r.hasProfile="Y"===n.showInCompanyDirectory&&!n.deleted;else if("Employee"===e&&null!=o&&t==o.employeeID)r.entityName=o.fullName,r.hasProfile="Y"===o.showInCompanyDirectory&&!o.deleted;else if(null!=i){var l=i.find(function(n){return n.entityType===e&&n.entityID.toLowerCase()===t.toLowerCase()});null!=l&&(r.entityName=l.entityName,r.hasProfile=l.hasProfile,r.isOpportunity=l.isOpportunity)}return r},getMobileItemIDValue:function(){var e;return(e=window.location.pathname.split("/"))[e.length-2]},isEditPost:function(){return window.location.pathname.endsWith("EditPost.aspx")&&null!=(0,u.getQueryStringValue)("ItemID")},isEditDraft:function(){return window.location.pathname.endsWith("EditDraft.aspx")&&null!=(0,u.getQueryStringValue)("ItemID")},getToken:function(){try{return localStorage.getItem("apiToken")}catch(e){return $window.sessionStorage.apiToken}},getProfileUrl:function(e,t,n){n=void 0!==n&&n;var i=e;return"Project"===e&&n&&(i="Opportunity"),urlTemplates[i.toLowerCase()+"ProfileUrl"]+"?"+e+"="+t},validateToken:function(e){var t=this,n=this.getToken();if(n)if(null==n||"null"===n)conosle.warn("removing null token",{storage:n}),this.deleteToken();else{if(this.isTokenRecent(n)&&this.isTokenForCurrentUser(n))return void(e&&e());console.warn("removing expired or wrong user token"),this.deleteToken()}if(e&&this.waitForToken(e),!window.waitingForToken){window.waitingForToken=!0;var i=void 0;i=urlTemplates.tokenProxyUrl?urlTemplates.tokenProxyUrl:"/_layouts/15/NexusAPIProxy/GetToken.ashx",o.default.get(i).withCredentials().end(function(e,n){try{if(e||!n.ok)t.receivedAPIError(e);else if(n.body)if(n.body.error)t.receivedAPIError((0,a.default)({},n.body.error,{url:i}));else{try{localStorage.setItem("apiToken",n.body.results[0])}catch(e){"undefined"!=typeof $window?$window.sessionStorage.apiToken=n.body.results[0]:(0,u.logError)(e)}t.gotTokenAsync(n.body.results[0])}else t.receivedAPIError({message:n.text});window.waitingForToken=!1}catch(e){(0,u.logError)(e),window.waitForToken=!1,t.validateToken()}})}},deleteToken:function(){localStorage.removeItem("apiToken")},waitForToken:function(e){window.addEventListener("gotApiToken",function t(n){e(),window.removeEventListener("gotApiToken",t)},!1)},setupTokenCheckTimer:function(){if(null==window.tokenTimer){var e=this;window.tokenTimer=window.setInterval(function(){return e.validateToken()},3e4)}},gotTokenAsync:function(e){this.dispatchEvent("gotApiToken",{token:e})},dispatchEvent:function(e,t){if("function"==typeof CustomEvent)window.dispatchEvent(new CustomEvent(e,{detail:t}));else{var n=document.createEvent("CustomEvent");n.initCustomEvent(e,!0,!0,t),window.dispatchEvent(n)}},isTokenRecent:function(e){return!(JSON.parse(atob(e.split(".")[1])).exp<=~~(Date.now()/1e3)+120)},isTokenForCurrentUser:function(e){var t=JSON.parse(atob(e.split(".")[1]));return t.EmployeeID.toUpperCase()===employeeID.toUpperCase()&&t.KA_ClientID.toUpperCase()===clientID.toUpperCase()||(console.error("Not my token!"),!1)},getAuthHeader:function(){return{Authorization:"Bearer "+this.getToken()}},isSPAdmin:function(){var e=this.getToken();if(e){var t=JSON.parse(atob(e.split(".")[1])).role;if(null!=t){if("string"==typeof t&&"SPAdmin"===t)return!0;if(t.constructor===Array&&t.length>0&&t.indexOf("SPAdmin")>-1)return!0}}return!1},isHome:function(){return"/"===urlTemplates.communityUrls[communityID]},getClientID:function(){var e=this.getToken();return e?JSON.parse(atob(e.split(".")[1])).KA_ClientID:window.clientID},runTagSearch:function(e,t,n,i){var a=this,r="Tags";return"@"===e[0]&&(e=e.substring(1),r="Mentions"),"#"===e[0]&&(r="Hashtag"),n(e,t),o.default.get(apiUrl+"/v5/search/tag?queryText="+encodeURIComponent(e)+"&tagSearchType="+r).authBearer(this.getToken()).withCredentials().end(function(e,o){n(null),e||!o.ok?a.receivedAPIError(e||o.text):i(o.body,t)})},getMaxModDate:function(e,t,n,a,o){return null==e||0===e.length?null:[].concat((0,i.default)(e),(0,i.default)(t),(0,i.default)(n),(0,i.default)(a),(0,i.default)(o)).map(function(e){return e.modDate}).sort(function(e,t){return new Date(t)-new Date(e)})[0]},getMostRecent:function(e,t){return new Date(e.modDate)>new Date(t.modDate)?e:t},handleResponseErrors:function(e){if(!e.ok)throw Error(e.statusText);return e},receivedAPIError:function(e){(0,u.logError)(e)},logVideoTranscode:function(e,t,n,i){o.default.post("https://browserlogger.knowledge-architecture.com/api/videowait?code=WwYwRC8dHI6jA9QRcCeXmF/2BZTYwyvqCq3AQ87Ph9sxY47maDIT3A==").send({clientID:clientID,employeeID:employeeID,time:(new Date).getTime(),transcodeJob:{videoID:e,fileSize:t,duration:n,transcodeMs:i}}).end(function(){})},buildErrorLogMessage:function(e,t){var n=(0,a.default)(this.buildLogMessage(),{url:e.url,error:{name:e.name,message:e.message,fileName:e.fileName,lineNumber:e.lineNumber,columnNumber:e.columnNumber,stack:e.stack},item:t});return e.response&&(n.apiResponse="("+e.status+") "+e.response.statusText,e.response.req&&e.response.req.toJSON&&(n.apiRequest=e.response.req.toJSON())),n},buildLogMessage:function(){return{clientID:clientID,employeeID:employeeID,url:window.location.href,time:(new Date).getTime(),browser:{name:r.default.name,version:r.default.version}}},htmlToText:function(e){var t=document.createElement("DIV");return t.innerHTML=e,this.removeChildElements(t),(t.innerText||t.textContent||"").trim()},removeChildElements:function(e){for(var t=0;t<e.children.length;t++)this.removeChildElements(e.children[t]);if(e.parentElement){var n=void 0;n=["style"].indexOf(e.nodeName.toLowerCase())>-1?"":["br"].indexOf(e.nodeName.toLowerCase())>-1?"\n":["p","h1","h2","h3","h4","h5","h6","ol","ul","pre","address","blockquote","dl","div","fieldset","form","hr","noscript","table"].indexOf(e.nodeName.toLowerCase())>-1?(e.innerText||e.textContent||"")+"\n":e.innerText||e.textContent||"",e.parentElement.replaceChild(document.createTextNode(n),e)}},getEntityRanges:function(e){for(var t=[],n=void 0;null!=(n=this.entityRegex.exec(e));)t.push({start:n.index,end:n.index+n[0].length-1});return t},reverseString:function(e){for(var t="",n=e.length-1;n>=0;n--)t+=e[n];return t},ellipsizeTextAt:function(e,t,n){var i=!1;if(n){var a=/[\.!\?](?=\W)|.{1}$/m.exec(e);a&&a.index!=e.length-1&&(e=e.substring(0,a.index+1),i=!0)}if(e.length>t){var o=this.getEntityRanges(e).find(function(e){return e.start<t-1&&e.end>=t-1});if(null==o){var r=/\W/m;-1===(e=e.substring(0,t-1))[e.length-1].search(r)&&(e=e.substring(0,e.length-this.reverseString(e.search(r))-1))}else e=e.substring(0,o.end+1);i=!0}return i&&((e=this.trimTrailingPunctuation(e)).endsWith("&hellip;")||e.endsWith("…")||e.endsWith("...")||(e+="&hellip;")),e},trimTrailingPunctuation:function(e){e=e.replace("&nbsp;"," ");for(var t=[".","!","?"," "];-1!==t.indexOf(e[e.length-1]);)e=e.substring(0,e.length-1);return e},getTextFromHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent},getEntityID:function(e){return e.entityID||e[e.entityType.toLowerCase()+"ID"]},getEntityName:function(e){return e.entityName||e.fullName||e[e.entityType.toLowerCase()+"Name"]},getEntityInDirectory:function(e){return"Employee"===e.entityType?e.showInCompanyDirectory:"Company"===e.entityType?e.showInCompaniesDirectory:e["showIn"+e.entityType+"Directory"]},validateSearchText:function(e){if(null==e||""===e||"@"===e||"#"===e)return!1;var t=e[0];if("#"===t&&s.RE_ILLEGAL_HASHTAG.test(e))return!1;if("#"===t||"@"===t){if(e.length<=2)return!1}else if(e.length<=1)return!1;return!0},forOS:function(e,t,n){return-1!=navigator.appVersion.indexOf("Win")?e:-1!=navigator.appVersion.indexOf("Mac")?t:n},isIE:function(){return r.default.msie},isOldIE:function(){return r.default.msie&&r.default.version<10},formatDateTimeStamp:function(e){null!=e&&"Z"!==e[e.length-1]&&(e+="Z");var t=new Date(e),n=new Date,i=void 0;if(t>new Date(n-1e3))i="just now";else if(t>new Date(n-6e4))i=Math.round((n-t)/1e3)+" sec";else if(t>new Date(n-36e5))i=Math.round((n-t)/6e4)+" min";else if(t>new Date(n-864e5))i=Math.round((n-t)/36e5)+"h";else{var a=t.getFullYear()!=n.getFullYear()?", "+t.getFullYear().toString():"";i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]+" "+t.getDate()+a}return i},decodeHTMLEntities:function(e,t){return e&&"string"==typeof e&&(e=(e=e.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),null==t&&(t=document.createElement("div")),t.innerHTML=e,e=t.textContent),e},getOaLinkTitle:function(e){var t="OpenAsset",n=document.createElement("a");return n.href=e,n.pathname.endsWith(".jpg")?t+" - Image":n.pathname.endsWith("ImageLink")?t+" - Image Info":n.pathname.endsWith("ProjectLink")?t+" - Project":t},isUrlOpenAsset:function(e){var t=document.createElement("a");return t.href=e,-1!==openAssetoEmbedHosts.indexOf(t.host.toLowerCase())},tagsContains:function(e,t){return null!=this.findTag(e,t)},findTag:function(e,t){return e.find(function(e){return t.entityType===e.entityType&&t.entityID===e.entityID&&t.hashtag===e.hashtag})},moveArrayElement:function(e,t,n){if(n>=e.length)for(var i=n-this.length;1+i--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e},getOffsetFromAncestorS4Workspace:function(e){var t=0;do{t+=e.offsetTop,e=e.offsetParent}while("s4-workspace"!==e.id&&"BODY"!==e.nodeName);return t},fixBlurInCenteredElement:function(e){e.clientWidth%2==1&&(e.style.width=e.clientWidth+1+"px"),e.clientHeight%2==1&&(e.style.height=e.clientHeight+1+"px")},compensateScrollPosition:function(e,t,n){if(document.getElementById("s4-workspace")){var i=document.getElementById("s4-workspace"),a=c.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-i.scrollTop;n(),window.setTimeout(function(){var e=t(),n=c.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-i.scrollTop;i.scrollTop=Math.max(i.scrollTop-(a-n),0)},100)}else{var o=c.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-(window.pageYOffset||document.documentElement.scrollTop);n(),window.setTimeout(function(){var e=t(),n=window.pageYOffset||document.documentElement.scrollTop,i=c.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-n,a=window.pageXOffset||document.documentElement.scrollLeft;window.scrollTo(a,Math.max(n-(o-i),0))},100)}},isUserBroken:function(){return"0"===currentEmployee.employeeID||"N"===currentEmployee.showInCompanyDirectory},draftSaveStatusText:function(e,t,n,i){if(!n)return"Saved";if(t||i)return"Saving...";switch(e){case l.draftSaveStatuses.saving:return"Saving...";case l.draftSaveStatuses.saved:return"Saved";default:return""}},uniqueItems:function(e){for(var t={},n=[],i=0;i<e.length;i++)t[e[i].itemID]||(t[e[i].itemID]=!0,n.push(e[i]));return n},findAncestor:function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e},pickFrom:function(e,t){if(1==t)return[e[0]];for(var n=[],i=(e.length-1)/(t-1),a=void 0,o=0;t--;)a=Math.round(o),n.push(e[a]),o+=i;return n},outterHeight:function(e){e="string"==typeof e?document.querySelector(e):e;var t=window.getComputedStyle(e),n=parseFloat(t.marginTop)+parseFloat(t.marginBottom);return Math.ceil(e.offsetHeight+n)},removeVideosInContentEditors:function(){if(document.querySelectorAll('div[contenteditor="True"] ka-video').forEach(function(e){return e.parentNode.removeChild(e)}),"undefined"!=typeof _spPageContextInfo){var e='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">                      <soap:Body>                          <GetWebPartProperties2 xmlns="http://microsoft.com/sharepoint/webpartpages">                              <pageUrl>'+location.pathname+"</pageUrl>                               <storage>Shared</storage>                               <behavior>Version3</behavior>                           </GetWebPartProperties2>                      </soap:Body>                   </soap:Envelope>";o.default.post(_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/WebPartPages.asmx").type("xml").send(e).then(function(e){for(var t=(new DOMParser).parseFromString(e.text,"text/xml").getElementsByTagName("WebPart"),n=0;n<t.length;n++){var i=t[n];"Microsoft.SharePoint.WebPartPages.ContentEditorWebPart"===(i.getElementsByTagName("TypeName").length>0?i.getElementsByTagName("TypeName")[0].childNodes[0].nodeValue:i.getElementsByTagName("type")[0].getAttribute("name"))&&document.querySelectorAll('div[webpartid="'+i.getAttribute("ID")+'"] ka-video').forEach(function(e){return e.parentNode.removeChild(e)})}}).catch(function(e){return console.warn(e)})}},generateSimpleID:function(){return Math.floor(65536*(1+Math.random()))}},f={aspx:"wiki",bmp:"image",png:"image",doc:"word",docx:"word",gif:"image",jpeg:"image",jpg:"image",pdf:"pdf",ppt:"ppt",pptx:"ppt",xls:"xls",xlsx:"xls",csv:"xls",wmv:"video",avi:"video",mp4:"video",mov:"video"},m={Community:"communityIcon_25_v2.png",Hashtag:"topicIcon_25.png",OtherResult:"GenericDocument_25_v2.png",SharepointList:"List_25.png",SharepointListItem:"GenericDocument_25_v2.png",SharepointNavItem:"linkIcon_25_v2.png",Link:"linkIcon_25_v2.png",ExternalLink:"linkIcon_25_v2.png",SharepointVideo:"videoIcon_25_v2.png",StreamItem:"Posts_25.png",Video:"videoIcon_25_v2.png",WikiPage:"wikiIcon_25_v2.png"},p=t.imgRoot="https://kamedia3.knowledge-architecture.com/images/";t.static_images={like_off_20:p+"like_off_20.png",like_on_20:p+"like_on_20.png",comment_20:p+"comment_20.png",cancel_11:p+"cancel_11.png",less_caret_cyan_14:p+"less_caret_cyan_14.png",more_caret_cyan_14:p+"more_caret_cyan_14.png",spinner_16:p+"spinner_16.gif",ajax_loader_32:p+"ajax_loader_32.gif",right_caret_dk_grey_7:p+"right_caret_dk_grey_7.png",more_caret_dk_grey_14:p+"more_caret_dk_grey_14.png",more_caret_lt_grey_14:p+"more_caret_lt_grey_14.png",link_grey_16:p+"link_grey_16.png",link_cyan_16:p+"link_cyan_16.png",camera_grey_24:p+"camera_grey_24.png",camera_cyan_24:p+"camera_cyan_24.png",play_grey_18:p+"play_grey_18.png",play_cyan_18:p+"play_cyan_18.png",paperclip_grey_10:p+"paperclip_grey_10.png",paperclip_cyan_10:p+"paperclip_cyan_10.png",ellipsis:p+"ellipsis.png",ellipsis_cyan:p+"ellipsis_cyan.png",upArrow_grey_24:p+"upArrow_grey_24.png",upload_16:p+"upload_16.png",upload_16_cyan:p+"upload_16_cyan.png",right_white_7:p+"right_white_7.png",left_white_7:p+"left_white_7.png",openasset_225:p+"openasset_225.png",pencil_16:p+"pencil_16.png",pencil_black_24:p+"pencil_black_24.png",yield_16:p+"yield_16.png",sharepoint_gray:p+"sharepoint_gray.png",word_post_editor:p+"word_post_editor.png",close_x_white_sm:p+"close_x_white_sm.svg",embed_code_cyan:p+"embed_code_cyan.png",image:p+"image.svg",image_cyan:p+"image_cyan.svg",help_dark:p+"help_dark.png",share_white_20:p+"share_white_20.png"},t.fileBlackList=["bat","cmd","csh","dll","exe","htr","lnk","msi","pl","ps1","ps2","psc1","psc2","reg","scf","shb","url","svc","vb","vbe","vbs","cpl","aspx","asmx","ashx","json","soap","ascx","master","swf","jar","xap"];t.default=c},188:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildThreadUrl=t.buildReqUrl=t.SAVED_COMMENT_DRAFT=t.SET_DRAFT_STATUS=t.SET_WARN_BROKEN_USER=t.SET_WARN_OFFLINE=t.SET_IS_ONLINE=t.SET_ACTION_ERROR=t.UPDATED_ITEM_PUBLISHED=t.UPDATED_ITEM_PROMOTTION=t.RESTORE_COMMENT_EDITOR=t.UPDATED_ITEM_COMMENT=t.UPDATE_ITEM_COMMENT=t.ADDED_ITEM_COMMENT=t.ADD_ITEM_COMMENT=t.SET_IS_COMMENTING=t.DELETED_COMMENT=t.DELETE_COMMENT=t.DELETED_ITEM_TAG=t.DELETING_ITEM_TAG=t.ADDED_ITEM_TAG=t.ADDING_ITEM_TAG=t.TOGGLE_TAG_EDITOR=t.SET_STREAM_VIEW=t.TOGGLE_VIEW_MENU=t.SHOW_NEW_ITEMS=t.SHOW_ALL_COMMENTS=t.DELETED_ITEM_SUBSCRIPTION=t.DELETE_ITEM_SUBSCRIPTION=t.ADDED_ITEM_SUBSCRIPTION=t.ADD_ITEM_SUBSCRIPTION=t.DELETED_ITEM_LIKE=t.DELETE_ITEM_LIKE=t.ADDED_ITEM_LIKE=t.ADD_ITEM_LIKE=t.UNDELETED_ITEM=t.UNDELETE_ITEM=t.DELETED_ITEM=t.DELETE_ITEM=t.SHARED_STREAM_ITEM=t.RECEIVE_UPDATED_ITEMS=t.REQUEST_UPDATED_ITEMS=t.COULDNT_RECEIVE_ITEMS=t.SET_IS_FETCHING=t.RECEIVE_ITEMS=t.REQUEST_ITEMS=t.SET_LIST_MORE_MODE=t.SET_LIST_LESS_MODE=t.TOGGLE_COMMENT_LESS_MODE=t.TOGGLE_SEMI_LESS_MODE=t.TOGGLE_CONTENT_LESS_MODE=t.TOGGLE_ITEM_LESS_MODE=t.SET_CONTENT_TALL=t.GOT_STREAM_CONFIG=t.USER_ZERO=void 0;var i=c(n(275)),a=c(n(235)),o=c(n(186));t.gotStreamConfig=ce,t.setListLessMode=function(){return{type:E}},t.setListMoreMode=function(){return{type:_}},t.toggleViewMenu=function(){return{type:V}},t.setStreamView=function(e){return{type:W,newView:e}},t.requestItems=fe,t.receiveItems=me,t.couldntReceiveItems=pe,t.setIsFetching=he,t.requestUpdatedItems=function(e){return{type:b,url:e}},t.receiveUpdatedItems=ge,t.sharedStreamItem=function(e){return{type:D,item:e}},t.deleteItem=ve,t.deletedItem=ye,t.undeleteItem=Ee,t.undeletedItem=_e,t.toggleItemLessMode=function(e){return{type:h,itemID:e}},t.toggleContentLessMode=function(e){return{type:g,itemID:e}},t.toggleSemiLessMode=function(e){return{type:v,itemID:e}},t.setContentTall=function(e,t){return{type:p,itemID:e,contentIsTall:t}},t.showNewItems=function(){return{type:j}},t.updatedItemPromotion=ke,t.updatedItemPublished=Ie,t.addItemLike=Se,t.addedItemLike=Te,t.deleteItemLike=be,t.deletedItemLike=Ce,t.addItemSubscription=De,t.addedItemSubscription=Me,t.deleteItemSubscription=we,t.deletedItemSubscription=Pe,t.toggleTagEditor=function(e){return{type:K,itemID:e}},t.addingItemTag=Le,t.addedItemTag=Oe,t.deletingItemTag=Ae,t.deletedItemTag=Ne,t.setIsCommenting=function(e,t,n){return{type:X,itemID:e,isCommenting:t,commentID:n}},t.showAllComments=function(e){return{type:H,itemID:e}},t.deleteComment=Re,t.deletedComment=xe,t.addItemComment=Ue,t.addedItemComment=function(e,t){return{type:Z,itemID:e,item:t}},t.updateItemComment=Be,t.updatedItemComment=Fe,t.restoreCommentEditor=He,t.toggleCommentLessMode=function(e){return{type:y,commentID:e}},t.setDraftStatus=je,t.savedCommentDraft=Ve,t.setActionError=We,t.setIsOnLine=function(e){return{type:re,isOnLine:e}},t.setWarnOffline=function(e,t){return{type:se,bannerNumber:e,showWarning:t}},t.setWarnBrokenUser=Ke,t.fetchItems=Ge,t.fetchUpdatedItems=function(){return function(e,t){var n=t(),i=Je(0,25,n.streamView,n.filters,n.filterOperation,l.default.getMaxModDate(n.items,n.newItems,n.updatedItems,n.belowItems,n.deletedItems))+"&enableDeleted=1";return r.default.get(Ye(i)).authBearer(l.default.getToken()).withCredentials().end(function(t,n){t||!n.ok?l.default.receivedAPIError(t||n.text):e(ge(i,n.body))})}},t.removeItem=function(e){return"0"!==currentEmployee.employeeID||l.default.isSPAdmin()?function(t){return t(ve(e)),r.default.delete(Ye("/stream/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(We(n||i.text))):t(ye(e,i.body))})}:{type:f}},t.restoreItem=function(e){return"0"!==currentEmployee.employeeID||l.default.isSPAdmin()?function(t){return t(Ee(e)),r.default.put(Ye("/streamadmin/restore/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(We(n||i.text))):t(_e(e,i.body))})}:{type:f}},t.likeItem=function(e){return function(t){if(!l.default.isUserBroken())return t(Se(e)),r.default.post(Ye("/likes")).authBearer(l.default.getToken()).send({itemID:e}).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(be(e)),t(We(n||i.text))):t(Te(e,i.body))});t(Ke(!0))}},t.unlikeItem=function(e){return function(t){return t(be(e)),r.default.delete(Ye("/likes/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Se(e)),t(We(n||i.text))):t(Ce(e,i.body))})}},t.subscribeToItem=function(e){return function(t){if(!l.default.isUserBroken())return t(De(e)),qe(e,!0,function(){return t(Me(e))});t(Ke(!0))}},t.unsubscribeFromItem=function(e){return"0"===currentEmployee.employeeID?{type:f}:function(t){return t(we(e)),qe(e,!1,function(){return t(Pe(e))})}},t.removeComment=function(e){return"0"===currentEmployee.employeeID?{type:f}:function(t){return t(Re(e)),r.default.delete(Ye("/comments/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(We(n||i.text))):t(xe(e))})}},t.submitCommentDraft=function(e){return function(t,n){return t(je(u.draftSaveStatuses.saving,e.itemID,e.commentID)),e.commentID?function(e,t){return ze=window.setTimeout(function(){e(je(u.draftSaveStatuses.failed,t.itemID,t.commentID))},1e4),r.default.put(apiUrl+"/comments/"+t.commentID).authBearer(l.default.getToken()).send(t).end(function(n,i){ze&&(window.clearTimeout(ze),ze=null),n||!i.ok?((0,d.logError)(n||i.text,t),e(je(u.draftSaveStatuses.failed,t.itemID,t.commentID))):e(Ve(i.body))})}(t,e):function(e,t){return r.default.post(apiUrl+"/comments").authBearer(l.default.getToken()).send(t).end(function(n,i){n||!i.ok?((0,d.logError)(n||i.text,t),e(je(u.draftSaveStatuses.failed,t.itemID,t.commentID))):e(Ve(i.body))})}(t,e)}},t.submitUpdatedItemComment=function(e,t){return function(t){return e.isDraft?t(Ue(e)):t(Be(e)),e.isDraft=!1,r.default.put(Ye("/comments/"+e.commentID)).authBearer(l.default.getToken()).send(e).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(He(itemID,commentID)),t(We(n||i.text))):t(Fe(e.itemID,e.commentID,i.body))})}},t.addItemTag=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:(t=(0,o.default)(t,{itemID:e}),function(n){return n(Le(e,t)),r.default.post(Ye("/"+(t.hashtag?"hashtags":"mentions"))).authBearer(l.default.getToken()).send(t).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(We(t||i.text))):n(Oe(e,i.body))})})},t.deleteItemTag=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:(t=(0,o.default)(t,{itemID:e,entityType:t.hashtag?"Hashtag":t.entityType,entityID:t.entityID||t.hashtag}),function(n){return n(Ae(e,t)),r.default.delete(Ye("/mentions")).authBearer(l.default.getToken()).send(t).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(We(t||i.text))):n(Ne(e,i.body))})})},t.promoteItem=function(e,t,n){return"0"===currentEmployee.employeeID?{type:f}:function(i){return r.default.post(Ye("/streamadmin/promoted/"+e)).authBearer(l.default.getToken()).send({PromotedEndDate:t,PushNotification:n?1:0}).end(function(t,n){t||!n.ok?(l.default.receivedAPIError(t||n.text),i(We(t||n.text))):(i(ke(e,n.body)),i(Ge()))})}},t.updateItemPromotion=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:function(n){return r.default.put(Ye("/streamadmin/promoted/"+e)).authBearer(l.default.getToken()).send({PromotedEndDate:t}).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(We(t||i.text))):(n(ke(e,i.body)),n(Ge()))})}},t.demoteItem=function(e){return"0"===currentEmployee.employeeID?{type:f}:function(t){return r.default.delete(Ye("/streamadmin/promoted/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(We(n||i.text))):(t(ke(e,i.body)),t(Ge()))})}},t.setPublished=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:function(n){return(t?r.default.post(Ye("/streamadmin/published/"+e)):r.default.delete(Ye("/streamadmin/published/"+e))).authBearer(l.default.getToken()).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(We(t||i.text))):n(Ie(e,i.body))})}},t.getStreamConfig=function(){return function(e){return r.default.get("/_layouts/15/NexusAPIProxy/StreamConfig.ashx").end(function(t,n){t||!n.ok?(l.default.receivedAPIError(t||n.text),e(ce({apiFilterEnabled:!1,presenceEnabled:!1}))):e(ce(n.body))})}};var r=c(n(191)),s=n(257),l=c(n(179)),u=n(208),d=n(189);function c(e){return e&&e.__esModule?e:{default:e}}n(216)(r.default);var f=t.USER_ZERO="NOT_IN_DIRECTORY",m=t.GOT_STREAM_CONFIG="GOT_STREAM_CONFIG",p=t.SET_CONTENT_TALL="SET_CONTENT_TALL",h=t.TOGGLE_ITEM_LESS_MODE="TOGGLE_ITEM_LESS_MODE",g=t.TOGGLE_CONTENT_LESS_MODE="TOGGLE_CONTENT_LESS_MODE",v=t.TOGGLE_SEMI_LESS_MODE="TOGGLE_SEMI_LESS_MODE",y=t.TOGGLE_COMMENT_LESS_MODE="TOGGLE_COMMENT_LESS_MODE",E=t.SET_LIST_LESS_MODE="SET_LIST_LESS_MODE",_=t.SET_LIST_MORE_MODE="SET_LIST_MORE_MODE",k=t.REQUEST_ITEMS="REQUEST_ITEMS",I=t.RECEIVE_ITEMS="RECEIVE_ITEMS",S=t.SET_IS_FETCHING="SET_IS_FETCHING",T=t.COULDNT_RECEIVE_ITEMS="COULDNT_RECEIVE_ITEMS",b=t.REQUEST_UPDATED_ITEMS="REQUEST_UPDATED_ITEMS",C=t.RECEIVE_UPDATED_ITEMS="RECEIVE_UPDATED_ITEMS",D=t.SHARED_STREAM_ITEM="SHARED_STREAM_ITEM",M=t.DELETE_ITEM="DELETE_ITEM",w=t.DELETED_ITEM="DELETED_ITEM",P=t.UNDELETE_ITEM="UNDELETE_ITEM",L=t.UNDELETED_ITEM="UNDELETED_ITEM",O=t.ADD_ITEM_LIKE="ADD_ITEM_LIKE",A=t.ADDED_ITEM_LIKE="ADDED_ITEM_LIKE",N=t.DELETE_ITEM_LIKE="DELETE_ITEM_LIKE",R=t.DELETED_ITEM_LIKE="DELETED_ITEM_LIKE",x=t.ADD_ITEM_SUBSCRIPTION="ADD_ITEM_SUBSCRIPTION",U=t.ADDED_ITEM_SUBSCRIPTION="ADDED_ITEM_SUBSCRIPTION",B=t.DELETE_ITEM_SUBSCRIPTION="DELETE_ITEM_SUBSCRIPTION",F=t.DELETED_ITEM_SUBSCRIPTION="DELETED_ITEM_SUBSCRIPTION",H=t.SHOW_ALL_COMMENTS="SHOW_ALL_COMMENTS",j=t.SHOW_NEW_ITEMS="SHOW_NEW_ITEMS",V=t.TOGGLE_VIEW_MENU="TOGGLE_VIEW_MENU",W=t.SET_STREAM_VIEW="SET_STREAM_VIEW",K=t.TOGGLE_TAG_EDITOR="TOGGLE_TAG_EDITOR",G=t.ADDING_ITEM_TAG="ADDING_ITEM_TAG",q=t.ADDED_ITEM_TAG="ADDED_ITEM_TAG",z=t.DELETING_ITEM_TAG="DELETING_ITEM_TAG",Y=t.DELETED_ITEM_TAG="DELETED_ITEM_TAG",J=t.DELETE_COMMENT="DELETE_COMMENT",Q=t.DELETED_COMMENT="DELETED_COMMENT",X=t.SET_IS_COMMENTING="SET_IS_COMMENTING",$=t.ADD_ITEM_COMMENT="ADD_ITEM_COMMENT",Z=t.ADDED_ITEM_COMMENT="ADDED_ITEM_COMMENT",ee=t.UPDATE_ITEM_COMMENT="UPDATE_ITEM_COMMENT",te=t.UPDATED_ITEM_COMMENT="UPDATED_ITEM_COMMENT",ne=t.RESTORE_COMMENT_EDITOR="RESTORE_COMMENT_EDITOR",ie=t.UPDATED_ITEM_PROMOTTION="UPDATED_ITEM_PROMOTION",ae=t.UPDATED_ITEM_PUBLISHED="UPDATED_ITEM_PUBLISHED",oe=t.SET_ACTION_ERROR="SET_ACTION_ERROR",re=t.SET_IS_ONLINE="SET_IS_ONLINE",se=t.SET_WARN_OFFLINE="SET_WARN_OFFLINE",le=t.SET_WARN_BROKEN_USER="SET_WARN_BROKEN_USER",ue=t.SET_DRAFT_STATUS="SET_DRAFT_STATUS",de=t.SAVED_COMMENT_DRAFT="SAVED_COMMENT_DRAFT";function ce(e){return{type:m,config:e}}function fe(e){return{type:k,url:e}}function me(e,t){return{type:I,url:e,items:t.results}}function pe(e){return{type:T,error:e}}function he(e){return{type:S,isFetching:e}}function ge(e,t){return{type:C,url:e,items:t.results}}function ve(e){return{type:M,itemID:e}}function ye(e,t){return{type:w,itemID:e,item:t}}function Ee(e){return{type:P,itemID:e}}function _e(e,t){return{type:L,itemID:e,item:t}}function ke(e,t){return{type:ie,item:t,itemID:e}}function Ie(e,t){return{type:ae,item:t,itemID:e}}function Se(e){return{type:O,itemID:e}}function Te(e,t){return{type:A,itemID:e,item:t}}function be(e){return{type:N,itemID:e}}function Ce(e,t){return{type:R,itemID:e,item:t}}function De(e){return{type:x,itemID:e}}function Me(e){return{type:U,itemID:e}}function we(e){return{type:B,itemID:e}}function Pe(e){return{type:F,itemID:e}}function Le(e,t){return{type:G,itemID:e,tag:t}}function Oe(e,t){return{type:q,itemID:e,item:t}}function Ae(e,t){return{type:z,itemID:e,tag:t}}function Ne(e,t){return{type:Y,itemID:e,item:t}}function Re(e){return{type:J,commentID:e}}function xe(e){return{type:Q,commentID:e,receivedAt:Date.now()}}function Ue(e){return{type:$,comment:e}}function Be(e){return{type:ee,comment:e}}function Fe(e,t,n){return{type:te,itemID:e,commentID:t,item:n}}function He(e,t){return{type:ne,itemID:e,commentID:t}}function je(e,t,n){return{type:ue,draftSaveStatus:e,itemID:t,commentID:n}}function Ve(e){return{type:de,commentDraft:e}}function We(e){return{type:oe,error:e}}function Ke(e){return{type:le,showWarning:e}}function Ge(){return function(e,t){var n=t(),i=void 0;if(n.filters.length>0&&void 0!==n.filters[0].StreamItem)i=Qe(n.filters[0].StreamItem);else{var a=s.ITEMS_PER_PAGE;0!==n.maxItems&&(a=Math.min(n.maxItems,s.ITEMS_PER_PAGE));var o=n.maxItems-n.items.length;o>0&&o<a&&(a=o),i=Je(n.items.length-1,a,n.streamView,n.filters,n.filterOperation)}return e(fe(i)),r.default.get(Ye(i)).authBearer(l.default.getToken()).withCredentials().end(function(t,n){t||!n.ok?(l.default.receivedAPIError(t||n.text),e(pe(t||n.text)),window.setTimeout(function(){return e(he(!1))},2e3)):e(me(i,n.body))})}}var qe=function(e,t,n){return r.default.post(Ye("/subscriptions")).authBearer(l.default.getToken()).send({EntityType:"StreamItem",EntityID:e,Type:"notify",Enabled:t?1:-1}).end(function(e,t){e||!t.ok?(l.default.receivedAPIError(e||t.text),dispatch(We(e||t.text))):n()})};var ze=void 0;var Ye=t.buildReqUrl=function(e){return apiUrl+e},Je=function(e,t,n,i,a,o){return"/stream?offset="+e+"&pageSize="+t+"&view="+Xe(n)+$e(i,a)+Ze(o)},Qe=t.buildThreadUrl=function(e){return"/stream/"+e},Xe=function(e){switch(e){case"ImFollowing":return"Following";case"MostActive":return"Active";case"Promoted":return"PromotedAdmin";case"Removed":return"DeletedAdmin";case"Published":return"PublishedAdmin";default:return"/pages/streamadministration.aspx"===window.location.pathname.toLowerCase()?"Admin":l.default.isHome()?"HomeAll":"Default"}},$e=function(e,t){var n="";return e.forEach(function(t){switch((0,a.default)(t)[0]){case"BlogPost":var o=t.BlogPost.split("|");n+="&spListID="+o[0]+"&spPostID="+o[1];break;case"BlogCategory":n+="&blogPostCategoryURL="+encodeURIComponent(t.BlogCategory);break;case"Author":n+="&authorID="+encodeURIComponent(e[0].Author);break;default:n+="&mentionID="+(0,a.default)(t)[0]+"|"+encodeURIComponent((0,i.default)(t)[0])}}),e.length>1&&(n+="&andOr="+t),n},Ze=function(e){return null!=e?"&minModDate="+e:""}},189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProfileInfo=t.getCancelUploadFilter=t.getLinkTarget=t.isEditingWebpartPage=t.isEditingWikiPage=t.isWikiPage=t.getQueryStringValue=t.logError=void 0;var i=l(n(186)),a=l(n(96)),o=l(n(191)),r=l(n(204)),s=l(n(179));function l(e){return e&&e.__esModule?e:{default:e}}t.logError=function(e,t){console.error(e),e&&null!=e.status&&401===e.status&&(console.warn("API returned 401. Reloading token."),localStorage.removeItem("apiToken"),s.default.validateToken()),e.message&&0===e.message.indexOf("Request has been terminated")||("undefined"!=typeof newrelic&&newrelic.noticeError(e),o.default.post("https://browserlogger.knowledge-architecture.com/api/log?code=cEjHEuR83JGCrIO4T31PMIvhSJpZhwxfGRc6C95PGXZrYlnBYhtMag==").type("application/json; charset=UTF-8").send(d(e,t)).then(function(e){}).catch(function(e){console.log(e)}))};var u=t.getQueryStringValue=function(e){e=e.toLowerCase();var t=!0,n=!1,i=void 0;try{for(var o,r=(0,a.default)(window.location.search.split(/[?&]/));!(t=(o=r.next()).done);t=!0){var s=o.value.split("=");if(2===s.length&&s[0].toLowerCase()===e)return s[1]}}catch(e){n=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw i}}return null},d=(t.isWikiPage=function(){return!("undefined"==typeof MSOWebPartPageFormName||!document.forms[MSOWebPartPageFormName]||!document.forms[MSOWebPartPageFormName]._wikiPageMode)},t.isEditingWikiPage=function(){if("undefined"!=typeof MSOWebPartPageFormName&&document.forms[MSOWebPartPageFormName]){var e=document.forms[MSOWebPartPageFormName]._wikiPageMode;return e&&"Edit"===e.value}return!1},t.isEditingWebpartPage=function(){if("undefined"!=typeof MSOWebPartPageFormName&&document.forms[MSOWebPartPageFormName]){var e=document.forms[MSOWebPartPageFormName].MSOLayout_InDesignMode;return e&&"1"===e.value}return!1},t.getLinkTarget=function(e){if("A"===e.nodeName)return e;for(var t=e.parentNode;null!=t;){if("A"===t.nodeName)return t;t=t.parentNode}return null},t.getCancelUploadFilter=function(){return{cancel:!1,loggingOn:!0,onCancelComplete:null,nextCounter:0,returnCounter:0,handle:function(e,t){var n=this;n.cancel||t&&(n.nextCounter++,t(e,function(e,t,i){n.returnCounter++,n.cancel?n.nextCounter==n.returnCounter&&n.onCancelComplete&&n.onCancelComplete():i?i(e):t&&t(e)}))},log:function(e){this.loggingOn&&console.log("cancelUploadFilter: "+e+" nc: "+this.nextCounter+", rc: "+this.returnCounter)}}},function(e,t){var n=(0,i.default)(c(),{url:e.url,error:{name:e.name,message:e.message,fileName:e.fileName,lineNumber:e.lineNumber,columnNumber:e.columnNumber,stack:e.stack},item:t});return e.response&&(n.apiResponse="("+e.status+") "+e.response.statusText,e.response.req&&e.response.req.toJSON&&(n.apiRequest=e.response.req.toJSON())),n}),c=function(){return{clientID:clientID,employeeID:employeeID,url:window.location.href,time:(new Date).getTime(),browser:{name:r.default.name,version:r.default.version}}};t.getProfileInfo=function(){return null!=u("Employee")?(0,i.default)(location,{entityType:"Employee",entityID:u("Employee")}):null!=u("Project")?(0,i.default)(location,{entityType:"Project",entityID:u("Project")}):null!=u("Opportunity")?(0,i.default)(location,{entityType:"Opportunity",entityID:u("Opportunity")}):null!=u("Company")?(0,i.default)(location,{entityType:"Company",entityID:u("Company")}):null!=u("Contact")?(0,i.default)(location,{entityType:"Contact",entityID:u("Contact")}):void 0}},192:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(181)),a=m(n(182)),o=m(n(183)),r=m(n(184)),s=m(n(185)),l=n(177),u=m(l),d=m(n(187)),c=n(179),f=m(c);function m(e){return e&&e.__esModule?e:{default:e}}n(283),f.default.isIE()&&n(284);var p=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleKey=n.handleKey.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentWillMount",value:function(){window.addEventListener("keydown",this.handleKey,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKey,!0)}},{key:"handleKey",value:function(e){this.props.onClose&&27===e.keyCode&&this.props.onClose()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.style,a=t.onClose,o=t.title,r=t.titleHelp,s=t.children,l=t.onLeft,f=t.onRight,m=t.hideX,p=t.disableOverlayClick;return d.default.createPortal(u.default.createElement("div",{className:"kamodal-overlay"+(p?" disabled":""),onClick:p?void 0:a},u.default.createElement("div",{className:"kamodal-container "+(n||""),style:i,onClick:function(e){e.stopPropagation()},ref:function(t){return e.box=t}},!m&&u.default.createElement("img",{className:"kamodal-close",src:c.imgRoot+"close_x_sm.svg",title:"Close (Esc)",onClick:a}),o&&u.default.createElement("div",{className:"kamodal-title"},u.default.createElement("span",null,o),r),u.default.createElement("div",{className:"kamodal-content "+(o?"":"notitle")},s)),l&&u.default.createElement("img",{className:"kamodal-left",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),l()}}),f&&u.default.createElement("img",{className:"kamodal-right",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),f()}})),document.body)}}]),t}(l.Component);t.default=p},203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(181)),a=c(n(182)),o=c(n(183)),r=c(n(184)),s=c(n(185)),l=n(177),u=(c(l),c(n(180))),d=c(n(187));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"handleClick",value:function(e){d.default.findDOMNode(this).contains(e.target)||this.props.onClose()}},{key:"componentWillMount",value:function(){var e=this;window.setTimeout(function(){return window.addEventListener("click",e.handleClick,!1)},0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick,!1)}},{key:"render",value:function(){return this.props.children}}]),t}(l.Component);f.proptypes={onClose:u.default.func.isRequired},t.default=f},205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHHMMSS=void 0;var i=d(n(181)),a=d(n(182)),o=d(n(183)),r=d(n(184)),s=d(n(185)),l=n(177),u=d(l);function d(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,a.default)(this,t),(0,r.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return u.default.createElement("span",{className:"ka-duration"},f(this.props.duration))}}]),t}(l.Component);t.default=c;var f=t.toHHMMSS=function(e){var t=Math.ceil(parseFloat(e)),n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),a=t-3600*n-60*i;return a<10&&(a="0"+a),n>0&&i<10&&(i="0"+i),n>0?n+":"+i+":"+a:i+":"+a}},207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEF_VIDEO_WIDTH=576,t.DEF_VIDEO_HEIGHT=324,t.MIN_VIDEO_WIDTH=330,t.MAX_VIDEO_WIDTH=1026},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.draftSaveStatuses={failed:-2,blocked:-1,idle:0,saving:1,saved:2}},209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INT_TITLE_MAX_CHARS=150,t.INT_BODY_MAX_CHARS=15e3,t.INT_STREAM_IMAGE_WIDTH=578,t.INT_STREAM_IMAGE_HEIGHT=800,t.INT_COMMENT_IMAGE_WIDTH=492,t.INT_COMMENT_IMAGE_HEIGHT=800,t.INT_STREAM_LESS_CHARS=164,t.INT_COMMENT_LESS_CHARS=1115,t.INT_WEBPAGE_BODY_CHARS=111,t.INT_MAX_VIDEO_SIZE=5368709120,t.INT_MAX_IMAGE_SIZE=31457280},211:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RE_URL_ONLY=new RegExp("^((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*$","i"),t.RE_URL_END=new RegExp("((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*$","i"),t.RE_URL_ANYWHERE=new RegExp("((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*","i"),t.RE_URL_EVERYWHERE=new RegExp("((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*","ig"),t.RE_ILLEGAL_HASHTAG=/[^\w&+\/#-]/,t.RE_HASHTAG_EVERYWHERE=/(?:\s|^|&#160;|​)(#[\w&+\/-]*[a-zA-Z_-]+[\w&+\/-]*)/gi,t.RE_FILE_EXTENSION=/(?:\.([^.]+))?$/,t.RE_VID_URL_ONLY=/^https?:\/\/[\w-\._~:\/\?%#\[\]@!\$&'\(\)\*\+,;=]*\/_layouts\/video\/player\.aspx\?id=([0-9a-f-]{36})[\w-\._~:\/\?%#\[\]@!\$&'\(\)\*\+,;=]*?(?:&start=(\d+))*[\w-\._~:\/\?%#\[\]@!\$&'\(\)\*\+,;=]*$/i,t.RE_GIPHY_DIRECT=/^https?:\/\/media\.giphy\.com\/media\/.*\/giphy\.gif$/i,t.RE_GIPHY_PAGE=/^https?:\/\/giphy\.com\/gifs\/.*$/i,t.RE_GIPHY_SHORT=/^https?:\/\/gph\.is\/.*$/i},213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventTypes=void 0;var i=r(n(186));t.trackPostAuthorClick=function(e,t,n){u("Clickthrough",{Post:{ItemID:n.itemID,Promoted:n.promoted?1:0},Target:{Context:"PostAuthor",Url:e,Title:t,RelativeUrl:c(e)}})},t.trackPostLinkClick=function(e,t,n){u("Clickthrough",{Post:{ItemID:n.itemID,Promoted:n.promoted?1:0},Target:{Context:"PostLink",Url:e,Title:t,RelativeUrl:c(e)}})},t.trackPostTagClick=function(e,t,n,i,a){u("Clickthrough",{Post:{ItemID:a.itemID,Promoted:a.promoted?1:0},Target:{Context:"PostTag",Url:e,Title:t,EntityType:n,EntityID:i,RelativeUrl:c(e)}})},t.trackCommentLinkClick=function(e,t,n,i){u("Clickthrough",{Post:{ItemID:n.itemID,Promoted:n.promoted?1:0},Comment:{CommentID:i.commentID},Target:{Context:"CommentLink",Url:e,Title:t,RelativeUrl:c(e)}})},t.trackCommentTagClick=function(e,t,n,i,a,o){u("Clickthrough",{Post:{ItemID:a.itemID,Promoted:a.promoted?1:0},Comment:{CommentID:o.commentID},Target:{Context:"CommentTag",Url:e,Title:t,EntityType:n,EntityID:i,RelativeUrl:c(e)}})},t.trackPostSubitemClick=function(e,t,n,i){u("Clickthrough",{Post:{ItemID:i.itemID,Promoted:i.promoted?1:0},Target:{Context:"PostSubitem",CollectionType:e,CollectionID:t,CollectionMember:n}})},t.trackCommentSubitemClick=function(e,t,n,i,a){u("Clickthrough",{Post:{ItemID:i.itemID,Promoted:i.promoted?1:0},Comment:{CommentID:a.commentID},Target:{Context:"CommentSubitem",CollectionType:e,CollectionID:t,CollectionMember:n}})},t.trackPostImpression=function(e){u("Impression",{Post:{ItemID:e.itemID,Promoted:e.promoted?1:0}})},t.trackPostOpen=function(e){u("Open",{Post:{ItemID:e.itemID,Promoted:e.promoted?1:0}})},t.trackVideoWatch=function(e,t,n,i,a){u("Watch",{Video:{mediaID:e,sessionID:n,chunksWatched:t},Post:i?{ItemID:i.itemID,Promoted:i.promoted?1:0}:void 0,Comment:a?{CommentID:a.commentID}:void 0})};var a=r(n(191)),o=n(189);function r(e){return e&&e.__esModule?e:{default:e}}var s="https://kasa.knowledge-architecture.com/api/spa?code=FLof2z/4dZ7srUY7/mDJsfjmMcwm32jERVCU9b1ChxlzcrV4MR1hHA==",l="https://kasa.knowledge-architecture.com/api/sva?code=dalnU09SW/8eiTkw7vNHiePWIZd6KsdSlzrVLIJALGiRkc3veLA1AA==";function u(e,t){var n={Client:clientID.toLowerCase(),Timestamp:"",User:employeeID,CurrentEmployee:currentEmployee||null,Channel:"Web",Source:"ReactStream",StreamMode:null==(0,o.getQueryStringValue)("ItemID")?localStorage.getItem("moreOrLess")||"less":void 0,StreamView:null==(0,o.getQueryStringValue)("ItemID")?localStorage.getItem("streamView")||"All":void 0,EventType:e,Location:d(),Referrer:{Url:document.referrer,RelativeUrl:c(document.referrer)},UserAgent:{CurrentTime:Date.now(),TimeZone:(new Date).getTimezoneOffset(),ScreenResolution:screen.width+"x"+screen.height,WindowSize:window.innerWidth+"x"+window.innerHeight,UaHeader:window.navigator.userAgent,Version:"16"}},r={Client:clientID.toLowerCase(),User:employeeID,EventType:e,Channel:"Web",Source:"ReactStream",Location:window.location.href,EventData:(0,i.default)(n,t)};a.default.post("Watch"===e?l:s).type("application/json; charset=UTF-8").send(r).then(function(e){}).catch(function(e){})}function d(){var e={Url:window.location.href,RelativeUrl:c(window.location.href),Title:document.title,Community:communityID};return null!=(0,o.getQueryStringValue)("ItemID")?(0,i.default)(e,{EntityType:"Post",EntityID:(0,o.getQueryStringValue)("ItemID")}):null!=(0,o.getQueryStringValue)("Hashtag")?(0,i.default)(e,{EntityType:"Hashtag",EntityID:decodeURIComponent((0,o.getQueryStringValue)("Hashtag"))}):null!=(0,o.getQueryStringValue)("Employee")?(0,i.default)(e,{EntityType:"Employee",EntityID:(0,o.getQueryStringValue)("Employee")}):null!=(0,o.getQueryStringValue)("Project")?(0,i.default)(e,{EntityType:"Project",EntityID:(0,o.getQueryStringValue)("Project")}):null!=(0,o.getQueryStringValue)("Opportunity")?(0,i.default)(e,{EntityType:"Opportunity",EntityID:(0,o.getQueryStringValue)("Opportunity")}):null!=(0,o.getQueryStringValue)("Company")?(0,i.default)(e,{EntityType:"Company",EntityID:(0,o.getQueryStringValue)("Company")}):null!=(0,o.getQueryStringValue)("Contact")?(0,i.default)(e,{EntityType:"Contact",EntityID:(0,o.getQueryStringValue)("Contact")}):window.location.pathname.toLowerCase().endsWith("post.aspx")?(0,i.default)(e,{EntityType:"BlogPost",EntityID:(0,o.getQueryStringValue)("List")+"|"+(0,o.getQueryStringValue)("ID")}):window.location.pathname.toLowerCase().endsWith("category.aspx")?(0,i.default)(e,{EntityType:"BlogCategory",EntityID:window.location.href}):(0,i.default)(e,{EntityType:"Community",EntityID:communityID}),e}function c(e){var t=document.createElement("a");return t.href=e,t.pathname.length>0&&(0!=t.pathname.indexOf("/")&&(t.pathname="/"+t.pathname),-1!==t.pathname.indexOf("/",t.pathname.length-1)&&(t.pathname=t.pathname.substring(0,t.pathname.length-1))),t.hostname.toLowerCase()==window.location.hostname.toLowerCase()?t.pathname.toLowerCase()+t.search.toLowerCase():e.toLowerCase()}t.eventTypes={click:0,watch:1}},214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ALERT_MISSING_TITLE={title:"Oops! You forgot a title.",message:"Please include a title."},t.ALERT_MISSING_TAGS={title:"Oops! You forgot to add tags.",message:"Please add at least one tag."},t.ALERT_TITLE_LENGTH={title:"Title cannot exceed 150 characters.",message:"Please shorten your title."},t.ALERT_MISSING_COMMENT={title:"Oops! You forgot to comment.",message:"Please enter a comment."},t.ALERT_BODY_LENGTH={title:"Post cannot exceed 15,000 characters.",message:"Please shorten your post."},t.ALERT_STILL_UPLOADING={title:"Some files are still uploading.",message:"Please try again soon."},t.ALERT_IMAGE_SIZE={title:"30 MB Size Limit for Images",message:"Please resize or upload a smaller image."},t.ALERT_VIDEO_SIZE={title:"5 GB Size Limit for Videos",message:"Please upload a smaller video."},t.ALERT_DOC_SIZE={title:"250 MB Size Limit for Files",message:"Please upload a smaller file."},t.ALERT_DOC_TYPE={title:"File Type Not Supported",message:'For more information on supported file types, please visit our <a href="https://knowledgearchitecture.zendesk.com/hc/en-us/articles/115003909846-Unsupported-File-Types" class="linkActive" target="_blank">support site</a>.'},t.ALERT_VID_TYPE={title:"File Type Not Supported",message:"Please upload only video files with this tool."},t.ALERT_UPLOAD_FAILED={title:"File Upload Failed",message:"Please try again."},t.ALERT_VIDEO_FAILED={title:"Video Upload Failed",message:"Please try again."},t.OUTAGE_BANNERS={isEditing:{message:"Posting and commenting are temporarily unavailable. Your unfinished work has been saved and will be available once internet connectivity is restored.",dismissible:!1,number:1},notCommenting:{message:"Commenting is temporarily unavailable. Please check your internet connection.",dismissible:!0,number:2},notPosting:{message:"Posting is temporarily unavailable. Please check your internet connection.",dismissible:!0,number:3},brokenUser:{message:"Posting, commenting, and liking is currently unavailable for your user account. Please contact your administrator.",dismissible:!0,number:3}}},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.containsFiles=t.getLinkPeekPos=t.getCollectionMemberID=t.decorateInlineMentions=t.selectionStateAtEnd=t.getEntityRangeAtCursor=t.insertLinkAt=t.newBlogCallback=t.confirmLeaveListener=t.didTextChange=t.populateMissingCollectionIDsInContent=t.jsonContentToContentState=t.formattedContentToContentState=t.removeBrokenAtomicBlocksFromRawContent=t.removeDataUrlsFromRawContent=t.selectLink=t.tryGetLinkSelection=t.insertLink=t.getSelectedLinkUrl=t.getTextSelection=t.removeConfirmLeave=t.addConfirmLeave=t.newEditorState=t.getDecorator=t.adjustTargetBasedOnCursor=t.createSPBlog=t.createWordBlog=void 0;var i=m(n(234)),a=m(n(186));t.findTagEntities=v,t.findLinkEntities=y,t.findPendingHashtags=E;var o=n(220),r=n(662),s=m(n(179)),l=n(211),u=m(n(547)),d=m(n(548)),c=m(n(549)),f=n(325);function m(e){return e&&e.__esModule?e:{default:e}}t.createWordBlog=function(){return newBlogPostOnClient("18faf3ff-2cdd-4f17-9b7c-b11d0116f405",blogOptions.webUrl,blogOptions.webID)},t.createSPBlog=function(){OpenPopUpPage(urlTemplates.communityUrls[communityID]+"/Lists/Posts/NewPost.aspx",k)},t.adjustTargetBasedOnCursor=function(e,t){if(e.isCollapsed()){var n=t.getBlockForKey(e.getAnchorKey());if("atomic"===n.getType()||e.getAnchorOffset()>=n.getLength()/2){var i=t.getKeyAfter(e.getAnchorKey());e=i?new o.SelectionState({anchorKey:i,anchorOffset:0,focusKey:i,focusOffset:0}):null}}return e};var p=t.getDecorator=function(e){return new o.CompositeDecorator([{strategy:v,component:d.default},{strategy:y,component:u.default,props:{onLinkPeek:e}},{strategy:E,component:c.default}])},h=(t.newEditorState=function(e){return o.EditorState.createEmpty(p(e||null))},t.addConfirmLeave=function(){window.addEventListener("beforeunload",_)},t.removeConfirmLeave=function(){window.removeEventListener("beforeunload",_)},t.getTextSelection=function(e,t){var n=e.getSelection();t=t||"\n";var i=n.getStartKey(),a=n.getEndKey(),o=e.getCurrentContent().getBlockMap(),r=!1;return o.skipUntil(function(e){return e.getKey()===i}).takeUntil(function(e){var t=r;return e.getKey()===a&&(r=!0),t}).map(function(e){var t=e.getKey(),o=e.getText(),r=0,s=o.length;return t===i&&(r=n.getStartOffset()),t===a&&(s=n.getEndOffset()),o=o.slice(r,s)}).join(t)},t.getSelectedLinkUrl=function(e){var t=e.getSelection();if(!t.isCollapsed()){var n=e.getCurrentContent(),i=n.getBlockForKey(t.getAnchorKey()).getEntityAt(t.getAnchorOffset()-(!0===t.getIsBackward()?1:0)),a=n.getBlockForKey(t.getFocusKey()).getEntityAt(t.getFocusOffset()-(!0===t.getIsBackward()?0:1));if(null!=i&&i===a)return n.getEntity(i).getData().url}return null},t.insertLink=function(e,t,n){return I(e,e.getSelection(),t,n)},t.tryGetLinkSelection=function(e){var t=S(e);if(null!=t){var n=e.getCurrentContent();if("LINK"===n.getEntity(n.getBlockForKey(t.blockKey).getEntityAt(t.start)).getType()){var i=e.getSelection();return i.merge({anchorOffset:!0===i.getIsBackward()?t.end:t.start,focusOffset:!0===i.getIsBackward()?t.start:t.end})}}return null}),g=(t.selectLink=function(e){var t=h(e);return null!=t?o.EditorState.forceSelection(e,t):e},t.removeDataUrlsFromRawContent=function(e){var t={entityMap:{},blocks:e.blocks};for(var n in e.entityMap){var i=e.entityMap[n];t.entityMap[n]={type:i.type,mutability:i.mutability,data:"Image"===i.data.collectionType?{collectionType:i.data.collectionType,collection:i.data.collection?(0,a.default)({},i.data.collection,{collectionMembers:i.data.collection.collectionMembers?i.data.collection.collectionMembers.map(function(e){return(0,a.default)({},e,{mediaList:e.mediaList?e.mediaList.map(function(e){return(0,a.default)({},e,{dataUrl:void 0})}):void 0})}):void 0}):void 0,files:void 0}:i.data}}return t},t.removeBrokenAtomicBlocksFromRawContent=function(e){return(0,a.default)({},e,{blocks:e.blocks.map(function(t){return"atomic"!==t.type||null!=e.entityMap[t.entityRanges[0].key].data.collection?t:{data:{},depth:0,entityRanges:[],inlineStyleRanges:[],key:t.key,text:"",type:"unstyled"}})})},t.formattedContentToContentState=function(e,t,n,i){if(null!=e){var a=(0,r.stateFromHTML)(e.replace(/<\/div><br>/gi,"<br></div>"));return a=b(a,t,n,i)}return null});t.jsonContentToContentState=function(e,t,n,i,a){var r=o.ContentState.createFromText("");return"string"==typeof e&&(e=JSON.parse(e)),e.forEach(function(e){if(null!=e.html){var s=g(e.html,t,n,i);r=o.ContentState.createFromBlockArray(r.getBlocksAsArray().concat(s.getBlocksAsArray()),r.getEntityMap())}else if(null!=e.collectionID){r.createEntity("StreamCollection","IMMUTABLE",{collection:a.find(function(t){return t.collectionType===e.type&&t.collectionID===e.collectionID}),collectionType:e.type});var l=r.getLastCreatedEntityKey();r=o.AtomicBlockUtils.insertAtomicBlock(o.EditorState.acceptSelection(o.EditorState.createWithContent(r),T(r)),l," ").getCurrentContent()}}),r},t.populateMissingCollectionIDsInContent=function(e,t){e&&t&&e.forEach(function(e){if(e.collection){var n=t.find(function(t){if(t.collectionType===(e.collection.collectionType||e.collection.type)){if((e.collection.collectionID||e.collectionID)===t.collectionID)return!0;if(t.collectionMembers&&t.collectionMembers.length>0){for(var n=function(n){var i=e.collection.collectionMembers[n];if(null==t.collectionMembers.find(function(n){return C(e.collection.collectionType,i)==C(t.collectionType,n)}))return{v:!1}},a=0;a<e.collection.collectionMembers.length;a++){var o=n(a);if("object"===(void 0===o?"undefined":(0,i.default)(o)))return o.v}return!0}}return!1});n&&(e.collectionID=n.collectionID,e.collection.collectionID=n.collectionID,e.collection.collectionMembers.forEach(function(t){t.collectionID=n.collectionID;var i=n.collectionMembers.find(function(i){return C(e.collection.collectionType,t)==C(n.collectionType,i)});i&&(t.mediaCollectionID=i.mediaCollectionID,t.documentID=i.documentID,t.memberData=i.memberData)}))}})},t.didTextChange=function(e,t){return e.getCurrentContent().getPlainText()!==t.getCurrentContent().getPlainText()};function v(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();try{return null!==t&&"TAG"===n.getEntity(t).getType()}catch(e){return console.error(e),!1}},t)}function y(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();try{return null!==t&&"LINK"===n.getEntity(t).getType()}catch(e){return console.error(e),!1}},t)}function E(e,t,n){l.RE_HASHTAG_EVERYWHERE.lastIndex=0;for(var i;i=l.RE_HASHTAG_EVERYWHERE.exec(e.getText());)t(l.RE_HASHTAG_EVERYWHERE.lastIndex-i[1].length,l.RE_HASHTAG_EVERYWHERE.lastIndex)}var _=t.confirmLeaveListener=function(e){return e.returnValue="Your content is still uploading and has not been saved.",e.returnValue},k=t.newBlogCallback=function(){},I=t.insertLinkAt=function(e,t,n,i){var a=e.getCurrentContent();return a=a.createEntity("LINK","IMMUTABLE",{url:i,text:n,target:0===i.indexOf(f.LOCAL_LINK_SCHEME)?void 0:"_blank"}),a=o.Modifier.replaceText(a,t,n,null,a.getLastCreatedEntityKey()),o.EditorState.push(e,a,"apply-entity")},S=t.getEntityRangeAtCursor=function(e){var t=e.getSelection(),n=e.getCurrentContent(),i=t.getAnchorKey(),o=n.getBlockForKey(i),r=o.getEntityAt(t.getAnchorOffset());if(null==r&&null==(r=o.getEntityAt(t.getFocusOffset())))return null;var s={blockKey:i};return o.findEntityRanges(function(e){return e.getEntity()===r},function(e,t){return(0,a.default)(s,{start:e,end:t})}),null!=s.start?s:null},T=t.selectionStateAtEnd=function(e){var t=e.getLastBlock();return new o.SelectionState({anchorKey:t.getKey(),anchorOffset:t.getLength(),focusKey:t.getKey(),focusOffset:t.getLength()})},b=t.decorateInlineMentions=function(e,t,n,i){s.default.entityRegex.lastIndex=0;for(var a=e.getBlockMap().find(function(e){return s.default.entityRegex.test(e.getText())});null!=a;){s.default.entityRegex.lastIndex=0;var r=s.default.entityRegex.exec(a.getText()),l=r[1],u=r[2],d=s.default.getTagForLink(l,u,t,n,i,null);e=e.createEntity("TAG","IMMUTABLE",d),e=o.Modifier.replaceText(e,o.SelectionState.createEmpty(a.getKey()).merge({anchorOffset:r.index,focusOffset:r.index+r[0].length}),d.entityName,null,e.getLastCreatedEntityKey()),s.default.entityRegex.lastIndex=0,a=e.getBlockMap().find(function(e){return s.default.entityRegex.test(e.getText())})}return e},C=t.getCollectionMemberID=function(e,t){switch(e){case"Link":return(t.uRL||t.url)+(t.previewImageOriginalURL||(t.images&&t.images.length>0?t.images[0].src:""));case"Document":return t.fromSharepoint?t.sourceAssetURL||t.sourceAssetUrl:t.documentID;case"Image":return t.mediaList.map(function(e){return e.mediaID}).toString();case"oEmbedContent":return t.oEmbedContentID;case"Video":return t.mediaID}};t.getLinkPeekPos=function(e){var t=e.getBoundingClientRect(),n=t.left+(t.right-t.left)/2;return{top:t.bottom+25,left:n}},t.containsFiles=function(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1}},225:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(177),o=(i=a)&&i.__esModule?i:{default:i};t.default=function(e){var t=e.title,n=e.children,i=e.backgroundClick;return o.default.createElement("div",{className:"ka-video-modal-overlay",onClick:i},o.default.createElement("div",{className:"ka-video-modal"},o.default.createElement("div",{className:"ka-video-modal-title"},t),o.default.createElement("div",{className:"ka-video-modal-content"},n)))}},226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),a=r(n(180)),o=r(n(190));function r(e){return e&&e.__esModule?e:{default:e}}if(null==s)var s=n(179).static_images;var l=function(e){var t=e.itemID,n=e.isLessMode,a=e.toggleItemLessMode;return i.default.createElement("span",{className:(0,o.default)("ka_streamItemToggle","linkActive","invisible"),onClick:function(e){a(t),e.stopPropagation()}},n?"More":"Less"," ",i.default.createElement("img",{src:n?s.more_caret_cyan_14:s.less_caret_cyan_14}))};l.propTypes={itemID:a.default.number.isRequired,isLessMode:a.default.bool.isRequired,toggleItemLessMode:a.default.func.isRequired},t.default=l},228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(186)),a=o(n(177));function o(e){return e&&e.__esModule?e:{default:e}}if(null==r)var r=n(179).static_images;t.default=function(e){return a.default.createElement("img",{src:r.ajax_loader_32,style:(0,i.default)({position:"absolute",left:"50%",top:"50%"},e.style)})}},232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(181)),a=c(n(182)),o=c(n(183)),r=c(n(184)),s=c(n(185)),l=n(177),u=c(l),d=c(n(328));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n.start=n.start.bind(n),n.end=n.end.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"start",value:function(e){var t=this;window.draggingSubitem=!0,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("Text","kasubitem|"+this.props.blockKey);var n=e.target.querySelector(".ka_subitem"),i=n.classList.contains("selected");n.classList.add("dragging"),n.classList.remove("selected"),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(e.target,0,0),window.setTimeout(function(){t.setState({dragging:!0}),n.classList.remove("dragging"),n.classList.toggle("selected",i)},1)}},{key:"end",value:function(e){delete window.draggingSubitem,this.setState({dragging:!1});e.target.querySelector(".ka_streamImg");this.dragThumb&&document.body.removeChild(this.dragThumb)}},{key:"render",value:function(){return u.default.createElement("div",{draggable:!0,className:this.state.dragging?"ka_draggable dragging":"ka_draggable",onDragStart:this.start,onDragEnd:this.end},u.default.createElement(d.default,null,this.props.children))}}]),t}(l.Component);t.default=f},236:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=A(n(186)),a=A(n(181)),o=A(n(182)),r=A(n(183)),s=A(n(184)),l=A(n(185)),u=n(177),d=A(u),c=A(n(187)),f=A(n(180)),m=A(n(572)),p=n(179),h=A(p),g=A(n(191)),v=A(n(291)),y=A(n(205)),E=A(n(292)),_=n(261),k=A(_),I=A(n(293)),S=A(n(294)),T=A(n(295)),b=n(207),C=A(n(306)),D=A(n(307)),M=A(n(204)),w=A(n(203)),P=n(189),L=A(n(308)),O=n(188);function A(e){return e&&e.__esModule?e:{default:e}}e.videojs=m.default;var N=n(514).default;n(515),n(309),n(310),n(311),M.default.chrome&&((0,P.isEditingWikiPage)()||(0,P.isEditingWebpartPage)())&&n(312);var R=n(313),x=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={hover:!1,videoMeta:(0,i.default)({duration:e.duration,fileSize:e.fileSize,uploadedAt:e.uploadedAt},e.videoMeta),playerID:e.videoID+"_"+h.default.generateSimpleID(),isResizable:!n.props.disableSizing&&((0,P.isEditingWikiPage)()||(0,P.isEditingWebpartPage)()),transcode:n.props.didUpload?{progress:-1}:void 0,sessionID:(new Date).getTime(),setupMode:!1,savingPosterFromAPI:!1},n.getVideoMeta=n.getVideoMeta.bind(n),n.setVideoSource=n.setVideoSource.bind(n),n.getTranscodeProgress=n.getTranscodeProgress.bind(n),n.titleUpdated=n.titleUpdated.bind(n),n.posterUpdated=n.posterUpdated.bind(n),n.getThumbnails=n.getThumbnails.bind(n),n.isLowRes=n.isLowRes.bind(n),n.onPlayerReady=n.onPlayerReady.bind(n),n.backgroundClick=n.backgroundClick.bind(n),n.setupPlayerPage=n.setupPlayerPage.bind(n),n.setPosterSize=n.setPosterSize.bind(n),n.renderPlayer=n.renderPlayer.bind(n),n.setScriptEditorValue=n.setScriptEditorValue.bind(n),n.getSizeBasedOnParentAndAspect=n.getSizeBasedOnParentAndAspect.bind(n),n.dimensionBox=n.dimensionBox.bind(n),n.isTranscoding=n.isTranscoding.bind(n),n.isInEditor=n.isInEditor.bind(n),n.setStartTime=n.setStartTime.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.timeUpdate=n.timeUpdate.bind(n),n.sendAnalytics=n.sendAnalytics.bind(n),n.startAnalytics=n.startAnalytics.bind(n),n.stopAnalytics=n.stopAnalytics.bind(n),n.setPreviewAtTimeUsingAPI=n.setPreviewAtTimeUsingAPI.bind(n),n.openToBeginning=n.openToBeginning.bind(n),n.chunksWatched=[],n.chunksWatched_all=[],n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"isCloseToInt",value:function(e){return e-Math.floor(e)<=.06||Math.ceil(e)-e<=.06}},{key:"componentDidMount",value:function(){var e=this;if(!this.state.videoMeta||"FAILED"!==this.state.videoMeta.transcodeStatus&&"NOFILEYET"!==this.state.videoMeta.transcodeStatus){this.props.disableThumbnails||m.default.getPlugins(["thumbnails"])||m.default.registerPlugin("thumbnails",C.default);var t={};if("/_layouts/15/video/player.aspx"===window.location.pathname.toLowerCase())t.width=b.DEF_VIDEO_WIDTH;else if(this.props.width)t.width=this.props.width;else if(this.state.videoMeta&&this.state.videoMeta.originalWidth&&this.state.videoMeta.originalHeight)t=this.getSizeBasedOnParentAndAspect();else{var n=h.default.findAncestor(c.default.findDOMNode(this),"ka_block");n?t=this.getSizeBasedOnParentAndAspect(n.clientWidth):(t.width=b.DEF_VIDEO_WIDTH,t.height=b.DEF_VIDEO_HEIGHT)}this.videoNode&&(m.default.addLanguage("en",R),this.player=(0,m.default)(this.videoNode,(0,i.default)(H,t),this.onPlayerReady),this.props.disableThumbnails||this.player.one("play",function(){e.getThumbnails()})),this.state.videoMeta.mediaID&&this.state.videoMeta.transcodeStatus?"FINISHED"===this.state.videoMeta.transcodeStatus?this.setVideoSource():"PRIMARY"===this.state.videoMeta.transcodeStatus?this.setVideoSourceTemp():"FAILED"!==this.state.videoMeta.transcodeStatus&&"FAILED2"!==this.state.videoMeta.transcodeStatus||(0,P.logError)(new Error("Video transcode failed for "+this.state.videoMeta.mediaID)):this.getVideoMeta(),this.isLowRes()&&(this.player.addClass("lowres"),this.setState({lowRes:!0}));var a=this.props.fallbackPoster||window.localStorage.getItem("ka_videoPreview_"+this.props.videoID);if(a&&this.player){this.player.poster(a),this.player.el().querySelector("video").poster="";var o=new Image;o.crossOrigin="use-credentials",o.addEventListener("load",function(){var t=void 0;t=o.width/o.height<4/3?"4:3":o.width+":"+o.height,e.player.aspectRatio(t)}),o.src=a}this.setPosterSize(),this.videoNode&&this.player.one("loadedmetadata",function(){e.setState({duration:e.player.duration(),width:e.player.width(),height:e.player.height()}),h.default.isIE()&&e.setStartTime()}),this.setupPlayerPage(),M.default.chrome&&((0,P.isEditingWikiPage)()||(0,P.isEditingWebpartPage)())&&this.videoNode.setAttribute("controls","true")}}},{key:"setStartTime",value:function(){if(this.props.startTime)this.player.currentTime(this.props.startTime);else if(this.state.videoMeta.memberData){var e=this.state.videoMeta.memberData;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){console.warn("Can't parse memberData.",this.state.videoMeta)}e&&e.startTime&&this.player.currentTime(e.startTime)}}},{key:"componentWillReceiveProps",value:function(e){if(e.width!=this.props.width&&this.player){var t=this.getSizeBasedOnParentAndAspect();this.player.width(t.width),this.player.height(t.height)}}},{key:"getSizeBasedOnParentAndAspect",value:function(e,t,n){(t||(t=10),e)||(e=c.default.findDOMNode(this).parentElement.clientWidth);var i=e;n||(n=this.state.videoMeta);var a=n.originalWidth/n.originalHeight;if(!a&&this.player&&(a=this.player.videoWidth()/this.player.videoHeight()),a||(a=this.props.aspectRatio),!a)return{width:i};a<4/3&&(a=4/3);for(var o=i/a;!this.isCloseToInt(o)&&e-i<t;)o=--i/a;return o=this.isCloseToInt(o)?Math.round(o):(i=e)/a,{width:i,height:o,fluid:!1}}},{key:"componentDidUpdate",value:function(e,t,n){this.setPosterSize()}},{key:"setupPlayerPage",value:function(){var e=this;if("/_layouts/15/video/player.aspx"===window.location.pathname.toLowerCase()){var t=document.getElementById("s4-workspace")||document.body;this.setState({containerStyle:{width:b.DEF_VIDEO_WIDTH,marginLeft:(document.getElementById("s4-bodyContainer").clientWidth-b.DEF_VIDEO_WIDTH)/2,marginTop:(t.clientHeight-b.DEF_VIDEO_HEIGHT-19)/2}}),this.player.one("loadeddata",function(){e.setState({containerStyle:(0,i.default)({},e.state.containerStyle,{marginTop:(t.clientHeight-e.player.el().clientHeight-19)/2})}),window.addEventListener("resize",function(){e.windowResizeTimer_videoCentering&&(window.clearTimeout(e.windowResizeTimer_videoCentering),delete e.windowResizeTimer_videoCentering),e.windowResizeTimer_videoCentering=window.setTimeout(function(){e.player&&!e.player.isFullscreen()&&e.setState({containerStyle:(0,i.default)({},e.state.containerStyle,{marginTop:(t.clientHeight-e.player.el().clientHeight-19)/2})})},100)})})}}},{key:"onPlayerReady",value:function(){var e=this;this.player.posterImage.off(["click","tap"]),this.player.posterImage.on(["click","tap"],this.backgroundClick),h.default.isIE()||this.setStartTime(),this.player.one("play",function(){return e.player.focus()}),this.player.on("play",this.startAnalytics),this.player.on("pause",this.stopAnalytics)}},{key:"timeUpdate",value:function(){var e=Math.floor(this.player.currentTime()/this.player.duration()*100);if(e<100&&!this.chunksWatched_all.some(function(t){return t.chunkIndex===e})){var t={chunkIndex:e,timestamp:(new Date).getTime()};this.chunksWatched.push(t),this.chunksWatched_all.push(t)}}},{key:"sendAnalytics",value:function(){this.props.trackVideoWatch&&this.chunksWatched.length>0&&(this.props.trackVideoWatch(this.props.videoID,this.chunksWatched,this.state.sessionID),this.chunksWatched=[])}},{key:"startAnalytics",value:function(){this.timeUpdate(),this.analyticsWatchTimer=window.setInterval(this.timeUpdate,this.player.duration()/105),this.analyticsSendTimer=window.setInterval(this.sendAnalytics,5e3)}},{key:"stopAnalytics",value:function(){this.analyticsWatchTimer&&(window.clearInterval(this.analyticsWatchTimer),delete this.analyticsWatchTimer),this.analyticsSendTimer&&(window.clearInterval(this.analyticsSendTimer),delete this.analyticsSendTimer),this.sendAnalytics()}},{key:"backgroundClick",value:function(){this.props.onSelect?this.props.onSelect():this.state.isResizable?this.isTranscoding()||this.setState({isSelected:!0}):this.player.paused()?this.player.play():this.player.pause()}},{key:"componentWillUnmount",value:function(){this.stopGettingTranscodeProgress()}},{key:"componentWillUpdate",value:function(e,t){!this.state.hovered&&t.hovered?this.player.addClass("hover"):this.state.hovered&&!t.hovered&&this.player.removeClass("hover")}},{key:"getVideoMeta",value:function(){var e=this;g.default.get(apiUrl+"/video/"+this.props.videoID).set({Authorization:"Bearer "+h.default.getToken()}).withCredentials().then(function(t){var n=t.body.results[0];if(e.setState({videoMeta:(0,i.default)({},e.state.videoMeta,n)}),e.isLowRes(n)&&(e.player.addClass("lowres"),e.setState({lowRes:!0})),!e.props.width&&!e.props.height&&n.originalWidth&&n.originalHeight&&n.originalWidth/n.originalHeight<4/3&&e.player.aspectRatio("4:3"),"FINISHED"===n.transcodeStatus?(e.setVideoSource(),e.state.transcode&&100==e.state.transcode.progress&&(e.setState({setupMode:!0}),e.props.processingEnded&&e.props.processingEnded(e.props.videoID))):"PRIMARY"===n.transcodeStatus?(e.setVideoSourceTemp(),e.state.transcode&&100==e.state.transcode.progress&&(e.setState({setupMode:!0}),e.props.processingEnded&&e.props.processingEnded(e.props.videoID),h.default.logVideoTranscode(e.props.videoID,e.state.videoMeta.fileSize,e.state.videoMeta.duration,(new Date).getTime()-e.state.videoMeta.uploadedAt))):"PENDING"===n.transcodeStatus&&e.state.transcode&&100==e.state.transcode.progress?window.setTimeout(e.getVideoMeta,1e3):(e.startGettingTranscodeProgress(),e.player&&e.state.videoMeta.previewImageFilename&&"NOFILEYET"!==e.state.videoMeta.transcodeStatus&&"PENDING"!==e.state.videoMeta.transcodeStatus&&e.player.poster(apiUrl+"/video/"+e.props.videoID+"/blob"+e.state.videoMeta.previewImageFilename),e.player.el().querySelector("video").poster=""),n.originalWidth&&n.originalHeight){var a=c.default.findDOMNode(e);if(a){var o=h.default.findAncestor(a,"ka_block"),r=void 0;r=o?o.clientWidth:e.player.width();var s=e.getSizeBasedOnParentAndAspect(r,null,n);e.player.width(s.width),e.player.height(s.height),e.player.fluid(!1),e.setState(s)}}e.setPosterSize(n)}).catch(function(e){return(0,P.logError)(e)})}},{key:"stopGettingTranscodeProgress",value:function(){null!=this.progressGetter&&(window.clearInterval(this.progressGetter),this.progressGetter=null)}},{key:"startGettingTranscodeProgress",value:function(){var e=this;this.isInEditor()&&(this.props.processingStarted&&this.props.processingStarted(this.props.videoID),this.player&&this.player.fluid()&&this.player.fluid(!1),this.state.transcode||this.setState({transcode:{progress:-1}}),this.progressGetter=window.setInterval(function(){e.getTranscodeProgress()},3e3))}},{key:"getTranscodeProgress",value:function(){var e=this;g.default.get(apiUrl+"/video/"+this.props.videoID+"/progress").set({Authorization:"Bearer "+h.default.getToken()}).then(function(t){var n=parseInt(t.text);NaN!==n&&(n>0&&n<e.state.transcode.progress&&(n=100),e.setState({transcode:{progress:n}}),100===n&&(window.clearInterval(e.progressGetter),e.progressGetter=null,e.getVideoMeta()))}).catch(function(e){})}},{key:"setVideoSource",value:function(){if(this.player){this.state.videoMeta.previewImageFilename&&(this.player.poster(apiUrl+"/video/"+this.props.videoID+"/blob"+this.state.videoMeta.previewImageFilename),this.player.el().querySelector("video").poster="");var e=[{src:apiUrl+"/video/"+this.props.videoID+"/blob/hls/multi_bitrate_playlist.m3u8",type:"application/x-mpegURL"},{src:apiUrl+"/video/"+this.props.videoID+"/blob/mp4/high.mp4",type:"video/mp4"}];h.default.isIE()||e.unshift({src:apiUrl+"/video/"+this.props.videoID+"/blob/dash/manifest.mpd",type:"application/dash+xml"}),this.player.src(e),this.props.openToBeginning&&this.openToBeginning()}window.localStorage.removeItem("ka_videoPreview_"+this.props.videoID)}},{key:"setVideoSourceTemp",value:function(){this.player&&(this.state.videoMeta.previewImageFilename?(this.player.poster(apiUrl+"/video/"+this.props.videoID+"/blob"+this.state.videoMeta.previewImageFilename),this.player.el().querySelector("video").poster=""):console.warn("previewImageFilename not set yet",this.state.videoMeta),this.player.src([{src:apiUrl+"/video/"+this.props.videoID+"/blob/mp4/low.mp4",type:"video/mp4"}]),this.props.openToBeginning&&this.openToBeginning()),window.localStorage.removeItem("ka_videoPreview_"+this.props.videoID)}},{key:"openToBeginning",value:function(){var e=this;this.player.one("loadeddata",function(){e.player.play(),e.player.pause(),e.player.currentTime(0),window.setTimeout(function(){e.player&&!e.player.paused()&&(e.player.pause(),e.player.currentTime(0))},0)})}},{key:"getThumbnails",value:function(){var e=this;g.default.get(apiUrl+"/video/"+this.props.videoID+"/blob/thumbnails.vtt").responseType("blob").set(h.default.getAuthHeader()).withCredentials().then(function(t){e.player&&(e.player.addRemoteTextTrack({kind:"metadata",label:"thumbnails",src:window.URL.createObjectURL(t.body)},!0),e.player.thumbnails({basePath:apiUrl+"/video/"+e.props.videoID+"/blob",width:200,height:112}))}).catch(function(e){return(0,P.logError)(e)})}},{key:"titleUpdated",value:function(e){this.setState({videoMeta:(0,i.default)({},this.state.videoMeta,{title:e}),posterEditorOpen:this.state.setupMode,titleEditorOpen:!1}),this.props.releaseInputControl&&this.props.releaseInputControl()}},{key:"posterUpdated",value:function(e,t){this.player.poster(e),this.player.el().querySelector("video").poster="",this.setState({setupMode:!1,posterEditorOpen:!1}),t&&this.setState({videoMeta:(0,i.default)({},this.state.videoMeta,{previewImageFilename:t})}),this.player&&-1===this.player.poster().indexOf("/posters/")&&this.player.el().querySelector(".vjs-poster").style.removeProperty("background-size")}},{key:"setPreviewAtTimeUsingAPI",value:function(e){var t=this;this.setState({savingPosterFromAPI:!0,setupMode:!1,posterEditorOpen:!1}),g.default.post((0,O.buildReqUrl)("/video/"+this.props.videoID+"/ffmpegpreview")).query({seconds:e}).authBearer(h.default.getToken()).then(function(e){var n=e.text,i=apiUrl+"/video/"+t.props.videoID+"/blob"+n;t.posterUpdated(i,n),t.setState({savingPosterFromAPI:!1})}).catch(function(e){t.setState({savingPosterFromAPI:!1}),h.default.receivedAPIError(e),t.setState({saving:!1}),alert("Thumbnail failed to save. Please try again.")})}},{key:"isLowRes",value:function(e){return e=e||this.state.videoMeta,this.state.videoMeta&&this.videoNode&&this.state.videoMeta.originalWidth<c.default.findDOMNode(this.videoNode).clientWidth}},{key:"setPosterSize",value:function(e){var t=this;if(e||(e=this.state.videoMeta),this.player&&this.player.poster()){var n=this.player.el().querySelector(".vjs-poster");if(this.state.lowRes&&this.player&&this.player.poster().indexOf("/posters/")>-1)n.style.backgroundSize=e.originalWidth+"px "+e.originalHeight+"px";else{var i=this.state.backgroundAspectRatio;null==i?j(n,function(e){i=e,t.setState({backgroundAspectRatio:i}),V(n,i)}):V(n,i)}}}},{key:"setScriptEditorValue",value:function(e,t){var n=h.default.findAncestor(this.player.el(),"ms-rte-embedcode").getAttribute("inputfield");n||(n=h.default.findAncestor(this.player.el(),"ms-WPBody").getAttribute("webpartid2")+"scriptcontent");var i=(0,_.getShareCode)(this.props.videoID,e,t,this.props.startTime,this.props.duration,this.props.fileSize),a=document.getElementById("aspnetForm"),o=a.querySelector('input[name="'+n+'"]');o||((o=document.createElement("input")).type="hidden",o.name=n,a.appendChild(o)),o.value=i}},{key:"dimensionBox",value:function(){return this.state.dimensionBoxSize?d.default.createElement("div",{className:"ka-resizer-dimensionBox"},this.state.dimensionBoxSize.width," x ",this.state.dimensionBoxSize.height):null}},{key:"isTranscoding",value:function(){return this.state.transcode&&this.state.transcode.progress<100||"NOFILEYET"===this.state.videoMeta.transcodeStatus||"PENDING"===this.state.videoMeta.transcodeStatus}},{key:"isInEditor",value:function(){return this.props.inEditor||(0,P.isEditingWebpartPage)()||(0,P.isEditingWikiPage)()}},{key:"onKeyDown",value:function(e){32!==(e||window.event).keyCode||this.state.titleEditorOpen||this.state.posterEditorOpen||(this.player.paused()?this.player.play():this.player.pause(),e.preventDefault())}},{key:"renderPlayer",value:function(){var e=this,t=this.isInEditor();return this.state.videoMeta&&"FAILED"===this.state.videoMeta.transcodeStatus?d.default.createElement("div",{style:{textAlign:"center",padding:5,background:"lightgrey"}},"Video processing failed.",d.default.createElement("br",null),"Please try uploading your video again."):!t&&this.isTranscoding()?d.default.createElement(D.default,{width:this.props.width}):d.default.createElement("div",{className:this.props.className,style:this.state.containerStyle},d.default.createElement("div",{"data-vjs-player":!0,onClick:this.props.onClick,tabIndex:0,onKeyDown:this.onKeyDown},d.default.createElement("video",{ref:function(t){return e.videoNode=t},id:this.state.playerID,crossOrigin:!this.props.hideCog&&M.default.firefox?void 0:"use-credentials",className:"video-js vjs-big-play-centered"}),d.default.createElement("div",{className:"ka-overlayBG ka-playOverlay",onClick:this.backgroundClick}),d.default.createElement("div",{className:"ka-titleBar ka-playOverlay",onClick:this.backgroundClick},this.state.videoMeta&&d.default.createElement("div",{className:"ka-title",spellCheck:!1},this.state.videoMeta.title||this.state.videoMeta.originalFilename),t&&!this.props.hideCog&&!this.state.setupMode&&(!this.state.transcode||this.state.transcode.progress>=100)&&d.default.createElement(v.default,{videoID:this.props.videoID,width:this.props.width,height:this.props.height,setPlayerHovered:function(t){return e.setState({hovered:t})},openPosterEditor:function(){return e.setState({posterEditorOpen:!0})},openTitleEditor:function(){e.props.requestInputControl&&e.props.requestInputControl(),e.setState({titleEditorOpen:!0})},player:this.player}),!this.state.setupMode&&(!this.state.transcode||this.state.transcode.progress>=100)&&d.default.createElement("div",{className:"ka-titleIcon ka-share",onClick:function(t){t.stopPropagation(),e.props.requestInputControl&&e.props.requestInputControl(),e.setState({shareDialogOpen:!0})}},d.default.createElement("img",{src:p.static_images.share_white_20}))),this.isTranscoding()&&d.default.createElement(E.default,{fileSize:this.state.videoMeta.fileSize,videoDuration:this.state.videoMeta.duration,uploadedAt:this.state.videoMeta.uploadedAt,backgroundClick:this.backgroundClick,progress:this.state.transcode?this.state.transcode.progress:0,inEditor:this.props.inEditor}),this.state.setupMode&&d.default.createElement(I.default,{onClose:function(t){t.stopPropagation(),e.setState({setupMode:!1})},onEdit:function(t){t.stopPropagation(),e.setState({titleEditorOpen:!0}),e.props.requestInputControl&&e.props.requestInputControl()},backgroundClick:this.backgroundClick}),this.state.shareDialogOpen&&d.default.createElement(k.default,{videoID:this.props.videoID,width:this.props.width,height:this.props.height,onClose:function(){e.setState({shareDialogOpen:!1}),e.props.releaseInputControl&&e.props.releaseInputControl()},currentTime:this.props.player?Math.floor(this.props.player.currentTime()):void 0}),this.state.titleEditorOpen&&d.default.createElement(S.default,{onClose:function(){e.setState({titleEditorOpen:!1,setupMode:!1}),e.props.releaseInputControl&&e.props.releaseInputControl()},onTitleUpdated:this.titleUpdated,videoID:this.props.videoID,title:this.state.videoMeta.title,poster:this.state.videoMeta.previewImageFilename,duration:this.state.videoMeta.duration,setupMode:this.state.setupMode}),this.state.posterEditorOpen&&d.default.createElement(T.default,{onClose:function(){return e.setState({posterEditorOpen:!1,setupMode:!1})},posterUpdated:this.posterUpdated,setPreviewAtTimeUsingAPI:this.setPreviewAtTimeUsingAPI,videoID:this.props.videoID,title:this.state.videoMeta.title,previewImageFilename:this.state.videoMeta.previewImageFilename,duration:this.state.videoMeta.duration,setupMode:this.state.setupMode,playerAspectRatio:this.player.el().clientWidth/this.player.el().clientHeight}),this.state.savingPosterFromAPI&&d.default.createElement(L.default,{backgroundClick:this.backgroundClick}),this.state.duration&&d.default.createElement("div",{className:"ka-footerBar ka-playOverlay",onClick:this.backgroundClick},d.default.createElement(y.default,{duration:this.state.duration})),d.default.createElement("div",{className:"ka-videoError"},d.default.createElement("div",{className:"ka-videoErrorTitle"},"This video is currently unavailable."),d.default.createElement("div",{className:"ka-videoErroBody"},"Please try refreshing the page. If the problem persists, contact an administrator."))))}},{key:"render",value:function(){var e=this;return this.state.isResizable?d.default.createElement(w.default,{onClose:function(){return e.setState({isSelected:!1})}},d.default.createElement(N,{className:this.state.isSelected?"ka-video-resizer":void 0,enable:this.state.isSelected?B:U,size:{width:this.state.width,height:this.state.height},handleClasses:F,minWidth:b.MIN_VIDEO_WIDTH,minHeight:this.props.width&&this.props.height?b.MIN_VIDEO_WIDTH/(this.props.width/this.props.height):void 0,maxWidth:b.MAX_VIDEO_WIDTH,maxHeight:this.props.width&&this.props.height?b.MAX_VIDEO_WIDTH/(this.props.width/this.props.height):void 0,lockAspectRatio:!0,onResize:function(t,n,i,a){var o=e.state.width+a.width,r=(e.state.height,a.height,e.getSizeBasedOnParentAndAspect(o,20));e.setState({dimensionBoxSize:r}),e.player.width(r.width),e.player.height(r.height)},onResizeStop:function(t,n,i,a){var o=e.state.width+a.width,r=(e.state.height,a.height,e.getSizeBasedOnParentAndAspect(o,20));e.setState({width:r.width,height:r.height}),e.setScriptEditorValue(r.width,r.height),window.setTimeout(function(){return e.setState({dimensionBoxSize:null})},1e3)}},this.renderPlayer(),this.dimensionBox())):this.renderPlayer()}}]),t}(u.Component),U={top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},B={top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},F={topRight:"ka-video-resizer-handle",bottomRight:"ka-video-resizer-handle",bottomLeft:"ka-video-resizer-handle",topLeft:"ka-video-resizer-handle"},H={autoplay:!1,controls:!0,techOrder:["html5"],html5:{hls:{withCredentials:!0}}},j=function(e,t){var n=e.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2").split(",")[0],i=new Image;i.addEventListener("load",function(){t(i.width/i.height)}),i.src=n},V=function(e,t){var n=t-e.clientWidth/e.clientHeight;n>=-.01&&.01>=n&&0!==n&&(e.style.backgroundSize=e.clientWidth+"px "+e.clientHeight+"px")};x.propTypes={videoID:f.default.string.isRequired,width:f.default.number,height:f.default.number,startTime:f.default.number},t.default=x}).call(this,n(201))},238:function(e,t,n){},239:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviewImageBlob=void 0;var i=v(n(181)),a=v(n(182)),o=v(n(183)),r=v(n(184)),s=v(n(185)),l=n(177),u=v(l),d=v(n(187)),c=v(n(192)),f=v(n(179)),m=v(n(191)),p=(v(n(204)),n(188)),h=n(189),g=n(331);function v(e){return e&&e.__esModule?e:{default:e}}n(511),ArrayBuffer.isView||n(301),String.prototype.startsWith||n(302),String.prototype.endsWith||n(303),String.prototype.includes||n(304),String.prototype.repeat||n(262),Array.prototype.includes||n(305);var y=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={uploadAttempt:0,progress:0,fileObjectUrl:E(e.file)},n.abortUpload=n.abortUpload.bind(n),n.getUploadTicket=n.getUploadTicket.bind(n),n.setPlayPosition=n.setPlayPosition.bind(n),n.uploadBlob_chunked=n.uploadBlob_chunked.bind(n),n.checkIfWeCanGetAPreviewImage=n.checkIfWeCanGetAPreviewImage.bind(n),n.checkIfVideoUploadIsDone=n.checkIfVideoUploadIsDone.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.props.file&&this.getUploadTicket(this.props.file)}},{key:"componentWillUnmount",value:function(){this.abortUpload()}},{key:"abortUpload",value:function(){this.req&&(this.req.abort(),delete this.req),this.cancelUploadFilter&&(this.cancelUploadFilter.cancel=!0)}},{key:"checkIfWeCanGetAPreviewImage",value:function(e){var t=this,n=d.default.findDOMNode(this.videoNode);n.readyState>=2?_(e,n,this.checkIfVideoUploadIsDone):this.state.cantPlayLocalFile?this.checkIfVideoUploadIsDone(e):(n.addEventListener("loadeddata",function(){return _(e,n,t.checkIfVideoUploadIsDone)}),n.addEventListener("error",function(){return t.checkIfVideoUploadIsDone(e)},!0))}},{key:"checkIfVideoUploadIsDone",value:function(e){this.state.videoUploadDone?this.props.onUploadEnd(this.state.mediaID,this.state.duration):this.setState({previewImageUplaodDone:!0,mediaID:e})}},{key:"getUploadTicket",value:function(e){var t=this;this.state.uploadAttempt<2&&(this.setState({uploadAttempt:this.state.uploadAttempt+1}),this.req=m.default.post(window.apiUrl+"/subitem/uploadticket").set({Authorization:"Bearer "+f.default.getToken()}).send({SubItemType:"Video",OriginalFilename:e.name,MIMEType:e.type,fileSize:e.size,duration:this.videoNode?this.videoNode.duration:void 0}).end(function(n,i){n||!i.ok?(0,h.logError)(n||i.text):(t.checkIfWeCanGetAPreviewImage(i.body.results[0].subItemID),t.uploadBlob_chunked(e,i.body.results[0]))}))}},{key:"uploadBlob",value:function(e,t){var n=this;this.req=m.default.put(t.azureStorageSASURL).set({"x-ms-blob-type":"BlockBlob","x-ms-version":"2017-04-17"}).send(e).on("progress",function(e){n.setState({progress:e.percent}),n.setPlayPosition(e.percent)}).end(function(i,a){n.req=void 0,i||!a.ok?((0,h.logError)(i||a.text),n.abortUpload(),n.props.onUploadFail(e)):n.state.previewImageUplaodDone?n.props.onUploadEnd(t.subItemID,n.videoNode.duration):n.setState({videoUploadDone:!0,mediaID:t.subItemID,duration:n.videoNode.duration})})}},{key:"uploadBlob_chunked",value:function(e,t){var n=this;this.setState({subItemID:t.subItemID});var i=g.StorageURL.newPipeline(new g.AnonymousCredential,{}),a=new g.BlobURL(t.azureStorageSASURL,i),o=g.BlockBlobURL.fromBlobURL(a);this.uploadAborter=g.Aborter.none,(0,g.uploadBrowserDataToBlockBlob)(this.uploadAborter,e,o,{blockSize:4194304,progress:function(t){var i=t.loadedBytes/e.size*100;e.size>104857600&&(i=Math.max(i,2)),n.setState({progress:i}),n.setPlayPosition(i)}}).then(function(e){n.props.onUploadEnd(n.state.subItemID,n.videoNode.duration)}).catch(function(e){"aborted"!==e.status&&console.error(e)})}},{key:"setPlayPosition",value:function(e){this.videoNode&&this.videoNode.duration&&e&&(this.videoNode.currentTime=this.videoNode.duration*(e/100))}},{key:"render",value:function(){var e=this,t=this.props.file;return u.default.createElement(c.default,{title:"Uploading Your Video...",onClose:this.props.onClose,disableOverlayClick:!0},u.default.createElement("br",null),u.default.createElement("div",{style:{position:"relative",background:"black"}},u.default.createElement("video",{width:480,height:270,ref:function(t){return e.videoNode=t},src:this.state.fileObjectUrl,type:t.type,style:{display:"block"},onError:function(t){e.setState({cantPlayLocalFile:!0})}}),u.default.createElement("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(255,255,255,.5)"}})),u.default.createElement("div",{className:"ka_imgUploadProgress",style:{position:"static",marginTop:5}},u.default.createElement("div",{style:{width:this.state.progress+"%"}})))}}]),t}(l.Component);t.default=y;var E=function(e){try{return URL.createObjectURL(e)}catch(e){return(0,h.logError)(e),null}},_=function(e,t,n){k(t,function(i){m.default.post((0,p.buildReqUrl)("/video/"+e+"/previewimage")).authBearer(f.default.getToken()).attach("itsablob",i,t.currentTime+".png").then(function(t){n(e)}).catch(function(t){f.default.receivedAPIError(t),n(e)})})},k=t.getPreviewImageBlob=function(e,t){var n=document.createElement("canvas");n.width=e.videoWidth,n.height=e.videoHeight,n.getContext("2d").drawImage(e,0,0),n.toBlob(t)}},242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(177)),a=o(n(192));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.title,n=e.message,o=e.confirmText,r=e.denyText,s=e.onConfirm,l=e.onDeny,u=e.onClose,d=e.redConfirm;return i.default.createElement(a.default,{onClose:u,title:t,hideX:!0},i.default.createElement("span",null,n),i.default.createElement("br",null),i.default.createElement("div",{style:{textAlign:"right",marginTop:15}},i.default.createElement("input",{type:"button",className:"ka_button",value:r||"Cancel",onClick:function(){l&&l(),u()}}),i.default.createElement("input",{type:"button",className:"ka_button"+(d?" red":""),value:o,onClick:function(){s&&s(),u()}})))}},244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={ABORTED:-2,FAILED:-1,PENDING:0,UPLOADING:1,UPLOADED:2}},245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(177)),a=o(n(192));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.onClose,n=e.title,o=e.message;return i.default.createElement(a.default,{onClose:t,title:n,hideX:!0},i.default.createElement("span",{dangerouslySetInnerHTML:{__html:o}}),i.default.createElement("br",null),i.default.createElement("div",{style:{textAlign:"right"}},i.default.createElement("input",{type:"button",className:"ka_button",style:{marginTop:15},value:"OK",onClick:t})))}},246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(177),a=l(i),o=l(n(192)),r=n(214),s=n(179);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.onClose,n=e.fileAlerts;return a.default.createElement(o.default,{className:"ka-fileAlert",onClose:t,hideX:!0},u(n.imagesTooLarge,r.ALERT_IMAGE_SIZE),u(n.videosTooLarge,r.ALERT_VIDEO_SIZE),u(n.docsTooLarge,r.ALERT_DOC_SIZE),u(n.filesBlocked,r.ALERT_DOC_TYPE),u(n.fileUploadFailures,r.ALERT_UPLOAD_FAILED),u(n.videoUploadFailures,r.ALERT_VIDEO_FAILED),u(n.blockedVideoFormat,r.ALERT_VID_TYPE),a.default.createElement("div",{style:{textAlign:"right"}},a.default.createElement("input",{type:"button",className:"ka_button",value:"OK",onClick:t})))};var u=function(e,t){if(e&&e.length>0)return a.default.createElement("div",null,a.default.createElement("div",{className:"kamodal-title",style:{marginLeft:0}},t.title),e.map(d),a.default.createElement("span",{className:"kamodal-message",dangerouslySetInnerHTML:{__html:t.message}}))},d=function(e,t){return a.default.createElement("div",{key:t,style:{paddingTop:10}},a.default.createElement("img",{src:s.imgRoot+"yield_red_med.svg",style:{width:23,height:22,verticalAlign:"middle"}}),a.default.createElement("span",{style:{fontWeight:500,marginLeft:10}},e.name),a.default.createElement("span",{style:{fontWeight:500,marginLeft:20}},c(e.size)))},c=function(e){var t="MB";return(e=e/1024/1024)>1024&&(e/=1024,t="GB"),e>1024&&(e/=1024,t="TB"),a.default.createElement(i.Fragment,null,e.toFixed(1)," ",t)}},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(236),o=(i=a)&&i.__esModule?i:{default:i};t.default=o.default},254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(186)),a=g(n(181)),o=g(n(182)),r=g(n(183)),s=g(n(184)),l=g(n(185)),u=n(177),d=(g(u),g(n(204)),g(n(179))),c=g(n(244)),f=g(n(191)),m=n(211),p=n(189),h=n(331);function g(e){return e&&e.__esModule?e:{default:e}}ArrayBuffer.isView||n(301),String.prototype.startsWith||n(302),String.prototype.endsWith||n(303),String.prototype.includes||n(304),String.prototype.repeat||n(262),Array.prototype.includes||n(305);var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={uploadAttempt:0,checkAttempt:0},n.checkExists=n.checkExists.bind(n),n.checkExists_doc=n.checkExists_doc.bind(n),n.checkExists_img=n.checkExists_img.bind(n),n.uploadComplete=n.uploadComplete.bind(n),n.uploadBlob_chunked=n.uploadBlob_chunked.bind(n),n.alreadyRecheckedGifAnimation=0,n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.props.file.status===c.default.ABORTED&&(this.props.file.status=c.default.PENDING),this.props.file.status===c.default.PENDING&&this.props.autoStart&&this.getUploadTicket(this.props.file)}},{key:"componentWillReceiveProps",value:function(e){e.file.status===c.default.PENDING&&e.autoStart&&this.getUploadTicket(e.file)}},{key:"componentWillUnmount",value:function(){this.abortUpload(),this.checkerTimeout&&window.clearTimeout(this.checkerTimeout),this.props.uploadProps.onUploadEnd&&this.props.file.uploadStatus===c.default.UPLOADING&&this.props.uploadProps.onUploadEnd((0,i.default)(this.props.file,{status:c.default.ABORTED}))}},{key:"getUploadTicket",value:function(e){var t=this;d.default.validateToken(function(){var n=t.props.uploadProps,a=n.onUploadStart,o=n.onUploadEnd,r=n.getUploadHeader,s=void 0===r?function(){return{}}:r;t.state.uploadAttempt<2&&(t.setState({uploadAttempt:t.state.uploadAttempt+1}),"function"==typeof a&&a((0,i.default)(e,{status:c.default.UPLOADING})),t.req=f.default.post(window.apiUrl+"/subitem/uploadticket").set(s()).send({SubItemType:t.props.subItemType,OriginalFilename:e.name,MIMEType:e.type}).end(function(n,a){n||!a.ok?((0,p.logError)(n||a.text),"function"==typeof o&&(o((0,i.default)(e,{error:n,status:c.default.FAILED})),t.props.removeBlock())):t.uploadBlob_chunked(e,a.body.results[0])}))})}},{key:"uploadBlob",value:function(e,t){var n=this,a=this.props.uploadProps,o=a.onUploadEnd,r=a.onUploadProgress;this.req=f.default.put(t.azureStorageSASURL).set({"x-ms-blob-type":"BlockBlob","x-ms-version":"2017-04-17"}).send(e).on("progress",function(t){"function"==typeof r&&("video"===n.props.subItemType.toLowerCase()?r(t.percent,e):r(.8*t.percent,e))}).end(function(a,r){n.req=void 0,a||!r.ok?((0,p.logError)(a||r.text),"function"==typeof o&&(o((0,i.default)(e,{error:a,status:c.default.FAILED})),n.props.removeBlock())):"video"===n.props.subItemType.toLowerCase()?n.uploadComplete(t,e):n.checkExists(t,e)})}},{key:"uploadBlob_chunked",value:function(e,t){var n=this;this.setState({subItemID:t.subItemID});var i=h.StorageURL.newPipeline(new h.AnonymousCredential,{}),a=new h.BlobURL(t.azureStorageSASURL,i),o=h.BlockBlobURL.fromBlobURL(a);this.uploadAborter=h.Aborter.none,(0,h.uploadBrowserDataToBlockBlob)(this.uploadAborter,e,o,{blockSize:4194304,progress:function(t){var i=t.loadedBytes/e.size*100;e.size>104857600&&(i=Math.max(i,2)),"video"===n.props.subItemType.toLowerCase()?n.props.uploadProps.onUploadProgress(i,e):n.props.uploadProps.onUploadProgress(.8*i,e)}}).then(function(i){"video"===n.props.subItemType.toLowerCase()?n.uploadComplete(t,e):n.checkExists(t,e)}).catch(function(e){"aborted"!==e.status&&console.error(e)})}},{key:"checkExists",value:function(e,t){var n=this;this.checkerTimeout=window.setTimeout(function(){n.checkerTimeout=null,"function"==typeof n.props.uploadProps.onUploadProgress&&n.props.uploadProps.onUploadProgress(n.getPostProcessingProgress(n.state.checkAttempt+1),t),n.setState({checkAttempt:n.state.checkAttempt+1}),"Document"===n.props.subItemType?n.checkExists_doc(e,t):"Image"===n.props.subItemType&&n.checkExists_img(e,t)},1e3)}},{key:"checkExists_doc",value:function(e,t){var n=this;this.req=f.default.head("/_layouts/15/media/exist.ashx").query({type:this.props.subItemType,id:e.subItemID,filename:"Image"!==this.props.subItemType?t.name:void 0,size:"Image"===this.props.subItemType?this.props.imageSize.width+"w"+this.props.imageSize.height+"h":void 0}).end(function(a,o){n.req=void 0,a||!o.ok?((0,p.logError)(a||o.text),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:c.default.FAILED})),n.props.removeBlock())):204===o.status?n.state.checkAttempt<30?n.checkExists(e,t):n.state.uploadAttempt<2?(n.setState({checkAttempt:0}),console.warn("Failed to process uploaded file after 1 attempt. Trying again.",t),n.getUploadTicket(t)):(console.error("Failed to process uploaded file after 2 attempts.",t),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:c.default.FAILED})),n.props.removeBlock())):("function"==typeof n.props.uploadProps.onUploadProgress&&n.props.uploadProps.onUploadProgress(100,t),window.setTimeout(function(){n.uploadComplete(e,t)},1e3))})}},{key:"checkExists_img",value:function(e,t){var n=this;this.req=f.default.head(apiUrl+"/media/"+e.subItemID).set(d.default.getAuthHeader()).query({size:this.props.imageSize.width+"w"+this.props.imageSize.height+"h"}).then(function(a){n.req=void 0,204===a.status?n.state.checkAttempt<30?n.checkExists(e,t):n.state.uploadAttempt<2?(n.setState({checkAttempt:0}),console.warn("Failed to process uploaded file after 1 attempt. Trying again.",t),n.getUploadTicket(t)):(console.error("Failed to process uploaded file after 2 attempts.",t),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:c.default.FAILED})),n.props.removeBlock())):t.name.toLowerCase().indexOf(".gif")>-1&&!a.headers.animatedoriginal&&n.alreadyRecheckedGifAnimation<3?(n.alreadyRecheckedGifAnimation++,n.checkExists(e,t)):("function"==typeof n.props.uploadProps.onUploadProgress&&n.props.uploadProps.onUploadProgress(100,t),window.setTimeout(function(){n.uploadComplete(e,t,"true"===a.headers.animatedoriginal?"anim":void 0)},1e3))}).catch(function(e){(0,p.logError)(e||res.text),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:c.default.FAILED})),n.props.removeBlock())})}},{key:"uploadComplete",value:function(e,t,n){this.props.swapPendingForCollection(this.props.entityKey,t.index,{collectionType:this.props.subItemType,collectionMembers:[(0,i.default)({memberType:this.props.subItemType},this.getCollectionMemberProps(e,t,n))]}),this.props.uploadProps.onUploadEnd((0,i.default)(t,{status:c.default.UPLOADED}))}},{key:"getPostProcessingProgress",value:function(e){return 80+20/30*e}},{key:"getCollectionMemberProps",value:function(e,t,n){switch(e.subItemType){case"Image":return{mediaList:[{mediaID:e.subItemID,dataUrl:t.dataUrl,mediaType:n}]};case"Video":return{mediaID:e.subItemID,title:t.name};case"Document":return{documentID:e.subItemID,fromSharepoint:!1,title:t.name,documentType:m.RE_FILE_EXTENSION.exec(t.name)[1]};default:throw new Error("Unsupported subItemType returned when requesting upload ticket: "+e.subItemType)}}},{key:"abortUpload",value:function(){this.req&&this.req.abort(),this.uploadAborter&&this.uploadAborter.abort(),this.cancelUploadFilter&&(this.cancelUploadFilter.cancel=!0),this.props.uploadProps.onUploadEnd&&this.props.uploadProps.onUploadEnd((0,i.default)(this.props.file,{status:c.default.ABORTED}))}},{key:"render",value:function(){return this.props.children}}]),t}(u.Component);t.default=v},255:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET_IS_ONLINE=t.OPEN_DRAFT=t.GOT_DRAFTS=t.DELETING_DRAFT=t.SAVED_DRAFT=t.SET_DRAFT_STATUS=t.CLEAR_ITEM_CONTENT=t.CLEAR_ITEM_TITLE=t.RECEIVE_ITEM=t.GOT_DEFAULT_MENTIONS=t.DELETED_TAG=t.ADDED_TAG=t.ADDED_ITEM=t.ADDING_ITEM=t.SET_IS_OPEN=void 0,t.setIsOpen=T,t.addingItem=b,t.addedItem=C,t.addTag=function(e){return{type:f,tag:e}},t.deleteTag=function(e){return{type:m,tag:e}},t.gotDefaultMentions=D,t.receiveItem=M,t.clearItemTitle=function(){return{type:g}},t.clearItemContent=function(){return{type:v}},t.setDraftStatus=w,t.savedDraft=P,t.deletingDraft=L,t.gotDrafts=O,t.openDraft=function(e){return{type:I,itemID:e}},t.setIsOnLine=function(e){return{type:S,isOnLine:e}},t.submitItem=function(e){if("0"===currentEmployee.employeeID)return{type:o.USER_ZERO};var t=e.isDraft;return e.isDraft=!1,t?function(e){return function(t){return t(b(e,!0)),i.default.put(apiUrl+"/stream/"+e.itemID).authBearer(a.default.getToken()).send(e).end(function(n,i){n||!i.ok?((0,s.logError)(n||i.text,e),t(b(e,!1)),t((0,o.setActionError)(n||i.text))):a.default.isEditDraft()||a.default.isEditPost()?window.location.href=urlTemplates.threadUrl+"?ItemID="+e.itemID:(t(C(i.body)),a.default.dispatchEvent("SharedStreamItem",i.body))})}}(e):e.itemID?function(e){return function(t){return i.default.put(apiUrl+"/stream/"+e.itemID).authBearer(a.default.getToken()).send(e).end(function(n,i){n||!i.ok?((0,s.logError)(n||i.text,e),t(b(e,!1)),t((0,o.setActionError)(n||i.text))):window.location.href=urlTemplates.threadUrl+"?ItemID="+e.itemID})}}(e):function(e){return function(t){return t(b(e,!0)),i.default.post(apiUrl+"/stream").authBearer(a.default.getToken()).send(e).end(function(n,i){n||!i.ok?((0,s.logError)(n||i.text,e),t(b(e,!1)),t((0,o.setActionError)(n||i.text))):(t(C(i.body)),a.default.dispatchEvent("SharedStreamItem",i.body))})}}(e)},t.getDefaultMentions=function(){return function(e){return i.default.get("/_layouts/15/NexusAPIProxy/GetDefaultMentions2.ashx"+window.location.search).query({CommunityID:communityID}).withCredentials().end(function(t,n){t||!n.ok?a.default.receivedAPIError(t||n.text):e(D(n.body))})}},t.fetchItem=function(e){return function(t){return i.default.get(apiUrl+"/stream/"+e).query({draftJs:!0}).authBearer(a.default.getToken()).withCredentials().end(function(n,i){if(n||!i.ok)(0,s.logError)(n||i.text,{itemID:e}),t((0,o.setActionError)(n||i.text));else{var r=i.body.results[0];a.default.isEditDraft()&&!r.isDraft?window.location.href=urlTemplates.threadUrl+"?ItemID="+e:r.author&&r.author.employeeID==currentEmployee.employeeID||a.default.isSPAdmin()?t(M(r)):alert("You may not edit another user's post.")}})}},t.submitDraft=function(e){return function(t,n){return t(w(r.draftSaveStatuses.saving,e.itemID)),e.itemID?function(e,t){return A=window.setTimeout(function(){e(w(r.draftSaveStatuses.failed,t.itemID))},1e4),i.default.put(apiUrl+"/stream/"+t.itemID).authBearer(a.default.getToken()).send(t).end(function(n,i){A&&(window.clearTimeout(A),A=null),n||!i.ok?((0,s.logError)(n||i.text,t),e(w(r.draftSaveStatuses.failed,t.itemID))):e(P(i.body,t.tempItemID))})}(t,e):function(e,t){return i.default.post(apiUrl+"/stream").authBearer(a.default.getToken()).send(t).end(function(n,i){n||!i.ok?((0,s.logError)(n||i.text,t),e(w(r.draftSaveStatuses.failed,t.itemID))):e(P(i.body,t.tempItemID))})}(t,e)}},t.deleteOpenDraft=function(){return function(e,t){var n=t().item.itemID;return e(T(!1)),N(n,e)}},t.deleteOldDraft=function(e){return function(t,n){n().item.itemID===e&&t(T(!1)),N(e,t)}},t.getDrafts=function(){return function(e){return i.default.get(apiUrl+"/stream?view=myDrafts").authBearer(a.default.getToken()).withCredentials().end(function(t,n){t||!n.ok?(0,s.logError)(t||n.text):e(O(n.body.results))})}};var i=l(n(191)),a=l(n(179)),o=n(188),r=n(208),s=n(189);function l(e){return e&&e.__esModule?e:{default:e}}n(216)(i.default);var u=t.SET_IS_OPEN="SET_IS_OPEN",d=t.ADDING_ITEM="ADDING_ITEM",c=t.ADDED_ITEM="ADDED_ITEM",f=t.ADDED_TAG="ADDED_TAG",m=t.DELETED_TAG="DELETED_TAG",p=t.GOT_DEFAULT_MENTIONS="GOT_DEFAULT_MENTIONS",h=t.RECEIVE_ITEM="RECEIVE_ITEM",g=t.CLEAR_ITEM_TITLE="CLEAR_ITEM_TITLE",v=t.CLEAR_ITEM_CONTENT="CLEAR_ITEM_CONTENT",y=t.SET_DRAFT_STATUS="SET_DRAFT_STATUS",E=t.SAVED_DRAFT="SAVED_DRAFT",_=t.DELETING_DRAFT="DELETING_DRAFT",k=t.GOT_DRAFTS="GOT_DRAFTS",I=t.OPEN_DRAFT="OPEN_DRAFT",S=t.SET_IS_ONLINE="SET_IS_ONLINE";function T(e){return{type:u,isOpen:e}}function b(e,t){return{type:d,item:e,isAddingItem:t}}function C(e){return{type:c,item:e}}function D(e){return{type:p,tags:e}}function M(e){return{type:h,item:e}}function w(e,t){return{type:y,draftSaveStatus:e,itemID:t}}function P(e,t){return{type:E,streamDraft:e,tempItemID:t}}function L(e){return{type:_,itemID:e}}function O(e){return{type:k,drafts:e}}var A=void 0;function N(e,t){return t(L(e)),i.default.delete(apiUrl+"/stream/"+e).authBearer(a.default.getToken()).end(function(t,n){!t&&n.ok||(0,s.logError)(t||n.text,{itemID:e})})}},257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITEMS_PER_PAGE=void 0;var i=c(n(222)),a=c(n(186)),o=n(188),r=c(n(276)),s=c(n(179)),l=n(258),u=n(214),d=n(189);function c(e){return e&&e.__esModule?e:{default:e}}t.ITEMS_PER_PAGE=10;var f={items:(0,r.default)(),newItems:[],updatedItems:[],belowItems:[],deletedItems:[]},m=(0,a.default)({isSPAdmin:!1,isFetching:!0,isThreadView:p(),isListLessMode:!p()&&"less"==(localStorage.getItem("moreOrLess")||"less"),streamView:(0,l.getViewsToShow)(!1,!1).indexOf(h())>-1?h():(0,l.getViewsToShow)(!1,!1)[0],filters:g(),filterOperation:window.streamFilterOperation||"Or",maxItems:window.streamMaxItems||0,isViewMenuOpen:!1,didInvalidate:!1,endOfStream:!1,isOnLine:navigator.onLine},f);function p(){var e=g();return e.length>0&&(e.filter(function(e){return null!=e.StreamItem}).length>0||e.filter(function(e){return null!=e.BlogPost}).length>0)}function h(){return localStorage.getItem("streamView")||"All"}function g(){return void 0===window.streamFilters&&(window.streamFilters=null),null!=window.streamFilters&&window.streamFilters.length>0?window.streamFilters:null!=(0,d.getQueryStringValue)("ItemID")?[{StreamItem:(0,d.getQueryStringValue)("ItemID")}]:null!=(0,d.getQueryStringValue)("Hashtag")?[{Hashtag:decodeURIComponent((0,d.getQueryStringValue)("Hashtag"))}]:null!=(0,d.getQueryStringValue)("Employee")?[{Author:(0,d.getQueryStringValue)("Employee")}]:null!=(0,d.getQueryStringValue)("Project")?[{Project:(0,d.getQueryStringValue)("Project")}]:null!=(0,d.getQueryStringValue)("Opportunity")?[{Opportunity:(0,d.getQueryStringValue)("Opportunity")}]:null!=(0,d.getQueryStringValue)("Company")?[{Company:(0,d.getQueryStringValue)("Company")}]:null!=(0,d.getQueryStringValue)("Contact")?[{Contact:(0,d.getQueryStringValue)("Contact")}]:window.location.pathname.toLowerCase().endsWith("post.aspx")&&!window.location.pathname.toLowerCase().endsWith("newpost.aspx")?[{BlogPost:(0,d.getQueryStringValue)("List").toUpperCase()+"|"+(0,d.getQueryStringValue)("ID")}]:window.location.pathname.toLowerCase().endsWith("category.aspx")?[{BlogCategory:window.location}]:s.default.isHome()?[]:[{Community:communityID}]}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments[1];switch(t.type){case o.GOT_STREAM_CONFIG:return(0,a.default)({},e,t.config);case o.SET_LIST_LESS_MODE:return localStorage.setItem("moreOrLess","less"),(0,a.default)({},e,{isListLessMode:!0,items:(0,r.default)(e.items,t)});case o.SET_LIST_MORE_MODE:return localStorage.setItem("moreOrLess","more"),(0,a.default)({},e,{isListLessMode:!1,items:(0,r.default)(e.items,t)});case o.TOGGLE_VIEW_MENU:return(0,a.default)({},e,{isViewMenuOpen:!e.isViewMenuOpen});case o.SET_STREAM_VIEW:return-1!==l.views_Persistable.indexOf(t.newView)&&localStorage.setItem("streamView",t.newView),(0,a.default)({},e,{isViewMenuOpen:!1,streamView:t.newView},f);case o.SET_IS_ONLINE:return(0,a.default)({},e,{isOnLine:t.isOnLine,warnOffline:!t.isOnLine&&(e.items||[]).find(function(e){return e.commentDrafts&&e.commentDrafts.length>0})?u.OUTAGE_BANNERS.isEditing.number:0});case o.SET_WARN_OFFLINE:return(0,a.default)({},e,{warnOffline:t.showWarning?t.bannerNumber:0});case o.SET_WARN_BROKEN_USER:return(0,a.default)({},e,{warnBrokenUser:t.showWarning});case o.UPDATED_ITEM_PROMOTTION:return(0,a.default)({},e,f);case o.DELETED_ITEM:case o.UNDELETE_ITEM:return e.isThreadView?(0,a.default)({},e,{items:(0,r.default)(e.items,t,e.isListLessMode)}):(0,a.default)({},e,{items:e.items.filter(function(e){return e.itemID!=t.itemID})});case o.REQUEST_ITEMS:return(0,a.default)({},e,{isFetching:!0});case o.RECEIVE_ITEMS:var n=e.items.concat((0,r.default)(t.items,t,e.isListLessMode));return n=s.default.uniqueItems(n),(0,a.default)({},e,{isSPAdmin:s.default.isSPAdmin(),isFetching:!1,endOfStream:0==t.items.length||e.maxItems>0&&n.length>=e.maxItems||e.isThreadView,items:n,receiveError:null});case o.COULDNT_RECEIVE_ITEMS:return(0,a.default)({},e,{receiveError:t.error});case o.SET_IS_FETCHING:return(0,a.default)({},e,{isFetching:t.isFetching});case o.RECEIVE_UPDATED_ITEMS:var d=new Date(s.default.getMaxModDate(e.items,e.newItems,e.updatedItems,e.belowItems,e.deletedItems)),c=t.items.filter(function(e){return e.deleted}),p=t.items.filter(function(t){return!t.deleted&&null!=e.items.find(function(e){return t.itemID===e.itemID})}),h=t.items.filter(function(t){return!t.deleted&&null==e.items.find(function(e){return t.itemID===e.itemID})&&null==e.newItems.find(function(e){return t.itemID===e.itemID})}),g=t.items.filter(function(t){return null!=e.newItems.find(function(e){return t.itemID===e.itemID})}),v=h.filter(function(e){return new Date(e.dateStamp)>d}),y=v.filter(function(e){return"New Blog Post"===e.itemType&&e.author&&e.author.employeeID===currentEmployee.employeeID}),E=v.filter(function(e){return null==y.find(function(t){return e.itemID===t.itemID})}),_=h.filter(function(e){return new Date(e.dateStamp)<d});return(0,a.default)({},e,{items:[].concat((0,i.default)(e.items.filter(function(e){return e.promoted})),(0,i.default)((0,r.default)(y,t).map(function(t){return(0,a.default)({},t,{isLessMode:e.isListLessMode})})),(0,i.default)(e.items.filter(function(e){return!e.promoted}))),newItems:[].concat((0,i.default)(E),(0,i.default)(e.newItems.filter(function(e){return null==c.find(function(t){return e.itemID===t.itemID})}).map(function(e){return g.find(function(t){return e.itemID===t.itemID})||e}))),updatedItems:[].concat((0,i.default)(p),(0,i.default)(e.updatedItems.filter(function(e){return null==p.find(function(t){return e.itemID===t.itemID})&&null==c.find(function(t){return e.itemID===t.itemID})}))),belowItems:[].concat((0,i.default)(e.belowItems.filter(function(e){return null==c.find(function(t){return e.itemID===t.itemID})})),(0,i.default)(_)),deletedItems:[].concat((0,i.default)(c),(0,i.default)(e.deletedItems.filter(function(e){return null==c.find(function(t){return e.itemID===t.itemID})})))});case o.SHARED_STREAM_ITEM:return null==t.item||"null"===t.item?(alert("null stream item returned"),e):(0,a.default)({},e,{items:[].concat((0,i.default)(e.items.filter(function(e){return e.promoted})),(0,i.default)((0,r.default)([t.item],t,e.isListLessMode)),(0,i.default)(e.items.filter(function(e){return!e.promoted})))});case o.SHOW_NEW_ITEMS:var k=(0,r.default)(e.newItems,t).map(function(t){return t.isLessMode=e.isListLessMode,t}),I=k.filter(function(e){return e.promoted}),S=k.filter(function(e){return!e.promoted}),T=e.items.filter(function(e){return e.promoted}),b=e.items.filter(function(e){return!e.promoted}),C=[].concat((0,i.default)(I),(0,i.default)(T),(0,i.default)(S),(0,i.default)(b));return 0!==e.maxItems&&C.splice(e.maxItems),(0,a.default)({},e,{items:C,newItems:[],endOfStream:e.maxItems>0&&C.length>=e.maxItems});case o.SET_ACTION_ERROR:return(0,a.default)({},e,{actionError:t.error});default:return(0,a.default)({},e,{items:(0,r.default)(e.items,t,e.isListLessMode)})}}},258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.views_Persistable=t.getViewsToShow=void 0;var i=s(n(177)),a=s(n(180)),o=s(n(190)),r=s(n(203));function s(e){return e&&e.__esModule?e:{default:e}}if(null==l)var l=n(179).static_images;var u=function(e){var t=e.isListLessMode,n=e.setListLessMode,a=e.setListMoreMode,s=e.isViewMenuOpen,u=e.isThreadView,c=e.isSPAdmin,f=e.apiFilterEnabled,m=e.toggleViewMenu,p=e.currentView,h=e.setView;if(u)return null;var g=d(c,f);return i.default.createElement("div",{style:{margin:"0 15px 14px 5px",textAlign:"center"}},i.default.createElement("ul",{className:(0,o.default)("ka_streamViews","dropdown",s?"open":null)},i.default.createElement("li",null,i.default.createElement("span",{onClick:m},E[p],i.default.createElement("img",{src:l.more_caret_dk_grey_14,style:{marginLeft:5}})),s&&i.default.createElement(r.default,{onClose:m},i.default.createElement("ul",{style:{visibility:"visible"}},g.map(function(e){return e!==p?i.default.createElement("li",{key:e},i.default.createElement("span",{onClick:function(){return h(e)}},E[e])):null}))))),i.default.createElement("div",{className:"ka_streamMoreLess"},i.default.createElement("span",{onClick:function(){n()},className:t?"linkActive":"linkInactive"},"Less")," | ",i.default.createElement("span",{onClick:function(){a()},className:t?"linkInactive":"linkActive"},"More")),i.default.createElement("div",{style:{width:0,clear:"both"}}))},d=t.getViewsToShow=function(e,t){return window.location.pathname.endsWith("StreamAdmin.aspx")?t?p:m:window.location.pathname.endsWith("Topic.aspx")?e?t?y:v:f:"undefined"!=typeof urlTemplates&&"/"===urlTemplates.communityUrls[communityID]?e?t?g:h:c:e?t?y:v:f},c=(t.views_Persistable=["All","ImFollowing"],["All","ImFollowing","MostActive"]),f=["All","MostActive"],m=["All","Promoted","Removed"],p=["All","Promoted","Published","Removed"],h=["All","ImFollowing","MostActive","Promoted","Removed"],g=["All","ImFollowing","MostActive","Promoted","Published","Removed"],v=["All","MostActive","Promoted","Removed"],y=["All","MostActive","Promoted","Published","Removed"],E={All:"All Items",ImFollowing:"I'm Following",MostActive:"Most Active",Promoted:"Promoted",Published:"Published",Removed:"Removed"};u.propTypes={isListLessMode:a.default.bool.isRequired,setListLessMode:a.default.func.isRequired,setListMoreMode:a.default.func.isRequired,isViewMenuOpen:a.default.bool,isThreadView:a.default.bool,toggleViewMenu:a.default.func.isRequired,currentView:a.default.string,setView:a.default.func.isRequired,isSPAdmin:a.default.bool,apiFilterEnabled:a.default.bool},t.default=u},259:function(e,t,n){},261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShareCode=void 0;var i=v(n(181)),a=v(n(182)),o=v(n(183)),r=v(n(184)),s=v(n(185)),l=n(177),u=v(l),d=v(n(187)),c=v(n(180)),f=v(n(192)),m=n(179),p=n(205),h=n(207),g=v(n(499));function v(e){return e&&e.__esModule?e:{default:e}}n(238);var y=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),o=e.width?parseInt(e.width):h.DEF_VIDEO_WIDTH,s=e.height?parseInt(e.height):h.DEF_VIDEO_HEIGHT;return n.state={shareStartChecked:!1,shareStartValue:n.props.currentTime?(0,p.toHHMMSS)(n.props.currentTime):"0:00",shareStartTime:n.props.currentTime||0,shareStartChecked_embed:!1,shareStartValue_embed:n.props.currentTime?(0,p.toHHMMSS)(n.props.currentTime):"0:00",shareStartTime_embed:n.props.currentTime||0,shareWidth:o,shareHeight:s,aspectRatio:o/s},n.getShareUrl=n.getShareUrl.bind(n),n.updateShareWidth=n.updateShareWidth.bind(n),n.updateShareHeight=n.updateShareHeight.bind(n),n.shareWidthKeyDown=n.shareWidthKeyDown.bind(n),n.shareHeightKeyDown=n.shareHeightKeyDown.bind(n),n.shareWidthChanged=n.shareWidthChanged.bind(n),n.shareHeightChanged=n.shareHeightChanged.bind(n),n.startCheckChanged=n.startCheckChanged.bind(n),n.startValueChanged=n.startValueChanged.bind(n),n.startValueBlur=n.startValueBlur.bind(n),n.startCheckChanged_embed=n.startCheckChanged_embed.bind(n),n.startValueChanged_embed=n.startValueChanged_embed.bind(n),n.startValueBlur_embed=n.startValueBlur_embed.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{title:"Share This Video on Your Intranet",titleHelp:u.default.createElement("img",{src:m.static_images.help_dark,width:20,height:20,"data-tip":E}),onClose:this.props.onClose},u.default.createElement("div",{className:"kamodal-subtitle"},"Share in a Post or Comment"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{ref:function(t){return e.shareUrl=t},type:"text",value:this.getShareUrl(),onChange:function(){},style:{width:350},onClick:function(){return e.copyText(e.shareUrl)}}),u.default.createElement("span",{className:"linkActive",style:{marginLeft:10},onClick:function(){return e.copyText(e.shareUrl)}},u.default.createElement("img",{src:m.static_images.link_cyan_16,style:{marginRight:10,verticalAlign:"middle"},width:16,height:20}),"Copy URL")),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{type:"checkbox",checked:this.state.shareStartChecked,onChange:this.startCheckChanged})," Start video at  ",u.default.createElement("input",{type:"text",value:this.state.shareStartValue,onChange:this.startValueChanged,onBlur:this.startValueBlur,className:"ka-little-input"})),u.default.createElement("div",{className:"kamodal-subtitle"},"Embed in a Wiki Page",u.default.createElement("img",{src:m.static_images.help_dark,width:20,height:20,style:{verticalAlign:"middle",marginLeft:10},"data-tip":_})),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("textarea",{ref:function(t){return e.embedCode=t},style:{resize:"vertical",width:350,height:35,overflow:"hidden"},value:this.getShareCode(),onChange:function(){},spellCheck:!1,onClick:function(){return e.copyText(e.embedCode)}}),u.default.createElement("span",{className:"linkActive",style:{marginLeft:10},onClick:function(){return e.copyText(e.embedCode)}},u.default.createElement("img",{src:m.static_images.embed_code_cyan,style:{marginRight:10,verticalAlign:"middle"},width:24,height:24}),"Copy Embed Code")),u.default.createElement("div",{className:"kamodal-block"},"Video Size:  ",u.default.createElement("input",{type:"text",value:this.state.shareWidth,onChange:this.shareWidthChanged,onKeyDown:this.shareWidthKeyDown,className:"ka-little-input"}),"  x  ",u.default.createElement("input",{type:"text",value:this.state.shareHeight,onChange:this.shareHeightChanged,onKeyDown:this.shareHeightKeyDown,className:"ka-little-input"}),"  pixels"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{type:"checkbox",checked:this.state.shareStartChecked_embed,onChange:this.startCheckChanged_embed})," Start video at  ",u.default.createElement("input",{type:"text",value:this.state.shareStartValue_embed,onChange:this.startValueChanged_embed,onBlur:this.startValueBlur_embed,className:"ka-little-input"}))),d.default.createPortal(u.default.createElement(l.Fragment,null,u.default.createElement(g.default,{place:"top",type:"light",effect:"solid",className:"ka-tooltip",scrollHide:!0,html:!0,delayHide:1500})),document.body)," ")}},{key:"getShareUrl",value:function(){var e=window.location.origin+"/_layouts/video/player.aspx?id="+this.props.videoID;return this.state.shareStartChecked&&0!==this.state.shareStartTime&&(e+="&start="+this.state.shareStartTime),e}},{key:"getShareCode",value:function(){return I(this.props.videoID,this.state.shareWidth,this.state.shareHeight,this.state.shareStartChecked_embed?this.state.shareStartTime_embed:void 0)}},{key:"shareWidthChanged",value:function(e){/[^0-9]/.test(e.target.value)||this.updateShareWidth(parseInt(e.target.value))}},{key:"shareWidthKeyDown",value:function(e){switch(e.keyCode){case 38:this.updateShareWidth(this.state.shareWidth+1),e.stopPropagation();break;case 40:this.updateShareWidth(this.state.shareWidth-1),e.stopPropagation()}}},{key:"updateShareWidth",value:function(e){this.setState({shareWidth:e,shareHeight:Math.round(e/this.state.aspectRatio)})}},{key:"shareHeightChanged",value:function(e){/[^0-9]/.test(e.target.value)||this.updateShareHeight(parseInt(e.target.value))}},{key:"shareHeightKeyDown",value:function(e){switch(e.keyCode){case 38:this.updateShareHeight(this.state.shareHeight+1),e.stopPropagation();break;case 40:this.updateShareHeight(this.state.shareHeight-1),e.stopPropagation()}}},{key:"updateShareHeight",value:function(e){this.setState({shareHeight:e,shareWidth:Math.round(e*this.state.aspectRatio)})}},{key:"startCheckChanged",value:function(e){this.setState({shareStartChecked:e.target.checked})}},{key:"startValueChanged",value:function(e){/[^0-9:]/.test(e.target.value)||this.setState({shareStartValue:e.target.value,shareStartChecked:!0,shareStartTime:k(e.target.value)||0})}},{key:"startValueBlur",value:function(e){k(e.target.value)?this.setState({shareStartValue:(0,p.toHHMMSS)(this.state.shareStartTime)}):this.setState({shareStartValue:"0:00"})}},{key:"startCheckChanged_embed",value:function(e){this.setState({shareStartChecked_embed:e.target.checked})}},{key:"startValueChanged_embed",value:function(e){/[^0-9:]/.test(e.target.value)||this.setState({shareStartValue_embed:e.target.value,shareStartChecked_embed:!0,shareStartTime_embed:k(e.target.value)||0})}},{key:"startValueBlur_embed",value:function(e){k(e.target.value)?this.setState({shareStartValue_embed:(0,p.toHHMMSS)(this.state.shareStartTime_embed)}):this.setState({shareStartValue_embed:"0:00"})}},{key:"copyText",value:function(e){e.select(),document.execCommand("Copy")}}]),t}(l.Component),E='Can Synthesis Videos be shared outside our Intranet? Nope! This URL and Embed Code only works within your intranet. Learn more in <a href="https://knowledgearchitecture.zendesk.com/hc/en-us/articles/360015148192-Can-Synthesis-Native-Video-Be-Shared-Outside-Our-Intranet-" target="_blank">this article</a>.',_="To embed this video in a Wiki Page:<br/><br/><span style='font-weight:500'>1.</span> Copy code below.<br/><span style='font-weight:500'>2.</span> Edit your Wiki Page.<br/><span style='font-weight:500'>3.</span> Click on Insert ribbon.<br/><span style='font-weight:500'>4.</span> Click on Embed Code tool.<br/><span style='font-weight:500'>5.</span> Paste in your code and click Insert.",k=function(e){var t=e.split(":");switch(t.length){case 1:return parseInt(t[0])||0;case 2:return 60*(parseInt(t[0])||0)+(parseInt(t[1])||0);case 3:return 60*(parseInt(t[0])||0)*60+60*(parseInt(t[1])||0)+(parseInt(t[2])||0);default:return NaN}},I=function(e,t,n,i,a,o,r){var s='<ka-video id="'+e+'" width="'+(t||h.DEF_VIDEO_WIDTH)+'" height="'+(n||h.DEF_VIDEO_HEIGHT)+'"';return i&&(s+=' start="'+i+'"'),a&&(s+=' duration="'+a+'"'),o&&(s+=' fileSize="'+o+'"'),r&&(s+=' uploaded="'+r+'"'),s+="></ka-video>"};t.getShareCode=I,y.propTypes={currentTime:c.default.number},t.default=y},269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(186)),a=o(n(177));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=(0,i.default)({},e);return delete t.enabled,1==e.enabled?a.default.createElement("a",t):a.default.createElement("span",t)}},276:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(222)),a=u(n(186)),o=n(188),r=u(n(277)),s=u(n(278)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213));function u(e){return e&&e.__esModule?e:{default:e}}var d={isLiking:!1,isAddingComment:!1,showingAllComments:!1,isEditingTags:!1},c=function(e,t){return{isLiking:e.isLiking,isAddingComment:e.isAddingComment,showingAllComments:e.showingAllComments,isEditingTags:e.isEditingTags,isLessMode:void 0!==e.isLessMode?e.isLessMode:t,isContentLessMode:void 0!==e.isContentLessMode?e.isContentLessMode:t,isCommenting:e.isCommenting}},f=function(e,t,n){switch(t.type){case o.DELETE_ITEM:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isRemoving:!0});case o.DELETED_ITEM:case o.UNDELETED_ITEM:return e.itemID!==t.itemID?e:(0,a.default)({},t.item,c(e,n));case o.SET_CONTENT_TALL:return e.itemID!==t.itemID?e:(0,a.default)({},e,{contentIsTall:t.contentIsTall});case o.TOGGLE_ITEM_LESS_MODE:return e.itemID!==t.itemID?e:(e.isContentLessMode&&l.trackPostOpen(e),(0,a.default)({},e,{isLessMode:!e.isLessMode,isContentLessMode:!e.isLessMode}));case o.TOGGLE_CONTENT_LESS_MODE:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isContentLessMode:!e.isContentLessMode});case o.TOGGLE_SEMI_LESS_MODE:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isLessMode:!e.isLessMode});case o.TOGGLE_TAG_EDITOR:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isEditingTags:!e.isEditingTags});case o.SHOW_ALL_COMMENTS:return e.itemID!==t.itemID?e:(0,a.default)({},e,{showingAllComments:!0});case o.SET_LIST_LESS_MODE:return(0,a.default)({},e,{isLessMode:!0,isContentLessMode:!0});case o.SET_LIST_MORE_MODE:return(0,a.default)({},e,{isLessMode:!1,isContentLessMode:!1});case o.ADD_ITEM_LIKE:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isLiking:!0,likes:[].concat((0,i.default)(e.likes||[]),[{author:currentEmployee}])});case o.DELETE_ITEM_LIKE:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isLiking:!0,likes:(e.likes||[]).filter(function(e){return e.author.employeeID.toLowerCase()!=currentEmployee.employeeID.toLowerCase()})});case o.ADDED_ITEM_LIKE:case o.DELETED_ITEM_LIKE:return e.itemID!==t.itemID?e:(0,a.default)({},t.item,c(e,n),{isLiking:!1});case o.ADD_ITEM_SUBSCRIPTION:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isSubscribing:!0,isNotify:1});case o.DELETE_ITEM_SUBSCRIPTION:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isSubscribing:!0,isNotify:0});case o.ADDED_ITEM_SUBSCRIPTION:case o.DELETED_ITEM_SUBSCRIPTION:return e.itemID!==t.itemID?e:(0,a.default)({},e,{isSubscribing:!1});case o.ADDING_ITEM_TAG:return e.itemID!==t.itemID?e:t.tag.hashtag?(0,a.default)({},e,{hashtags:[].concat((0,i.default)(e.hashtags||[]),[(0,a.default)({},t.tag,{deleted:!1})])}):(0,a.default)({},e,{mentions:[].concat((0,i.default)(e.mentions||[]),[(0,a.default)({},t.tag,{deleted:!1,hasProfile:!0})])});case o.DELETING_ITEM_TAG:return e.itemID!==t.itemID?e:t.tag.hashtag?(0,a.default)({},e,{hashtags:e.hashtags.map(function(e){return e.hashtag===t.tag.hashtag?(0,a.default)({},e,{deleted:!0}):e})}):(0,a.default)({},e,{mentions:e.mentions.map(function(e){return e.entityType===t.tag.entityType&&e.entityID==t.tag.entityID?(0,a.default)({},e,{deleted:!0}):e})});case o.ADDED_ITEM_TAG:case o.DELETED_ITEM_TAG:case o.SET_IS_COMMENTING:return e.itemID!==t.itemID?e:null==t.commentID?t.isCommenting?(0,a.default)({},e,{commentDrafts:(0,s.default)(e.commentDrafts,t)}):(0,a.default)({},e,{commentDrafts:[]}):(0,a.default)({},e,{comments:(0,r.default)(e.comments,t)});case o.ADD_ITEM_COMMENT:return e.itemID!==t.comment.itemID?e:(0,a.default)({},e,{isAddingComment:!0,comments:(0,r.default)(e.comments,t),commentDrafts:[],mentions:(e.mentions||[]).concat(t.comment.mentions||[]),hashtags:(e.hashtags||[]).concat(t.comment.hashtags||[]),commentEditorState:t.editorState,restoreCommentEditorState:null});case o.ADDED_ITEM_COMMENT:return e.itemID!==t.itemID?e:(0,a.default)({},t.item,c(e,n),{comments:(0,r.default)(e.comments,t),isAddingComment:!1,commentEditorState:null});case o.UPDATE_ITEM_COMMENT:return e.itemID!==t.comment.itemID?e:(0,a.default)({},e,{comments:(0,r.default)(e.comments,t),mentions:[].concat((0,i.default)(e.mentions||[]),(0,i.default)(t.comment.mentions||[])),hashtags:[].concat((0,i.default)(e.hashtags||[]),(0,i.default)(t.comment.hashtags||[]))});case o.UPDATED_ITEM_COMMENT:return e.itemID!==t.itemID?e:(0,a.default)({},t.item,c(e,n),{comments:(0,r.default)(e.comments,t)});case o.RESTORE_COMMENT_EDITOR:if(e.itemID!==t.itemID)return e;if(null==t.commentID)return(0,a.default)({},e,{restoreCommentEditorState:e.commentEditorState,commentEditorState:null,isAddingComment:!1});if(null!=t.commentID)return(0,a.default)({},e,{comments:(0,r.default)(e.comments,t)});case o.SAVED_COMMENT_DRAFT:return e.itemID!==t.commentDraft.itemID?e:(0,a.default)({},e,{commentDrafts:(0,s.default)(e.commentDrafts,t)});case o.RECEIVE_ITEMS:case o.SHOW_NEW_ITEMS:case o.SHARED_STREAM_ITEM:case o.RECEIVE_UPDATED_ITEMS:return(0,a.default)({},e,{comments:(0,r.default)(e.comments,t)},d,{isLessMode:!(e.commentDrafts&&e.commentDrafts.length>0)&&n,isContentLessMode:n});default:return t.itemID&&t.itemID!==e.itemID?e:(0,a.default)({},e,{comments:(0,r.default)(e.comments,t),commentDrafts:(0,s.default)(e.commentDrafts,t)})}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.map(function(e){return f(e,t,n)})}},277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(186),o=(i=a)&&i.__esModule?i:{default:i},r=n(188);var s={isLessMode:!0,isDraft:!1},l=(0,o.default)({},s,{isLessMode:!0}),u=function(e,t){switch(t.type){case r.RECEIVE_ITEMS:case r.SHOW_NEW_ITEMS:case r.RECEIVE_UPDATED_ITEMS:return(0,o.default)({},e,s);case r.UPDATED_ITEM_COMMENT:return(0,o.default)({},t.item.comments.find(function(e){return e.commentID===t.commentID}),s,{isLessMode:!1});case r.TOGGLE_COMMENT_LESS_MODE:return(0,o.default)({},e,{isLessMode:!e.isLessMode,hasLessMode:!0});case r.SET_IS_COMMENTING:return(0,o.default)({},e,{isCommenting:t.isCommenting});case r.UPDATE_ITEM_COMMENT:return(0,o.default)({},e,{editorState:t.editorState,jsonContent:t.comment.jsonContent,draftJsContent:t.comment.draftJsContent,mentions:t.comment.mentions},s,{isLessMode:!1});case r.RESTORE_COMMENT_EDITOR:return(0,o.default)({},e,{restoreEditorState:c.editorState,editorState:null});default:return e}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case r.RECEIVE_ITEMS:case r.SHOW_NEW_ITEMS:case r.RECEIVE_UPDATED_ITEMS:return e.map(function(e){return u(e,t)});case r.ADDED_ITEM_COMMENT:var n=e.filter(function(e){return null!=t.item.comments.find(function(t){return e.commentID===t.commentID})}),i=t.item.comments.filter(function(e){return null==n.find(function(t){return e.commentID===t.commentID})}).map(function(e){return(0,o.default)(e,l)});return n.concat(i).map(function(e){return u(e,t)});case r.ADD_ITEM_COMMENT:return(e||[]).concat((0,o.default)({author:currentEmployee,isPending:!0},l,t.comment));case r.UPDATED_ITEM_COMMENT:var a=t.item.comments.find(function(e){return e.commentID===t.commentID});return e.map(function(e){return e.commentID!=t.commentID?e:(0,o.default)({isLessMode:e.isDraft},a)});case r.DELETE_COMMENT:case r.DELETED_COMMENT:return e.filter(function(e){return e.commentID!=t.commentID});default:return e.map(function(e){return e.commentID!=t.commentID?e:u(e,t)})}}},278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(186),o=(i=a)&&i.__esModule?i:{default:i},r=n(188),s=n(208);var l={isDraft:!0,editCount:0};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case r.SET_IS_COMMENTING:return e.concat((0,o.default)({itemID:t.itemID},l));case r.SET_DRAFT_STATUS:return e.map(function(e,n){return 0===n?(0,o.default)({},e,{draftSaveStatus:t.draftSaveStatus}):e});case r.SAVED_COMMENT_DRAFT:return[(0,o.default)({},e[0],{commentID:t.commentDraft.commentID,editCount:t.commentDraft.editCount,draftSaveStatus:s.draftSaveStatuses.saved,draftJsContent:t.commentDraft.draftJsContent,subitems:t.commentDraft.subitems||t.commentDraft.subItemCollections})];case r.DELETE_COMMENT:case r.DELETED_COMMENT:return e.filter(function(e){return e.commentID!=t.commentID});default:return e}}},279:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSubject=t.getSubjectImageUrl=t.renderFormattedContent=t.renderJsonContent=void 0;var i=D(n(186)),a=D(n(181)),o=D(n(182)),r=D(n(183)),s=D(n(184)),l=D(n(185)),u=n(177),d=D(u),c=D(n(187)),f=D(n(180)),m=D(n(190)),p=D(n(280)),h=D(n(516)),g=D(n(519)),v=D(n(526)),y=D(n(527)),E=D(n(530)),_=D(n(560)),k=n(179),I=D(k),S=n(209),T=D(n(562)),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213)),C=n(189);function D(e){return e&&e.__esModule?e:{default:e}}var M=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={},n.toggleItemLessMode=n.toggleItemLessMode.bind(n),n.trackSubitem=n.trackSubitem.bind(n),n.linkClicked=n.linkClicked.bind(n),n.authorClicked=n.authorClicked.bind(n),e.isThreadView&&e.item&&(document.title=I.default.replaceInlineTagsWithText(e.item.title,e.item.mentions)),n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidCatch",value:function(e,t){(0,C.logError)(e,this.props.item),this.setState({error:e})}},{key:"toggleItemLessMode",value:function(e){var t=this;this.props.item.isLessMode||I.default.compensateScrollPosition(c.default.findDOMNode(this).querySelector(".ka_streamItemToggle"),function(){return c.default.findDOMNode(t).querySelector(".ka_streamItemToggle")},function(){return t.props.toggleItemLessMode(e)})}},{key:"trackSubitem",value:function(e,t,n,i,a){"Video"===e&&a===b.eventTypes.watch?b.trackVideoWatch(i.videoID,i.chunksWatched,i.sessionID,this.props.item):b.trackPostSubitemClick(e,t,n,this.props.item)}},{key:"linkClicked",value:function(e,t,n){var i=(0,C.getLinkTarget)(e.target);i&&(i.className.indexOf("ka_mention_link")>-1||i.className.indexOf("ka_hashtag_link")>-1?b.trackPostTagClick(i.href,i.text,t||i.getAttribute("entityType"),n||i.getAttribute("entityID"),this.props.item):i.className.indexOf("ka_authorName")>-1?b.trackPostAuthorClick(i.href,i.text,this.props.item):b.trackPostLinkClick(i.href,i.text,this.props.item))}},{key:"authorClicked",value:function(e){b.trackPostAuthorClick(e.target.href,e.target.text,this.props.item)}},{key:"render",value:function(){var e=this,t=this.props,n=t.item,i=t.presenceEnabled,a=(t.checkContentTall,t.toggleItemLessMode),o=t.toggleTagEditor;if(this.state.error)return w(n.itemID);if(n.isRemoving&&!this.props.isThreadView)return null;if(n.deleted&&!I.default.isSPAdmin()&&n.author.employeeID!==employeeID)return d.default.createElement("div",{style:{textAlign:"center",padding:"30px 0",fontWeight:500}},"This post has been removed from the stream.");void 0===n.contentIsTall?(0,m.default)("ka_streamItemContent","less"):!0===n.contentIsTall&&(0,m.default)("ka_streamItemContent","lessTall");var r=F(n.subjectType,n.subjectID,n.author,n.mentions,n.entityOverride);null===r&&console.error("No subject entity found for item "+n.itemID);var s=r.entityType,l=I.default.getEntityID(r),u=!r.deleted&&(r.hasProfile||null!=I.default.getEntityInDirectory(r)&&"Y"===I.default.getEntityInDirectory(r).toUpperCase()),c=I.default.getEntityName(r),f=r.primaryImageID||r.entityImageID,k=d.default.createElement("img",{className:"imgSubjectImage"+("Employee"===s?" ka_circular":""),src:B(f,s)}),b=d.default.createElement("a",{href:I.default.getProfileUrl(s,l),onClick:this.authorClicked},k),C=d.default.createElement("a",{className:"ka_authorName",href:I.default.getProfileUrl(s,l),onClick:this.authorClicked},c),D={content:null,trimmed:!1};n.jsonContent?D=P(n.jsonContent,n.subitems,n.author,n.mentions,n.hashtags,n.isContentLessMode,"ka_streamItemContent",{width:S.INT_STREAM_IMAGE_WIDTH,height:S.INT_STREAM_IMAGE_HEIGHT},S.INT_STREAM_LESS_CHARS,!0,this.trackSubitem,this.linkClicked):n.formattedContent&&(D=L(n.formattedContent,n.subitems,n.author,n.mentions,n.hashtags,n.isContentLessMode,"New Event"===n.itemType,"ka_streamItemContent",S.INT_STREAM_LESS_CHARS,this.linkClicked));var M=n.isContentLessMode&&(D.trimmed||null!=n.subitems&&n.subitems.length>0&&"Image"===n.subitems[0].collectionType);return d.default.createElement("div",{className:"updatesRow"+(n.promoted?" Promoted":"")+(n.isLessMode?" less":""),onClick:function(e){n.isLessMode&&a(n.itemID)},style:n.isLessMode?{cursor:"pointer"}:null},d.default.createElement("div",{className:"ka_subject"},u?b:k,i&&null!=r.email&&r.email.indexOf("@")>-1&&d.default.createElement("span",{className:"ms-imnSpan ka_streamPresence",style:{display:"none"},dangerouslySetInnerHTML:{__html:'\n                            <a href="#" onclick="IMNImageOnClick(event);return false;" class="ms-imnlink ms-spimn-presenceLink">\n                                <span class=\'ms-spimn-presenceWrapper ms-imnImg ms-spimn-imgSize-10x10\'>\n                                    <img onload=\'KA_IMNRC("'+r.email+"\",this)' name='imnmark' title='' ShowOfflinePawn='0' class='ms-spimn-img ms-spimn-presence-disconnected-10x10x32' src='/_layouts/15/images/spimn.png?rev=23' alt='User Presence' sip='"+r.email+"' id='imn_"+n.itemID+",type=smtp' />\n                                </span>\n                            </a>\n                            "}}),u?C:c,d.default.createElement("span",{className:"ka_streamDate ka_streamItemDate"},n.promoted?"PROMOTED":I.default.formatDateTimeStamp(n.dateStamp))),d.default.createElement("div",{className:"divStreamBody"},d.default.createElement(T.default,{streamItem:n},n.isLessMode?d.default.createElement("span",{className:"ka_streamItemTitle",dangerouslySetInnerHTML:{__html:I.default.replaceInlineTagsWithText(n.title,n.mentions)}}):d.default.createElement("a",{className:"ka_streamItemTitle",href:urlTemplates.threadUrl+"?ItemID="+n.itemID,dangerouslySetInnerHTML:{__html:I.default.replaceInlineTagsWithText(n.title,n.mentions)}})),d.default.createElement("div",{onClick:M?function(){return e.props.toggleContentLessMode(n.itemID)}:void 0,style:M?{cursor:"pointer"}:void 0},D.content,"New Event"===n.itemType&&!n.jsonContent&&n.subitems&&n.subitems.length>0&&n.subitems[0].collectionMembers&&n.subitems[0].collectionMembers.length>0&&n.subitems[0].collectionMembers[0].description&&d.default.createElement("div",{className:"ka_streamItemContent",dangerouslySetInnerHTML:{__html:n.subitems[0].collectionMembers[0].description},key:"text"}),"New Blog Post"===n.itemType&&n.isContentLessMode&&null!=n.subItemImageURL?d.default.createElement("div",{className:"ka_streamLessImg"},d.default.createElement("img",{src:n.subItemImageURL})):null,!n.jsonContent&&d.default.createElement(p.default,{subitemCollections:n.subitems,isLessMode:n.isContentLessMode,imageSize:{width:S.INT_STREAM_IMAGE_WIDTH,height:S.INT_STREAM_IMAGE_HEIGHT},className:"ka_SubItemContainer",trackSubitem:this.trackSubitem})),n.isLessMode?d.default.createElement(h.default,{itemID:n.itemID}):[d.default.createElement(g.default,{itemID:n.itemID,key:"controls",showContentMoreToggle:M}),n.isEditingTags?d.default.createElement(_.default,{className:"ka_streamSubBox",itemID:n.itemID,key:"tags",onClose:function(){return o(n.itemID)}}):null,d.default.createElement(y.default,{itemID:n.itemID,key:"likes"}),d.default.createElement(E.default,{itemID:n.itemID,key:"comments",focusEditor:this.state.focusCommentEditor}),d.default.createElement(v.default,{item:n,showItemModeToggle:!M,toggleItemLessMode:function(){return e.toggleItemLessMode(n.itemID)},tagClicked:this.linkClicked,blogCategories:n.blogCategories,key:"footer"})]))}}]),t}(u.Component),w=function(e){return d.default.createElement("div",{className:"ka_brokenPost"},d.default.createElement("div",{className:"divSubjectImage"},d.default.createElement("img",{src:k.imgRoot+"yield_cyan_lrg.svg"})),d.default.createElement("div",{className:"divStreamBody"},e?d.default.createElement("span",{className:"ka_streamItemTitle"},"Post ",e," Cannot Be Displayed"):d.default.createElement("span",{className:"ka_streamItemTitle"},"This Post Cannot Be Displayed"),d.default.createElement("div",{className:"ka_streamItemContent"},"Please contact an administrator.")))},P=t.renderJsonContent=function(e,t,n,i,a,o,r,s,l,u,c,f){var m=!1,h=void 0,g="string"==typeof e?JSON.parse(e):e,v=null!=g[0].collectionID||null!=g[0].collection;null==t&&g.filter(function(e){return null!=e.collection}).length>0&&(t=g.filter(function(e){return null!=e.collection}).map(function(e){return e.collection}));var y=null!=t&&t.length>0;if(g.forEach(function(e){e.html&&(e.html=I.default.replaceInlineTagsWithLink(e.html,n,i,a))}),o){var E=g.filter(function(e){return void 0===e.collectionID});u&&(E=E.filter(function(e){return""!=I.default.getTextFromHtml(e.html).trim()}));var _=void 0;if(u)_=E.length>0?E.slice(0,1):[];else{var k=g.find(function(e){return void 0!==e.collectionID});if(void 0===k)_=g;else{g.indexOf(k);if(v){_=[];for(var S=1;S<g.length;S++)if(void 0===g[S].collectionID)_.push(g[S]);else if(_.length>0)break}else _=g.slice(0,g.indexOf(k))}}if(_.length!==g.filter(function(e){return void 0===e.collectionID}).length&&(m=!0),E.length>_.length){var T=document.createElement("div"),b=_[_.length-1];T.innerHTML=b.html,N(T),b.html=T.innerHTML}var C=A((g=_).map(function(e){return e.html}).join(""),l,u),D=C.content.trim();m=m||C.trimmed,h=""==D?y?d.default.createElement(p.default,{subitemCollections:t,isLessMode:o,className:"ka_SubItemContainer",imageSize:s,trackSubitem:c}):null:v?[d.default.createElement(p.default,{subitemCollections:t,isLessMode:o,className:"ka_SubItemContainer",imageSize:s,key:"subitem",trackSubitem:c}),d.default.createElement("div",{className:r,dangerouslySetInnerHTML:{__html:D},onClick:f,key:"text"})]:y?[d.default.createElement("div",{className:r+" leadingText",dangerouslySetInnerHTML:{__html:D},onClick:f,key:"text"}),d.default.createElement(p.default,{subitemCollections:t,isLessMode:o,className:"ka_SubItemContainer",imageSize:s,key:"subitem",trackSubitem:c})]:d.default.createElement("div",{className:r+" leadingText",dangerouslySetInnerHTML:{__html:D},onClick:f})}else h=d.default.createElement("div",{className:r},g.map(function(e,n){if(void 0!==e.html)return d.default.createElement("div",{className:0===n?"leadingText":void 0,dangerouslySetInnerHTML:{__html:e.html},key:n,onClick:f});if(t&&void 0!==e.collectionID){0===n&&void 0===e.html&&(r+=" leadingSubItem");var i=t.find(function(t){return t.collectionID===e.collectionID});return d.default.createElement(p.default,{subitemCollections:[i],isLessMode:o,className:o?"ka_SubItemContainer":"",imageSize:s,trackSubitem:c,key:n})}return e.collection&&e.collection.collectionMembers&&e.collection.collectionMembers.length>0?d.default.createElement(p.default,{subitemCollections:[e.collection],isLessMode:o,className:o?"ka_SubItemContainer":"",imageSize:s,trackSubitem:c,key:n}):void 0}));return{content:h,trimmed:m}},L=t.renderFormattedContent=function(e,t,n,i,a,o,r,s,l,u){var c=!1,f=e||"";if(f=I.default.replaceInlineTagsWithLink(f,n,i,a),r&&null!=t&&null!=t[0].collectionMembers&&(f=t[0].collectionMembers[0].description||""),o){var m=A(f,l);f=m.content,c=m.trimmed}return{content:d.default.createElement("div",{className:s+" leadingText",dangerouslySetInnerHTML:{__html:f},onClick:u}),trimmed:c}},O=[" ",".",",","?","!"," "],A=function(e,t,n){var i=0,a=!1,o=!1,r=document.createElement("div");r.innerHTML=e;for(var s=[],l=document.createTreeWalker(r,NodeFilter.SHOW_ALL,null,null),u=void 0;u=l.nextNode();)if(i>=t||o)a=!0,s.push(u);else if("IMG"===u.nodeName||n&&"BR"===u.nodeName)o=!0,a=!0,s.push(u);else if("#text"===u.nodeName){var d=u.nodeValue;if("\n"==d||null==d||""==d)s.push(u);else if(i+d.length>t){a=!0;var c=t-i,f=d.substring(0,c);i+=f.length;for(var m=d.substring(f.length,f.length+1)[0],p=f.length>0?f.slice(-1):"a";f.length>0&&(-1===O.indexOf(m)||O.indexOf(p)>-1);)m=f.slice(-1),p=(f=f.slice(0,-1)).length>0?f.slice(-1):"a";0===f.length?s.push(u):u.nodeValue=f}else i+=d.length}return s.forEach(function(e){return U(e)}),R(r),x(r),e=r.innerHTML.trim(),a&&e.length>0&&(N(r),e=r.innerHTML.trim()),{content:e,trimmed:a}},N=function(e){var t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,null).lastChild();null==t||t.nodeValue.endsWith("&hellip;")||t.nodeValue.endsWith("…")||t.nodeValue.endsWith("...")||("A"!==t.parentNode.nodeName?t.nodeValue=I.default.trimTrailingPunctuation(t.nodeValue)+"…":t.parentNode.parentNode.innerHTML+="…")},R=function(e){for(;1==e.childNodes.length&&("P"===e.childNodes[0].nodeName||"DIV"===e.childNodes[0].nodeName);)e.innerHTML=e.childNodes[0].innerHTML},x=function e(t){for(;t.childNodes.length>0&&"BR"===t.childNodes[t.childNodes.length-1].nodeName;)t.removeChild(t.childNodes[t.childNodes.length-1]);t.childNodes.length>0&&e(t.childNodes[t.childNodes.length-1])},U=function e(t){try{null==t.parentNode?t.innerHTML="":1==t.parentNode.childNodes.lount?e(t.parentNode):t.parentNode.removeChild(t)}catch(e){}},B=t.getSubjectImageUrl=function(e,t){return null!=e?I.default.getImageURL(t,e,50,50,!0):urlTemplates.placeholderUrl+"?id="+t+"&size=50w50h_fxd"},F=t.getSubject=function(e,t,n,a,o){if(o&&"Author"===o&&n)return(0,i.default)(n,{entityType:"Employee"});if(null==e&&null!=n)return(0,i.default)(n,{entityType:"Employee"});if("Employee"===e&&null!=n&&t===n.employeeID)return(0,i.default)(n,{entityType:"Employee"});if(null!=a){var r=a.find(function(n){return n.entityType===e&&I.default.getEntityID(n)===t});if(null!=r)return r}return null};M.propTypes={item:f.default.object.isRequired,presenceEnabled:f.default.bool,isThreadView:f.default.bool,toggleItemLessMode:f.default.func.isRequired,checkContentTall:f.default.func.isRequired,toggleTagEditor:f.default.func.isRequired},t.default=M},280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(181)),a=y(n(182)),o=y(n(183)),r=y(n(184)),s=y(n(185)),l=n(177),u=y(l),d=y(n(180)),c=y(n(281)),f=y(n(286)),m=y(n(287)),p=y(n(493)),h=y(n(288)),g=y(n(249)),v=n(213);function y(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={alreadyClicked:!1},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.subitemCollections,i=t.isLessMode,a=t.className,o=t.imageSize,r=t.trackSubitem;return n&&n.length>0?(n=n.filter(function(e){return!e.deleted}),i&&n.length>1&&(n=[n[0]]),u.default.createElement("div",{className:a},n.map(function(t,n){if(void 0===t)return"There was an error displaying this item.";var a=t.collectionType,s=t.collectionID;return t.collectionMembers.map(function(t,l){var d=r&&!e.state.alreadyClicked?function(){r(a,s,t,void 0,v.eventTypes.click),e.setState({alreadyClicked:!0})}:void 0;switch(a){case"Image":return u.default.createElement(c.default,{images:t.mediaList,isLessMode:i,imageSize:o,onClick:d,key:n+"."+l});case"oEmbedContent":return u.default.createElement(f.default,{body:t.body,onClick:d,key:n+"."+l});case"Link":return u.default.createElement(m.default,{link:t,isLessMode:i,onClick:d,key:n+"."+l});case"CalendarEvent":return u.default.createElement(p.default,{event:t,onClick:d,key:n+"."+l});case"Document":return u.default.createElement(h.default,{document:t,onClick:d,key:n+"."+l});case"Video":return u.default.createElement(g.default,{videoID:t.mediaID,className:"ka_subitem",videoMeta:t,onClick:function(e){d&&d(),e.stopPropagation()},trackVideoWatch:function(e,n,i){return r(a,s,t,{videoID:e,chunksWatched:n,sessionID:i},v.eventTypes.watch)},key:n+"."+l})}})}))):null}}]),t}(l.Component);E.propTypes={subitemCollections:d.default.array,isLessMode:d.default.bool.isRequired,className:d.default.string},t.default=E},281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(282),o=(i=a)&&i.__esModule?i:{default:i};t.default=o.default},282:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processDataUrl=void 0;var i=E(n(206)),a=E(n(181)),o=E(n(182)),r=E(n(183)),s=E(n(184)),l=E(n(185)),u=n(177),d=E(u),c=E(n(180)),f=E(n(581)),m=E(n(190)),p=E(n(332)),h=E(n(492)),g=E(n(179)),v=n(209),y=E(n(285));function E(e){return e&&e.__esModule?e:{default:e}}var _=function(e){return d.default.createElement("button",{type:"button",className:e.className,onClick:e.onClick},d.default.createElement("img",{src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png"}))},k={lazyLoad:!0,nextArrow:d.default.createElement(_,{className:"slick-next"}),prevArrow:d.default.createElement(_,{className:"slick-prev"})},I=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={currentImageIndex:0},n.renderContent=n.renderContent.bind(n),n.hasNext=n.hasNext.bind(n),n.hasPrev=n.hasPrev.bind(n),n.onNext=n.onNext.bind(n),n.onPrev=n.onPrev.bind(n),n.changeModalToMediaID=n.changeModalToMediaID.bind(n),n.imageClick=n.imageClick.bind(n),n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"imageUrl",value:function(e,t,n){return n?g.default.getGifURL(e):g.default.getImageURL(null,e,this.props.imageSize.width,t?333:this.props.imageSize.height,!1)}},{key:"hasNext",value:function(){return this.props.images.length>this.state.currentImageIndex+1}},{key:"hasPrev",value:function(){return this.state.currentImageIndex>0}},{key:"onNext",value:function(){this.slider.slickNext(),this.changeModalToMediaID(this.props.images[this.state.currentImageIndex+1].mediaID),this.setState({currentImageIndex:this.state.currentImageIndex+1})}},{key:"onPrev",value:function(){this.slider.slickPrev(),this.changeModalToMediaID(this.props.images[this.state.currentImageIndex-1].mediaID),this.setState({currentImageIndex:this.state.currentImageIndex-1})}},{key:"changeModalToMediaID",value:function(e){if(this.state.mediaModalTarget){var t=document.createElement("img");t.setAttribute("src",this.imageUrl(e,!0)),this.setState({mediaModalTarget:t})}}},{key:"render",value:function(){var e=this;return d.default.createElement("div",{spellCheck:!1,className:"ka_imgOutterBox"},this.renderContent(),this.state.mediaModalTarget&&d.default.createElement(p.default,{isOpened:!0},d.default.createElement(h.default,{target:this.state.mediaModalTarget,onClose:function(){return e.setState({mediaModalTarget:null})},onLeft:this.hasPrev()?this.onPrev:null,onRight:this.hasNext()?this.onNext:null})))}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.images,a=t.isLessMode,o=t.isSelected,r="anim"===n[0].mediaType;return 1==n.length?d.default.createElement("div",{className:"ka_imgBox ka_subitem"+(o?" selected":"")+(r?" gif":""),onClick:r?void 0:function(t){return e.imageClick(S(t.target),n[0],0)}},r?d.default.createElement(y.default,{className:(0,m.default)("ka_streamImg ",a?"less":"more"),src:n[0].dataUrl||this.imageUrl(n[0].mediaID,!1,!1),image:n[0],animSrc:this.imageUrl(n[0].mediaID,!1,!0),onClick:this.props.onClick,handleClick:this.props.handleClick}):d.default.createElement("img",{className:(0,m.default)("ka_streamImg",a?"less":"more"),src:n[0].dataUrl||this.imageUrl(n[0].mediaID,!1),onClick:function(t){return e.imageClick(t.target,n[0],0)},draggable:!1})):a?d.default.createElement("div",{className:"ka_streamSliderPreview"},d.default.createElement("span",{className:"lblViewAllPhotos"},"View all ",n.length," photos"),d.default.createElement("img",{src:this.imageUrl(n[0].mediaID,!1)})):d.default.createElement(f.default,(0,i.default)({ref:function(t){return e.slider=t}},k),n.map(function(t,n){return d.default.createElement("div",{key:n},d.default.createElement("img",{src:t.dataUrl||e.imageUrl(t.mediaID,!0),onClick:function(i){return e.imageClick(i.target,t,n)}}))}))}},{key:"imageClick",value:function(e,t,n){this.props.handleClick&&this.props.handleClick(n,e)||(this.props.onClick&&this.props.onClick(),t.dataUrl||this.props.isLessMode||this.setState({mediaModalTarget:e,currentImageIndex:n}))}}]),t}(u.Component),S=function(e){return"IMG"===e.tagName?e:e.querySelector("img.ka_streamImg")};t.processDataUrl=function(e,t){if(!e)return e;var n=T(function(e){e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var t=atob(e),n=t.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=t.charCodeAt(a);return i.buffer}(e)),i=document.createElement("img");i.addEventListener("load",function(){var e=i.width,a=i.height,o=document.createElement("canvas");if([5,6,7,8].indexOf(n)>-1){var r=a>v.INT_STREAM_IMAGE_WIDTH?a/v.INT_STREAM_IMAGE_WIDTH:1;o.width=a/=r,o.height=e/=r}else{var s=e>v.INT_STREAM_IMAGE_WIDTH?e/v.INT_STREAM_IMAGE_WIDTH:1;o.width=e/=s,o.height=a/=s}var l=o.getContext("2d");switch(n){case 2:l.transform(-1,0,0,1,e,0);break;case 3:l.transform(-1,0,0,-1,e,a);break;case 4:l.transform(1,0,0,-1,0,a);break;case 5:l.transform(0,1,1,0,0,0);break;case 6:l.transform(0,1,-1,0,a,0);break;case 7:l.transform(0,-1,-1,0,a,e);break;case 8:l.transform(0,-1,1,0,0,e);break;default:l.transform(1,0,0,1,0,0)}l.drawImage(i,0,0,e,a),t(o.toDataURL())}),i.src=e};I.propTypes={images:c.default.array.isRequired,isLessMode:c.default.bool.isRequired,isSelected:c.default.bool},t.default=I;var T=function(e){var t=new window.DataView(e);if(65496!=t.getUint16(0,!1))return-2;for(var n=t.byteLength,i=2;i<n;){var a=t.getUint16(i,!1);if(i+=2,65505==a){if(1165519206!=t.getUint32(i+=2,!1))return-1;var o=18761==t.getUint16(i+=6,!1);i+=t.getUint32(i+4,o);var r=t.getUint16(i,o);i+=2;for(var s=0;s<r;s++)if(274==t.getUint16(i+12*s,o))return t.getUint16(i+12*s+8,o)}else{if(65280!=(65280&a))break;i+=t.getUint16(i,!1)}}return-1}},283:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(206)),a=h(n(186)),o=h(n(181)),r=h(n(182)),s=h(n(183)),l=h(n(184)),u=h(n(185)),d=n(177),c=h(d),f=h(n(187)),m=n(179),p=(h(m),n(570));function h(e){return e&&e.__esModule?e:{default:e}}n(259);var g=function(e){function t(e){(0,r.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={playing:!1},n.onControlClick=n.onControlClick.bind(n),n.onBackgroundClick=n.onBackgroundClick.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.imgLoaded=n.imgLoaded.bind(n),n.renderGif=n.renderGif.bind(n),n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=f.default.findDOMNode(this.img);e.complete?this.imgLoaded():e.addEventListener("load",this.imgLoaded)}},{key:"onControlClick",value:function(e){e.stopPropagation(),this.props.onClick&&this.props.onClick(),this.setState({playing:!this.state.playing})}},{key:"onBackgroundClick",value:function(e){e.stopPropagation(),this.props.handleClick&&this.props.handleClick(0,this.img)||(this.props.onClick&&this.props.onClick(),this.setState({playing:!this.state.playing}))}},{key:"onKeyDown",value:function(e){32===(e||window.event).keyCode&&(this.setState({playing:!this.state.playing}),e.preventDefault())}},{key:"imgLoaded",value:function(){this.setState({loaded:!0})}},{key:"renderGif",value:function(){var e=this,t=(0,a.default)({},this.props);return delete t.animSrc,delete t.image,delete t.handleClick,delete t.onClick,this.state.playing||this.preLoaded||window.setTimeout(function(){(new Image).src=e.props.animSrc,e.preLoaded=!0},1),c.default.createElement("div",{className:"ka_gif_container",draggable:!1,tabIndex:0,onKeyDown:this.onKeyDown,onClick:this.onBackgroundClick},c.default.createElement("img",(0,i.default)({},t,{src:this.state.playing?this.props.animSrc:this.props.src,draggable:!1,ref:function(t){return e.img=t}})),this.state.loaded?c.default.createElement(d.Fragment,null,this.state.playing?c.default.createElement("img",{className:"ka_gif_play playing",src:m.imgRoot+"GIF_Pause.png",onClick:this.onControlClick,draggable:!1}):c.default.createElement("img",{className:"ka_gif_play paused",src:m.imgRoot+"GIF_Play.png",onClick:this.onControlClick,draggable:!1}),this.state.playing?null:c.default.createElement("div",{className:"ka_gif_label",draggable:!1},"GIF")):null)}},{key:"render",value:function(){var e=this.props.image?this.props.image.mediaID:this.props.src.split("id=")[1].split("&")[0];return c.default.createElement(d.Fragment,null,c.default.createElement(p.ContextMenuTrigger,{id:e,style:{display:"inline-block"},draggable:!1},this.renderGif()),c.default.createElement(p.ContextMenu,{id:e,className:"gifMenu"},c.default.createElement(p.MenuItem,{data:{url:this.props.animSrc,filename:this.props.image?this.props.image.originalFilename:e+".gif"},onClick:v},"Download GIF")))}}]),t}(d.Component),v=function(e,t){e.stopPropagation();var n=document.createElement("a");n.href=t.url,n.download=t.filename,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)};t.default=g},286:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(181)),a=c(n(182)),o=c(n(183)),r=c(n(184)),s=c(n(185)),l=n(177),u=c(l),d=c(n(180));c(n(190));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.mouseOver=!1,n.windowBlurListener=n.windowBlurListener.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.props.onClick&&window.addEventListener("blur",this.windowBlurListener,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("blur",this.windowBlurListener,!1)}},{key:"windowBlurListener",value:function(){this.mouseOver&&this.props.onClick()}},{key:"render",value:function(){var e=this,t=this.props,n=t.body,i=t.isSelected,a=t.isInEditor;return u.default.createElement("div",{className:"ka_oEmbedOutterBox"},u.default.createElement("div",{className:"ka_oEmbedBox ka_subitem"+(i?" selected":""),spellCheck:!1},u.default.createElement("div",{className:"video_wrapper",dangerouslySetInnerHTML:{__html:n},onMouseOver:function(){return e.mouseOver=!0},onMouseOut:function(){return e.mouseOver=!1}}),a&&u.default.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",top:0}})))}}]),t}(l.Component);f.propTypes={body:d.default.string.isRequired,onClick:d.default.func,isSelected:d.default.bool,isInEditor:d.default.bool},t.default=f},287:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(177)),a=l(n(180)),o=n(179),r=l(o),s=n(209);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t=e.link,n=e.isSelected,a=e.onClick,l=e.selectedImageIndex,u=void 0===l?0:l,f=e.onImageChange,m=e.isInEditor,p=void 0!==m&&m,h=t.isSharepoint?null:"_blank",g=document.createElement("div"),v=t.body||"";v=r.default.htmlToText(v),v=r.default.ellipsizeTextAt(v,s.INT_WEBPAGE_BODY_CHARS,!0);return i.default.createElement("a",{className:"ka_streamWebpage ka_subitem"+(n?" selected":""),href:p?void 0:t.url,onClick:a,target:h,spellCheck:!1},t.showEmbedLogo&&window.embedLogoID&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg embedLogo"},i.default.createElement("img",{src:r.default.getImageURL(null,window.embedLogoID,225,1125,!1)})),(!t.showEmbedLogo||!t.showEmbedLogo||!window.embedLogoID)&&t.subItemImageID&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg"+(d(t.subItemImageID)?" embedLogo":"")},i.default.createElement("img",{src:r.default.getImageURL(null,t.subItemImageID,225,1125,!1)})),(!t.showEmbedLogo||!t.showEmbedLogo||!window.embedLogoID)&&t.previewImageOriginalURL&&!t.subItemImageID&&!t.images&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg"+(d(c(t.previewImageOriginalURL))?" embedLogo":"")},i.default.createElement("img",{src:t.previewImageOriginalURL})),t.images&&t.images.length>0&&-1!==u&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg"+(t.images[u].isSPLogo?" embedLogo":"")},t.images.map(function(e,t){return i.default.createElement("div",{className:t!==u?"queued":void 0,key:t},i.default.createElement("img",{src:e.src}))})),i.default.createElement("div",{className:"ka_column ka_streamWebpageText"},i.default.createElement("span",{className:"ka_streamSubItemTitle"},r.default.decodeHTMLEntities(t.title,g)),v&&i.default.createElement("div",{className:"ka_steamSubItemBody",dangerouslySetInnerHTML:{__html:v}}),t.subtitle&&i.default.createElement("div",{className:"ka_streamSubItemSubtitle"},t.subtitle)),t.images&&t.images.length>0&&i.default.createElement("div",{className:"ka_linkImgPager"},i.default.createElement("img",{src:o.static_images.left_white_7,onClick:function(e){f(-1===u?t.images.length-1:u-1),r.default.stopBubble(e)}}),u>-1?u+1:t.images.length+1," of ",t.images.length+1,i.default.createElement("img",{src:o.static_images.right_white_7,onClick:function(e){f(u===t.images.length-1?-1:u+1),r.default.stopBubble(e)}})),p&&(!t.images||0===t.images.length)&&i.default.createElement("div",{className:"ka_linkImgPager",style:{padding:"6px 10px"}},"No Compatible Images Found"))},d=function(e){if(!e)return!1;var t,n=document.getElementById("ka_suiteBarLogo");return!!n&&(!!(t=c(n.src))&&t.toLowerCase()===e.toLowerCase())},c=function(e){return-1===e.indexOf("id=")||-1===e.indexOf("&size")?null:e.split("id=")[1].split("&size")[0]};u.propTypes={link:a.default.object.isRequired,isInEditor:a.default.bool,isSelected:a.default.bool,onClick:a.default.func,selectedImageIndex:a.default.number,onImageChange:a.default.func},t.default=u},288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),a=r(n(180)),o=r(n(179));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.document,n=t.title,a=t.originalFilename,r=t.sourceAssetURL,s=t.documentType,u=t.documentID,d=t.fromSharepoint,c=t.fileSize,f=t.progress,m=e.isSelected,p=e.onClick,h=void 0;return e.inEditor||(d&&r?h=r:u&&(h="/_layouts/15/documents/proxy.ashx?id="+u+"&name="+a)),i.default.createElement("a",{className:"ka_docBox ka_subitem"+(m?" selected":""),onClick:function(e){return l(e,p)},href:h,target:"_blank",spellCheck:!1},i.default.createElement("img",{src:o.default.getImageURL("Document",s,40)+"?r=0619170747"}),c&&i.default.createElement("div",{className:"ka_docSize",spellCheck:!1},(c/1048576).toFixed(1)," MB"),i.default.createElement("div",{className:"ka_streamSubItemTitle",spellCheck:!1},n||a),"number"==typeof f&&i.default.createElement("div",{className:"ka_docProg"},i.default.createElement("div",{style:{width:f+"%"}})))},l=function(e,t){t&&t(),o.default.stopBubble(e)};s.propTypes={document:a.default.object.isRequired},t.default=s},291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(181)),a=c(n(182)),o=c(n(183)),r=c(n(184)),s=c(n(185)),l=n(177),u=c(l),d=c(n(203));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={menuOpen:!1,shareOpen:!1},n.openMenu=n.openMenu.bind(n),n.closeMenu=n.closeMenu.bind(n),n.openShare=n.openShare.bind(n),n.closeShare=n.closeShare.bind(n),n.openTitleEditor=n.openTitleEditor.bind(n),n.openPosterEditor=n.openPosterEditor.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"openMenu",value:function(e){e.stopPropagation(),this.props.setPlayerHovered(!0),this.setState({menuOpen:!0})}},{key:"closeMenu",value:function(){this.props.setPlayerHovered(!1),this.setState({menuOpen:!1})}},{key:"openShare",value:function(){this.setState({menuOpen:!1}),this.props.openShareDialog()}},{key:"closeShare",value:function(){this.setState({shareOpen:!1}),this.props.setPlayerHovered(!1)}},{key:"openTitleEditor",value:function(){this.setState({menuOpen:!1}),this.props.openTitleEditor()}},{key:"openPosterEditor",value:function(){this.setState({menuOpen:!1}),this.props.openPosterEditor()}},{key:"render",value:function(){return u.default.createElement("div",{className:"ka-titleIcon ka-cog",onClick:function(e){return e.stopPropagation()}},u.default.createElement("span",{onClick:this.openMenu},""),u.default.createElement("div",{className:"ka_calloutMenu"},this.state.menuOpen&&u.default.createElement(d.default,{onClose:this.closeMenu},u.default.createElement("div",null,this.props.openShareDialog&&u.default.createElement("span",{onClick:this.openShare},"Share Video"),this.props.openTitleEditor&&u.default.createElement("span",{onClick:this.openTitleEditor},"Edit Title"),this.props.openPosterEditor&&u.default.createElement("span",{onClick:this.openPosterEditor},"Edit Thumbnail"),u.default.createElement("div",{className:"tri center"},u.default.createElement("div",null))))))}}]),t}(l.Component);t.default=f},292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(181)),a=m(n(182)),o=m(n(183)),r=m(n(184)),s=m(n(185)),l=n(177),u=m(l),d=n(205),c=m(n(228)),f=m(n(225));function m(e){return e&&e.__esModule?e:{default:e}}n(238);var p=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={timeRemaining:_(e.videoDuration,e.fileSize,e.progress,e.uploadedAt),beginningTranscodeEstimate:_(e.videoDuration,e.fileSize,0,null)},n.timer=null,n.startTimer=n.startTimer.bind(n),n.startTimer(),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"startTimer",value:function(){var e=this;this.timer=setInterval(function(){e.setState({timeRemaining:Math.max(e.state.timeRemaining-1,0)})},1e3)}},{key:"componentWillReceiveProps",value:function(e){e.videoDuration&&!this.props.videoDuration&&this.setState({timeRemaining:_(e.videoDuration,e.fileSize,e.progress,e.uploadedAt),beginningTranscodeEstimate:_(e.videoDuration,e.fileSize,0,null)})}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"stopTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"render",value:function(){return u.default.createElement(f.default,{title:(this.state.timeRemaining>0?"Processing":"Finishing")+"  Your Video...",backgroundClick:this.props.backgroundClick},this.state.timeRemaining>0?u.default.createElement(l.Fragment,null,"Estimated Time Remaining: ",u.default.createElement("b",null,(0,d.toHHMMSS)(this.state.timeRemaining)),u.default.createElement("i",{className:"ka_vidTrancode_body"},u.default.createElement("span",{className:"wikiProcessingMessage"},g,E),u.default.createElement("span",{className:"postProcessingMessage"},v,E),u.default.createElement("span",{className:"commentProcessingMessage"},y,E)),u.default.createElement("i",{className:"ka_vidTrancode_helpLink"},"Learn more in ",u.default.createElement("a",{href:h,target:"_blank"},"this article"),".")):u.default.createElement("div",{style:{textAlign:"center",paddingTop:10,marginBottom:25}},u.default.createElement(c.default,{style:{position:"static"}})))}}]),t}(l.Component);t.default=p;var h="https://knowledgearchitecture.zendesk.com/hc/en-us/articles/360015147992-Behind-the-Scenes-of-Synthesis-Native-Video-Uploads",g="Feel free to save your page while your video is processing. Your video will appear as soon as it is finished processing.",v="You can publish your post once your video is finished processing. In the meantime, feel free to save a draft of your post and return to it later.",y="You can post your comment once your video is finished processing. Your draft comment has been saved so you can return to it later.",E=" We’ll send you an e-mail when your video is finished.",_=function(e,t,n,i){if(t=t||0,e){var a=void 0;if(a=e<120&&t<7e7?50:.06*e+t/9e6+60,n>0?a*=1-.01*n:a=a,i)a-=((new Date).getTime()-i)/1e3;return a}return 90}},293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(177)),a=o(n(225));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.onEdit,n=(e.onClose,e.backgroundClick);return i.default.createElement(a.default,{title:"Edit Video Title + Thumbnail",backgroundClick:n},"Make your video more searchable and appealing by giving it a useful Title and Thumbnail.",i.default.createElement("div",{style:{margin:"0 0 20px",textAlign:"right"}},i.default.createElement("div",{className:"ka_button ka_buttonActive",style:{display:"inline-block"},spellCheck:!1,onClick:t},"Next")))}},294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(181)),a=y(n(182)),o=y(n(183)),r=y(n(184)),s=y(n(185)),l=n(177),u=y(l),d=y(n(187)),c=y(n(192)),f=y(n(205)),m=n(207),p=y(n(191)),h=n(188),g=n(179),v=y(g);function y(e){return e&&e.__esModule?e:{default:e}}n(216)(p.default);var E=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={title:e.title,updatingTitle:!1},n.getButtonText=n.getButtonText.bind(n),n.submitTitle=n.submitTitle.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=d.default.findDOMNode(this.input);e.focus(),e.value="",e.value=this.props.title}},{key:"submitTitle",value:function(){var e=this;if(this.props.title!==this.state.title){var t=this.state.title.trim();t&&(this.setState({updatingTitle:!0}),p.default.put((0,h.buildReqUrl)("/video/"+this.props.videoID+"/title")).authBearer(v.default.getToken()).type("json").send('"'+t+'"').then(function(n){e.props.onTitleUpdated(t)}).catch(function(t){v.default.receivedAPIError(t),e.setState({updatingTitle:!1})}))}else this.props.setupMode?this.props.onTitleUpdated(this.props.title):this.props.onClose()}},{key:"getButtonText",value:function(){return this.state.saving?"Saving...":this.props.setupMode?"Next":"Save"}},{key:"render",value:function(){var e=this;return u.default.createElement(c.default,{title:"Edit Video Title",fixedSize:!1,onClose:this.props.onClose,onKeyDown:function(e){return e.stopPropagation()},disableOverlayClick:!0},u.default.createElement("div",{className:"kamodal-subtitle"},"Preview"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("div",{className:"video-js ka-video-mockPlayer vjs-big-play-centered",style:{width:m.DEF_VIDEO_WIDTH,height:m.DEF_VIDEO_HEIGHT}},u.default.createElement("img",{className:"poster",src:apiUrl+"/video/"+this.props.videoID+"/blob"+this.props.poster}),u.default.createElement("div",{className:"ka-titleBar"},u.default.createElement("span",{className:"ka-title"},this.state.title)),u.default.createElement("button",{className:"vjs-big-play-button","aria-disabled":"true"},u.default.createElement("span",{"aria-hidden":"true",className:"vjs-icon-placeholder"})),u.default.createElement("div",{className:"ka-footerBar"},u.default.createElement(f.default,{duration:this.props.duration})))),u.default.createElement("div",{className:"kamodal-subtitle"},"Title"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{className:"videoTitleInput",ref:function(t){return e.input=t},value:this.state.title,onChange:function(t){e.setState({title:t.target.value})}})),u.default.createElement("div",{className:"kamodal-block"},!this.state.title.trim()&&u.default.createElement("div",{style:{color:"#FF4947",display:"inline-block",marginTop:19}},u.default.createElement("img",{src:g.imgRoot+"Yield_25_Red.png",style:{verticalAlign:"middle"}})," Your video must have a title."),u.default.createElement("div",{className:"ka_button ka_buttonActive"+(this.state.updatingTitle||!this.state.title.trim()?" disabled":""),style:{display:"inline-block",float:"right",marginTop:15},onClick:this.state.updatingTitle?void 0:this.submitTitle,disabled:this.state.updatingTitle},this.getButtonText())))}}]),t}(l.Component);t.default=E},295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=S(n(181)),a=S(n(182)),o=S(n(183)),r=S(n(184)),s=S(n(185)),l=n(177),u=S(l),d=S(n(187)),c=S(n(192)),f=S(n(205)),m=n(207),p=S(n(191)),h=n(188),g=n(179),v=S(g),y=S(n(236)),E=S(n(296)),_=n(239),k=S(n(204)),I=n(189);function S(e){return e&&e.__esModule?e:{default:e}}n(216)(p.default);var T=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={uploadStarted:!1,uploadProgress:0,stills:[],previewImageFilename:e.previewImageFilename},n.chooseThumbFromPC=n.chooseThumbFromPC.bind(n),n.thumbChosenFromPC=n.thumbChosenFromPC.bind(n),n.chooseThumbFromStill=n.chooseThumbFromStill.bind(n),n.chooseThumbFromVideo=n.chooseThumbFromVideo.bind(n),n.saveClicked=n.saveClicked.bind(n),n.getPoster=n.getPoster.bind(n),n.getPosterStyle=n.getPosterStyle.bind(n),n.thumbChosenFromStill=n.thumbChosenFromStill.bind(n),n.thumbHovered=n.thumbHovered.bind(n),n.thumbUnhovered=n.thumbUnhovered.bind(n),n.getButtonText=n.getButtonText.bind(n),n.renderVideo=n.renderVideo.bind(n),n.renderStill=n.renderStill.bind(n),n.resizeStillsContainer=n.resizeStillsContainer.bind(n),n.resizeStillContainer_timer=n.resizeStillContainer_timer.bind(n),n.getStills=n.getStills.bind(n),n.getStills(),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeStillContainer_timer,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeStillContainer_timer,!1)}},{key:"getStills",value:function(){var e=this;p.default.get(apiUrl+"/video/"+this.props.videoID+"/blob/thumbs.json").withCredentials().then(function(t){var n=t.body.thumbnails;n.length>100&&(n=v.default.pickFrom(n,100)),n=(n=t.body.savedThumbnails.concat(n)).filter(function(e,t){return n.indexOf(e)===t}),e.setState({stills:n})}).catch(function(e){return(0,I.logError)(e)})}},{key:"chooseThumbFromPC",value:function(){this.setState({activeCategory:"computer"});var e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=this.thumbChosenFromPC,e.style.display="none",v.default.isIE()&&d.default.findDOMNode(this.ieBlows).appendChild(e),e.click()}},{key:"thumbChosenFromPC",value:function(e){var t=this;"image/gif"===e.target.files[0].type.toLowerCase()?alert("GIF is not an accepted format at this time."):-1===e.target.files[0].type.toLowerCase().indexOf("image/")?alert("Oops! You selected "+e.target.files[0].name+" but we need an image."):(this.setState({newPosterUrl:URL.createObjectURL(e.target.files[0]),uploadStarted:!0}),p.default.post((0,h.buildReqUrl)("/video/"+this.props.videoID+"/previewimage")).authBearer(v.default.getToken()).attach("itsafile",e.target.files[0],e.target.files[0].name).on("progress",function(e){return t.setState({uploadProgress:e.percent})}).then(function(e){t.setState({uploadStarted:!1,previewImageFilename:e.body.results[0]})}).catch(function(e){v.default.receivedAPIError(e),t.setState({uploadStarted:!1}),alert("Thumbnail failed to save. Please try again.")}))}},{key:"chooseThumbFromStill",value:function(){this.setState({activeCategory:"stills"}),window.setTimeout(this.resizeStillsContainer,0)}},{key:"chooseThumbFromVideo",value:function(){this.setState({activeCategory:"video"})}},{key:"saveClicked",value:function(){var e=this;if(!this.state.uploadStarted)if("stills"==this.state.activeCategory&&this.state.previewImageFilename)this.setState({saving:!0}),p.default.put(apiUrl+"/video/"+this.props.videoID+"/previewfilename").withCredentials().type("json").send('"'+this.state.previewImageFilename+'"').then(function(t){e.props.posterUpdated(e.state.newPosterUrl,e.state.previewImageFilename)}).catch(function(t){(0,I.logError)(t),e.setState({saving:!1}),alert("Thumbnail failed to save. Please try again.")});else if("computer"===this.state.activeCategory&&this.state.newPosterUrl)this.props.posterUpdated(this.state.newPosterUrl,this.state.previewImageFilename);else if("video"===this.state.activeCategory)if(this.kavideo.player.pause(),this.setState({saving:!0}),k.default.msie||k.default.safari)this.props.setPreviewAtTimeUsingAPI(this.kavideo.player.currentTime());else{var t=this.kavideo.player.el().querySelector("video");(0,_.getPreviewImageBlob)(t,function(t){var n=e.kavideo.player.currentTime()+".png";p.default.post((0,h.buildReqUrl)("/video/"+e.props.videoID+"/previewimage")).query({seconds:e.kavideo.player.currentTime()}).authBearer(v.default.getToken()).attach("itsablob",t,n).on("progress",function(t){return e.setState({uploadProgress:t.percent})}).then(function(i){e.props.posterUpdated(URL.createObjectURL(t),n)}).catch(function(t){v.default.receivedAPIError(t),e.setState({uploadStarted:!1}),alert("Thumbnail failed to save. Please try again.")})})}else this.props.onClose()}},{key:"getPoster",value:function(){return this.state.tempPosterUrl?this.state.tempPosterUrl:this.state.newPosterUrl?this.state.newPosterUrl:apiUrl+"/video/"+this.props.videoID+"/blob"+this.state.previewImageFilename}},{key:"getPosterStyle",value:function(e){return e.indexOf("/tinythumbs/")>-1||e.indexOf("/posters/")>-1?{height:"100%"}:void 0}},{key:"resizeStillsContainer",value:function(){var e=0,t=d.default.findDOMNode(this.modal).querySelector(".kamodal-container");t.childNodes.forEach(function(t){return e+=v.default.outterHeight(t)}),e-=v.default.outterHeight(t.querySelector(".kavideo-stillsContainer"));var n=.9*window.innerHeight-e,i=69*Math.floor(n/69)+27.6;i>n&&i--;var a=Math.min(345,i),o=69*Math.ceil(this.state.stills.length/5),r=Math.max(96.6,Math.min(a,o));this.setState({stillContHeight:r})}},{key:"resizeStillContainer_timer",value:function(){var e=this;"stills"===this.state.activeCategory&&(this.resizeTimer||(this.resizeTimer=window.setTimeout(function(){e.resizeTimer=null,e.resizeStillsContainer()},250)))}},{key:"thumbChosenFromStill",value:function(e){var t=void 0;t=e.length>12&&"/tinythumbs/"===e.substring(0,12)?"/posters/"+e.substring(12):e;var n=apiUrl+"/video/"+this.props.videoID+"/blob"+t;this.setState({newPosterUrl:n,previewImageFilename:t,tempPosterUrl:null})}},{key:"thumbHovered",value:function(e,t){var n=this;if(this.setState({tempPosterUrl:apiUrl+"/video/"+this.props.videoID+"/blob"+e}),e.length>12&&"/tinythumbs/"===e.substring(0,12)){var i="/posters/"+e.substring(12);window.setTimeout(function(){return n.setState({tempPosterUrl:apiUrl+"/video/"+n.props.videoID+"/blob"+i})},0)}}},{key:"thumbUnhovered",value:function(){this.setState({tempPosterUrl:null})}},{key:"getButtonText",value:function(){return this.state.saving?"Saving...":this.state.uploadStarted?"Uploading...":"Save"}},{key:"renderVideo",value:function(){var e=this,t=m.DEF_VIDEO_WIDTH,n=t/this.props.playerAspectRatio;if("video"===this.state.activeCategory)return u.default.createElement(y.default,{videoID:this.props.videoID,videoMeta:this.state.videoMeta,openToBeginning:!0,width:t,height:n,hideCog:!0,disableSizing:!0,disableThumbnails:!0,ref:function(t){return e.kavideo=t}});var i=this.getPoster();return u.default.createElement("div",{className:"video-js ka-video-mockPlayer vjs-big-play-centered",style:{width:t,height:n},ref:function(t){return e.mockPlayer=t}},u.default.createElement("img",{className:"poster",src:i,style:this.getPosterStyle(i)}),u.default.createElement("div",{className:"ka-titleBar"},u.default.createElement("span",{className:"ka-title"},this.props.title)),u.default.createElement("button",{className:"vjs-big-play-button","aria-disabled":"true"},u.default.createElement("span",{"aria-hidden":"true",className:"vjs-icon-placeholder"})),u.default.createElement("div",{className:"ka-footerBar"},u.default.createElement(f.default,{duration:this.props.duration})))}},{key:"renderStill",value:function(e,t){var n=this;return t>0||this.state.stillHeight?u.default.createElement("img",{src:apiUrl+"/video/"+this.props.videoID+"/blob"+e}):u.default.createElement("img",{src:apiUrl+"/video/"+this.props.videoID+"/blob"+e,ref:function(e){return n.firstStill=e},onLoad:this.resizeStillsContainer})}},{key:"render",value:function(){var e=this;return u.default.createElement(c.default,{title:"Edit Video Thumbnail",onClose:this.props.onClose,fixedSize:!1,disableOverlayClick:!0,ref:function(t){return e.modal=t}},u.default.createElement("div",{className:"kamodal-subtitle"},"Preview"),u.default.createElement("div",{className:"kamodal-block"},this.renderVideo()),this.state.uploadStarted&&u.default.createElement("div",{style:{height:0,position:"relative"}},u.default.createElement("div",{className:"ka_imgUploadProgress",style:{position:"absolute"}},u.default.createElement("div",{style:{width:this.state.uploadProgress+"%"}}))),u.default.createElement("div",{className:"kamodal-subtitle"},"Select a new Thumbnail Image"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("span",{className:"kavideo-editThumbCategory"+("stills"===this.state.activeCategory?" active":""),onClick:this.chooseThumbFromStill},u.default.createElement("img",{src:g.static_images.image,className:"unhover",style:{width:25,height:25}}),u.default.createElement("img",{src:g.static_images.image_cyan,className:"hover",style:{width:25,height:25}}),"Select from stills."),u.default.createElement("span",{className:"kavideo-editThumbCategory"+("video"===this.state.activeCategory?" active":""),onClick:this.chooseThumbFromVideo},u.default.createElement("img",{src:g.static_images.play_grey_18,className:"unhover"}),u.default.createElement("img",{src:g.static_images.play_cyan_18,className:"hover"}),"Select from video."),u.default.createElement("span",{className:"kavideo-editThumbCategory"+("computer"===this.state.activeCategory?" active":""),onClick:this.chooseThumbFromPC},u.default.createElement("img",{src:g.static_images.upload_16,className:"unhover"}),u.default.createElement("img",{src:g.static_images.upload_16_cyan,className:"hover"}),"Upload from computer.")),"stills"===this.state.activeCategory&&u.default.createElement("div",{className:"kamodal-block"},u.default.createElement(E.default,{className:"kavideo-stillsContainer",style:{height:this.state.stillContHeight}},!this.state.stills.length>0&&u.default.createElement("img",{src:"/_layouts/15/Updates/images/Ajax-loader.gif",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:32,height:32,margin:0}}),this.state.stills.map(function(t,n){return u.default.createElement("div",{onClick:function(){return e.thumbChosenFromStill(t)},onMouseEnter:function(n){return e.thumbHovered(t,n.target)},onMouseLeave:e.thumbUnhovered,className:"still"+(b(e.state.previewImageFilename,t)?" active":""),key:n},u.default.createElement("div",null,e.renderStill(t,n)))}))),u.default.createElement("div",{className:"kamodal-block",style:{overflow:"hidden"}},u.default.createElement("div",{className:"ka_button ka_buttonActive"+(this.state.uploadStarted?" disabled":""),style:{display:"inline-block",float:"right",marginTop:15},onClick:this.saveClicked},this.getButtonText())),u.default.createElement("div",{ref:function(t){return e.ieBlows=t}}))}}]),t}(l.Component);t.default=T;var b=function(e,t){if(e)if(t.length>12&&"/tinythumbs/"===t.substring(0,12)){if(t.substring(12)===e.substring(9))return!0}else if(e===t)return!0;return!1}},296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(206)),a=m(n(181)),o=m(n(182)),r=m(n(183)),s=m(n(184)),l=m(n(185)),u=n(177),d=m(u),c=m(n(187)),f=m(n(500));function m(e){return e&&e.__esModule?e:{default:e}}n(501);var p=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){f.default.initEl(c.default.findDOMNode(this.box))}},{key:"render",value:function(){var e=this;return d.default.createElement("div",(0,i.default)({},this.props,{ref:function(t){return e.box=t}}))}}]),t}(u.Component);t.default=p},306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(234),o=(i=a)&&i.__esModule?i:{default:i};t.default=function(e){var t,n,i,a,u,d,c,f,m,p={width:0,height:0,basePath:e.basePath||""};n=function e(){var t,n,i,a,r;t=Array.prototype.slice.call(arguments);n=t.shift()||{};for(i in t)for(r in a=t[i])a.hasOwnProperty(r)&&("object"===(0,o.default)(a[r])?n[r]=e(n[r],a[r]):n[r]=a[r]);return n}({},p,e);var h=(a=this).textTracks().length;if(0===h)return;m=0;for(;m<h;){var g=a.textTracks()[m];if("metadata"===g.kind&&"thumbnails"===g.label){(f=a.textTracks()[m]).mode="hidden";break}m++}var v=a.controlBar.progressControl;if(-1!==navigator.userAgent.toLowerCase().indexOf("android")){var y=function(){return v.removeClass("fake-active")};v.on("touchstart",function(){return v.addClass("fake-active")}),v.on("touchend",y),v.on("touchcancel",y)}(t=document.createElement("div")).className="vjs-thumbnail-holder";var E=document.createElement("div");E.className="ka-thumbnail-holderInner",t.appendChild(E),(i=document.createElement("img")).className="vjs-thumbnail",E.appendChild(i);var _=document.createElement("div");_.className="ka-video-scrubTime",E.appendChild(_),u=a.duration(),a.on("durationchange",function(e){return u=a.duration()}),a.on("loadedmetadata",function(e){return u=a.duration()}),v.el().appendChild(t),d=function(e){var a,o,d,c,h,g,y,k,I;k=(window.pageXOffset?{x:window.pageXOffset,y:window.pageYOffset}:{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}).x,I=s(v.el()).getBoundingClientRect(),h=(I.width||I.right)+k,c=e.pageX,e.changedTouches&&(c=e.changedTouches[0].pageX),o=c||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o-=s(v.el()).getBoundingClientRect().left+k,a=Math.floor((o-v.el().offsetLeft)/v.width()*u),_.innerHTML=(0,r.toHHMMSS)(a);var S=f&&f.cues.length;for(m=0;m<S;){var T=f.cues[m];if(T.startTime<=a&&T.endTime>=a){d=l(T.text,p.basePath);break}m++}if(void 0!==d){d.src&&i.src!=d.src&&(i.src=d.src),0===d.w&&(d.w=n.width),0===d.h&&(d.h=n.height),g=d.w-d.x;var b=d.h-d.y+15;E.style.width==g&&E.style.height==d.h+15||(E.style.height=b+"px"),i.style.left=200==g?-d.x+"px":-d.x+(200-g)/2+"px",i.style.top=-d.y+"px",i.style.clip="rect("+d.y+"px,"+d.w+"px,"+d.h+"px,"+d.x+"px)",g=t.offsetWidth,o+(y=g/2)>h?o=h-g:o<y?o=0:o-=y,t.style.left=o+"px"}},v.on("mousemove",d),v.on("touchmove",d),c=function(e){return t.style.left="-10000px"},v.on("mouseleave",c),v.on("touchcancel",c),v.on("touchend",c),a.on("userinactive",c)};var r=n(205);function s(e){return"HTML"!==e.nodeName&&"static"===function(e,t){return function(n){return window.getComputedStyle?window.getComputedStyle(e,t)[n]:e.currentStyle[n]}}(e)("position")?s(e.offsetParent):e}function l(e,t){var n,i,a;if(-1===(i=e.indexOf("#")))return{src:t+e,w:0,h:0,x:0,y:0};if(n=e.substring(0,i),"xywh="!==(a=e.substring(i+1)).substring(0,5))return{src:defaults.basePath+n,w:0,h:0,x:0,y:0};var o=a.substring(5).split(",");return{src:t+n,w:parseInt(o[2]),h:parseInt(o[3]),x:parseInt(o[0]),y:parseInt(o[1])}}},307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(177),o=(i=a)&&i.__esModule?i:{default:i},r=n(207);t.default=function(e){return o.default.createElement("div",{className:"ka_hangTight",style:{width:e.width?parseInt(e.width):r.DEF_VIDEO_WIDTH,height:(e.width?parseInt(e.width):r.DEF_VIDEO_WIDTH)/(16/9)}},o.default.createElement("div",null,o.default.createElement("div",{style:{fontSize:32}},"Hang tight..."),o.default.createElement("div",{style:{fontSize:24,marginTop:50}},"This video will be available shortly.")))}},308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),a=r(n(225)),o=r(n(228));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.backgroundClick;return i.default.createElement(a.default,{title:"Saving Your Thumbnail",backgroundClick:t},"This should take less than a minute.",i.default.createElement("div",{style:{textAlign:"center",paddingTop:15,marginBottom:25}},i.default.createElement(o.default,{style:{position:"static"}})))}},309:function(e,t,n){},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e){e.exports={"A network error caused the media download to fail part-way.":"e1","The media could not be loaded, either because the server or network failed or because the format is not supported.":"e2","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"e3","No compatible source was found for this media.":"e4","The media playback was aborted because too many consecutive download errors occurred.":"e5","You aborted the media playback":"e6"}},314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(206)),a=s(n(186)),o=s(n(177)),r=s(n(180));function s(e){return e&&e.__esModule?e:{default:e}}if(null==l)var l=n(179).static_images;var u=function(e){var t=e.likeStatus,n=(0,a.default)({},e);return delete n.likeStatus,o.default.createElement("img",(0,i.default)({},n,{className:"ka_likeIcon "+(t?"on":"off"),src:t?l.like_on_20:l.like_off_20,style:{width:20,height:20}}))};u.propTypes={likeStatus:r.default.bool},t.default=u},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOCAL_LINK_SCHEME="ka-file://"},326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MIME_VIDEO="video/*,video/mp4,video/x-m4v,video/webm"},327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=v(n(552)),a=v(n(206)),o=v(n(186)),r=v(n(181)),s=v(n(182)),l=v(n(183)),u=v(n(184)),d=v(n(185)),c=n(177),f=v(c),m=v(n(187)),p=v(n(180)),h=v(n(179)),g=v(n(190));n(220);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.state={selectedSuggestion:0,sugArray:k(e.suggestions,e.mentions,e.hashtags)},n.onUpArrow=n.onUpArrow.bind(n),n.onDownArrow=n.onDownArrow.bind(n),n.renderSuggestions=n.renderSuggestions.bind(n),n.renderSearchingFor=n.renderSearchingFor.bind(n),n.sugPosMover=n.sugPosMover.bind(n),n}return(0,d.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=(0,o.default)({},this.props);return delete e.searchingFor,delete e.suggestions,delete e.mentions,delete e.hashtags,delete e.onAddTag,delete e.clearSearch,delete e.suggestionsFor,delete e.usesInputBox,f.default.createElement("div",(0,a.default)({},e,{style:(0,o.default)({},this.props.style,{position:"relative"})}),this.props.children,this.renderSearchingFor(),this.renderSuggestions())}},{key:"componentWillReceiveProps",value:function(e){(0,i.default)(this.props.suggestions)!==(0,i.default)(e.suggestions)&&this.setState({selectedSuggestion:0,sugArray:k(e.suggestions,e.mentions,e.hashtags)}),e.suggestionsFor&&this.props.suggestionsFor!==e.suggestionsFor&&this.setState({sugPos:E(e.suggestionsFor,e.usesInputBox,m.default.findDOMNode(this))})}},{key:"sugPosMover",value:function(){this.props.searchingFor?this.setState({sugPos:E(this.props.searchingFor,this.props.usesInputBox,m.default.findDOMNode(this))}):this.state.sugArray&&this.props.suggestionsFor&&this.setState({sugPos:E(this.props.suggestionsFor,this.props.usesInputBox,m.default.findDOMNode(this))})}},{key:"componentDidMount",value:function(){this.props.usesInputBox||m.default.findDOMNode(this).children[0].addEventListener("scroll",this.sugPosMover,!1)}},{key:"componentWillUnmount",value:function(){this.props.usesInputBox||m.default.findDOMNode(this).children[0].removeEventListener("scroll",this.sugPosMover,!1)}},{key:"onUpArrow",value:function(e){this.state.sugArray&&(e.preventDefault(),this.state.selectedSuggestion>0&&this.setState({selectedSuggestion:this.state.selectedSuggestion-1}))}},{key:"onDownArrow",value:function(e){this.state.sugArray&&(e.preventDefault(),this.state.sugArray.length>this.state.selectedSuggestion+1&&this.setState({selectedSuggestion:this.state.selectedSuggestion+1}))}},{key:"onEscape",value:function(e){this.state.sugArray&&(e.preventDefault(),this.props.clearSearch())}},{key:"onTab",value:function(e){return this.state.sugArray?(e.preventDefault(),S(this.props.clearSearch,this.props.onAddTag,this.state.sugArray[this.state.selectedSuggestion]),"handled"):"not-handled"}},{key:"handleReturn",value:function(e){return this.state.sugArray?(S(this.props.clearSearch,this.props.onAddTag,this.state.sugArray[this.state.selectedSuggestion]),"handled"):"not-handled"}},{key:"renderSuggestions",value:function(){var e=this.state,t=e.sugArray,n=e.selectedSuggestion,i=this.props,a=i.onAddTag,o=i.clearSearch;i.suggestionsFor,i.usesInputBox;if(t)return f.default.createElement("div",{key:"suggestions",className:"ka_tagSuggestionBox",style:this.state.sugPos},t.map(function(e,t){return I(e,n===t,a,o,t)}))}},{key:"renderSearchingFor",value:function(){if(this.props.searchingFor)return f.default.createElement("div",{key:"searchingFor",className:"ka_tagSuggestionBox",style:this.state.sugPos},'Searching for "',this.props.searchingFor,'"')}}]),t}(c.Component),E=function(e,t,n){if(t)return{top:document.activeElement.offsetTop+document.activeElement.clientHeight+5,left:document.activeElement.offsetLeft+5};var i=window.getSelection();if(0===i.rangeCount)return{top:-5e3,left:-5e3};var a=i.getRangeAt(0).cloneRange();a.setStart(i.anchorNode,Math.max(i.anchorOffset-e.length,0));var o=a.getBoundingClientRect(),r=n.getBoundingClientRect();return{top:o.bottom-r.top+5,left:o.left-r.left}},_=["Community","Employee","Company","Project","Contact","Opportunity","Hashtag"],k=function(e,t,n){if(!e)return null;var i=[];return _.forEach(function(a){e[a]&&e[a].results.filter(function(e){return!(t&&null!=t.find(function(t){return t.entityType===e.$type&&t.entityID==C(e)&&!t.deleted})||n&&null!=n.find(function(t){return t.hashtag==e.HashtagID&&!t.deleted}))}).forEach(function(e){return i.push(e)})}),0===i.length?null:i},I=function(e,t,n,i,a){return f.default.createElement("div",{className:(0,g.default)("ka_tagSuggestion",t?"hovered":null),onClick:function(t){S(i,n,e)},key:a},f.default.createElement("div",{style:{width:35,height:35}},f.default.createElement("img",{src:h.default.getImageURL(e.$type,e.PrimaryImageID,35,null,null,e.IsOpportunity),className:"Employee"===e.$type?"ka_circular":null})),f.default.createElement("div",{style:{padding:"0px 0px 0px 3px"}},f.default.createElement("span",{className:"ka_tagSuggestionTitle",dangerouslySetInnerHTML:{__html:T(e)}}),f.default.createElement("div",{className:"ka_tagSuggestionSubTitle",dangerouslySetInnerHTML:{__html:b(e)}})))},S=function(e,t,n){t(D(n)),e()},T=function(e){switch(e.$type){case"Employee":return e.FullName;case"Project":return e.MarketingName;case"Contact":return e.ContactName;case"Company":return e.CompanyName;case"Opportunity":return e.OpportunityName;case"Community":return e.CommunityName;case"Hashtag":return e.HashtagID;default:return e.$type}},b=function(e){switch(e.$type){case"Employee":return e.Title;case"Project":return e.ClientName;case"Contact":return e.CompanyName;case"Company":return e.PrimaryDiscipline;case"Opportunity":return e.ClientName;default:return null}},C=function(e){return e.EmployeeID||e.ProjectID||e.ContactID||e.CompanyID||e.OpportunityID||e.CommunityID||e.HashtagID},D=function(e){return"Hashtag"==e.$type?{hashtag:e.HashtagID,deleted:!1}:{entityType:e.$type,entityID:C(e),entityName:T(e),deleted:!1,hasProfile:!0,isOpportunity:e.IsOpportunity}};y.propTypes={searchingFor:p.default.string,suggestionsFor:p.default.string,suggestions:p.default.object,mentions:p.default.array,hashtags:p.default.array,onAddTag:p.default.func.isRequired,clearSearch:p.default.func.isRequired,usesInputBox:p.default.bool},t.default=y},328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),a=f(n(182)),o=f(n(183)),r=f(n(184)),s=f(n(185)),l=n(177),u=f(l),d=n(220),c=n(223);function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={over:!1},n.dragEnter=n.dragEnter.bind(n),n.dragLeave=n.dragLeave.bind(n),n.dragOver=n.dragOver.bind(n),n.counter=0,n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"dragEnter",value:function(e){(window.draggingSubitem||(0,c.containsFiles)(e))&&(e.preventDefault(),this.counter++,this.setState({over:!0}))}},{key:"dragLeave",value:function(e){(window.draggingSubitem||(0,c.containsFiles)(e))&&(this.counter--,0===this.counter&&this.setState({over:!1}))}},{key:"dragOver",value:function(e){window.draggingSubitem&&e.preventDefault()}},{key:"render",value:function(){var e="ka_block";return this.state.over&&(e+=" over"),u.default.createElement("div",{className:e,onDragEnter:this.dragEnter,onDragLeave:this.dragLeave,onDrop:this.dragLeave,onDragOver:this.dragOver},this.props.children||u.default.createElement(d.EditorBlock,this.props))}}]),t}(l.Component);t.default=m},329:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),a=f(n(182)),o=f(n(183)),r=f(n(184)),s=f(n(185)),l=n(177),u=f(l),d=f(n(187)),c=f(n(179));function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.closeBannerListener=n.closeBannerListener.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"closeBannerListener",value:function(e){this.props.onClose&&this.props.onClose()}},{key:"componentWillMount",value:function(){c.default.dispatchEvent("Close_Banner",null)}},{key:"componentDidMount",value:function(){window.addEventListener("Close_Banner",this.closeBannerListener)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("Close_Banner",this.closeBannerListener)}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.children;return d.default.createPortal(u.default.createElement("div",{className:"ka_outageBannerContainer"+(t?"":" nondismissible")},u.default.createElement("div",{className:"ka_outageBanner"},n,t&&u.default.createElement("span",{onClick:function(e){e.stopPropagation(),t()}},"X"))),document.getElementById("titleAreaRow"))}}]),t}(l.Component);t.default=m},330:function(e,t,n){},472:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLOCK_TYPES=t.HEADER_TYPES=t.INLINE_STYLES=void 0;var i=_(n(235)),a=_(n(240)),o=_(n(206)),r=_(n(181)),s=_(n(182)),l=_(n(183)),u=_(n(184)),d=_(n(185)),c=n(177),f=_(c),m=_(n(187)),p=n(179),h=_(p),g=n(326),v=n(223),y=_(n(203)),E=_(n(550));function _(e){return e&&e.__esModule?e:{default:e}}var k=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.state={headersOpened:!1},n.menus=[],n.ATTACHMENT_TYPES=n.ATTACHMENT_TYPES.bind(n),n}return(0,d.default)(t,e),(0,l.default)(t,[{key:"onToggleHeaderStyle",value:function(e){this.setState({headersOpened:!1}),e!=this.props.editorState.getCurrentContent().getBlockForKey(this.props.editorState.getSelection().getStartKey()).getType()&&this.props.onToggleBlockType(e)}},{key:"componentDidUpdate",value:function(e,t){var n=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.menus=this.menus.filter(function(e){return null!=e&&null!=e.parentElement}),this.menus.forEach(function(e){e.getBoundingClientRect().bottom>n?e.className+=" inverted":e.className.indexOf("inverted")>-1&&e.parentElement.getBoundingClientRect().bottom+e.clientHeight+25<=n&&(e.className=e.className.replace(" inverted",""))})}},{key:"ATTACHMENT_TYPES",value:function(){return[{icon:"link",hoverIcon:"link_cyan",tooltip:"Link",shortcut:"K",clickHandlerProp:"onEditLink",iconWidth:16},{icon:"camera",hoverIcon:"camera_cyan",tooltip:"Add Images",iconWidth:24,fileHandlerProp:"onImageAttach",accept:"image/*",multiple:!0},{icon:"play",hoverIcon:"play_cyan",tooltip:"Add a Video",iconWidth:18,fileHandlerProp:"onVideoAttach",accept:g.MIME_VIDEO,multiple:!1},{icon:"paperclip",hoverIcon:"paperclip_cyan",tooltip:"Add Files",iconWidth:10,menuOptions:[{icon:"up_arrow",text:"Upload files from your computer",fileHandlerProp:"onDocumentAttach",multiple:!0},{icon:"sharepoint_gray",text:"Insert files from SharePoint",clickHandlerProp:"onBrowseSPDocuments"}]},{icon:"ellipsis",hoverIcon:"ellipsis_cyan",tooltip:"Other Post Options",iconWidth:14,disabled:!blogOptions.enableBlogging||this.props.disableBlogging,menuOptions:[{icon:"sharepoint_gray",text:"Use SharePoint to write a blog post.",onClick:v.createSPBlog,thenClose:!0,disabled:!blogOptions.enableSharePoint},{icon:"word_post_editor",text:"Use Word to write a blog post.",onClick:v.createWordBlog,thenClose:!0,disabled:!blogOptions.enableWord||!h.default.isIE()}]}]}},{key:"render",value:function(){var e=this,t=this.props.editorState.getCurrentInlineStyle(),n=this.props.editorState.getCurrentContent().getBlockForKey(this.props.editorState.getSelection().getStartKey()).getType(),r=S.find(function(e){return e.style===n})||S.find(function(e){return"unstyled"===e.style});return f.default.createElement("div",{className:"KAEditor-controls"},I.map(function(n){return f.default.createElement(E.default,(0,o.default)({key:n.style,active:t.has(n.style)},n,{onToggle:e.props.onToggleInlineStyle,disabled:e.props.readOnly}))}),f.default.createElement("div",{className:"KAEditor-control"},f.default.createElement("span",{className:"KAEditor-styleButton KAEditor-headerButton"+(this.props.readOnly?" disabled":""),onClick:this.props.readOnly?void 0:function(){return e.setState({headersOpened:!e.state.headersOpened})}},r.label),this.state.headersOpened&&f.default.createElement(y.default,{onClose:function(){return e.setState({headersOpened:!1})}},f.default.createElement("div",{className:"KAEditor-menuOptions",ref:function(t){-1===e.menus.indexOf(t)&&e.menus.push(t)}},S.map(function(t){return f.default.createElement("div",{className:"KAEditor-menuOption",onClick:function(){e.props.onToggleBlockType(t.style),e.setState({headersOpened:!1})},key:t.style},f.default.createElement(t.element,null,t.label))}),f.default.createElement("div",{className:"KAEditor-tri"},f.default.createElement("div",null))))),T.map(function(t){return f.default.createElement(E.default,(0,o.default)({key:t.style,active:t.style===n,label:t.label},t,{disabled:e.props.readOnly,onToggle:e.props.onToggleBlockType}))}),!this.props.hideAttachmentControls&&this.ATTACHMENT_TYPES().filter(function(e){return!e.disabled}).map(function(t){var n=t.shortcut?h.default.forOS(" (Ctrl+"+t.shortcut+")"," (⌘"+t.shortcut+")",""):"";return f.default.createElement("span",{className:"KAEditor-control",key:t.icon,title:t.tooltip+n,onMouseEnter:e.props.readOnly?void 0:function(n){return e.setState((0,a.default)({},t.icon+"Hover",!0))},onMouseLeave:e.props.readOnly?void 0:function(n){return e.setState((0,a.default)({},t.icon+"Hover",!1))},onClick:e.props.readOnly?void 0:t.fileHandlerProp?function(){return e[t.icon+"_input"].click()}:e.props[t.clickHandlerProp]||function(n){return e.setState((0,a.default)({},t.icon+"Open",!e.state[t.icon+"Open"]))}},f.default.createElement("img",{src:""+p.imgRoot+t.icon+(e.state[t.icon+"Hover"]?"_cyan":"")+".svg",className:"ka_shareTools"}),t.fileHandlerProp&&e.props[t.fileHandlerProp]&&f.default.createElement("input",{type:"file",ref:function(n){return e[t.icon+"_input"]=n},accept:t.accept,multiple:t.multiple,style:{display:"none"},onClick:function(){var n=m.default.findDOMNode(e[t.icon+"_input"]);n.type="",n.type="file"},onChange:function(n){e.props[t.fileHandlerProp]((0,i.default)(n.target.files).map(function(e){return n.target.files[e]}))},title:t.tooltip+n||" "}),e.state[t.icon+"Open"]&&t.menuOptions&&f.default.createElement(y.default,{onClose:function(){e.setState((0,a.default)({},t.icon+"Hover",!1)),e.setState((0,a.default)({},t.icon+"Open",!1))}},f.default.createElement("div",{className:"KAEditor-menuOptions",style:t.menuPosition,title:"",ref:function(t){-1===e.menus.indexOf(t)&&e.menus.push(t)}},t.menuOptions.filter(function(e){return!e.disabled}).map(function(o){return f.default.createElement("div",{style:{position:"relative"},className:"KAEditor-menuOption",onClick:o.onClick||(o.clickHandlerProp?e.props[o.clickHandlerProp]:void 0)||(o.fileHandlerProp?function(t){t.stopPropagation(),e[o.icon+"_input"].click()}:void 0),onMouseUp:function(){e.setState((0,a.default)({},t.icon+"Hover",!1)),o.thenClose&&window.setTimeout(e.props.onClose,0)},key:o.icon},f.default.createElement("img",{src:""+p.imgRoot+o.icon+".svg"}),f.default.createElement("span",null,o.text),o.fileHandlerProp&&e.props[o.fileHandlerProp]&&f.default.createElement("input",{type:"file",ref:function(t){return e[o.icon+"_input"]=t},accept:o.accept,multiple:o.multiple,style:{display:"none"},onClick:function(t){var n=m.default.findDOMNode(e[o.icon+"_input"]);n.type="",n.type="file"},onChange:function(n){e.props[o.fileHandlerProp]((0,i.default)(n.target.files).map(function(e){return n.target.files[e]})),e.setState((0,a.default)({},t.icon+"Open",!1)),e.setState((0,a.default)({},t.icon+"Hover",!1))},title:t.tooltip+n||" "}))}),f.default.createElement("div",{className:"KAEditor-tri"},f.default.createElement("div",null)))))}))}}]),t}(c.Component);t.default=k;var I=t.INLINE_STYLES=[{icon:"bold",style:"BOLD",tooltip:"Bold",shortcut:"B"},{icon:"italics",style:"ITALIC",tooltip:"Italic",shortcut:"I"}],S=t.HEADER_TYPES=[{label:"Heading 1",style:"header-one",element:"h1"},{label:"Heading 2",style:"header-two",element:"h2"},{label:"Normal",style:"unstyled",element:"div"}],T=t.BLOCK_TYPES=[{icon:"bullets",style:"unordered-list-item",tooltip:"Insert/Remove Bulleted List"},{icon:"outline",style:"ordered-list-item",tooltip:"Insert/Remove Numbered List"},{icon:"quote",style:"blockquote",tooltip:"Quote"}]},473:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),a=r(n(203)),o=n(325);function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.linkPeek,n=e.onEdit,r=e.onRemove,s=e.onClose;return i.default.createElement(a.default,{onClose:s},i.default.createElement("div",{className:"ka_linkPeeker"+(t?" active":""),style:t?t.position:void 0},i.default.createElement("a",{href:t?t.url:void 0,style:{cursor:"pointer"},target:t&&0===t.url.indexOf(o.LOCAL_LINK_SCHEME)?void 0:"_blank"},t?t.url.substring(0,35):""),t&&t.url.length>35&&i.default.createElement("span",{style:{color:"#555555"}},"…"),i.default.createElement("span",null," | "),i.default.createElement("span",{onClick:n,className:"button"},"Edit"),i.default.createElement("span",null," | "),i.default.createElement("span",{onClick:r,className:"button"},"Remove"),i.default.createElement("div",{className:"KAEditor-tri"},i.default.createElement("div",null))))}},474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(551),o=(i=a)&&i.__esModule?i:{default:i};t.default=o.default},475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),a=f(n(182)),o=f(n(183)),r=f(n(184)),s=f(n(185)),l=n(177),u=f(l),d=f(n(180)),c=f(n(192));function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={text:e.text||"",url:e.url||"",isEditing:null!=e.url},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){""!==this.state.text&&""===this.state.url?this.urlInput.focus():this.textInput.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,i=t.onCreate;return u.default.createElement(c.default,{onClose:n,title:(this.state.isEditing?"Edit this":"Add a")+" Text Link"},u.default.createElement("input",{ref:function(t){return e.textInput=t},type:"text",style:{width:400},value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})},placeholder:"Link Text"}),u.default.createElement("br",null),u.default.createElement("input",{ref:function(t){return e.urlInput=t},type:"text",style:{width:400,marginTop:15},value:this.state.url,onChange:function(t){return e.setState({url:t.target.value})},placeholder:"http://"}),u.default.createElement("br",null),u.default.createElement("div",{style:{textAlign:"right"}},u.default.createElement("input",{type:"button",className:"ka_button",style:{marginTop:15},value:this.state.isEditing?"Update":"Create Link",onClick:function(){""==e.state.text?alert("Enter the text to display in the link."):""==e.state.url.trim()?alert("Enter the url to open when the link is clicked."):i(e.state.text,p(e.state.url.trim()))}})))}}]),t}(l.Component),p=function(e){return-1===e.indexOf("://")&&"/"!==e[0]&&-1===e.toLowerCase().indexOf("mailto:")?"http://"+e:e};m.propTypes={onClose:d.default.func.isRequired,onCreate:d.default.func.isRequired},t.default=m},476:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dialogOption=void 0;var i=o(n(177)),a=o(n(192));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.title,n=e.message,o=e.onClose,r=e.optionArray;return i.default.createElement(a.default,{onClose:o,title:t,hideX:!0},n&&[i.default.createElement("span",{key:0},n),i.default.createElement("br",{key:1})],i.default.createElement("div",{style:{textAlign:"right",marginTop:15}},r.map(function(e,t){return i.default.createElement("input",{type:"button",className:"ka_button"+(e.disabled?" disabled":"")+(e.isRed?" red":""),value:e.title,key:t,disabled:e.disabled,onClick:function(){e.action(),o()}})})))};t.dialogOption=function(e,t,n,i){return{title:e,action:t,disabled:n||!1,isRed:i}}},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(186)),a=g(n(181)),o=g(n(182)),r=g(n(183)),s=g(n(184)),l=g(n(185)),u=n(177),d=g(u),c=g(n(180)),f=g(n(192)),m=g(n(191)),p=n(179),h=g(p);function g(e){return e&&e.__esModule?e:{default:e}}if(null==v)var v=n(179).static_images;var y=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={},n.fetchTreeData=n.fetchTreeData.bind(n),n.onNodeClick=n.onNodeClick.bind(n),n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.fetchTreeData()}},{key:"fetchTreeData",value:function(e){var t=this;m.default.get("/_layouts/15/ShareSomething/browseDocs.ashx").query(e).end(function(n,a){n||!a.ok||a.body.error?h.default.receivedAPIError(n||a.body.error||a.text):null==e?t.setState({tree:a.body}):t.setState({tree:t.state.tree.map(function(e){return _(e,(0,i.default)({},a.body,{expanding:!1,expanded:!0}))})})})}},{key:"onNodeClick",value:function(e,t){if(h.default.stopBubble(e),"File"===t.type)this.props.onChooseFile(E(t));else{var n=void 0;t.expanded?n=(0,i.default)({},t,{expanded:!1}):t.children?n=(0,i.default)({},t,{expanded:!0}):(n=(0,i.default)({},t,{expanding:!0}),this.fetchTreeData(t)),this.setState({tree:this.state.tree.map(function(e){return _(e,n)})})}}},{key:"render",value:function(){var e=this,t=this.props.onClose;return d.default.createElement(f.default,{onClose:t,title:"Insert files from SharePoint",style:{width:620,height:450}},this.state.tree&&this.state.tree.map(function(t){return k(t,e.onNodeClick)}))}}]),t}(u.Component),E=function(e){return{collectionType:"Document",collectionMembers:[{title:e.title,documentType:e.documentType||e.originalFilename.substring(e.originalFilename.lastIndexOf(".")+1),originalFilename:e.originalFilename,sourceAssetUrl:window.location.origin+e.sourceAssetUrl,memberType:"Document",fromSharepoint:!0}]}},_=function e(t,n){return t.type===n.type&&t.id===n.id?(0,i.default)({},t,n):t.children?(0,i.default)({},t,{children:t.children.map(function(t){return e(t,n)})}):t},k=function e(t,n){return d.default.createElement("div",{key:t.id,onClick:function(e){return n(e,t)}},d.default.createElement("div",{className:"ka_treeNode"+(t.inactive?" inactive":"")},function(e){return e.hideCaret||"File"===e.type?d.default.createElement("div",{className:"ka_treeControl"}):e.expanded?d.default.createElement("div",{className:"ka_treeControl"},d.default.createElement("img",{src:p.imgRoot+"caret.svg",style:{width:12}})):d.default.createElement("div",{className:"ka_treeControl"},d.default.createElement("img",{src:p.imgRoot+"caret_closed.svg",style:{width:6}}))}(t),d.default.createElement("img",{src:t.fileIcon||I(t.type),className:"ka_treeIcon"}),d.default.createElement("span",{title:t.title},t.title)),d.default.createElement("div",{className:"ka_treeChildren"},t.expanding&&e(S,function(e){return h.default.stopBubble(e)}),!t.expanding&&(!t.children||0===t.children.length)&&t.expanded&&e(T,function(e){return h.default.stopBubble(e)}),!t.expanding&&t.children&&t.expanded&&t.children.map(function(t){return e(t,n)})))},I=function(e){switch(e){case"Site":return p.imgRoot+"community_sm.svg";case"Folder":return p.imgRoot+"folder.svg"}},S={id:0,hideCaret:!0,inactive:!0,title:"Loading files...",fileIcon:v.spinner_16},T={id:0,hideCaret:!0,inactive:!0,title:"No files in folder",fileIcon:v.yield_16};y.propTypes={onClose:c.default.func.isRequired,onChooseFile:c.default.func.isRequired},t.default=y},478:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),a=p(n(182)),o=p(n(183)),r=p(n(184)),s=p(n(185)),l=n(177),u=p(l),d=p(n(180)),c=p(n(190)),f=p(n(561)),m=p(n(327));function p(e){return e&&e.__esModule?e:{default:e}}if(null==h)var h=n(179).static_images;var g=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={showPlaceholder:!0,taggingHovered:!0},n.clearSearch=n.clearSearch.bind(n),n.searchInputCleared=n.searchInputCleared.bind(n),n.onSearching=n.onSearching.bind(n),n.onSearched=n.onSearched.bind(n),n.onAddTag=n.addTag.bind(n),n.onInputBlur=n.onInputBlur.bind(n),n.onInputFocus=n.onInputFocus.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.focusInput=n.focusInput.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"focusInput",value:function(){this.input.focus()}},{key:"render",value:function(){var e=this,t=this.props.itemID,n=this.props.mentions,i=this.props.hashtags,a=(n||[]).concat(i||[]).filter(function(e){return!e.deleted});return u.default.createElement("div",{className:(0,c.default)(this.props.className,"ka_streamTagEditor"),style:{display:"block"}},u.default.createElement(m.default,{ref:"wrapper",className:"ka_addTagsBox",style:this.props.onClose?{width:487,display:"inline-block"}:{display:"block"},onClick:this.focusInput,searchingFor:this.state.searchingFor,suggestionsFor:this.state.suggestionsFor,suggestions:this.state.suggestions,mentions:n,hashtags:i,onAddTag:function(n){return e.addTag(n,t)},clearSearch:this.clearSearch,usesInputBox:!0,onMouseDown:function(){return e.setState({taggingHovered:!0})},onMouseEnter:function(){return e.setState({taggingHovered:!0})},onMouseLeave:function(){return e.setState({taggingHovered:!1})}},a.map(function(n,i){return u.default.createElement("div",{className:"shareTag",key:i},n.entityName||n.hashtag,u.default.createElement("img",{onClick:function(){return!e.props.readOnly&&v(a)&&e.props.deleteTag(n,t)},className:"btnRemoveTag",title:"Remove tag",src:h.cancel_11}))}),this.state.showPlaceholder&&u.default.createElement("span",{className:"ka_addTagsText"},"+ Add more tags"),u.default.createElement(f.default,{ref:function(t){return e.input=t},className:"ka_addTagPhrase",style:this.state.showPlaceholder?{width:0}:void 0,onAddTag:function(n){return e.addTag(n,t)},onFocus:this.onInputFocus,onBlur:this.onInputBlur,taggingHovered:this.state.taggingHovered,onSearching:this.onSearching,onSearched:this.onSearched,onCleared:this.searchInputCleared,readOnly:this.props.readOnly,onKeyDown:function(t){return e.onKeyDown(t)}})),this.props.onClose&&u.default.createElement("div",{onClick:this.props.onClose,className:(0,c.default)("ka_button","ka_buttonActive","ka_applyStreamTags"),style:{marginLeft:5,display:"inline-block"}},"Done"))}},{key:"onKeyDown",value:function(e){switch(e.keyCode){case 38:this.refs.wrapper.onUpArrow(e);break;case 40:this.refs.wrapper.onDownArrow(e);break;case 9:return this.refs.wrapper.onTab(e);case 27:this.refs.wrapper.onEscape(e);break;case 13:return this.refs.wrapper.handleReturn(e)}}},{key:"clearSearch",value:function(){this.setState({searchingFor:null,suggestionsFor:null,suggestions:null}),this.input.clearInput()}},{key:"searchInputCleared",value:function(){this.setState({searchingFor:null,suggestionsFor:null,suggestions:null})}},{key:"onSearching",value:function(e){this.setState({searchingFor:e,suggestionsFor:e})}},{key:"onSearched",value:function(e){this.setState({suggestions:e})}},{key:"addTag",value:function(e,t){this.props.addTag(e,t),this.clearSearch(),this.input.focus()}},{key:"onInputBlur",value:function(e){this.state.taggingHovered||this.setState({suggestions:null}),""==e.target.value&&this.setState({showPlaceholder:!0})}},{key:"onInputFocus",value:function(e){this.setState({showPlaceholder:!1})}},{key:"componentDidMount",value:function(){this.props.getDefaultMentions&&this.props.getDefaultMentions()}}]),t}(l.Component),v=function(e){return 1!==e.length||(alert("This is the last tag. Please add another before removing this one."),!1)};g.propTypes={mentions:d.default.array,hashtags:d.default.array,addTag:d.default.func.isRequired,deleteTag:d.default.func.isRequired,onClose:d.default.func},t.default=g},492:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keys=__webpack_require__(235),_keys2=_interopRequireDefault(_keys),_extends2=__webpack_require__(206),_extends3=_interopRequireDefault(_extends2),_getPrototypeOf=__webpack_require__(181),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(182),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(183),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(184),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(185),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(177),_react2=_interopRequireDefault(_react),_KAModal=__webpack_require__(192),_KAModal2=_interopRequireDefault(_KAModal),_utils=__webpack_require__(179),_utils2=_interopRequireDefault(_utils),_superagent=__webpack_require__(191),_superagent2=_interopRequireDefault(_superagent),_utils3=__webpack_require__(189);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var MediaModal=function(_Component){function MediaModal(e){(0,_classCallCheck3.default)(this,MediaModal);var t=(0,_possibleConstructorReturn3.default)(this,(MediaModal.__proto__||(0,_getPrototypeOf2.default)(MediaModal)).call(this,e));return t.state={},t.fetchImageDetails=t.fetchImageDetails.bind(t),t}return(0,_inherits3.default)(MediaModal,_Component),(0,_createClass3.default)(MediaModal,[{key:"componentWillMount",value:function(){this.fetchImageDetails(this.props.target)}},{key:"componentWillReceiveProps",value:function(e){this.props.target!=e.target&&this.fetchImageDetails(e.target)}},{key:"componentDidUpdate",value:function(e,t){var n=this;if(null==t.modalHtml&&null!=this.state.modalHtml){var i=this.refs.htmlContainer.getElementsByTagName("IMG")[0];i?i.addEventListener("load",function e(t){n.refs.htmlContainer.style.visibility="visible",t.target.removeEventListener("load",e)},!1):document.querySelector(".kamodal-content > div").style.visibility="visible"}}},{key:"fetchImageDetails",value:function fetchImageDetails(target){var _this3=this;_superagent2.default.get("/_layouts/15/KAMasterPage/imgDetail.ashx").query(imgDetailData(target)).end(function(err,res){err||!res.ok?(0,_utils3.logError)(err||res.text):(_this3.setState({modalHtml:res.text}),window.setTimeout(function(){for(var modalScripts=_this3.refs.htmlContainer.getElementsByTagName("script"),i=0;i<modalScripts.length;i++){var script=modalScripts[i].innerHTML;eval(script)}},1))})}},{key:"render",value:function(){return _react2.default.createElement(_KAModal2.default,(0,_extends3.default)({},this.props,{className:"kamodal_media",hideX:null==this.state.modalHtml}),null==this.state.modalHtml&&_react2.default.createElement("img",{src:"/_layouts/15/Updates/images/Ajax-loader.gif",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:-1}}),null!=this.state.modalHtml&&_react2.default.createElement("div",{ref:"htmlContainer",style:{visibility:"hidden"},dangerouslySetInnerHTML:{__html:this.state.modalHtml}}))}}]),MediaModal}(_react.Component);exports.default=MediaModal;var imgDetailData=function(e){return e.hasAttribute("ItemID")?{videoItemID:e.getAttribute("ItemID")}:{imageUrl:e.hasAttribute("fullsizeurl")?e.getAttribute("fullsizeurl"):e.getAttribute("src")}},queryString=function(e){return"?"+(0,_keys2.default)(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}},493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(177)),a=s(n(180)),o=s(n(178)),r=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.event,n=e.isSelected,a=e.onClick,r=o.default.utc(t.startTime,"YYYY-MM-DDTHH:mm:ss",!1).local(),s=(o.default.utc(t.endTime,"YYYY-MM-DDTHH:mm:ss",!1).local(),t.url);if(r)return i.default.createElement("div",{className:"ka_calendarBox ka_subitem"+(n?" selected":""),onClick:function(e){return u(e,a)},spellCheck:!1},i.default.createElement("div",{className:"ka_CalIcon"},i.default.createElement("a",{href:s,onClick:function(e){return u(e,a)}},i.default.createElement("div",{className:"ka_CalMonth"},r.format("MMM").toUpperCase()),i.default.createElement("div",{className:"ka_CalDay"},r.format("D")))),i.default.createElement("div",null,i.default.createElement("a",{className:"ka_streamSubItemTitle",href:s,onClick:function(e){return u(e,a)}},r.format("h:mm A")),i.default.createElement("span",{className:"ka_EventLocation"},(t.location||"").replace("{SubItemDateStamp}",r.format("lll"))),t.communityName&&t.listURL&&t.listName&&i.default.createElement("a",{className:"SubItemSubtitle",href:t.listURL,onClick:function(e){return u(e,a)}},t.communityName," ",t.listName)))},u=function(e,t){t&&t(),r.default.stopBubble(e)};l.propTypes={event:a.default.object.isRequired,isSelected:a.default.bool,onClick:a.default.func},t.default=l},494:function(e,t){},510:function(e,t){},516:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(517),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{comments:n.comments,likes:n.likes,isLiking:n.isLiking}},function(e){return{likeItem:function(t){return e((0,o.likeItem)(t))},unlikeItem:function(t){return e((0,o.unlikeItem)(t))},toggleSemiLessMode:function(t){return e((0,o.toggleSemiLessMode)(t))}}})(s.default)},517:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(177)),a=l(n(180)),o=l(n(518)),r=l(n(179)),s=l(n(314));function l(e){return e&&e.__esModule?e:{default:e}}if(null==u)var u=n(179).static_images;var d=function(e){var t=e.itemID,n=e.likes,a=e.isLiking,l=e.comments,d=e.likeItem,c=e.unlikeItem,f=e.toggleSemiLessMode,m=r.default.getLikeStatus(n);return i.default.createElement("div",{className:"ka_streamLessFooter"},i.default.createElement("span",{title:m?"Remove your like from this item":"Like this item",className:"ka_less_btnLike",onClick:function(e){r.default.stopBubble(e),a||(m?c(t):d(t))}},i.default.createElement(s.default,{likeStatus:m}),i.default.createElement("span",null," ",function(e){return null==e||0==e.length?"Like":1==e.length?"1 Like":e.length+" Likes"}(n))),i.default.createElement("span",{className:"ka_less_btnComment",onClick:function(e){r.default.stopBubble(e),f(t)},title:"View comments"},i.default.createElement("img",{src:u.comment_20}),i.default.createElement("span",null," ",function(e){return null==e||0==e.length?"Comment":1==e.length?"1 Comment":e.length+" Comments"}(l))),i.default.createElement(o.default,{itemID:t}))};d.propTypes={itemID:a.default.number.isRequired,likes:a.default.array,isLiking:a.default.bool,comments:a.default.array,likeItem:a.default.func.isRequired,unlikeItem:a.default.func.isRequired,onClickComment:a.default.func},t.default=d},518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(226),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{isLessMode:e.items.find(function(e){return e.itemID===t.itemID}).isLessMode}},function(e){return{toggleItemLessMode:function(t,n){e((0,o.toggleItemLessMode)(t,n))}}})(s.default)},519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(198),a=n(188),o=s(n(520)),r=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{itemType:n.itemType,likes:n.likes,isLiking:n.isLiking,likeStatus:r.default.getLikeStatus(n.likes),subscriptionStatus:null!=n.isNotify&&1===n.isNotify,isSubscribing:n.isSubscribing,authorID:null!=n.author?n.author.employeeID:n.authorID,isSPAdmin:e.isSPAdmin,subItemProfileURL:n.subItemProfileURL,deleted:n.deleted,promoted:n.promoted,promotedEndDate:n.promotedEndDate,promotedOrder:n.promotedOrder,apiFilter:n.apiFilter,apiFilterEnabled:e.apiFilterEnabled,title:r.default.replaceInlineTagsWithText(n.title,n.mentions)}},function(e){return{removeItem:function(t){return e((0,a.removeItem)(t))},restoreItem:function(t){return e((0,a.restoreItem)(t))},likeItem:function(t){return e((0,a.likeItem)(t))},unlikeItem:function(t){return e((0,a.unlikeItem)(t))},subscribeToItem:function(t){return e((0,a.subscribeToItem)(t))},unsubscribeFromItem:function(t){return e((0,a.unsubscribeFromItem)(t))},toggleTagEditor:function(t){return e((0,a.toggleTagEditor)(t))},promoteItem:function(t,n,i){return e((0,a.promoteItem)(t,n,i))},updateItemPromotion:function(t,n){return e((0,a.updateItemPromotion)(t,n))},setPublished:function(t,n){return e((0,a.setPublished)(t,n))},demoteItem:function(t){return e((0,a.demoteItem)(t))},toggleContentLessMode:function(t){return e((0,a.toggleContentLessMode)(t))}}})(o.default)},520:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=v(n(181)),a=v(n(182)),o=v(n(183)),r=v(n(184)),s=v(n(185)),l=n(177),u=v(l),d=v(n(180)),c=v(n(190)),f=v(n(521)),m=v(n(242)),p=v(n(203)),h=v(n(226)),g=v(n(179));function v(e){return e&&e.__esModule?e:{default:e}}if(null==y)var y=n(179).static_images;var E=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={isMenuOpen:!1,isPromoteOpen:!1},n.toggleMenu=n.toggleMenu.bind(n),n.togglePromoteModal=n.togglePromoteModal.bind(n),n.moreActionsArray=n.moreActionsArray.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.itemID,i=t.itemType,a=t.isLiking,o=t.likeStatus,r=t.subscriptionStatus,s=t.isSubscribing,l=t.authorID,d=t.subItemProfileURL,v=t.promoted,E=t.promotedEndDate,k=t.promoteItem,I=t.updateItemPromotion,S=t.demoteItem,T=t.likeItem,b=t.unlikeItem,C=t.subscribeToItem,D=t.unsubscribeFromItem,M=t.isSPAdmin,w=t.toggleContentLessMode,P=t.showContentMoreToggle;return u.default.createElement("div",{className:"ka_streamItemFooter"},u.default.createElement("span",{className:"linkInactive",title:o?"Remove your like from this item":"Like this item",onClick:a?null:o?function(){return b(n)}:function(){return T(n)}},o?"Unlike":"Like"),"  |  ",r?u.default.createElement("span",{className:"linkInactive",title:"Stop future email notifications.",onClick:function(){return s?null:D(n)}},"Unsubscribe"):u.default.createElement("span",{className:"linkInactive",title:"Start receiving email notifications on this thread.",onClick:function(){return s?null:C(n)}},"Subscribe"),"  |",(l==currentEmployee.employeeID||g.default.isSPAdmin())&&[u.default.createElement("span",{key:0},"  "),_(i,n,d),u.default.createElement("span",{key:2},"  |")],u.default.createElement("span",{className:(0,c.default)("ka_streamActions",this.state.isMenuOpen?"open":null,M&&v?"wide":null)},u.default.createElement("span",{title:"More Actions",onClick:this.toggleMenu},"More Actions ",u.default.createElement("img",{src:y.more_caret_dk_grey_14})),this.state.isMenuOpen&&u.default.createElement(p.default,{onClose:function(){return e.setState({isMenuOpen:!1})}},u.default.createElement("div",null,this.moreActionsArray().map(function(e,t){return u.default.createElement("div",{key:t},e)})))),P&&u.default.createElement(h.default,{itemID:n,isLessMode:!0,toggleItemLessMode:w}),this.state.isPromoteOpen&&u.default.createElement(f.default,{itemID:n,promoted:v,promotedEndDate:v?E:void 0,onClose:this.togglePromoteModal,promoteItem:k,updateItemPromotion:I,demoteItem:S}),this.state.showConfirmRemove&&u.default.createElement(m.default,{title:"Remove Post",message:"Are you sure you want to remove this post and its comments from all activity streams?",confirmText:"Remove",redConfirm:!0,onConfirm:function(){return e.props.removeItem(n)},onClose:function(){return e.setState({showConfirmRemove:!1})}}),this.state.showConfirmRestore&&u.default.createElement(m.default,{title:"Restore Post",message:"Are you sure you want to restore this post and its comments to all activity streams?",confirmText:"Restore",onConfirm:function(){return e.props.restoreItem(n)},onClose:function(){return e.setState({showConfirmRestore:!1})}}),this.state.showConfirmPublish&&u.default.createElement(m.default,{title:"Publish Post",message:"Are you sure you want to make this post available to the Synthesis API?",confirmText:"Publish",onConfirm:function(){return e.props.setPublished(n,!0)},onClose:function(){return e.setState({showConfirmPublish:!1})}}),this.state.showConfirmUnpublish&&u.default.createElement(m.default,{title:"Unpublish Post",message:"Are you sure you want to remove this post from the Synthesis API?",confirmText:"Unpublish",onConfirm:function(){return e.props.setPublished(n,!1)},onClose:function(){return e.setState({showConfirmUnpublish:!1})}}))}},{key:"toggleMenu",value:function(e){this.setState({isMenuOpen:!this.state.isMenuOpen})}},{key:"togglePromoteModal",value:function(){this.setState({isPromoteOpen:!this.state.isPromoteOpen})}},{key:"moreActionsArray",value:function(){var e=this,t=this.props,n=t.itemID,i=t.authorID,a=t.isSPAdmin,o=t.promoted,r=t.apiFilterEnabled,s=t.deleted,l=t.toggleTagEditor,d=t.title,c=urlTemplates.threadUrl+"?ItemID="+n,f=void 0;return f=window.location.origin?""+window.location.origin+c:window.location.protocol+"//"+window.location.hostname+(window.location.port?":":"")+window.location.port+c,[u.default.createElement("a",{href:c,title:"Open the permalink for this thread."},"View"),(i==employeeID||a)&&u.default.createElement("span",{onClick:function(){l(n),e.toggleMenu()},title:"Edit tags for this stream item."},"Edit Tags"),u.default.createElement("a",{href:"mailto:?subject="+encodeURIComponent(d||"Forwarded from Intranet")+"&body="+encodeURIComponent(f),title:"Email a link to this thread.",target:"_blank"},"Email"),a&&!o&&u.default.createElement("span",{onClick:function(){e.togglePromoteModal(),e.toggleMenu()},title:"Promote this item to the home page and all tagged activity streams."},"Promote"),a&&o&&u.default.createElement("span",{onClick:function(){e.togglePromoteModal(),e.toggleMenu()},title:"Edit the promotion date for this item."},"Update Promotion"),a&&r&&0===this.props.apiFilter&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmPublish:!0})}},"Publish"),a&&r&&0!==this.props.apiFilter&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmUnpublish:!0})}},"Unpublish"),(i==employeeID||a)&&!s&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmRemove:!0})},title:"Remove post"},"Remove"),a&&s&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmRestore:!0})},title:"Restore post"},"Restore")].filter(function(e){return e})}}]),t}(l.Component),_=function(e,t,n){var i=void 0,a=void 0,o=void 0;switch(e){case"New Blog Post":a="Edit this blog post",o=function(e){return k(n.replace("Post.aspx","EditPost.aspx"))};break;case"New Event":a="Edit this calendar event",o=function(e){return k(n.replace("DispForm.aspx","EditForm.aspx"))};break;default:a="Edit this post",i="/_layouts/15/ShareSomething/EditPost.aspx?ItemID="+t}return u.default.createElement("a",{className:"linkInactive",title:a,href:i,onClick:o,key:"edit"},"Edit")},k=function(e){SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){SP.UI.ModalDialog.OpenPopUpPage(e,I)})},I=function(e){SP.UI.DialogResult.cancel};E.propTypes={itemID:d.default.number.isRequired,itemType:d.default.string.isRequired,toggleTagEditor:d.default.func.isRequired,likes:d.default.array,isLiking:d.default.bool,likeStatus:d.default.bool,subscriptionStatus:d.default.bool,isSubscribing:d.default.bool,authorID:d.default.string,isSPAdmin:d.default.bool.isRequired,subItemProfileURL:d.default.string,deleted:d.default.bool.isRequired,promoted:d.default.bool.isRequired,promotedEndDate:d.default.string,promotedOrder:d.default.number,apiFilterEnabled:d.default.bool,apiFilter:d.default.number,title:d.default.string.isRequired,removeItem:d.default.func.isRequired,likeItem:d.default.func.isRequired,unlikeItem:d.default.func.isRequired,subscribeToItem:d.default.func.isRequired,unsubscribeFromItem:d.default.func.isRequired,updateItemPromotion:d.default.func.isRequired,setPublished:d.default.func.isRequired,promoteItem:d.default.func.isRequired},t.default=E},521:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(240)),a=h(n(181)),o=h(n(182)),r=h(n(183)),s=h(n(184)),l=h(n(185)),u=n(177),d=h(u),c=h(n(180)),f=h(n(192)),m=h(n(178));n(95);var p=n(605);function h(e){return e&&e.__esModule?e:{default:e}}n(635);var g=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e)),i=e.promotedEndDate?m.default.utc(e.promotedEndDate,"YYYY-MM-DDTHH:mm:ss",!1).local():null;return n.state={promEndDate:null!=i&&(0,p.isInclusivelyAfterDay)(i,(0,m.default)())?i:(0,m.default)(),promNotify:!1},n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e,t=this,n=this.props,a=n.itemID,o=n.promoted,r=n.onClose,s=n.promoteItem,l=n.updateItemPromotion,u=n.demoteItem;return d.default.createElement(f.default,{onClose:r,title:"Promote this Post",className:"ka_streamPromotePicker"},d.default.createElement("div",null,"Select a date for this promotion to end."),d.default.createElement("br",null),d.default.createElement(p.DayPickerRangeController,{startDate:(0,m.default)(),endDate:this.state.promEndDate,numberOfMonths:1,onDatesChange:function(e){e.startDate;var n=e.endDate;(0,p.isInclusivelyAfterDay)(n,(0,m.default)())&&t.setState({promEndDate:n})},focusedInput:"endDate",onFocusChange:function(e){return t.setState({focusedInput:e})},keepOpenOnDateSelect:!0,isOutsideRange:function(e){return!(0,p.isInclusivelyAfterDay)(e,(0,m.default)())},minimumNights:0,hideKeyboardShortcutsPanel:!0}),d.default.createElement("br",null),d.default.createElement("div",{style:{verticalAlign:"middle"}},o?d.default.createElement("div",{style:{textAlign:"right"}},d.default.createElement("input",{type:"button",className:"ka_button",value:"Update",onClick:function(){l(a,t.state.promEndDate.startOf("day").add(18,"hours").utc().format()),r()}}),d.default.createElement("input",(e={type:"button",className:"ka_button",value:"Demote"},(0,i.default)(e,"className","red"),(0,i.default)(e,"onClick",function(){u(a),r()}),e))):d.default.createElement("div",null,d.default.createElement("input",{type:"checkbox",checked:this.state.promNotify,onChange:function(e){return t.setState({promNotify:e.target.checked})}})," Send an e-mail notification to all users.",d.default.createElement("br",null),d.default.createElement("br",null),d.default.createElement("input",{type:"button",className:"ka_button",value:"Promote",style:{marginTop:0,float:"right"},onClick:function(){null!=t.state.promEndDate&&(s(a,t.state.promEndDate.startOf("day").add(18,"hours").utc().format(),t.state.promNotify),r())}}))))}}]),t}(u.Component);g.propTypes={itemID:c.default.number.isRequired,promoted:c.default.bool.isRequired,promotedEndDate:c.default.string,promotedOrder:c.default.number,promoteItem:c.default.func.isRequired},t.default=g},526:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(177)),a=s(n(180)),o=s(n(226)),r=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.item,n=t.itemID,a=t.isLessMode,s=t.mentions,l=t.hashtags,d=e.showItemModeToggle,c=e.toggleItemLessMode,f=e.blogCategories,m=e.tagClicked,p=null!=s?s.filter(function(e){return!e.deleted}):[],h=null!=l?l.filter(function(e){return!e.deleted}):[];return i.default.createElement("div",null,d&&i.default.createElement(o.default,{itemID:n,isLessMode:a,toggleItemLessMode:c}),i.default.createElement("div",{className:"ka_streamTags"},"Tags: ",r.default.separate(p.map(function(e,t){return e.hasProfile?i.default.createElement("a",{className:"ka_streamTagLink ka_mention_link",href:r.default.getResourceUrl(e.entityType,e.entityID,e.isOpportunity),onClick:function(t){return m(t,e.entityType,e.entityID)},key:t},e.entityName):e.entityName}),", "),p.length>0&&h.length>0?", ":null,r.default.separate(h.map(function(e,t){return i.default.createElement("a",{className:"ka_streamTagLink ka_hashtag_link",href:r.default.getResourceUrl("Hashtag",e.hashtag),onClick:function(t){return m(t,"Hashtag",e.hashtag)},key:t},e.hashtag)}),", ")),null!=f&&f.length>0&&i.default.createElement("div",{className:"ka_streamBlogCategories"},"Categories: ",r.default.separate(f.map(function(e,t){return i.default.createElement("a",{className:"ka_blogcategory_link",href:u(e.urlSlug,e.name),key:t},e.name)}),", ")))},u=function(e,t){return(e+="&name="+encodeURIComponent(t)).startsWith("/")||e.startsWith("http")?e:"/"+e};l.propTypes={item:a.default.object.isRequired,toggleItemLessMode:a.default.func.isRequired,blogCategories:a.default.array},t.default=l},527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(528),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{itemID:t.itemID,likes:n.likes}},function(e){return{likeItem:function(t){e((0,o.likeItem)(t))},unlikeItem:function(t){e((0,o.unlikeItem)(t))}}})(s.default)},528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(181)),a=h(n(182)),o=h(n(183)),r=h(n(184)),s=h(n(185)),l=n(177),u=h(l),d=h(n(180)),c=h(n(190)),f=(h(n(226)),h(n(179))),m=h(n(314)),p=h(n(529));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.itemID,i=t.likes,a=t.likeItem,o=t.unlikeItem,r=f.default.getLikeStatus(i);return null!=i&&i.length>0?u.default.createElement("div",{className:(0,c.default)("ka_streamSubBox","ka_streamLikeCount")},u.default.createElement(m.default,{likeStatus:r,title:r?"Remove your like from this item":"Like this item",onClick:function(e){return r?o(n):a(n)}}),function(){switch(i.length){case 1:return[v(i[0].author,0),u.default.createElement("span",{key:1}," likes this.")];case 2:return[v(i[0].author,0),u.default.createElement("span",{key:1}," and "),v(i[1].author,2),u.default.createElement("span",{key:3}," like this.")];default:return[u.default.createElement("span",{className:"linkInactive",onClick:function(){return e.setState({isViewingLikes:!0})},key:0},i.length," People"),u.default.createElement("span",{key:1}," like this.")]}}(),this.state.isViewingLikes&&u.default.createElement(p.default,{likes:i,onClose:function(){return e.setState({isViewingLikes:!1})}})):null}}]),t}(l.Component),v=function(e,t){return null==e?(console.error("like missing author"),u.default.createElement("span",{key:t},"someone")):"Y"===e.showInCompanyDirectory?u.default.createElement("a",{className:"ka_likeAuthor",href:f.default.getResourceUrl("Employee",e.employeeID),key:t},e.fullName):u.default.createElement("span",{key:t},e.fullName)};g.propTypes={itemID:d.default.number.isRequired,likes:d.default.array,likeItem:d.default.func.isRequired,unlikeItem:d.default.func.isRequired},t.default=g},529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),a=p(n(182)),o=p(n(183)),r=p(n(184)),s=p(n(185)),l=n(177),u=p(l),d=p(n(180)),c=p(n(192)),f=p(n(269)),m=p(n(179));function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,a.default)(this,t),(0,r.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this,t=this.props.likes.sort(function(e,t){return t.likeID-e.likeID}),n={minWidth:400};return t.length>7&&(n.height=500),u.default.createElement(c.default,{onClose:this.props.onClose,style:n,title:"Likes",ref:function(t){return e.modal=t}},t.map(function(e){return e.author?g(e):null}))}}]),t}(l.Component),g=function(e){return u.default.createElement("div",{style:{padding:3,margin:2,whiteSpace:"nowrap"},className:"ka_greyLinks",key:e.likeID},u.default.createElement(f.default,{enabled:!e.author.deleted&&"Y"===e.author.showInCompanyDirectory,href:m.default.getResourceUrl("Employee",e.author.employeeID)},u.default.createElement("img",{src:m.default.getImageURL("Employee",e.author.primaryImageID,50),width:"50px",height:"50px",style:{verticalAlign:"middle",marginRight:5},className:"ka_circular"}),u.default.createElement("span",null,e.author.fullName)))};h.propTypes={likes:d.default.array.isRequired,onClose:d.default.func},t.default=h},530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(531),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{item:n,itemAuthor:n.author,comments:n.comments,commentDrafts:n.commentDrafts,mentions:n.mentions,hashtags:n.hashtags,showingAllComments:n.showingAllComments,isAddingComment:n.isAddingComment,isSPAdmin:e.isSPAdmin}},function(e,t){return{showAllComments:function(t){return e((0,o.showAllComments)(t))},removeComment:function(t){return e((0,o.removeComment)(t))},setIsCommenting:function(n,i){return e((0,o.setIsCommenting)(t.itemID,n,i))},toggleCommentLessMode:function(t){return e((0,o.toggleCommentLessMode)(t))}}})(s.default)},531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=S(n(186)),a=S(n(181)),o=S(n(182)),r=S(n(183)),s=S(n(184)),l=S(n(185)),u=n(177),d=S(u),c=S(n(180)),f=S(n(190)),m=(S(n(226)),S(n(179))),p=S(n(269)),h=S(n(532)),g=(S(n(558)),n(669),S(n(203))),v=S(n(242)),y=n(279),E=n(209),_=S(n(280)),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213)),I=n(189);function S(e){return e&&e.__esModule?e:{default:e}}if(null==T)var T=n(179).static_images;var b=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.toggleDeleteCommentModal=n.toggleDeleteCommentModal.bind(n),n.editComment=n.editComment.bind(n),n.trackSubitem=n.trackSubitem.bind(n),n.state={deleteCommentOpen:!1,deletingComment:0,commentMenuOpen:0,showConfirmRemoveCommentID:0,hoveredComment:0},n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidCatch",value:function(e,t){(0,I.logError)(e,{itemID:this.props.itemID}),this.setState({error:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.itemID,i=t.itemAuthor,a=t.comments,o=t.commentDrafts,r=t.mentions,s=t.hashtags,l=t.showingAllComments,u=(t.isAddingComment,t.isSPAdmin),c=t.showAllComments,f=t.removeComment;if(this.state.error)return d.default.createElement("div",null);var m=o&&o.length>0?o[0]:void 0;return d.default.createElement("div",null,!1,!l&&a&&a.length>2&&this.renderShowAllComments(n,a.length,c,"showAll"),a&&a.slice((!l&&a.length)>2?-2:0).map(function(t,n){return e.renderComment(t,i,r,s,f,u,e.state.deletingComment,e.props.toggleCommentLessMode)}),d.default.createElement(h.default,{itemID:n,key:"newComment",focus:this.props.focusEditor,isCommenting:null!=m,comment:m}),0!==this.state.showConfirmRemoveCommentID&&d.default.createElement(v.default,{title:"Remove Comment",message:"Are you sure you want to remove this comment from the stream?",confirmText:"Remove",redConfirm:!0,onConfirm:function(){return e.props.removeComment(e.state.showConfirmRemoveCommentID)},onClose:function(){return e.setState({showConfirmRemoveCommentID:0,commentMenuOpen:0})}}),!1)}},{key:"linkClicked",value:function(e,t){"A"===e.target.nodeName&&(e.target.className.indexOf("ka_mention_link")>-1||e.target.className.indexOf("ka_hashtag_link")>-1?k.trackCommentTagClick(e.target.href,e.target.text,e.target.getAttribute("entityType"),e.target.getAttribute("entityID"),this.props.item,t):k.trackCommentLinkClick(e.target.href,e.target.text,this.props.item,t))}},{key:"trackSubitem",value:function(e,t,n,i,a,o){"Video"===e&&o===k.eventTypes.watch?k.trackVideoWatch(i.videoID,i.chunksWatched,i.sessionID,this.props.item,a):k.trackCommentSubitemClick(e,t,n,this.props.item,a)}},{key:"renderComment",value:function(e,t,n,a,o,r,s,l){var u=this;if(e.isCommenting||e.restoreEditorState)return d.default.createElement(h.default,{itemID:this.props.itemID,comment:e,focusOnMount:!0,isCommenting:!0,itemAuthor:t,mentions:n,hashtags:a,key:e.commentID});var c=(e.author.employeeID===employeeID||r)&&!e.isPending&&(this.state.hoveredComment===e.commentID||this.state.commentMenuOpen===e.commentID)&&!0,v={};v=e.jsonContent?(0,y.renderJsonContent)(e.jsonContent,e.subitems,t,n,a,e.isLessMode,"ka_streamCommentContent",{width:E.INT_COMMENT_IMAGE_WIDTH,height:E.INT_COMMENT_IMAGE_HEIGHT},E.INT_COMMENT_LESS_CHARS,!1,function(t,n,i,a,o){return u.trackSubitem(t,n,i,a,e,o)},function(t){return u.linkClicked(t,e)}):(0,y.renderFormattedContent)(e.formattedContent,e.subitems,t,n,a,e.isLessMode,!1,"ka_streamCommentContent",E.INT_COMMENT_LESS_CHARS,function(t){return u.linkClicked(t,e)});var k=e.isLessMode&&(v.trimmed||e.subitems&&(e.subitems.filter(function(e){return!e.deleted}).length>1||e.subitems.filter(function(e){return"Image"===e.collectionType&&!e.deleted}).length>0)),I=void 0;return k&&(I=function(){return l(e.commentID)}),d.default.createElement("div",{className:(0,f.default)("ka_streamSubBox","ka_streamComment",e.isPending||e.author.employeeID!==employeeID&&!r?null:"ka_myComment",e.commentID==s?"highlighted":null),style:(0,i.default)({minHeight:35},k?{cursor:"pointer"}:null),key:e.commentID,onClick:I,onMouseEnter:function(){return u.setState({hoveredComment:e.commentID})},onMouseLeave:function(){u.state.hoveredComment===e.commentID&&u.setState({hoveredComment:0})}},d.default.createElement("div",{style:{display:"inline-block",marginRight:12},className:"ka_commentAuthorImage"},d.default.createElement(p.default,{enabled:"Y"===e.author.showInCompanyDirectory,href:m.default.getResourceUrl("Employee",e.author.employeeID)},d.default.createElement("img",{className:"imgSubjectImage ka_circular",src:m.default.getImageURL("Employee",e.author.primaryImageID,50,50,!0)}))),d.default.createElement("div",{style:{display:"inline-block",width:"calc(100% - 62px)",verticalAlign:"top"}},d.default.createElement(p.default,{enabled:"Y"===e.author.showInCompanyDirectory,className:"ka_authorName",href:m.default.getResourceUrl("Employee",e.author.employeeID)},e.author.fullName),c?d.default.createElement("div",{className:"ka_editCommentOptions"},d.default.createElement("img",{src:T.pencil_16,onClick:function(){return u.setState({commentMenuOpen:e.commentID})}}),this.state.commentMenuOpen===e.commentID&&d.default.createElement(g.default,{onClose:function(){u.state.commentMenuOpen===e.commentID&&u.setState({commentMenuOpen:0})}},d.default.createElement("div",null,d.default.createElement("span",{onClick:function(){return u.editComment(e.commentID)}},"Edit"),d.default.createElement("span",{onClick:function(){return u.setState({showConfirmRemoveCommentID:e.commentID})}},"Remove"),d.default.createElement("div",{className:"KAEditor-tri center"},d.default.createElement("div",null))))):d.default.createElement("span",{className:"ka_streamDate"},e.dateStamp?m.default.formatDateTimeStamp(e.dateStamp):"just now"),v.content,!e.jsonContent&&d.default.createElement(_.default,{subitemCollections:e.subitems,isLessMode:e.isLessMode,imageSize:{width:E.INT_COMMENT_IMAGE_WIDTH,height:E.INT_COMMENT_IMAGE_HEIGHT},className:"ka_SubItemContainer",trackSubitem:this.trackSubitem})),"","",!1,k&&d.default.createElement("span",{className:"linkActive ka_comment_more"},"See more..."),!k&&e.hasLessMode&&d.default.createElement("div",{className:"ka_comment_more"},d.default.createElement("span",{className:"linkActive",onClick:function(t){var n=t.target.parentElement.parentElement;m.default.compensateScrollPosition(n,function(){return n},function(){return l(e.commentID)})}},"See less...")))}},{key:"editComment",value:function(e){this.setState({commentMenuOpen:0}),this.props.setIsCommenting(!0,e)}},{key:"confirmRemoveCommentMobile",value:function(e,t){this.toggleDeleteCommentModal(t)}},{key:"renderShowAllComments",value:function(e,t,n,i){return d.default.createElement("div",{className:(0,f.default)("ka_streamSubBox","ka_streamCommentCount"),onClick:function(t){n(e),t.stopPropagation()},key:i},d.default.createElement("span",{className:(0,f.default)("ka_commentIcon","linkInactive")},d.default.createElement("img",{className:"ka_commentIcon",src:T.comment_20}),"Show all ",t," comments"))}},{key:"toggleDeleteCommentModal",value:function(e){this.setState({deleteCommentOpen:!this.state.deleteCommentOpen,deletingComment:e})}},{key:"closeDeleteCommentModal",value:function(e){this.setState({deleteCommentOpen:!1,deletingComment:0})}},{key:"renderPendingComment",value:function(){return d.default.createElement("div",{className:"ka_streamSubBox",style:{minHeight:35,position:"relative"},key:"pendingComment"},d.default.createElement("img",{src:T.ajax_loader_32,style:{position:"absolute",left:"50%"}}))}}]),t}(u.Component);b.propTypes={itemID:c.default.number.isRequired,itemAuthor:c.default.object,comments:c.default.array,mentions:c.default.array,hashtags:c.default.array,showingAllComments:c.default.bool.isRequired,isAddingComment:c.default.bool,isSPAdmin:c.default.bool.isRequired,showAllComments:c.default.func.isRequired,removeComment:c.default.func.isRequired,setIsCommenting:c.default.func.isRequired},t.default=b},532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(533),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{restoreCommentEditorState:e.items.find(function(e){return e.itemID===t.itemID}).restoreCommentEditorState,isOnLine:e.isOnLine,warnOffline:e.warnOffline}},function(e,t){return{setIsCommenting:function(t,n,i){return e((0,o.setIsCommenting)(t,n,i))},submitItemComment:function(t,n){e((0,o.submitUpdatedItemComment)(t,n))},submitCommentDraft:function(t){return e((0,o.submitCommentDraft)(t))},setDraftStatus:function(t,n,i){return e((0,o.setDraftStatus)(t,n,i))},setActionError:function(t){return e((0,o.setActionError)(t))},setWarnOffline:function(t,n){return e((0,o.setWarnOffline)(t,n))},setWarnBrokenUser:function(t){return e((0,o.setWarnBrokenUser)(t))},removeComment:function(t){return e((0,o.removeComment)(t))}}})(s.default)},533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=O(n(186)),a=O(n(181)),o=O(n(182)),r=O(n(183)),s=O(n(184)),l=O(n(185)),u=n(177),d=O(u),c=O(n(187)),f=O(n(180)),m=O(n(190)),p=O(n(179)),h=n(223),g=O(n(472)),v=O(n(473)),y=O(n(474)),E=n(214),_=O(n(244)),k=n(209),I=O(n(245)),S=O(n(246)),T=O(n(475)),b=n(476),C=O(b),D=O(n(477)),M=O(n(557)),w=n(220),P=n(208),L=n(189);function O(e){return e&&e.__esModule?e:{default:e}}var A=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));n.onLinkPeek=n.onLinkPeek.bind(n);var i=void 0;return i=e.comment&&e.comment.restoreEditorState?e.comment.restoreEditorState:e.comment?N(e.comment,e.itemAuthor,e.mentions,e.hashtags,n.onLinkPeek):(0,h.newEditorState)(n.onLinkPeek),n.state={editorState:i,fileUploads:[],fileUploadFailures:[],videoUploadFailures:[],videosProcessing:[],showUploadFailures:!1,draftIsDirty:!1,confirmCloseComment:-1},n.submitClicked=n.submitClicked.bind(n),n.onEditorChange=n.onEditorChange.bind(n),n.onEditLink=n.onEditLink.bind(n),n.onRemoveLink=n.onRemoveLink.bind(n),n.onUploadStart=n.onUploadStart.bind(n),n.onUploadEnd=n.onUploadEnd.bind(n),n.renderLinkDialog=n.renderLinkDialog.bind(n),n.isOnLine=n.isOnLine.bind(n),n.newCommentClicked=n.newCommentClicked.bind(n),n.setupDraftSaveTimer=n.setupDraftSaveTimer.bind(n),n.cancelDraftSaveTimer=n.cancelDraftSaveTimer.bind(n),n.submitDraft=n.submitDraft.bind(n),n.cancelHandler=n.cancelHandler.bind(n),n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.focusOnMount&&(this.editor.focus(),window.setTimeout(function(){var t=c.default.findDOMNode(e),n=t.clientHeight,i=p.default.getOffsetFromAncestorS4Workspace(t),a=t.clientHeight,o=i+n;o>t.scrollTop+a&&(t.scrollTop=o-a)},0))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setMaxHeight)}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.props.comment&&(this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saved&&this.props.comment.draftSaveStatus!==P.draftSaveStatuses.failed||window.setTimeout(function(){!n.props.comment||n.props.comment.draftSaveStatus!==P.draftSaveStatuses.saved&&n.props.comment.draftSaveStatus!==P.draftSaveStatuses.failed||n.props.setDraftStatus(P.draftSaveStatuses.idle,n.props.comment.itemID,n.props.comment.commentID)},5e3)),void 0===this.draftSaveTimer&&this.props.comment&&this.props.comment.isDraft&&this.setupDraftSaveTimer()}},{key:"onLinkPeek",value:function(e){this.setState({linkPeek:e})}},{key:"onEditLink",value:function(){this.setState({isLinkDialogOpen:!0,linkPeek:null})}},{key:"onRemoveLink",value:function(){var e=this,t=(0,h.tryGetLinkSelection)(this.state.editorState);if(null!=t){var n=w.RichUtils.toggleLink(this.state.editorState,t,null),i=n.getSelection();n=w.EditorState.acceptSelection(n,i.merge({anchorOffset:i.getFocusOffset()})),this.onEditorChange(n)}this.setState({linkPeek:null}),window.setTimeout(function(){return e.editor.focus()},0)}},{key:"onUploadStart",value:function(e){0===this.state.fileUploads.length&&(0,h.addConfirmLeave)(),this.setState({fileUploads:this.state.fileUploads.concat(e.name)})}},{key:"onUploadEnd",value:function(e,t){if(t)this.props.comment&&this.props.comment.isDraft&&this.submitDraft();else{var n=this.state.fileUploads.filter(function(t){return t!==e.name});this.setState({fileUploads:n});var i=this.state.fileUploadFailures,a=this.state.videoUploadFailures;e.status===_.default.FAILED&&(0===e.type.indexOf("video/")?a.push(e):i.push(e)),(i.length>0||a.length>0)&&this.setState({showUploadFailures:!0}),0===n.length?((0,h.removeConfirmLeave)(),0===i.length&&0===a.length&&(this.state.submitAfterFileUpload?this.submitClicked():this.props.comment&&this.props.comment.isDraft&&this.submitDraft())):this.setState({fileUploadFailures:i,videoUploadFailures:a})}}},{key:"isOnLine",value:function(){return this.props.isOnLine}},{key:"setIsCommenting",value:function(e,t){e||(0,h.removeConfirmLeave)(),this.isOnLine()&&this.props.setIsCommenting(this.props.itemID,e,t)}},{key:"newCommentClicked",value:function(){var e=this;this.props.isCommenting||(p.default.isUserBroken()?this.props.setWarnBrokenUser(!0):this.isOnLine()?(this.setIsCommenting(!0,null),window.setTimeout(function(){return e.editor&&e.editor.focus()},0)):null===document.querySelector(".ka_outageBannerContainer.nondismissible")&&this.props.setWarnOffline(E.OUTAGE_BANNERS.notCommenting.number,!0))}},{key:"cancelHandler",value:function(){return!!(this.props.comment&&this.props.comment.commentID&&this.props.comment.isDraft&&this.isOnLine())&&(this.setState({confirmCloseComment:this.props.comment.commentID}),!0)}},{key:"render",value:function(){var e=this,t=this.props.comment?this.props.comment.commentID:null,n=this.props.comment&&this.props.comment.author?this.props.comment.author.primaryImageID:currentEmployee.primaryImageID,i=0===this.state.fileUploads.length&&this.isOnLine()&&0===this.state.videosProcessing.length&&this.props.comment&&this.props.comment.commentID&&this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saving;return d.default.createElement("div",{className:(0,m.default)("ka_streamSubBox ka_streamNewComment",this.props.isCommenting?null:"closed"),onClick:this.newCommentClicked},d.default.createElement("div",{style:{float:"left"}},d.default.createElement("img",{className:"imgSubjectImage ka_circular",src:p.default.getImageURL("Employee",n,50,50),style:{width:50}})),d.default.createElement("div",{className:"ka_newCommentWrapper"},this.props.isCommenting?d.default.createElement(y.default,{ref:function(t){return e.editor=t},placeholder:this.props.comment&&!this.props.comment.isDraft?"Update this comment...":"Add a comment...",onStartEditing:function(){return e.setIsCommenting(!0,t)},onStopEditing:function(){return e.setIsCommenting(!1,t)},style:{},handleCancel:this.cancelHandler,disableX:!this.isOnLine(),readOnly:!this.isOnLine(),editorState:this.state.editorState,onChange:this.onEditorChange,className:this.props.isCommenting?"open":null,isEditing:this.props.isCommenting,onEditLink:this.onEditLink,imageSize:{width:k.INT_COMMENT_IMAGE_WIDTH,height:k.INT_COMMENT_IMAGE_HEIGHT},uploadProps:{getToken:p.default.getToken,getUploadHeader:function(){return{Authorization:"Bearer "+p.default.getToken()}},onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd,videoProcessingStarted:function(t){return e.setState({videosProcessing:e.state.videosProcessing.concat(t)})},videoProcessingEnded:function(t){return e.setState({videosProcessing:e.state.videosProcessing.filter(function(e){return e!==t})})}}}):d.default.createElement(M.default,{isOnLine:this.isOnLine(),onOpen:function(){e.setIsCommenting(!0,t),window.setTimeout(function(){return e.editor.focus()},0)}})),this.props.isCommenting&&d.default.createElement("div",{className:"ka_commentFooter"},d.default.createElement(g.default,{editorState:this.state.editorState,onToggleInlineStyle:function(t){e.onEditorChange(w.RichUtils.toggleInlineStyle(e.state.editorState,t)),e.setState({draftIsDirty:!0})},onToggleBlockType:function(t){e.onEditorChange(w.RichUtils.toggleBlockType(e.state.editorState,t)),e.setState({draftIsDirty:!0}),window.setTimeout(function(){return e.editor.focus()},0)},readOnly:!this.isOnLine(),onImageAttach:function(t){return e.editor.onSelectFiles(e.state.editorState.getSelection(),t)},onVideoAttach:function(t){return e.editor.onSelectFiles(e.state.editorState.getSelection(),t)},onDocumentAttach:function(t){return e.editor.onSelectFiles(e.state.editorState.getSelection(),t)},onEditLink:this.onEditLink,onBrowseSPDocuments:function(){return e.setState({isDocBrowserOpen:!0})},disableBlogging:!0}),d.default.createElement(v.default,{linkPeek:this.state.linkPeek,onEdit:this.onEditLink,onRemove:this.onRemoveLink,onClose:function(){return e.setState({linkPeek:null})}}),d.default.createElement("span",{className:"ka_draftStatusMsg",style:{marginTop:5}},p.default.draftSaveStatusText(this.props.comment?this.props.comment.draftSaveStatus:P.draftSaveStatuses.idle,this.state.draftIsDirty,this.isOnLine(),this.state.fileUploads.length>0)),d.default.createElement("span",{className:(0,m.default)("ka_button","ka_buttonActive",i?null:"disabled"),style:{display:"inline-block",marginTop:5},onClick:i?this.submitClicked:void 0},this.state.submitAfterFileUpload?"Loading...":this.props.comment&&!this.props.comment.isDraft?"Update":"Comment")),this.state.isLinkDialogOpen&&this.renderLinkDialog(),this.state.isDocBrowserOpen&&d.default.createElement(D.default,{onChooseFile:function(t){e.editor.insertAtomicBlock((0,h.adjustTargetBasedOnCursor)(e.state.editorState.getSelection(),e.state.editorState.getCurrentContent()),t,t.collectionType,null,!0),e.setState({isDocBrowserOpen:!1,draftIsDirty:!0})},onClose:function(){return e.setState({isDocBrowserOpen:!1})}}),this.state.alert&&d.default.createElement(I.default,{onClose:function(){return e.setState({alert:null})},title:this.state.alert.title,message:this.state.alert.message}),this.state.showUploadFailures&&d.default.createElement(S.default,{onClose:function(){return e.setState({showUploadFailures:!1,fileUploadFailures:[],videoUploadFailures:[]})},fileAlerts:{fileUploadFailures:this.state.fileUploadFailures,videoUploadFailures:this.state.videoUploadFailures}}),-1!==this.state.confirmCloseComment&&d.default.createElement(C.default,{title:"Delete Comment",message:"Are you sure you want to delete this comment?",onClose:function(){return e.setState({confirmCloseComment:-1})},optionArray:[(0,b.dialogOption)("Cancel",function(){return e.setState({confirmCloseComment:-1})}),(0,b.dialogOption)("Delete Comment",function(){e.props.removeComment(t),e.editor.onCancel()},!1,!0)]}))}},{key:"renderLinkDialog",value:function(){var e=this,t=(0,h.selectLink)(this.state.editorState);return d.default.createElement(T.default,{text:(0,h.getTextSelection)(t," "),url:(0,h.getSelectedLinkUrl)(t),onCreate:function(n,i){e.onEditorChange((0,h.insertLink)(t,n,i)),e.setState({isLinkDialogOpen:!1,draftIsDirty:!0}),window.setTimeout(function(){return e.editor.focus()},0)},onClose:function(){e.setState({isLinkDialogOpen:!1}),window.setTimeout(function(){return e.editor.focus()},0)}})}},{key:"submitClicked",value:function(e){var t=this;if(void 0!==this.props.comment.commentID&&this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saving&&!(this.state.videosProcessing.length>0))try{if(this.state.fileUploads.length>0)this.setState({submitAfterFileUpload:!0});else if(!this.props.isAddingComment)if(this.editor.hasText()){var n=this.editor.getTags(),a=(n||[]).filter(function(e){return null==e.hashtag}),o=(n||[]).filter(function(e){return null!=e.hashtag}),r=this.editor.getJson();this.props.comment&&(0,h.populateMissingCollectionIDsInContent)(r,this.props.comment.subitems);var s=c.default.findDOMNode(this).parentElement;this.cancelDraftSaveTimer(),p.default.compensateScrollPosition(c.default.findDOMNode(this.editor),function(){var e=s.querySelectorAll(".ka_streamComment");return e[e.length-1]},function(){return t.props.submitItemComment((0,i.default)({},t.props.comment,{itemID:t.props.itemID,jsonContent:r,draftJsContent:(0,h.removeDataUrlsFromRawContent)((0,w.convertToRaw)(t.state.editorState.getCurrentContent())),mentions:a,hashtags:o}),t.state.editorState)}),this.setState({submitAfterFileUpload:!1}),this.editor.onCancel()}else this.setState({alert:E.ALERT_MISSING_COMMENT})}catch(e){(0,L.logError)(e),this.props.setActionError(e)}}},{key:"componentWillReceiveProps",value:function(e){null!=e.restoreCommentEditorState&&null==this.props.restoreCommentEditorState?this.setState({editorState:e.restoreCommentEditorState}):this.props.comment&&this.props.comment.isDraft&&this.props.isOnLine&&!e.isOnLine&&(e.comment&&e.comment.draftJsContent?this.setState({editorState:N(e.comment,e.itemAuthor,e.mentions,e.hashtags,this.onLinkPeek)}):this.setState({editorState:(0,h.newEditorState)(this.onLinkPeek)}))}},{key:"onEditorChange",value:function(e){this.props.comment&&!this.props.comment.isDraft||this.state.draftIsDirty||!(0,h.didTextChange)(this.state.editorState,e)&&e.getCurrentContent().getBlocksAsArray().filter(function(e){return"atomic"===e.getType()}).length===this.state.editorState.getCurrentContent().getBlocksAsArray().filter(function(e){return"atomic"===e.getType()}).length||this.setState({draftIsDirty:!0}),this.setState({editorState:e})}},{key:"setupDraftSaveTimer",value:function(){var e=this;this.setState({draftIsDirty:!1}),this.draftSaveTimer=window.setInterval(function(){e.state.draftIsDirty&&e.submitDraft()},3e3)}},{key:"cancelDraftSaveTimer",value:function(){window.clearInterval(this.draftSaveTimer),delete this.draftSaveTimer}},{key:"submitDraft",value:function(){if(this.props.isCommenting){if(this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saving){var e=this.editor.getTags(),t=(e||[]).filter(function(e){return null==e.hashtag}),n=(e||[]).filter(function(e){return null!=e.hashtag}),a=this.editor.getJson();this.props.comment&&(0,h.populateMissingCollectionIDsInContent)(a,this.props.comment.subitems),this.props.submitCommentDraft((0,i.default)({},this.props.comment,{jsonContent:a,draftJsContent:(0,h.removeDataUrlsFromRawContent)((0,h.removeBrokenAtomicBlocksFromRawContent)((0,w.convertToRaw)(this.state.editorState.getCurrentContent()))),mentions:t,hashtags:n})),this.setState({draftIsDirty:!1})}}else this.cancelDraftSaveTimer()}}]),t}(u.Component),N=function(e,t,n,i,a){var o=void 0;return e.draftJsContent?("string"==typeof e.draftJsContent&&(e.draftJsContent=JSON.parse(e.draftJsContent)),o=(0,w.convertFromRaw)(e.draftJsContent)):e.jsonContent?o=(0,h.jsonContentToContentState)(e.jsonContent,t,n,i,e.subitems):(e.formattedContent||e.subitems)&&(o=R((0,h.formattedContentToContentState)(e.formattedContent,t,n,i),e.subitems)),w.EditorState.createWithContent(o,(0,h.getDecorator)(a))},R=function(e,t){return t&&t.forEach(function(t){e.createEntity("StreamCollection","IMMUTABLE",{collection:t});var n=w.EditorState.createWithContent(e);n=w.EditorState.moveSelectionToEnd(n),n=w.AtomicBlockUtils.insertAtomicBlock(n,e.getLastCreatedEntityKey()," "),e=n.getCurrentContent()}),e};A.propTypes={isCommenting:f.default.bool,isAddingComment:f.default.bool,restoreCommentEditorState:f.default.object,setIsCommenting:f.default.func.isRequired,submitItemComment:f.default.func.isRequired,setActionError:f.default.func.isRequired},t.default=A},547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(177),o=(i=a)&&i.__esModule?i:{default:i},r=n(223);t.default=function(e){var t=e.contentState,n=e.entityKey,i=e.children,a=e.onLinkPeek,s=t.getEntity(n).getData(),l=s.url,u=s.target,d=(s.title,s.text);return o.default.createElement("a",{className:"ka_statusupdate_link",target:u||"_blank",href:l,spellCheck:!1,onClick:function(e){a({position:(0,r.getLinkPeekPos)(e.target),text:d,url:l}),e.stopPropagation()}},i)}},548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(177)),a=o(n(179));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.contentState.getEntity(e.entityKey).getData(),n=t.entityID,o=t.entityType,r=t.hashtag,s=(t.entityName,t.hasProfile),l=void 0===s||s,u=t.isOpportunity,d=void 0!==u&&u;return l?i.default.createElement("a",{className:"ka_inlineTag",target:"_blank",spellCheck:!1,href:a.default.getResourceUrl(o||"Hashtag",n||r,d)},e.children):i.default.createElement("span",null,e.children)}},549:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendingHashtag=void 0;var i,a=n(177),o=(i=a)&&i.__esModule?i:{default:i};t.PendingHashtag=function(e){return o.default.createElement("a",{className:"ka_hashtag_link",spellCheck:!1},e.children)}},550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),a=f(n(182)),o=f(n(183)),r=f(n(184)),s=f(n(185)),l=n(177),u=f(l),d=n(179),c=f(d);function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={hovered:!1},n.onToggle=function(e){e.preventDefault(),n.props.onToggle(n.props.style)},n.onMouseOver=function(e){return n.setState({hovered:!0})},n.onMouseOut=function(e){return n.setState({hovered:!1})},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this,t="KAEditor-control KAEditor-styleButton";if(this.state.active&&(t+=" KAEditor-activeButton"),this.props.disabled&&(t+=" disabled"),this.props.icon){var n=this.props.shortcut?c.default.forOS(" (Ctrl+"+this.props.shortcut+")","(⌘"+this.props.shortcut+")"):"";return u.default.createElement("img",{src:""+d.imgRoot+this.props.icon+(this.props.disabled||!this.state.hovered&&!this.props.active?"":"_cyan")+".svg",className:t,onMouseDown:this.props.disabled?void 0:function(t){return 0===t.button?e.onToggle(t):t.preventDefault()},onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,title:this.props.tooltip+n})}return u.default.createElement("span",{className:t,onMouseDown:this.props.disabled?void 0:this.onToggle,title:this.props.tooltip},this.props.label)}}]),t}(l.Component);t.default=m},551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=j(n(206)),a=j(n(186)),o=j(n(222)),r=j(n(181)),s=j(n(182)),l=j(n(183)),u=j(n(184)),d=j(n(185)),c=n(177),f=j(c),m=j(n(187)),p=j(n(180));n(664),n(665),n(102),n(666);var h=n(220),g=j(n(272)),v=j(n(323)),y=n(667),E=j(n(327)),_=n(179),k=j(_),I=j(n(244)),S=j(n(191)),T=n(282),b=j(n(287)),C=j(n(286)),D=j(n(245)),M=j(n(246)),w=j(n(242)),P=n(211),L=j(n(204)),O=n(223),A=j(n(553)),N=j(n(554)),R=j(n(555)),x=j(n(556)),U=j(n(232)),B=j(n(328)),F=n(209),H=n(189);function j(e){return e&&e.__esModule?e:{default:e}}if(n(216)(S.default),n(668),null==V)var V=n(179).static_images;null==window.blogOptions&&(window.blogOptions={enableBlogging:!1});var W=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.state={isEditing:"boolean"==typeof e.isEditing&&e.isEditing,taggingFocused:!1,files:[],readOnly:!1},n.focus=n.focus.bind(n),n.blur=n.blur.bind(n),n.onChange=n.onChange.bind(n),n.onCancel=n.onCancel.bind(n),n.cancelClickHandler=n.cancelClickHandler.bind(n),n.clearSearch=n.clearSearch.bind(n),n.onAddTag=n.onAddTag.bind(n),n.onSearching=n.onSearching.bind(n),n.onSearched=n.onSearched.bind(n),n.handleReturn=n.handleReturn.bind(n),n.handleKeyCommand=n.handleKeyCommand.bind(n),n.onTab=n.onTab.bind(n),n.handleFiles=n.handleFiles.bind(n),n.onDrop=n.onDrop.bind(n),n.onDragOver=n.onDragOver.bind(n),n.onDragEnter=n.onDragEnter.bind(n),n.onDragLeave=n.onDragLeave.bind(n),n.handlePastedText=n.handlePastedText.bind(n),n.handlePastedFiles=n.handlePastedFiles.bind(n),n.swapPendingForCollection_image=n.swapPendingForCollection_image.bind(n),n.swapPendingForCollection=n.swapPendingForCollection.bind(n),n.removeBlock=n.removeBlock.bind(n),n.getBlockRenderer=n.getBlockRenderer.bind(n),n.onSelectFiles=n.onSelectFiles.bind(n),n.handleBeforeInput=n.handleBeforeInput.bind(n),n.checkPrecedingUrl=n.checkPrecedingUrl.bind(n),n.dragCounter=0,n.blockRenderMap=h.DefaultDraftBlockRenderMap.set("unordered-list-item",{element:"li",wrapper:f.default.createElement(oe,null)}).set("ordered-list-item",{element:"li",wrapper:f.default.createElement(re,null)}),n}return(0,d.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){if(L.default.msie){var e=m.default.findDOMNode(this.editor).getElementsByClassName("public-DraftEditor-content")[0];e.spellcheck=!0,e.addEventListener("DOMCharacterDataModified",function(e){if(!(e.newValue.length-e.prevValue.length<1)){var t=document.createEvent("Event");t.initEvent("input",e.bubbles,e.cancelable),t.data=e.data,t.inputMethod=e.inputMethod,e.target.parentNode.dispatchEvent(t)}})}}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"kaKeyBindingFn",value:function(e){return 75===e.keyCode&&h.KeyBindingUtil.hasCommandModifier(e)?"kaeditor-link":(0,h.getDefaultKeyBinding)(e)}},{key:"handleKeyCommand",value:function(e){var t=this;if("kaeditor-link"===e)return!this.props.disableRichText&&this.props.onEditLink&&this.props.onEditLink(),"handled";if(!this.props.disableRichText){var n=this.props.editorState,i=n.getSelection(),a=n.getCurrentContent(),r=a.getBlockForKey(i.getAnchorKey());if("split-block"===e&&"atomic"===r.getType()){var s=a.getBlockMap(),l=s.toSeq().takeUntil(function(e){return e===r}).toArray(),u=s.toSeq().skipUntil(function(e){return e===r}).rest().toArray(),d=new h.ContentBlock({key:(0,h.genKey)()}),c=[].concat((0,o.default)(l),[d,r],(0,o.default)(u));return this.onChange(h.EditorState.push(n,h.ContentState.createFromBlockArray(c).set("selectionBefore",a.getSelectionBefore()).set("selectionAfter",h.SelectionState.createEmpty(d.getKey())))),"handled"}if(("backspace"===e||"delete"===e)&&i.isCollapsed()&&"atomic"===r.getType()){var f=void 0;if("backspace"===e){var m=a.getBlockBefore(i.getAnchorKey());m&&(f=new h.SelectionState({anchorKey:m.getKey(),anchorOffset:m.getCharacterList().size,focusKey:m.getKey(),focusOffset:m.getCharacterList().size}))}else if("delete"===e){var p=a.getBlockAfter(i.getAnchorKey());p&&(f=new h.SelectionState({anchorKey:p.getKey(),anchorOffset:0,focusKey:p.getKey(),focusOffset:0}))}var g=z(r,n);Y(r,n);return g&&"Video"===g?this.setState({confirmRemoveVideo:function(){return t.removeAtomicBlock(n,r,f)}}):this.removeAtomicBlock(n,r,f),"handled"}if("backspace"===e&&i.isCollapsed()&&0===i.getAnchorOffset()){var v=a.getBlockBefore(i.getAnchorKey());if(null!=v&&"atomic"===v.getType())return 0===r.getCharacterList().size&&null!=a.getBlockAfter(i.getAnchorKey())&&(n=he(n,i.getAnchorKey())),this.onChange(ge(n,v.getKey())),"handled"}else if("delete"===e&&i.isCollapsed()&&i.getAnchorOffset()===r.getCharacterList().size){var y=a.getBlockAfter(i.getAnchorKey());if(null!=y&&"atomic"===y.getType())return 0===r.getCharacterList().size?(this.onChange(he(n,i.getAnchorKey(),h.SelectionState.createEmpty(y.getKey()))),window.setTimeout(function(){return t.selectBlock(y.getKey())},150)):this.selectBlock(y.getKey()),"handled"}var E=h.RichUtils.handleKeyCommand(n,e);if(E)return this.onChange(E),"handled"}return"not-handled"}},{key:"removeAtomicBlock",value:function(e,t,n,i){e=he(this.props.editorState,t.getKey(),n,i),n&&(e=h.EditorState.acceptSelection(e,n)),this.onChange(e)}},{key:"onTab",value:function(e){"handled"!==this.wrapper.onTab(e)&&this.onChange(h.RichUtils.onTab(e,this.props.editorState,4))}},{key:"onChange",value:function(e){var t=this,n=e.getCurrentContent();if(this.props.deleteTag){var i=this.getTags();if(null!=i&&i.length>0){var a=J(n),o=null==a?i[0]:i.find(function(e){return!k.default.tagsContains(a,e)});null!=o&&this.props.deleteTag(o)}}var r=e.getSelection(),s=n.hasText()||r.getHasFocus();if(this.state.isEditing||!s||this.props.readOnly||(this.setState({isEditing:s}),this.props.onStartEditing&&this.props.onStartEditing()),"atomic"!==n.getBlockForKey(r.getAnchorKey()).getType()&&"atomic"===this.props.editorState.getCurrentContent().getBlockForKey(this.props.editorState.getSelection().getAnchorKey()).getType()&&(e=h.EditorState.forceSelection(e,r)),this.props.onChange(e),this.state.taggingFocused||this.setState({suggestions:null,suggestionsFor:null}),this.clearTypeTimer(),r.getHasFocus()&&r.isCollapsed()){var l=ue(e),u=(l||"").trim();if(k.default.validateSearchText(u)){var d=window.setTimeout(function(){return k.default.runTagSearch(u,l,t.onSearching,t.onSearched)},500);this.setState({timer:d,suggestions:null,suggestionsFor:l})}else this.setState({searchingFor:null,suggestions:null,suggestionsFor:null})}else this.clearTypeTimer(),this.setState({searchingFor:null})}},{key:"clearTypeTimer",value:function(){null!=this.state.timer&&(window.clearTimeout(this.state.timer),this.setState({timer:null}))}},{key:"cancelClickHandler",value:function(){this.props.handleCancel&&this.props.handleCancel()||this.props.disableX||this.onCancel()}},{key:"onCancel",value:function(){this.onChange(h.EditorState.push(this.props.editorState,h.ContentState.createFromText(""))),this.setState({isEditing:!1}),this.props.onStopEditing&&this.props.onStopEditing()}},{key:"hasText",value:function(){return this.props.editorState.getCurrentContent().hasText()}},{key:"getText",value:function(){var e=this.props.editorState.getCurrentContent().getPlainText().trim();return""!==e?e:null}},{key:"getEntitizedText",value:function(){var e=de(this.props.editorState.getCurrentContent()).getPlainText().trim();return""!==e?e:null}},{key:"getHtml",value:function(){return null!==this.getText()?te(this.props.editorState):null}},{key:"getJson",value:function(){var e=this.props.editorState.getCurrentContent(),t=e.getBlocksAsArray();if(t.length>0){for(;t.length>0&&""===t[0].getText().trim()&&"atomic"!==t[0].getType();)t.splice(0,1);for(;t.length>0&&""===t[t.length-1].getText().trim()&&"atomic"!==t[t.length-1].getType();)t.splice(t.length-1,1);for(var n=[];t.length>0;){for(var i=t.splice(0,1),a=i[0].getType();t.length>0&&-1!=ee.indexOf(a)&&t[0].getType()===a;)i.push(t.shift());i.length>1?n.push($(i,e)):n.push(Q(i[0],e))}return n}return null}},{key:"getRaw",value:function(){return(0,h.convertToRaw)(this.props.editorState.getCurrentContent())}},{key:"getTags",value:function(){return J(this.props.editorState.getCurrentContent())}},{key:"restoreEditorState",value:function(e){this.onChange(e)}},{key:"onSearching",value:function(e,t){this.setState({searchingFor:e,suggestionsFor:t})}},{key:"onSearched",value:function(e,t){this.setState({suggestions:e,suggestionsFor:t,selectedSuggestion:0})}},{key:"clearSearch",value:function(){this.setState({searchingFor:null,suggestions:null,suggestionsFor:null})}},{key:"selectBlock",value:function(e,t){this.onChange(ge(this.props.editorState,e))}},{key:"handlePastedText",value:function(e,t){var n=this,i=this.props.editorState;if(!this.props.disableRichText&&e&&this.props.onEditLink){if(e=e.trim(),P.RE_VID_URL_ONLY.test(e)){var a=P.RE_VID_URL_ONLY.exec(e),o=a[1],r=a[2];r&&(r=parseInt(r));var s=i.getCurrentContent();s.createEntity("StreamCollection","IMMUTABLE",{collectionType:"Video",collection:{collectionType:"Video",collectionMembers:[{memberType:"Video",mediaID:o,memberData:r?{startTime:r}:void 0}]}});var l=s.getLastCreatedEntityKey(),u=h.AtomicBlockUtils.insertAtomicBlock(i,l," ");return this.onChange(h.EditorState.push(i,u.getCurrentContent(),"insert-fragment")),"handled"}if(P.RE_GIPHY_DIRECT.test(e)){var d=e.substring(0,e.lastIndexOf("/"));return d=d.substring(d.lastIndexOf("/")+1),S.default.get(e).responseType("blob").then(function(e){return n.handlePastedFiles([G(e,d)])}).catch(function(e){return(0,H.logError)(e)}),"handled"}if(P.RE_GIPHY_PAGE.test(e)){var c=e.lastIndexOf("-")>-1?e.substring(e.lastIndexOf("-")+1):e.substring(e.lastIndexOf("/")+1),f="https://media.giphy.com/media/"+c+"/giphy.gif";return S.default.get(f).responseType("blob").then(function(e){return n.handlePastedFiles([G(e,c)])}).catch(function(e){return(0,H.logError)(e)}),"handled"}if(P.RE_GIPHY_SHORT.test(e))return S.default.get("https://api-ssl.bitly.com/v3/expand").query({access_token:"e068abf43b0aae088864a8fb067601f71d9a6c4d",shortUrl:e}).then(function(e){var t=e.body.data.expand[0].long_url,i=t.lastIndexOf("-")>-1?t.substring(t.lastIndexOf("-")+1):t.substring(t.lastIndexOf("/")+1),a="https://media.giphy.com/media/"+i+"/giphy.gif";S.default.get(a).responseType("blob").then(function(e){return n.handlePastedFiles([G(e,i)])}).catch(function(e){return(0,H.logError)(e)})}).catch(function(e){return(0,H.logError)(e)}),"handled";if(P.RE_URL_ONLY.test(e)){this.props.uploadProps.onUploadStart({name:e});var m=i.getCurrentContent();m.createEntity("StreamCollection","IMMUTABLE",{url:e,collectionType:"Link"});var p=m.getLastCreatedEntityKey(),g=h.AtomicBlockUtils.insertAtomicBlock(i,p," ");return this.onChange(h.EditorState.push(i,g.getCurrentContent(),"insert-fragment")),"handled"}P.RE_URL_ANYWHERE.test(e)&&this.linkifyURLsAfterPaste()}return this.props.maxChars&&i.getCurrentContent().getPlainText().length+e.length>this.props.maxChars?(this.setState({alert:this.props.maxCharsAlert}),"handled"):"not-handled"}},{key:"handlePastedFiles",value:function(e){return this.handleFiles((0,O.adjustTargetBasedOnCursor)(this.props.editorState.getSelection(),this.props.editorState.getCurrentContent()),e),"handled"}},{key:"onSelectFiles",value:function(e,t){this.handleFiles((0,O.adjustTargetBasedOnCursor)(e,this.props.editorState.getCurrentContent()),t)}},{key:"handleFiles",value:function(e,t){var n=this;if(this.props.uploadProps){var i=t.filter(function(e){return e.type.match("image.*")}),a=[];i.forEach(function(e){a.push(e)}),a.length>0?a.forEach(function(i){n.loadImageData(i,function(){null==a.find(function(e){return void 0===e.dataUrl})&&n.insertFiles(e,t)})}):this.insertFiles(e,t)}}},{key:"insertFiles",value:function(e,t){var n=this,i={imagesTooLarge:[],docsTooLarge:[],filesBlocked:[],videosTooLarge:[]};t.forEach(function(t,o){t.type.match("image.*")&&"image/svg+xml"!==t.type&&"image/webp"!==t.type?t.size>F.INT_MAX_IMAGE_SIZE?i.imagesTooLarge.push(t):window.setTimeout(function(){n.insertAtomicBlock(e,null,"Image",[(0,a.default)(t,{index:0,status:I.default.PENDING,percent:0,src:null})],0===o)},0):t.type.match("video.*")?t.size>F.INT_MAX_VIDEO_SIZE?i.videosTooLarge.push(t):window.setTimeout(function(){n.insertAtomicBlock(e,null,"Video",[(0,a.default)(K(t),{index:0,status:I.default.PENDING,percent:0,fileObjectUrl:URL.createObjectURL(t)})],0===o)},0):t.size>262144e3?i.docsTooLarge.push(t):-1!==_.fileBlackList.indexOf(P.RE_FILE_EXTENSION.exec(t.name)[1])?i.filesBlocked.push(t):window.setTimeout(function(){n.insertAtomicBlock(e,null,"Document",[(0,a.default)(t,{index:0,status:I.default.PENDING,percent:0})],0===o)},0)}),(i.filesBlocked.length>0||i.docsTooLarge.length>0||i.imagesTooLarge.length>0||i.videosTooLarge.length>0)&&this.setState({fileAlerts:i})}},{key:"onDrop",value:function(e){var t=this;this.dragCounter=0,this.setState({dragOver:!1,dragOverEmpty:!1});var n=this.getBlockKeyForEvent(e);if(e.dataTransfer.files&&e.dataTransfer.files.length>0){for(var i=[],a=0;a<e.dataTransfer.files.length;a++)i.push(e.dataTransfer.files[a]);var o=n?new h.SelectionState({anchorKey:n,anchorOffset:0,focusKey:n,focusOffset:0}):null;this.handleFiles(o,i),e.preventDefault()}else{var r=e.dataTransfer.getData("Text");if(r&&r.length>10&&"kasubitem|"===r.substring(0,10)){var s=r.slice(10),l=this.props.editorState.getCurrentContent();if("atomic"===l.getBlockForKey(s).getType()){e.preventDefault();var u=(l=(0,h.convertFromRaw)((0,h.convertToRaw)(l))).getBlocksAsArray(),d=u.map(function(e){return e.getKey()}),c=d.indexOf(s),f=n?d.indexOf(n):u.length;c<f&&f--,"atomic"===(u=k.default.moveArrayElement(u,c,f))[u.length-1].getType()&&u.push(new h.ContentBlock({key:(0,h.genKey)()})),l=h.ContentState.createFromBlockArray(u,l.getEntityMap()),L.default.chrome&&null!=m.default.findDOMNode(this.editor).querySelector("iframe")?window.setTimeout(function(){t.onChange(ge(h.EditorState.push(t.props.editorState,l,"insert-fragment"),s))},100):this.onChange(ge(h.EditorState.push(this.props.editorState,l,"insert-fragment"),s))}}}this.setState({dragOver:!1})}},{key:"getBlockKeyForEvent",value:function(e){return-1===e.target.className.indexOf("public-DraftEditor-content")?g.default.decode((0,v.default)(e.target)).blockKey:null}},{key:"onDragOver",value:function(e){(window.draggingSubitem||(0,O.containsFiles)(e))&&e.preventDefault()}},{key:"onDragEnter",value:function(e){if(window.draggingSubitem||(0,O.containsFiles)(e)){e.preventDefault(),this.setState({dragOver:!0}),this.dragCounter++;var t=m.default.findDOMNode(this).querySelector(".ka_subitem.selected");t&&t.classList.remove("selected"),e.target.classList.contains("public-DraftEditor-content")&&this.setState({dragOverEmpty:!0})}}},{key:"onDragLeave",value:function(e){(window.draggingSubitem||(0,O.containsFiles)(e))&&(this.dragCounter--,e.target.classList.contains("public-DraftEditor-content")&&this.setState({dragOverEmpty:!1})),0===this.dragCounter&&this.setState({dragOver:!1})}},{key:"loadImageData",value:function(e,t){var n=new FileReader;n.onload=function(){(0,T.processDataUrl)(n.result,function(n){e.dataUrl=n,t()})},n.readAsDataURL(e)}},{key:"insertAtomicBlock",value:function(e,t,n,i,a){var o=q(this.props.editorState,e,a),r=o.getCurrentContent();r.createEntity("StreamCollection","IMMUTABLE",{collection:t,collectionType:n,files:i});var s=r.getLastCreatedEntityKey();o=h.AtomicBlockUtils.insertAtomicBlock(o,s," "),this.onChange(o)}},{key:"swapPendingForCollection_image",value:function(e,t,n){var i=this.props.editorState,o=i.getCurrentContent(),r=o.getEntity(e);null!=r.getData().collection&&(n=k.default.getMostRecent(r.getData().collection,returnedCollection));var s=r.getData().files[t].dataUrl;n.collectionMembers[0].mediaList=n.collectionMembers[0].mediaList.map(function(e){return e.sortOrder===t+1?(0,a.default)(e,{dataUrl:s}):e});var l=o.mergeEntityData(e,{collection:n,files:r.getData().files.filter(function(e){return e.index!=t})}),u=h.EditorState.push(i,l,"insert-fragment");u=h.EditorState.forceSelection(u,u.getSelection()),this.onChange(u)}},{key:"swapPendingForCollection",value:function(e,t,n){var i=this.props.editorState,a=i.getCurrentContent().mergeEntityData(e,{files:void 0,collectionType:void 0,collection:n}),o=h.EditorState.push(i,a,"insert-fragment");o=h.EditorState.forceSelection(o,o.getSelection()),this.onChange(o)}},{key:"removeBlock",value:function(e){this.onChange(he(this.props.editorState,e,null))}},{key:"onAddTag",value:function(e){var t=this;this.clearSearch();var n=this.props.editorState,i=n.getCurrentContent(),a=(i=i.createEntity("TAG","IMMUTABLE",e)).getLastCreatedEntityKey(),o=this.props.editorState.getSelection().getFocusOffset()-ue(this.props.editorState).length;i=h.Modifier.replaceText(i,n.getSelection().set("anchorOffset",o),e.entityName||e.hashtag,null,a),n=h.EditorState.push(this.props.editorState,i,"apply-entity"),this.onChange(n),this.props.addTag&&this.props.addTag(e),window.setTimeout(function(){if(document.getElementById("s4-workspace")){var e=document.getElementById("s4-workspace").scrollTop;t.editor.focus(),document.getElementById("s4-workspace").scrollTop=e}else{var n=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;t.editor.focus(),window.scrollTo(i,n)}},10)}},{key:"getBlockRenderer",value:function(e){var t=this;if("atomic"===e.getType()&&e.getCharacterList().count()>0){var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null==n)return console.warn("Atomic block without an entity"),"undefined"!=typeof newrelic&&newrelic.noticeError(new Error("Atomic block without an entity,"+clientID)),null;var i=n.getEntity(),o=this.props.editorState.getCurrentContent().getEntity(i);if("StreamCollection"===o.getType()){var r=o.getData(),s=this.props.editorState.getSelection().getAnchorKey()===e.getKey(),l=r.collectionType||r.collection.collectionType,u={collection:r.collection,onClick:function(n){return t.selectBlock(e.getKey())},isSelected:s};switch(l){case"Image":return{component:N.default,editable:!1,props:(0,a.default)(u,{handleClick:function(n,i){return t.selectBlock(e.getKey(),i),!0},files:r.files,collectionType:l,entityKey:i,uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection_image,removeBlock:function(){return t.removeBlock(e.getKey())},imageSize:this.props.imageSize})};case"Link":return{component:se,editable:!1,props:(0,a.default)(u,{selectedImageIndex:r.selectedImageIndex,onImageChange:function(e){t.props.editorState.getCurrentContent().mergeEntityData(i,{selectedImageIndex:e}),t.onChange(h.EditorState.forceSelection(t.props.editorState,t.props.editorState.getSelection()))},uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection,url:r.url,entityKey:i})};case"oEmbedContent":return{component:le,editable:!1,props:u};case"Document":return r.files&&r.files.length>0&&null==r.files[0].name?null:{component:A.default,editable:!1,props:(0,a.default)(u,{files:r.files,collectionType:l,entityKey:i,uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection,removeBlock:function(){return t.removeBlock(e.getKey())}})};case"Video":return{component:R.default,editable:!1,props:(0,a.default)(u,{files:r.files,collectionType:l,entityKey:i,uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection,removeBlock:function(){return t.removeBlock(e.getKey())},requestInputControl:function(){return t.setState({readOnly:!0})},releaseInputControl:function(){return t.setState({readOnly:!1})}})}}}}if("unordered-list-item"!==e.getType()&&"ordered-list-item"!==e.getType()&&!this.props.disableRichText)return{component:B.default}}},{key:"handleBeforeInput",value:function(e){var t=this.props.editorState;return"atomic"===t.getCurrentContent().getBlockForKey(t.getSelection().getAnchorKey()).getType()?"handled":this.props.maxChars&&t.getCurrentContent().getPlainText().length>=this.props.maxChars?(this.setState({alert:this.props.maxCharsAlert}),"handled"):(" "===e&&this.props.onEditLink&&this.checkPrecedingUrl(),"not-handled")}},{key:"handleReturn",value:function(e){return"handled"===this.wrapper.handleReturn(e)?"handled":(this.props.onEditLink&&this.checkPrecedingUrl(),this.props.disableLineBreaks?"handled":"not-handled")}},{key:"linkifyURLsAfterPaste",value:function(){var e=this;window.setTimeout(function(){return e.onChange(pe(e.props.editorState,e.props.editorState.getSelection()))},0)}},{key:"checkPrecedingUrl",value:function(){var e=this,t=this.props.editorState.getSelection();fe(this.props.editorState.getCurrentContent(),t)&&window.setTimeout(function(){return e.onChange(me(e.props.editorState,t,e.props.editorState.getSelection()))},0)}},{key:"render",value:function(){var e=this,t=this.props.editorState,n=("KAEditor-editor "+(this.props.className||"")).trim();this.state.dragOver&&(n+=" dragOver"),this.state.dragOverEmpty&&(n+=" dragOverEmpty"),this.props.disableRichText||(n+=" richText");var i=t.getCurrentContent();return i.hasText()||"unstyled"!==i.getBlockMap().first().getType()&&(n+=" KAEditor-hidePlaceholder"),f.default.createElement("div",null,f.default.createElement(E.default,{ref:function(t){return e.wrapper=t},mentions:this.props.mentions,hashtags:this.props.hashtags,suggestions:this.state.suggestions,searchingFor:this.state.searchingFor,suggestionsFor:this.state.suggestionsFor,onAddTag:this.onAddTag,clearSearch:this.clearSearch,onMouseDown:function(){return e.setState({taggingFocused:!0})},onMouseEnter:function(){return e.setState({taggingFocused:!0})},onMouseLeave:function(){return e.setState({taggingFocused:!1})}},f.default.createElement("div",{className:"KAEditor-root"+(this.props.readOnly?" readonly":""),style:this.props.style,onFocus:function(t){L.default.msie&&t.target.className.indexOf("KAEditor-root")>-1&&e.editor.focus()}},f.default.createElement("div",{className:n,onDrop:this.props.disableRichText||this.state.readOnly?void 0:this.onDrop,onDragOver:this.props.disableRichText||this.state.readOnly?function(e){return e.preventDefault()}:this.onDragOver,onDragEnter:this.props.disableRichText||this.state.readOnly?void 0:this.onDragEnter,onDragLeave:this.props.disableRichText||this.state.readOnly?void 0:this.onDragLeave},f.default.createElement(h.Editor,{ref:function(t){return e.editor=t},blockStyleFn:ae,blockRendererFn:this.getBlockRenderer,blockRenderMap:this.blockRenderMap,customStyleMap:ie,editorState:t,handleBeforeInput:this.handleBeforeInput,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.kaKeyBindingFn,onTab:this.onTab,stripPastedStyles:this.props.stripPastedStyles,onUpArrow:function(t){return e.wrapper.onUpArrow(t)},onDownArrow:function(t){return e.wrapper.onDownArrow(t)},onEscape:function(t){return e.wrapper.onEscape(t)},onBlur:this.props.onBlur,handleReturn:this.handleReturn,handleDroppedFiles:function(){return"handled"},handlePastedText:this.handlePastedText,handlePastedFiles:this.handlePastedFiles,onChange:this.onChange,placeholder:this.props.placeholder,readOnly:this.props.readOnly||this.state.readOnly,spellCheck:!0})),this.state.isEditing&&!this.props.hideX&&f.default.createElement("img",{title:"Cancel",className:"KAEditor-x",onClick:this.cancelClickHandler,src:V.cancel_11})),this.props.draftStatusMsg&&f.default.createElement("span",{className:"ka_draftStatusMsg"},this.props.draftStatusMsg)),this.state.alert&&f.default.createElement(D.default,{onClose:function(){return e.setState({alert:null})},title:this.state.alert.title,message:this.state.alert.message}),this.state.fileAlerts&&f.default.createElement(M.default,{onClose:function(){return e.setState({fileAlerts:null})},fileAlerts:this.state.fileAlerts}),this.state.confirmRemoveVideo&&f.default.createElement(w.default,{title:"Delete Video",message:"Are you sure you want to delete this video?",confirmText:"Delete",redConfirm:!0,onConfirm:function(){e.state.confirmRemoveVideo(),e.setState({confirmRemoveVideo:null})},onClose:function(){return e.setState({confirmRemoveVideo:null})}}))}}]),t}(c.Component),K=function(e){var t=/#|\?/gi;if(t.test(e.name)){var n=e.slice(0,e.size,e.type);return t.lastIndex=0,new File([n],e.name.replace(t,""),{type:e.type})}return e},G=function(e,t){if(void 0!==window.navigator.msSaveBlob){var n=new Blob([e.body],{type:e.type});return n.name=t+".gif",n}return new File([e.body],t+".gif",{type:e.type})},q=function(e,t,n){var i=n?t:e.getSelection(),a=e.getCurrentContent();if(i){var o=!0===i.getIsBackward()?i.anchorKey:i.focusKey,r=a.getKeyBefore(o);if(r)if(n){var s=a.getBlockForKey(r);i=new h.SelectionState({anchorKey:r,focusKey:r,anchorOffset:s.getCharacterList().size,focusOffset:s.getCharacterList().size})}else a.getBlockForKey(i.getAnchorKey()).getLength()>0&&(a=h.Modifier.splitBlock(a,i),e=h.EditorState.push(e,a,"split-block"));else i=new h.SelectionState({anchorKey:o,focusKey:o,anchorOffset:0,focusOffset:0})}else{var l=a.getLastBlock();i=new h.SelectionState({anchorKey:l.getKey(),anchorOffset:l.getCharacterList().size,focusKey:l.getKey(),focusOffset:l.getCharacterList().size})}return h.EditorState.acceptSelection(e,i)},z=function(e,t){var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null!=n){var i=n.getEntity(),a=t.getCurrentContent().getEntity(i);if("StreamCollection"===a.getType()){var o=a.getData();return o.collectionType||o.collection.collectionType}}},Y=function(e,t){var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null!=n){var i=n.getEntity(),a=t.getCurrentContent().getEntity(i);if("StreamCollection"===a.getType())if(null==a.getData().collection)return!0}return!1},J=function(e){var t=[];return e.getBlockMap().forEach(function(n){(0,O.findTagEntities)(n,function(i,a){t.push(e.getEntity(n.getEntityAt(i)).getData())},e)}),0==t.length?null:t},Q=function(e,t){switch(e.getType()){case"atomic":var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null==n)return X;var i=n.getEntity();if(null==i)return X;var o=t.getEntity(i).getData(),r=o.collection,s=o.selectedImageIndex;if(!r)return X;if("Link"===r.collectionType){var l=void 0;return r.collectionMembers[0].images&&r.collectionMembers[0].images.length>0&&null!=s&&-1!=s?l=[r.collectionMembers[0].images[s]]:r.collectionMembers[0].images&&r.collectionMembers[0].images.length>0&&null==s&&-1!=s&&(l=[r.collectionMembers[0].images[0]]),{type:r.collectionType,collectionID:r.collectionID,collection:(0,a.default)({},r,{collectionMembers:[(0,a.default)({},r.collectionMembers[0],{images:l,showEmbedLogo:l&&l.length>0&&l[0].isSPLogo})]})}}return"Image"===r.collectionType&&r.collectionMembers.forEach(function(e){return e.mediaList.forEach(function(e){return delete e.dataUrl})}),{type:r.collectionType,collectionID:r.collectionID,collection:r};default:var u=h.ContentState.createFromBlockArray([e]);return u=ce(e,t,u),{type:e.getType(),html:te(h.EditorState.createWithContent(u,ne))}}},X={type:"unstyled",html:"<div></div><br />"},$=function(e,t){var n=h.ContentState.createFromBlockArray(e);return e.forEach(function(e){return n=ce(e,t,n)}),{type:Z(e[0].getType()),html:te(h.EditorState.createWithContent(n,ne))}},Z=function(e){switch(e){case"ordered-list-item":return"ordered-list";case"unordered-list-item":return"unordered-list";default:return e}},ee=["ordered-list-item","unordered-list-item"],te=function(e){return(0,y.stateToHTML)(de(e.getCurrentContent()),{inlineStyles:ie}).replace(/\r?\n|\r/g,"").replace(/<p>/gi,"<div>").replace(/<\/p>/gi,"</div>").replace(/<br><\/div>/gi,"</div><br>").replace(/<br><\/h1>/gi,"</h1><br>").replace(/<br><\/h2>/gi,"</h2><br>")},ne=(0,O.getDecorator)(null),ie={};function ae(e){return e.getType(),null}var oe=function(e){function t(){return(0,s.default)(this,t),(0,u.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){return f.default.createElement(B.default,null,f.default.createElement("ul",{className:"public-DraftStyleDefault-ul"},this.props.children))}}]),t}(c.Component),re=function(e){function t(){return(0,s.default)(this,t),(0,u.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,d.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){return f.default.createElement(B.default,null,f.default.createElement("ol",{className:"public-DraftStyleDefault-ol"},this.props.children))}}]),t}(c.Component),se=function(e){var t=e.block,n=e.blockProps;return n.collection?f.default.createElement(U.default,{blockKey:t.getKey()},n.collection.collectionMembers.map(function(e,t){return f.default.createElement(b.default,(0,i.default)({link:e,isInEditor:!0},n,{key:t}))})):f.default.createElement(U.default,{blockKey:t.getKey()},f.default.createElement(x.default,n))},le=function(e){var t=e.block,n=e.blockProps,i=n.collection.collectionMembers,a=n.isSelected,o=n.onClick;return f.default.createElement(U.default,{blockKey:t.getKey()},f.default.createElement(C.default,{body:i[0].body,onClick:o,isSelected:a,isInEditor:!0}))},ue=function(e){var t=e.getSelection(),n=e.getCurrentContent().getBlockForKey(t.focusKey),i=t.getFocusOffset(),a=n.getText().substring(0,i),o=Math.max(a.lastIndexOf("@"),a.lastIndexOf("#"));if(-1===o)return null;if(0!==o&&" "!==a[o-1]&&" "!==a[o-1])return null;for(var r=a.substring(o),s=n.getCharacterList(),l=o;l<s.count()&&l<=i;l++)if(null!=s.get(l).getEntity())return null;return r},de=function(e){var t=[];return e.getBlockMap().forEach(function(n){(0,O.findTagEntities)(n,function(i,o){t.push((0,a.default)({blockKey:n.getKey(),start:i,end:o},e.getEntity(n.getEntityAt(i)).getData()))},e)}),t.sort(function(e,t){return t.start-e.start}).forEach(function(t){var n=t.blockKey,i=t.start,a=t.end;e=h.Modifier.replaceText(e,new h.SelectionState({anchorKey:n,anchorOffset:i,focusKey:n,focusOffset:a}),"{"+(t.entityType||"Hashtag")+"|"+(t.entityID||t.hashtag)+"}")}),e},ce=function(e,t,n){return e.findEntityRanges(function(e){return null!==e.getEntity()},function(i,a){var o=t.getEntity(e.getEntityAt(i)),r=(n=n.createEntity(o.getType(),o.getMutability(),o.getData())).getLastCreatedEntityKey();n=h.Modifier.applyEntity(n,new h.SelectionState({anchorKey:e.getKey(),anchorOffset:i,focusKey:e.getKey(),focusOffset:a}),r)}),n},fe=function(e,t){var n=e.getBlockForKey(t.getAnchorKey());if(!n.getEntityAt(t.getAnchorOffset())){var i=n.getText().substring(0,t.getAnchorOffset());if(P.RE_URL_END.test(i))return i.match(P.RE_URL_END)[0]}return null},me=function(e,t,n){var i=e.getCurrentContent(),a=fe(i,t);return i=i.createEntity("LINK","IMMUTABLE",{text:a,href:a,url:a,target:"_blank"}),i=h.Modifier.applyEntity(i,new h.SelectionState({anchorKey:t.getAnchorKey(),anchorOffset:t.getAnchorOffset()-a.length,focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset()}),i.getLastCreatedEntityKey()),h.EditorState.acceptSelection(h.EditorState.push(e,i,"apply-entity"),n)},pe=function(e,t){for(var n=e.getCurrentContent(),i=void 0,a=void 0;i=n.getBlockMap().find(function(e){for(P.RE_URL_EVERYWHERE.lastIndex=0;a=P.RE_URL_EVERYWHERE.exec(e.getText());)if(null==e.getEntityAt(a.index))return!0;return!1});)n=n.createEntity("LINK","IMMUTABLE",{text:a[0],url:a[0],target:"_blank"}),n=h.Modifier.applyEntity(n,new h.SelectionState({anchorKey:i.getKey(),anchorOffset:a.index,focusKey:i.getKey(),focusOffset:a.index+a[0].length}),n.getLastCreatedEntityKey());return h.EditorState.acceptSelection(h.EditorState.push(e,n,"apply-entity"),t)},he=function(e,t,n,i){n||(n=e.getSelection());var a=e.getCurrentContent();n.getAnchorKey()!==t&&n.getFocusKey()!==t||(n=new h.SelectionState({anchorKey:a.getKeyAfter(t),anchorOffset:0,focusKey:a.getKeyAfter(t),focusOffset:0}));var o=a.getBlockMap().delete(t);return i&&(e=h.EditorState.set(e,{allowUndo:!1})),e=h.EditorState.push(e,a.merge({blockMap:o,selectionAfter:n}),"remove-range"),i&&(e=h.EditorState.set(e,{allowUndo:!0})),e},ge=function(e,t){return k.default.isIE()||document.getSelection().removeAllRanges(),h.EditorState.forceSelection(e,h.SelectionState.createEmpty(t))};W.propTypes={editorState:p.default.object.isRequired,onStartEditing:p.default.func,onStopEditing:p.default.func,onCancel:p.default.func,onChange:p.default.func.isRequired,placeholder:p.default.string,hideX:p.default.bool,addTag:p.default.func,deleteTag:p.default.func,disableRichText:p.default.bool,disableLineBreaks:p.default.bool,style:p.default.object,maxChars:p.default.number,imageWidth:p.default.number,imageHeight:p.default.number},t.default=W},553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(240)),a=g(n(186)),o=g(n(181)),r=g(n(182)),s=g(n(183)),l=g(n(184)),u=g(n(185)),d=n(177),c=g(d),f=g(n(288)),m=n(211),p=g(n(232)),h=g(n(254));function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,r.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={},n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props.blockProps,n=t.collection,o=t.files,r=o&&o.length>1&&null==n;return null!=o&&o.length>0?c.default.createElement(p.default,{blockKey:this.props.block.getKey()},o.map(function(t,n){return c.default.createElement(h.default,{subItemType:e.props.blockProps.collectionType,file:t,key:n,autoStart:!r||0===t.index,uploadProps:(0,a.default)({},e.props.blockProps.uploadProps,{onUploadProgress:function(n,a){n&&e.setState((0,i.default)({},t.name,n)),e.props.blockProps.uploadProps.onUploadProgress&&e.props.blockProps.uploadProps.onUploadProgress(n,a)}}),swapPendingForCollection:e.props.blockProps.swapPendingForCollection,removeBlock:e.props.blockProps.removeBlock,entityKey:e.props.blockProps.entityKey},c.default.createElement(f.default,{document:{title:t.name,sourceAssetURL:"hmmm",documentType:m.RE_FILE_EXTENSION.exec(t.name)[1],fileSize:t.size,progress:e.state[t.name]||0},isSelected:e.props.blockProps.isSelected,inEditor:!0,onClick:e.props.blockProps.onClick}))})):null!=n?c.default.createElement(p.default,{blockKey:this.props.block.getKey()},n.collectionMembers.map(function(t,n){return c.default.createElement(f.default,{document:t,isSelected:e.props.blockProps.isSelected,key:n,inEditor:!0,onClick:e.props.blockProps.onClick})})):c.default.createElement("span",{style:{backgroundColor:"red"}},"broken block. see console. ",console.error(this.props.blockProps))}}]),t}(d.Component);t.default=v},554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(240)),a=h(n(186)),o=h(n(181)),r=h(n(182)),s=h(n(183)),l=h(n(184)),u=h(n(185)),d=n(177),c=h(d),f=h(n(281)),m=h(n(232)),p=h(n(254));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,r.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={},n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props.blockProps,n=t.collection,o=t.files,r=o&&o.length>1&&null==n;return null!=o&&o.length>0?c.default.createElement(m.default,{blockKey:this.props.block.getKey()},o.map(function(t,n){return c.default.createElement(p.default,{subItemType:e.props.blockProps.collectionType,file:t,key:n,autoStart:!r||0===t.index,imageSize:e.props.blockProps.imageSize,uploadProps:(0,a.default)({},e.props.blockProps.uploadProps,{onUploadProgress:function(n,a){n&&e.setState((0,i.default)({},t.name,n)),e.props.blockProps.uploadProps.onUploadProgress&&e.props.blockProps.uploadProps.onUploadProgress(n,a)}}),swapPendingForCollection:e.props.blockProps.swapPendingForCollection,removeBlock:e.props.blockProps.removeBlock,entityKey:e.props.blockProps.entityKey},c.default.createElement("div",{className:"ka_imgOutterBox"},c.default.createElement("div",{style:{display:"inline-block",position:"relative"},className:"ka_imgBox ka_subitem uploading"+(e.props.blockProps.isSelected?" selected":""),onClick:e.props.blockProps.onClick},c.default.createElement("img",{src:t.dataUrl,className:"ka_streamImg more",draggable:!1}),c.default.createElement("div",{className:"ka_imgUploadProgress"},c.default.createElement("div",{style:{width:(e.state[t.name]||0)+"%"}})))))})):null!=n?c.default.createElement(m.default,{blockKey:this.props.block.getKey()},c.default.createElement(f.default,{images:n.collectionMembers[0].mediaList.sort(function(e,t){return new Date(e.modDate)-new Date(t.modDate)}),isLessMode:!1,isSelected:this.props.blockProps.isSelected,key:"uploaded",handleClick:this.props.blockProps.handleClick,imageSize:this.props.blockProps.imageSize})):c.default.createElement("span",{style:{backgroundColor:"red"}},"broken block. see console. ",console.error(this.props.blockProps))}}]),t}(d.Component);t.default=g},555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(186)),a=g(n(181)),o=g(n(182)),r=g(n(183)),s=g(n(184)),l=g(n(185)),u=n(177),d=g(u),c=g(n(187)),f=g(n(249)),m=n(239),p=g(n(232)),h=g(n(254));function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={didUpload:n.props.blockProps.files&&n.props.blockProps.files.length>0},n.props.blockProps.files&&(n.state.file=n.props.blockProps.files[0]),n.setPlayPosition=n.setPlayPosition.bind(n),n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"setPlayPosition",value:function(e){this.pendingVid&&this.pendingVid.duration&&(this.pendingVid.currentTime=this.pendingVid.duration*(e/100))}},{key:"componentDidMount",value:function(){var e=this;if((this.kavid||this.pendingVid)&&this.setState({width:c.default.findDOMNode(this.kavid||this.pendingVid).clientWidth}),this.pendingVid){var t=c.default.findDOMNode(this.pendingVid);t.readyState>=2?(0,m.getPreviewImageBlob)(t,function(t){return e.setState({fallbackPoster:URL.createObjectURL(t)})}):t.addEventListener("loadeddata",function(){return(0,m.getPreviewImageBlob)(t,function(t){return e.setState({fallbackPoster:URL.createObjectURL(t)})})})}}},{key:"componentDidUpdate",value:function(){if(this.kavid||this.pendingVid){var e=c.default.findDOMNode(this.kavid||this.pendingVid).parentElement.parentElement.clientWidth;e<this.state.width&&this.setState({width:e})}}},{key:"render",value:function(){var e=this,t=this.props.blockProps,n=t.collection,a=t.files;if(null!=a&&a.length>0){var o=a[0];return d.default.createElement(p.default,{blockKey:this.props.block.getKey()},d.default.createElement(h.default,{subItemType:this.props.blockProps.collectionType,file:o,autoStart:0===o.index,uploadProps:(0,i.default)({},this.props.blockProps.uploadProps,{onUploadProgress:function(t,n){t&&(e.setState({percent:t}),e.setPlayPosition(t)),e.props.blockProps.uploadProps.onUploadProgress&&e.props.blockProps.uploadProps.onUploadProgress(t,n)}}),swapPendingForCollection:function(t,n,i){i.collectionMembers[0].originalWidth=e.state.originalWidth,i.collectionMembers[0].originalHeight=e.state.originalHeight,i.collectionMembers[0].duration=e.state.duration,i.collectionMembers[0].fileSize=o.size,i.collectionMembers[0].uploadedAt=(new Date).getTime(),e.props.blockProps.swapPendingForCollection(t,n,i)},removeBlock:this.props.blockProps.removeBlock,entityKey:this.props.blockProps.entityKey},d.default.createElement("div",{style:{display:"inline-block",position:"relative",width:this.state.width},className:"ka_vidBox ka_subitem uploading"+(this.props.blockProps.isSelected?" selected":""),onClick:this.props.blockProps.onClick},d.default.createElement("video",{src:o.fileObjectUrl,type:o.type,className:"uploadingStreamVid",ref:function(t){return e.pendingVid=t},onLoadedMetadata:function(){e.setState({duration:e.pendingVid.duration,aspectRatio:e.pendingVid.videoWidth/e.pendingVid.videoHeight,originalWidth:e.pendingVid.videoWidth,originalHeight:e.pendingVid.videoHeight})}}),d.default.createElement("div",{className:"ka_imgUploadProgress"},d.default.createElement("div",{style:{width:(this.state.percent||0)+"%"}})))))}if(null!=n){var r=void 0,s=n.collectionMembers[0].memberData;return s&&("string"==typeof s&&(s=JSON.parse(s)),r=s.startTime),d.default.createElement(p.default,{blockKey:this.props.block.getKey()},d.default.createElement("div",{className:"ka_vidBox ka_subitem"+(this.props.blockProps.isSelected?" selected":"")},d.default.createElement(f.default,{videoID:n.collectionMembers[0].mediaID,startTime:r,duration:this.state.duration||n.collectionMembers[0].duration,fileSize:this.state.file?this.state.file.size:n.collectionMembers[0].fileSize,uploadedAt:n.collectionMembers[0].uploadedAt,isSelected:this.props.blockProps.isSelected,onSelect:this.props.blockProps.onClick,processingStarted:this.props.blockProps.uploadProps.videoProcessingStarted,processingEnded:this.props.blockProps.uploadProps.videoProcessingEnded,fallbackPoster:this.state.fallbackPoster,requestInputControl:this.props.blockProps.requestInputControl,releaseInputControl:this.props.blockProps.releaseInputControl,aspectRatio:this.state.aspectRatio,width:this.state.width,ref:function(t){return e.kavid=t},didUpload:this.state.didUpload,inEditor:!0})))}return d.default.createElement("span",{style:{backgroundColor:"red"}},"broken block. see console.",console.error(this.props.blockProps))}}]),t}(u.Component);t.default=v},556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(186)),a=m(n(181)),o=m(n(182)),r=m(n(183)),s=m(n(184)),l=m(n(185)),u=n(177),d=m(u),c=m(n(179)),f=m(n(191));function m(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(){return(0,o.default)(this,t),(0,s.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;window.setTimeout(function(){var t=document.createElement("a");t.href=e.props.url;var n=t.host.toLowerCase();n.endsWith(":80")&&(n=n.slice(0,-3));var a=t.protocol;window.location.hostname.toLowerCase()===t.hostname.toLowerCase()?f.default.post("/_layouts/15/ShareSomething/pageScraper3.ashx").query({url:e.props.url}).end(function(t,n){if(t||!n.ok)console.error("failed to get link preview"),c.default.receivedAPIError(t||n.text);else{var a={collectionType:"Link",collectionMembers:[n.body.error?{url:e.props.url,title:decodeURI(e.props.url),isSharepoint:!0,memberType:"Link"}:(0,i.default)({},n.body,{images:n.body.images.filter(function(e){return null==e.error})})]};e.props.swapPendingForCollection(e.props.entityKey,0,a)}e.props.uploadProps.onUploadEnd({name:e.props.url})}):"undefined"==typeof openAssetoEmbedHosts||-1===openAssetoEmbedHosts.indexOf(n)&&-1===openAssetoEmbedHosts.indexOf(a+"//"+n)?-1===t.hostname.indexOf(".")?f.default.post("/_layouts/15/ShareSomething/pageScraper3.ashx").query({url:e.props.url}).end(function(t,n){if(t||!n.ok)console.error("failed to get link preview"),c.default.receivedAPIError(t||n.text);else{var a={collectionType:"Link",collectionMembers:[(0,i.default)({},n.body,{images:n.body.images.filter(function(e){return null==e.error})})]};e.props.swapPendingForCollection(e.props.entityKey,0,a)}e.props.uploadProps.onUploadEnd({name:e.props.url})}):f.default.post(apiUrl+"/subitem/url").query({url:e.props.url}).set({Authorization:"Bearer "+c.default.getToken()}).accept("application/json").end(function(t,n){t||!n.ok?(console.error("failed to get url preview"),c.default.receivedAPIError(t||n.text)):e.props.swapPendingForCollection(e.props.entityKey,0,n.body.results[0]),e.props.uploadProps.onUploadEnd({name:e.props.url})}):f.default.get("/_layouts/15/ShareSomething/getoEmbed.ashx").query({media_url:e.props.url,endpoint_url:t.protocol+"//"+t.host+"/Feed/OEmbed"}).end(function(n,i){var a={collectionType:"Link"};n||!i.ok?(console.error("failed to get OpenAsset preview"),a.collectionMembers=[{memberType:"Link",url:e.props.url,title:c.default.getOaLinkTitle(e.props.url),subtitle:t.host,images:[{src:static_images.openasset_225}]}]):a.collectionMembers=[{memberType:"Link",url:e.props.url,title:i.body.title,subtitle:t.host,subItemData:i.body,images:[{src:i.body.url||i.body.thumbnail_url},{src:static_images.openasset_225}]}],e.props.swapPendingForCollection(e.props.entityKey,0,a),e.props.uploadProps.onUploadEnd({name:e.props.url})})},0)}},{key:"render",value:function(){var e=this.props.url;try{e=decodeURI(this.props.url)}catch(e){console.log("error",e)}return d.default.createElement("a",{className:"ka_subitem ka_streamWebpage"+(this.props.isSelected?" selected":""),onClick:this.props.onClick},d.default.createElement("div",{style:{padding:10}},e))}}]),t}(u.Component);t.default=p},557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(181)),a=c(n(182)),o=c(n(183)),r=c(n(184)),s=c(n(185)),l=n(177),u=c(l),d=(c(n(187)),c(n(180)));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.onOpen,n=e.isOnLine;return u.default.createElement("div",{className:"",onDragEnter:n?t:void 0},u.default.createElement("div",{style:{height:32,paddingTop:10,paddingLeft:5,color:"#9197a3",cursor:"text"}},"Add a comment..."))}}]),t}(l.Component);f.propTypes={onOpen:d.default.func.isRequired},t.default=f},558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),a=f(n(182)),o=f(n(183)),r=f(n(184)),s=f(n(185)),l=n(177),u=f(l),d=f(n(180)),c=f(n(559));function f(e){return e&&e.__esModule?e:{default:e}}n(95);var m=function(e){function t(e){return(0,a.default)(this,t),(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.commentID,n=e.removeComment,i=e.onClose;return u.default.createElement(c.default,{onClose:i},u.default.createElement("div",{className:"modalTitle"},"Delete your comment?"),u.default.createElement("div",{style:{paddingTop:10,verticalAlign:"middle"}},u.default.createElement("div",null,u.default.createElement("input",{type:"button",value:"Delete Comment",className:"destructive",onClick:function(){n(t),i()}}),u.default.createElement("input",{type:"button",value:"Cancel",className:"cancel",onClick:function(){i()}}))))}}]),t}(l.Component);m.propTypes={commentID:d.default.number.isRequired,removeComment:d.default.func.isRequired,onClose:d.default.func.isRequired},t.default=m},559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(177),o=(i=a)&&i.__esModule?i:{default:i};t.default=function(e){var t=e.className,n=e.onClose,i=(e.isOpen,e.children),a=e.onLeft,r=e.onRight;return o.default.createElement("div",{className:"kamobilemodal-overlay",onClick:n},o.default.createElement("div",{className:"kamobilemodal-content "+t,onClick:function(e){e.stopPropagation()}},i),a&&o.default.createElement("img",{className:"kamobilemodal-left",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),a()}}),r&&o.default.createElement("img",{className:"kamobilemodal-right",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),r()}}))}},560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(478),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{mentions:n.mentions,hashtags:n.hashtags}},function(e){return{addTag:function(t,n){e((0,o.addItemTag)(n,t))},deleteTag:function(t,n){e((0,o.deleteItemTag)(n,t))}}})(s.default)},561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(181)),a=m(n(182)),o=m(n(183)),r=m(n(184)),s=m(n(185)),l=n(177),u=m(l),d=m(n(180)),c=m(n(179)),f=n(211);function m(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={text:""},n.clearInput=n.clearInput.bind(n),n.onBlur=n.onBlur.bind(n),n.onFocus=n.onFocus.bind(n),n.onChange=n.onChange.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.onKeyPress=n.onKeyPress.bind(n),n.checkForNewHashtag=n.checkForNewHashtag.bind(n),n.submitNewHashtag=n.submitNewHashtag.bind(n),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this;return u.default.createElement("input",{type:"text",className:this.props.className,ref:function(t){return e.input=t},onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeyDown,onKeyPress:this.onKeyPress,value:this.state.text,style:this.props.style,autoComplete:"off",readOnly:this.props.readOnly})}},{key:"onKeyDown",value:function(e){this.props.onKeyDown&&"handled"===this.props.onKeyDown(e)||9!==e.keyCode&&13!==e.keyCode&&32!==e.keyCode||this.checkForNewHashtag()&&(this.submitNewHashtag(),e.preventDefault())}},{key:"onKeyPress",value:function(e){this.checkForNewHashtag()&&f.RE_ILLEGAL_HASHTAG.test(String.fromCharCode(e.charCode))&&(e.preventDefault(),this.submitNewHashtag())}},{key:"checkForNewHashtag",value:function(){return this.state.text.length>1&&"#"===this.state.text[0]&&!f.RE_ILLEGAL_HASHTAG.test(this.state.text)}},{key:"submitNewHashtag",value:function(){this.props.onAddTag(g(this.state.text))}},{key:"onChange",value:function(e){var t=this;this.props.onChange&&this.props.onChange(e),null!=this.state.timer&&(window.clearTimeout(this.state.timer),this.setState({timer:null})),null!=h&&(h.abort(),h=null);var n=e.target.value;this.setState({text:n});var i=n.trim();if(c.default.validateSearchText(i)){var a=window.setTimeout(function(){return h=c.default.runTagSearch(i,n,t.props.onSearching,t.props.onSearched)},500);this.setState({timer:a})}else this.props.onCleared()}},{key:"onBlur",value:function(e){!this.props.taggingHovered&&this.checkForNewHashtag()&&this.submitNewHashtag(),this.props.onBlur&&this.props.onBlur(e),this.clearInput()}},{key:"onFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"clearInput",value:function(){this.setState({text:""})}},{key:"focus",value:function(){this.input.focus()}}]),t}(l.Component),h=void 0,g=function(e){return{hashtag:e,deleted:!1}};p.propTypes={onAddTag:d.default.func.isRequired,onCleared:d.default.func.isRequired},t.default=p},562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),a=f(n(182)),o=f(n(183)),r=f(n(184)),s=f(n(185)),l=n(177),u=f(l),d=f(n(674)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213));function f(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,a.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.onChange=n.onChange.bind(n),n.state={active:!0},n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"onChange",value:function(e){e&&(c.trackPostImpression(this.props.streamItem),this.setState({active:!1}))}},{key:"render",value:function(){return u.default.createElement(d.default,{active:this.state.active,onChange:this.onChange},this.props.children)}}]),t}(l.Component);t.default=m},563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(198),o=n(188),r=n(564),s=(i=r)&&i.__esModule?i:{default:i};t.default=(0,a.connect)(function(e,t){return{actionError:e.actionError}},function(e){return{onClose:function(){e((0,o.setActionError)())}}})(s.default)},564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(177)),a=o(n(245));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.actionError,n=e.onClose;return t?i.default.createElement(a.default,{title:"Jinkies! Something seems to have gone wrong...",message:"Give it another try. If this problem persists, please contact an administrator.",onClose:n}):null}},568:function(e,t,n){},585:function(e,t,n){var i={"./af":333,"./af.js":333,"./ar":334,"./ar-dz":335,"./ar-dz.js":335,"./ar-kw":336,"./ar-kw.js":336,"./ar-ly":337,"./ar-ly.js":337,"./ar-ma":338,"./ar-ma.js":338,"./ar-sa":339,"./ar-sa.js":339,"./ar-tn":340,"./ar-tn.js":340,"./ar.js":334,"./az":341,"./az.js":341,"./be":342,"./be.js":342,"./bg":343,"./bg.js":343,"./bm":344,"./bm.js":344,"./bn":345,"./bn.js":345,"./bo":346,"./bo.js":346,"./br":347,"./br.js":347,"./bs":348,"./bs.js":348,"./ca":349,"./ca.js":349,"./cs":350,"./cs.js":350,"./cv":351,"./cv.js":351,"./cy":352,"./cy.js":352,"./da":353,"./da.js":353,"./de":354,"./de-at":355,"./de-at.js":355,"./de-ch":356,"./de-ch.js":356,"./de.js":354,"./dv":357,"./dv.js":357,"./el":358,"./el.js":358,"./en-SG":359,"./en-SG.js":359,"./en-au":360,"./en-au.js":360,"./en-ca":361,"./en-ca.js":361,"./en-gb":362,"./en-gb.js":362,"./en-ie":363,"./en-ie.js":363,"./en-il":364,"./en-il.js":364,"./en-nz":365,"./en-nz.js":365,"./eo":366,"./eo.js":366,"./es":367,"./es-do":368,"./es-do.js":368,"./es-us":369,"./es-us.js":369,"./es.js":367,"./et":370,"./et.js":370,"./eu":371,"./eu.js":371,"./fa":372,"./fa.js":372,"./fi":373,"./fi.js":373,"./fo":374,"./fo.js":374,"./fr":375,"./fr-ca":376,"./fr-ca.js":376,"./fr-ch":377,"./fr-ch.js":377,"./fr.js":375,"./fy":378,"./fy.js":378,"./ga":379,"./ga.js":379,"./gd":380,"./gd.js":380,"./gl":381,"./gl.js":381,"./gom-latn":382,"./gom-latn.js":382,"./gu":383,"./gu.js":383,"./he":384,"./he.js":384,"./hi":385,"./hi.js":385,"./hr":386,"./hr.js":386,"./hu":387,"./hu.js":387,"./hy-am":388,"./hy-am.js":388,"./id":389,"./id.js":389,"./is":390,"./is.js":390,"./it":391,"./it-ch":392,"./it-ch.js":392,"./it.js":391,"./ja":393,"./ja.js":393,"./jv":394,"./jv.js":394,"./ka":395,"./ka.js":395,"./kk":396,"./kk.js":396,"./km":397,"./km.js":397,"./kn":398,"./kn.js":398,"./ko":399,"./ko.js":399,"./ku":400,"./ku.js":400,"./ky":401,"./ky.js":401,"./lb":402,"./lb.js":402,"./lo":403,"./lo.js":403,"./lt":404,"./lt.js":404,"./lv":405,"./lv.js":405,"./me":406,"./me.js":406,"./mi":407,"./mi.js":407,"./mk":408,"./mk.js":408,"./ml":409,"./ml.js":409,"./mn":410,"./mn.js":410,"./mr":411,"./mr.js":411,"./ms":412,"./ms-my":413,"./ms-my.js":413,"./ms.js":412,"./mt":414,"./mt.js":414,"./my":415,"./my.js":415,"./nb":416,"./nb.js":416,"./ne":417,"./ne.js":417,"./nl":418,"./nl-be":419,"./nl-be.js":419,"./nl.js":418,"./nn":420,"./nn.js":420,"./pa-in":421,"./pa-in.js":421,"./pl":422,"./pl.js":422,"./pt":423,"./pt-br":424,"./pt-br.js":424,"./pt.js":423,"./ro":425,"./ro.js":425,"./ru":426,"./ru.js":426,"./sd":427,"./sd.js":427,"./se":428,"./se.js":428,"./si":429,"./si.js":429,"./sk":430,"./sk.js":430,"./sl":431,"./sl.js":431,"./sq":432,"./sq.js":432,"./sr":433,"./sr-cyrl":434,"./sr-cyrl.js":434,"./sr.js":433,"./ss":435,"./ss.js":435,"./sv":436,"./sv.js":436,"./sw":437,"./sw.js":437,"./ta":438,"./ta.js":438,"./te":439,"./te.js":439,"./tet":440,"./tet.js":440,"./tg":441,"./tg.js":441,"./th":442,"./th.js":442,"./tl-ph":443,"./tl-ph.js":443,"./tlh":444,"./tlh.js":444,"./tr":445,"./tr.js":445,"./tzl":446,"./tzl.js":446,"./tzm":447,"./tzm-latn":448,"./tzm-latn.js":448,"./tzm.js":447,"./ug-cn":449,"./ug-cn.js":449,"./uk":450,"./uk.js":450,"./ur":451,"./ur.js":451,"./uz":452,"./uz-latn":453,"./uz-latn.js":453,"./uz.js":452,"./vi":454,"./vi.js":454,"./x-pseudo":455,"./x-pseudo.js":455,"./yo":456,"./yo.js":456,"./zh-cn":457,"./zh-cn.js":457,"./zh-hk":458,"./zh-hk.js":458,"./zh-tw":459,"./zh-tw.js":459};function a(e){var t=o(e);return n(t)}function o(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(i)},a.resolve=o,e.exports=a,a.id=585}}]);
//# sourceMappingURL=shareSomething.kaModules.js.map