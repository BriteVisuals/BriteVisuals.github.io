(window.webpackJsonp=window.webpackJsonp||[]).push([[10,1,4],{1000:function(e,t,n){(function(t){var i=n(680),o=n(480);e.exports=c;var r,a=/\n/g,s=/\\n/g;function l(){}function u(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function c(e){if(i.call(this,e),this.query=this.query||{},!r){var t=u();r=t.___eio=t.___eio||[]}this.index=r.length;var n=this;r.push(function(e){n.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=l)},!1)}o(c,i),c.prototype.supportsBinary=!1,c.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i.prototype.doClose.call(this)},c.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},c.prototype.doWrite=function(e,t){var n=this;if(!this.form){var i,o=document.createElement("form"),r=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=l,o.method="POST",o.setAttribute("accept-charset","utf-8"),r.name="d",o.appendChild(r),document.body.appendChild(o),this.form=o,this.area=r}function u(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=n.iframeId,i.src="javascript:0"}i.id=n.iframeId,n.form.appendChild(i),n.iframe=i}this.form.action=this.uri(),c(),e=e.replace(s,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,n(201))},1001:function(e,t,n){(function(t){var i,o,r=n(567),a=n(273),s=n(479),l=n(480),u=n(682),c=n(233)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)i=WebSocket;else if("undefined"!=typeof self)i=self.WebSocket||self.MozWebSocket;else try{o=n(1002)}catch(e){}var d=i||o;function f(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=i&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(d=o),r.call(this,e)}e.exports=f,l(f,r),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new d(e,t):new d(e):new d(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},f.prototype.write=function(e){var n=this;this.writable=!1;for(var i=e.length,o=0,r=i;o<r;o++)!function(e){a.encodePacket(e,n.supportsBinary,function(o){if(!n.usingBrowserWebSocket){var r={};if(e.options&&(r.compress=e.options.compress),n.perMessageDeflate)("string"==typeof o?t.byteLength(o):o.length)<n.perMessageDeflate.threshold&&(r.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,r)}catch(e){c("websocket closed before onclose event")}--i||s()})}(e[o]);function s(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}},f.prototype.onClose=function(){r.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},f.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===f.prototype.name)}}).call(this,n(464).Buffer)},1002:function(e,t){},1003:function(e,t){e.exports=function(e,t){for(var n=[],i=(t=t||0)||0;i<e.length;i++)n[i-t]=e[i];return n}},1004:function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},1005:function(e,t,n){},172:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStream=void 0;var i=k(n(234)),o=k(n(177)),r=n(187),a=n(198),s=n(569),l=k(n(577)),u=n(578),c=n(188),d=k(n(257)),f=k(n(743)),p=k(n(978)),m=k(n(979)),h=k(n(981)),g=k(n(563)),y=k(n(982)),v=k(n(179)),E=k(n(984));function k(e){return e&&e.__esModule?e:{default:e}}t.loadStream=function(e){v.default.isIE()&&n(1005),n(330),n(568);(0,u.createLogger)();var t=(0,s.compose)((0,s.applyMiddleware)(l.default))(s.createStore)(d.default),k="";if("object"===("undefined"==typeof localStorage?"undefined":(0,i.default)(localStorage)))try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(e){Storage.prototype._setItem=Storage.prototype.setItem,Storage.prototype.setItem=function(e,t){"apiToken"==e&&(k=t)},Storage.prototype._getItem=Storage.prototype.getItem,Storage.prototype.getItem=function(e){if("apiToken"==e)return k}}t.dispatch((0,c.getStreamConfig)()),v.default.validateToken(function(){t.dispatch((0,c.fetchItems)());var e=(0,E.default)("https://webnotifier.knowledge-architecture.com",{query:"notificationKey=NOTIFICATION_KEY",transports:["websocket","xhr-polling"]});e.on("NOTIFICATION",function(e){if("STREAMUPDATE"===e||"STREAMUPDATEFROMINDEXER"===e){var n=v.default.getToken();n&&"null"!==n?t.dispatch((0,c.fetchUpdatedItems)()):v.default.validateToken(function(){return t.dispatch((0,c.fetchUpdatedItems)())})}else console.log(e)}),e.emit("join",v.default.getClientID().toUpperCase())}),v.default.setupTokenCheckTimer(),(0,r.render)(o.default.createElement(a.Provider,{store:t},o.default.createElement("div",{style:{width:608}},o.default.createElement(h.default,null),o.default.createElement(g.default,null),o.default.createElement(p.default,null),o.default.createElement(m.default,null),o.default.createElement(f.default,{streamHolder:e}),o.default.createElement(y.default,null))),e)}},179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileBlackList=t.static_images=t.imgRoot=void 0;var i=c(n(222)),o=c(n(186)),r=c(n(191)),a=c(n(204)),s=n(211),l=n(208),u=n(189);function c(e){return e&&e.__esModule?e:{default:e}}var d={stopBubble:function(e){(e=e||window.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0},getResourceUrl:function(e,t,n){n=void 0!==n&&n;var i=e;"Project"===e&&n&&(i="Opportunity");var o=void 0;return"undefined"==typeof urlTemplates?"ka-synthesis://"+e+"/"+("Hashtag"===e?encodeURIComponent(t):t):("StreamItem"==e?o=urlTemplates.threadUrl+"?ItemID="+t:"Hashtag"==e?o=urlTemplates.topicUrl+"?Hashtag="+encodeURIComponent(t):"Community"==e?void 0!==urlTemplates.communityUrls?o=urlTemplates.communityUrls[t]:console.warn("communityUrls not part of urlTemplates. Check MasterPage version."):o=urlTemplates[i.toLowerCase()+"ProfileUrl"]+"?"+e+"="+encodeURIComponent(t),o)},getImageURL:function(e,t,n,i,o,r){r=void 0!==r&&r;var a=e;"Project"===e&&r&&(a="Opportunity"),o=null==o||o;var s=m;if("Document"===e||"SharepointListItem"===e)null!=f[t.toLowerCase()]?s+=f[t.toLowerCase()]+"_"+n+".png":s+="generic_"+n+".png";else if(null!=t&&""!=t&&"00000000-0000-0000-0000-000000000000"!=t){if("undefined"==typeof urlTemplates)return apiBaseUrl+"media/"+t+"/data/"+n+"w"+i+"h"+(o?"_fxd":"");s=urlTemplates.imageProxyUrl+"?id="+t+"&size="+n+"w"+(i||n)+"h"+(o?"_fxd":"")}else null!=p[e]?s+=p[e]:s="/_layouts/15/Images/MediaProxy/Entities/"+a+"_"+n+".png";return s},getGifURL:function(e){return"undefined"==typeof urlTemplates?apiBaseUrl+"media/"+e+"/data/anim":urlTemplates.imageProxyUrl+"?id="+e+"&size=anim&dl=1"},separate:function(e,t){return 0===e.length?[]:e.slice(1).reduce(function(e,n,i){return e.concat([t,n])},[e[0]])},getLikeStatus:function(e){return null!=e&&e.filter(function(e){return(e.author?e.author.employeeID.toLowerCase():e.authorID.toLowerCase())===employeeID.toLowerCase()}).length>0},entityRegex:/{([^\{]*)\|([^\{\}\|]*)\}/g,replaceInlineTagsWithLink:function(e,t,n,i){return n=n||[],null==e?null:e.replace(this.entityRegex,function(e,o,r){if("Hashtag"===o){if(null==i)return r;var a=i.find(function(e){return e.hashtag.toLowerCase()===r.toLowerCase()});return a&&!a.deleted?"<a href='"+d.getResourceUrl(o,r)+"' class='ka_hashtag_link' entityType='"+o+"' entityID='"+r+"'>"+(a.hashtag||e)+"</a>":a?a.hashtag:r}if("Employee"===o){var s=void 0;if(Array.isArray(t)?s=t.find(function(e){return e.employeeID.toLowerCase()==r.toLowerCase()}):null!=t&&t.employeeID.toLowerCase()===r.toLowerCase()&&(s=t),null!=s)return"Y"!==s.showInCompanyDirectory||s.deleted?s.fullName:"<a href='"+d.getResourceUrl(o,r)+"' class='ka_mention_link' entityType='"+o+"' entityID='"+r+"'>"+(s.fullName||e)+"</a>"}var l=n.find(function(e){return e.entityType===o&&("string"==typeof e.entityID?e.entityID.toLowerCase()===r.toLowerCase():e.entityID===r)});return l&&l.hasProfile?"<a href='"+d.getResourceUrl(o,r,l.isOpportunity)+"' class='ka_mention_link' entityType='"+o+"' entityID='"+r+"'>"+(l.entityName||e)+"</a>":l&&l.entityName||e})},replaceInlineTagsWithText:function(e,t){return null==e?null:e.replace(this.entityRegex,function(e,n,i){if("Hashtag"===n)return i;if(null==t)return e;var o=t.find(function(e){return e.entityType===n&&e.entityID.toLowerCase()===i.toLowerCase()});return o?o.entityName:e})},blogImgRegex:/<img[^>]+src="([^"\s]+media\/proxy.ashx\?id=([a-zA-Z0-9-]+)&[amp;]*size=([0-9hw]+))"[^>]*>/g,replaceBlogImageUrls:function(e){return null==e?null:e.replace(this.blogImgRegex,function(e,t,n,i){return e.replace(t,apiBaseUrl+"media/"+n+"/data/"+i)})},getTagForLink:function(e,t,n,i,o,r){var a={entityType:e,entityID:t,entityName:e,hasProfile:!0,isOpportunity:!1};if("Hashtag"===e){if(a.entityName=t,null!=o){var s=o.find(function(e){return e.hashtag===t});null!=s&&(a.hasProfile=s.availableTopic||a.hasProfile)}}else if("Employee"===e&&null!=n&&t==n.employeeID)a.entityName=n.fullName,a.hasProfile="Y"===n.showInCompanyDirectory&&!n.deleted;else if("Employee"===e&&null!=r&&t==r.employeeID)a.entityName=r.fullName,a.hasProfile="Y"===r.showInCompanyDirectory&&!r.deleted;else if(null!=i){var l=i.find(function(n){return n.entityType===e&&n.entityID.toLowerCase()===t.toLowerCase()});null!=l&&(a.entityName=l.entityName,a.hasProfile=l.hasProfile,a.isOpportunity=l.isOpportunity)}return a},getMobileItemIDValue:function(){var e;return(e=window.location.pathname.split("/"))[e.length-2]},isEditPost:function(){return window.location.pathname.endsWith("EditPost.aspx")&&null!=(0,u.getQueryStringValue)("ItemID")},isEditDraft:function(){return window.location.pathname.endsWith("EditDraft.aspx")&&null!=(0,u.getQueryStringValue)("ItemID")},getToken:function(){try{return localStorage.getItem("apiToken")}catch(e){return $window.sessionStorage.apiToken}},getProfileUrl:function(e,t,n){n=void 0!==n&&n;var i=e;return"Project"===e&&n&&(i="Opportunity"),urlTemplates[i.toLowerCase()+"ProfileUrl"]+"?"+e+"="+t},validateToken:function(e){var t=this,n=this.getToken();if(n)if(null==n||"null"===n)conosle.warn("removing null token",{storage:n}),this.deleteToken();else{if(this.isTokenRecent(n)&&this.isTokenForCurrentUser(n))return void(e&&e());console.warn("removing expired or wrong user token"),this.deleteToken()}if(e&&this.waitForToken(e),!window.waitingForToken){window.waitingForToken=!0;var i=void 0;i=urlTemplates.tokenProxyUrl?urlTemplates.tokenProxyUrl:"/_layouts/15/NexusAPIProxy/GetToken.ashx",r.default.get(i).withCredentials().end(function(e,n){try{if(e||!n.ok)t.receivedAPIError(e);else if(n.body)if(n.body.error)t.receivedAPIError((0,o.default)({},n.body.error,{url:i}));else{try{localStorage.setItem("apiToken",n.body.results[0])}catch(e){"undefined"!=typeof $window?$window.sessionStorage.apiToken=n.body.results[0]:(0,u.logError)(e)}t.gotTokenAsync(n.body.results[0])}else t.receivedAPIError({message:n.text});window.waitingForToken=!1}catch(e){(0,u.logError)(e),window.waitForToken=!1,t.validateToken()}})}},deleteToken:function(){localStorage.removeItem("apiToken")},waitForToken:function(e){window.addEventListener("gotApiToken",function t(n){e(),window.removeEventListener("gotApiToken",t)},!1)},setupTokenCheckTimer:function(){if(null==window.tokenTimer){var e=this;window.tokenTimer=window.setInterval(function(){return e.validateToken()},3e4)}},gotTokenAsync:function(e){this.dispatchEvent("gotApiToken",{token:e})},dispatchEvent:function(e,t){if("function"==typeof CustomEvent)window.dispatchEvent(new CustomEvent(e,{detail:t}));else{var n=document.createEvent("CustomEvent");n.initCustomEvent(e,!0,!0,t),window.dispatchEvent(n)}},isTokenRecent:function(e){return!(JSON.parse(atob(e.split(".")[1])).exp<=~~(Date.now()/1e3)+120)},isTokenForCurrentUser:function(e){var t=JSON.parse(atob(e.split(".")[1]));return t.EmployeeID.toUpperCase()===employeeID.toUpperCase()&&t.KA_ClientID.toUpperCase()===clientID.toUpperCase()||(console.error("Not my token!"),!1)},getAuthHeader:function(){return{Authorization:"Bearer "+this.getToken()}},isSPAdmin:function(){var e=this.getToken();if(e){var t=JSON.parse(atob(e.split(".")[1])).role;if(null!=t){if("string"==typeof t&&"SPAdmin"===t)return!0;if(t.constructor===Array&&t.length>0&&t.indexOf("SPAdmin")>-1)return!0}}return!1},isHome:function(){return"/"===urlTemplates.communityUrls[communityID]},getClientID:function(){var e=this.getToken();return e?JSON.parse(atob(e.split(".")[1])).KA_ClientID:window.clientID},runTagSearch:function(e,t,n,i){var o=this,a="Tags";return"@"===e[0]&&(e=e.substring(1),a="Mentions"),"#"===e[0]&&(a="Hashtag"),n(e,t),r.default.get(apiUrl+"/v5/search/tag?queryText="+encodeURIComponent(e)+"&tagSearchType="+a).authBearer(this.getToken()).withCredentials().end(function(e,r){n(null),e||!r.ok?o.receivedAPIError(e||r.text):i(r.body,t)})},getMaxModDate:function(e,t,n,o,r){return null==e||0===e.length?null:[].concat((0,i.default)(e),(0,i.default)(t),(0,i.default)(n),(0,i.default)(o),(0,i.default)(r)).map(function(e){return e.modDate}).sort(function(e,t){return new Date(t)-new Date(e)})[0]},getMostRecent:function(e,t){return new Date(e.modDate)>new Date(t.modDate)?e:t},handleResponseErrors:function(e){if(!e.ok)throw Error(e.statusText);return e},receivedAPIError:function(e){(0,u.logError)(e)},logVideoTranscode:function(e,t,n,i){r.default.post("https://browserlogger.knowledge-architecture.com/api/videowait?code=WwYwRC8dHI6jA9QRcCeXmF/2BZTYwyvqCq3AQ87Ph9sxY47maDIT3A==").send({clientID:clientID,employeeID:employeeID,time:(new Date).getTime(),transcodeJob:{videoID:e,fileSize:t,duration:n,transcodeMs:i}}).end(function(){})},buildErrorLogMessage:function(e,t){var n=(0,o.default)(this.buildLogMessage(),{url:e.url,error:{name:e.name,message:e.message,fileName:e.fileName,lineNumber:e.lineNumber,columnNumber:e.columnNumber,stack:e.stack},item:t});return e.response&&(n.apiResponse="("+e.status+") "+e.response.statusText,e.response.req&&e.response.req.toJSON&&(n.apiRequest=e.response.req.toJSON())),n},buildLogMessage:function(){return{clientID:clientID,employeeID:employeeID,url:window.location.href,time:(new Date).getTime(),browser:{name:a.default.name,version:a.default.version}}},htmlToText:function(e){var t=document.createElement("DIV");return t.innerHTML=e,this.removeChildElements(t),(t.innerText||t.textContent||"").trim()},removeChildElements:function(e){for(var t=0;t<e.children.length;t++)this.removeChildElements(e.children[t]);if(e.parentElement){var n=void 0;n=["style"].indexOf(e.nodeName.toLowerCase())>-1?"":["br"].indexOf(e.nodeName.toLowerCase())>-1?"\n":["p","h1","h2","h3","h4","h5","h6","ol","ul","pre","address","blockquote","dl","div","fieldset","form","hr","noscript","table"].indexOf(e.nodeName.toLowerCase())>-1?(e.innerText||e.textContent||"")+"\n":e.innerText||e.textContent||"",e.parentElement.replaceChild(document.createTextNode(n),e)}},getEntityRanges:function(e){for(var t=[],n=void 0;null!=(n=this.entityRegex.exec(e));)t.push({start:n.index,end:n.index+n[0].length-1});return t},reverseString:function(e){for(var t="",n=e.length-1;n>=0;n--)t+=e[n];return t},ellipsizeTextAt:function(e,t,n){var i=!1;if(n){var o=/[\.!\?](?=\W)|.{1}$/m.exec(e);o&&o.index!=e.length-1&&(e=e.substring(0,o.index+1),i=!0)}if(e.length>t){var r=this.getEntityRanges(e).find(function(e){return e.start<t-1&&e.end>=t-1});if(null==r){var a=/\W/m;-1===(e=e.substring(0,t-1))[e.length-1].search(a)&&(e=e.substring(0,e.length-this.reverseString(e.search(a))-1))}else e=e.substring(0,r.end+1);i=!0}return i&&((e=this.trimTrailingPunctuation(e)).endsWith("&hellip;")||e.endsWith("…")||e.endsWith("...")||(e+="&hellip;")),e},trimTrailingPunctuation:function(e){e=e.replace("&nbsp;"," ");for(var t=[".","!","?"," "];-1!==t.indexOf(e[e.length-1]);)e=e.substring(0,e.length-1);return e},getTextFromHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent},getEntityID:function(e){return e.entityID||e[e.entityType.toLowerCase()+"ID"]},getEntityName:function(e){return e.entityName||e.fullName||e[e.entityType.toLowerCase()+"Name"]},getEntityInDirectory:function(e){return"Employee"===e.entityType?e.showInCompanyDirectory:"Company"===e.entityType?e.showInCompaniesDirectory:e["showIn"+e.entityType+"Directory"]},validateSearchText:function(e){if(null==e||""===e||"@"===e||"#"===e)return!1;var t=e[0];if("#"===t&&s.RE_ILLEGAL_HASHTAG.test(e))return!1;if("#"===t||"@"===t){if(e.length<=2)return!1}else if(e.length<=1)return!1;return!0},forOS:function(e,t,n){return-1!=navigator.appVersion.indexOf("Win")?e:-1!=navigator.appVersion.indexOf("Mac")?t:n},isIE:function(){return a.default.msie},isOldIE:function(){return a.default.msie&&a.default.version<10},formatDateTimeStamp:function(e){null!=e&&"Z"!==e[e.length-1]&&(e+="Z");var t=new Date(e),n=new Date,i=void 0;if(t>new Date(n-1e3))i="just now";else if(t>new Date(n-6e4))i=Math.round((n-t)/1e3)+" sec";else if(t>new Date(n-36e5))i=Math.round((n-t)/6e4)+" min";else if(t>new Date(n-864e5))i=Math.round((n-t)/36e5)+"h";else{var o=t.getFullYear()!=n.getFullYear()?", "+t.getFullYear().toString():"";i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]+" "+t.getDate()+o}return i},decodeHTMLEntities:function(e,t){return e&&"string"==typeof e&&(e=(e=e.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),null==t&&(t=document.createElement("div")),t.innerHTML=e,e=t.textContent),e},getOaLinkTitle:function(e){var t="OpenAsset",n=document.createElement("a");return n.href=e,n.pathname.endsWith(".jpg")?t+" - Image":n.pathname.endsWith("ImageLink")?t+" - Image Info":n.pathname.endsWith("ProjectLink")?t+" - Project":t},isUrlOpenAsset:function(e){var t=document.createElement("a");return t.href=e,-1!==openAssetoEmbedHosts.indexOf(t.host.toLowerCase())},tagsContains:function(e,t){return null!=this.findTag(e,t)},findTag:function(e,t){return e.find(function(e){return t.entityType===e.entityType&&t.entityID===e.entityID&&t.hashtag===e.hashtag})},moveArrayElement:function(e,t,n){if(n>=e.length)for(var i=n-this.length;1+i--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e},getOffsetFromAncestorS4Workspace:function(e){var t=0;do{t+=e.offsetTop,e=e.offsetParent}while("s4-workspace"!==e.id&&"BODY"!==e.nodeName);return t},fixBlurInCenteredElement:function(e){e.clientWidth%2==1&&(e.style.width=e.clientWidth+1+"px"),e.clientHeight%2==1&&(e.style.height=e.clientHeight+1+"px")},compensateScrollPosition:function(e,t,n){if(document.getElementById("s4-workspace")){var i=document.getElementById("s4-workspace"),o=d.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-i.scrollTop;n(),window.setTimeout(function(){var e=t(),n=d.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-i.scrollTop;i.scrollTop=Math.max(i.scrollTop-(o-n),0)},100)}else{var r=d.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-(window.pageYOffset||document.documentElement.scrollTop);n(),window.setTimeout(function(){var e=t(),n=window.pageYOffset||document.documentElement.scrollTop,i=d.getOffsetFromAncestorS4Workspace(e)+e.clientHeight-n,o=window.pageXOffset||document.documentElement.scrollLeft;window.scrollTo(o,Math.max(n-(r-i),0))},100)}},isUserBroken:function(){return"0"===currentEmployee.employeeID||"N"===currentEmployee.showInCompanyDirectory},draftSaveStatusText:function(e,t,n,i){if(!n)return"Saved";if(t||i)return"Saving...";switch(e){case l.draftSaveStatuses.saving:return"Saving...";case l.draftSaveStatuses.saved:return"Saved";default:return""}},uniqueItems:function(e){for(var t={},n=[],i=0;i<e.length;i++)t[e[i].itemID]||(t[e[i].itemID]=!0,n.push(e[i]));return n},findAncestor:function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e},pickFrom:function(e,t){if(1==t)return[e[0]];for(var n=[],i=(e.length-1)/(t-1),o=void 0,r=0;t--;)o=Math.round(r),n.push(e[o]),r+=i;return n},outterHeight:function(e){e="string"==typeof e?document.querySelector(e):e;var t=window.getComputedStyle(e),n=parseFloat(t.marginTop)+parseFloat(t.marginBottom);return Math.ceil(e.offsetHeight+n)},removeVideosInContentEditors:function(){if(document.querySelectorAll('div[contenteditor="True"] ka-video').forEach(function(e){return e.parentNode.removeChild(e)}),"undefined"!=typeof _spPageContextInfo){var e='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">                      <soap:Body>                          <GetWebPartProperties2 xmlns="http://microsoft.com/sharepoint/webpartpages">                              <pageUrl>'+location.pathname+"</pageUrl>                               <storage>Shared</storage>                               <behavior>Version3</behavior>                           </GetWebPartProperties2>                      </soap:Body>                   </soap:Envelope>";r.default.post(_spPageContextInfo.webAbsoluteUrl+"/_vti_bin/WebPartPages.asmx").type("xml").send(e).then(function(e){for(var t=(new DOMParser).parseFromString(e.text,"text/xml").getElementsByTagName("WebPart"),n=0;n<t.length;n++){var i=t[n];"Microsoft.SharePoint.WebPartPages.ContentEditorWebPart"===(i.getElementsByTagName("TypeName").length>0?i.getElementsByTagName("TypeName")[0].childNodes[0].nodeValue:i.getElementsByTagName("type")[0].getAttribute("name"))&&document.querySelectorAll('div[webpartid="'+i.getAttribute("ID")+'"] ka-video').forEach(function(e){return e.parentNode.removeChild(e)})}}).catch(function(e){return console.warn(e)})}},generateSimpleID:function(){return Math.floor(65536*(1+Math.random()))}},f={aspx:"wiki",bmp:"image",png:"image",doc:"word",docx:"word",gif:"image",jpeg:"image",jpg:"image",pdf:"pdf",ppt:"ppt",pptx:"ppt",xls:"xls",xlsx:"xls",csv:"xls",wmv:"video",avi:"video",mp4:"video",mov:"video"},p={Community:"communityIcon_25_v2.png",Hashtag:"topicIcon_25.png",OtherResult:"GenericDocument_25_v2.png",SharepointList:"List_25.png",SharepointListItem:"GenericDocument_25_v2.png",SharepointNavItem:"linkIcon_25_v2.png",Link:"linkIcon_25_v2.png",ExternalLink:"linkIcon_25_v2.png",SharepointVideo:"videoIcon_25_v2.png",StreamItem:"Posts_25.png",Video:"videoIcon_25_v2.png",WikiPage:"wikiIcon_25_v2.png"},m=t.imgRoot="https://kamedia3.knowledge-architecture.com/images/";t.static_images={like_off_20:m+"like_off_20.png",like_on_20:m+"like_on_20.png",comment_20:m+"comment_20.png",cancel_11:m+"cancel_11.png",less_caret_cyan_14:m+"less_caret_cyan_14.png",more_caret_cyan_14:m+"more_caret_cyan_14.png",spinner_16:m+"spinner_16.gif",ajax_loader_32:m+"ajax_loader_32.gif",right_caret_dk_grey_7:m+"right_caret_dk_grey_7.png",more_caret_dk_grey_14:m+"more_caret_dk_grey_14.png",more_caret_lt_grey_14:m+"more_caret_lt_grey_14.png",link_grey_16:m+"link_grey_16.png",link_cyan_16:m+"link_cyan_16.png",camera_grey_24:m+"camera_grey_24.png",camera_cyan_24:m+"camera_cyan_24.png",play_grey_18:m+"play_grey_18.png",play_cyan_18:m+"play_cyan_18.png",paperclip_grey_10:m+"paperclip_grey_10.png",paperclip_cyan_10:m+"paperclip_cyan_10.png",ellipsis:m+"ellipsis.png",ellipsis_cyan:m+"ellipsis_cyan.png",upArrow_grey_24:m+"upArrow_grey_24.png",upload_16:m+"upload_16.png",upload_16_cyan:m+"upload_16_cyan.png",right_white_7:m+"right_white_7.png",left_white_7:m+"left_white_7.png",openasset_225:m+"openasset_225.png",pencil_16:m+"pencil_16.png",pencil_black_24:m+"pencil_black_24.png",yield_16:m+"yield_16.png",sharepoint_gray:m+"sharepoint_gray.png",word_post_editor:m+"word_post_editor.png",close_x_white_sm:m+"close_x_white_sm.svg",embed_code_cyan:m+"embed_code_cyan.png",image:m+"image.svg",image_cyan:m+"image_cyan.svg",help_dark:m+"help_dark.png",share_white_20:m+"share_white_20.png"},t.fileBlackList=["bat","cmd","csh","dll","exe","htr","lnk","msi","pl","ps1","ps2","psc1","psc2","reg","scf","shb","url","svc","vb","vbe","vbs","cpl","aspx","asmx","ashx","json","soap","ascx","master","swf","jar","xap"];t.default=d},188:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildThreadUrl=t.buildReqUrl=t.SAVED_COMMENT_DRAFT=t.SET_DRAFT_STATUS=t.SET_WARN_BROKEN_USER=t.SET_WARN_OFFLINE=t.SET_IS_ONLINE=t.SET_ACTION_ERROR=t.UPDATED_ITEM_PUBLISHED=t.UPDATED_ITEM_PROMOTTION=t.RESTORE_COMMENT_EDITOR=t.UPDATED_ITEM_COMMENT=t.UPDATE_ITEM_COMMENT=t.ADDED_ITEM_COMMENT=t.ADD_ITEM_COMMENT=t.SET_IS_COMMENTING=t.DELETED_COMMENT=t.DELETE_COMMENT=t.DELETED_ITEM_TAG=t.DELETING_ITEM_TAG=t.ADDED_ITEM_TAG=t.ADDING_ITEM_TAG=t.TOGGLE_TAG_EDITOR=t.SET_STREAM_VIEW=t.TOGGLE_VIEW_MENU=t.SHOW_NEW_ITEMS=t.SHOW_ALL_COMMENTS=t.DELETED_ITEM_SUBSCRIPTION=t.DELETE_ITEM_SUBSCRIPTION=t.ADDED_ITEM_SUBSCRIPTION=t.ADD_ITEM_SUBSCRIPTION=t.DELETED_ITEM_LIKE=t.DELETE_ITEM_LIKE=t.ADDED_ITEM_LIKE=t.ADD_ITEM_LIKE=t.UNDELETED_ITEM=t.UNDELETE_ITEM=t.DELETED_ITEM=t.DELETE_ITEM=t.SHARED_STREAM_ITEM=t.RECEIVE_UPDATED_ITEMS=t.REQUEST_UPDATED_ITEMS=t.COULDNT_RECEIVE_ITEMS=t.SET_IS_FETCHING=t.RECEIVE_ITEMS=t.REQUEST_ITEMS=t.SET_LIST_MORE_MODE=t.SET_LIST_LESS_MODE=t.TOGGLE_COMMENT_LESS_MODE=t.TOGGLE_SEMI_LESS_MODE=t.TOGGLE_CONTENT_LESS_MODE=t.TOGGLE_ITEM_LESS_MODE=t.SET_CONTENT_TALL=t.GOT_STREAM_CONFIG=t.USER_ZERO=void 0;var i=d(n(275)),o=d(n(235)),r=d(n(186));t.gotStreamConfig=de,t.setListLessMode=function(){return{type:E}},t.setListMoreMode=function(){return{type:k}},t.toggleViewMenu=function(){return{type:W}},t.setStreamView=function(e){return{type:V,newView:e}},t.requestItems=fe,t.receiveItems=pe,t.couldntReceiveItems=me,t.setIsFetching=he,t.requestUpdatedItems=function(e){return{type:S,url:e}},t.receiveUpdatedItems=ge,t.sharedStreamItem=function(e){return{type:D,item:e}},t.deleteItem=ye,t.deletedItem=ve,t.undeleteItem=Ee,t.undeletedItem=ke,t.toggleItemLessMode=function(e){return{type:h,itemID:e}},t.toggleContentLessMode=function(e){return{type:g,itemID:e}},t.toggleSemiLessMode=function(e){return{type:y,itemID:e}},t.setContentTall=function(e,t){return{type:m,itemID:e,contentIsTall:t}},t.showNewItems=function(){return{type:H}},t.updatedItemPromotion=_e,t.updatedItemPublished=be,t.addItemLike=Ie,t.addedItemLike=Ce,t.deleteItemLike=Se,t.deletedItemLike=Te,t.addItemSubscription=De,t.addedItemSubscription=we,t.deleteItemSubscription=Me,t.deletedItemSubscription=Pe,t.toggleTagEditor=function(e){return{type:K,itemID:e}},t.addingItemTag=Ae,t.addedItemTag=Le,t.deletingItemTag=Oe,t.deletedItemTag=Ne,t.setIsCommenting=function(e,t,n){return{type:Q,itemID:e,isCommenting:t,commentID:n}},t.showAllComments=function(e){return{type:j,itemID:e}},t.deleteComment=Re,t.deletedComment=xe,t.addItemComment=Ue,t.addedItemComment=function(e,t){return{type:Z,itemID:e,item:t}},t.updateItemComment=Be,t.updatedItemComment=Fe,t.restoreCommentEditor=je,t.toggleCommentLessMode=function(e){return{type:v,commentID:e}},t.setDraftStatus=He,t.savedCommentDraft=We,t.setActionError=Ve,t.setIsOnLine=function(e){return{type:ae,isOnLine:e}},t.setWarnOffline=function(e,t){return{type:se,bannerNumber:e,showWarning:t}},t.setWarnBrokenUser=Ke,t.fetchItems=qe,t.fetchUpdatedItems=function(){return function(e,t){var n=t(),i=Xe(0,25,n.streamView,n.filters,n.filterOperation,l.default.getMaxModDate(n.items,n.newItems,n.updatedItems,n.belowItems,n.deletedItems))+"&enableDeleted=1";return a.default.get(Ye(i)).authBearer(l.default.getToken()).withCredentials().end(function(t,n){t||!n.ok?l.default.receivedAPIError(t||n.text):e(ge(i,n.body))})}},t.removeItem=function(e){return"0"!==currentEmployee.employeeID||l.default.isSPAdmin()?function(t){return t(ye(e)),a.default.delete(Ye("/stream/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Ve(n||i.text))):t(ve(e,i.body))})}:{type:f}},t.restoreItem=function(e){return"0"!==currentEmployee.employeeID||l.default.isSPAdmin()?function(t){return t(Ee(e)),a.default.put(Ye("/streamadmin/restore/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Ve(n||i.text))):t(ke(e,i.body))})}:{type:f}},t.likeItem=function(e){return function(t){if(!l.default.isUserBroken())return t(Ie(e)),a.default.post(Ye("/likes")).authBearer(l.default.getToken()).send({itemID:e}).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Se(e)),t(Ve(n||i.text))):t(Ce(e,i.body))});t(Ke(!0))}},t.unlikeItem=function(e){return function(t){return t(Se(e)),a.default.delete(Ye("/likes/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Ie(e)),t(Ve(n||i.text))):t(Te(e,i.body))})}},t.subscribeToItem=function(e){return function(t){if(!l.default.isUserBroken())return t(De(e)),Ge(e,!0,function(){return t(we(e))});t(Ke(!0))}},t.unsubscribeFromItem=function(e){return"0"===currentEmployee.employeeID?{type:f}:function(t){return t(Me(e)),Ge(e,!1,function(){return t(Pe(e))})}},t.removeComment=function(e){return"0"===currentEmployee.employeeID?{type:f}:function(t){return t(Re(e)),a.default.delete(Ye("/comments/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Ve(n||i.text))):t(xe(e))})}},t.submitCommentDraft=function(e){return function(t,n){return t(He(u.draftSaveStatuses.saving,e.itemID,e.commentID)),e.commentID?function(e,t){return ze=window.setTimeout(function(){e(He(u.draftSaveStatuses.failed,t.itemID,t.commentID))},1e4),a.default.put(apiUrl+"/comments/"+t.commentID).authBearer(l.default.getToken()).send(t).end(function(n,i){ze&&(window.clearTimeout(ze),ze=null),n||!i.ok?((0,c.logError)(n||i.text,t),e(He(u.draftSaveStatuses.failed,t.itemID,t.commentID))):e(We(i.body))})}(t,e):function(e,t){return a.default.post(apiUrl+"/comments").authBearer(l.default.getToken()).send(t).end(function(n,i){n||!i.ok?((0,c.logError)(n||i.text,t),e(He(u.draftSaveStatuses.failed,t.itemID,t.commentID))):e(We(i.body))})}(t,e)}},t.submitUpdatedItemComment=function(e,t){return function(t){return e.isDraft?t(Ue(e)):t(Be(e)),e.isDraft=!1,a.default.put(Ye("/comments/"+e.commentID)).authBearer(l.default.getToken()).send(e).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(je(itemID,commentID)),t(Ve(n||i.text))):t(Fe(e.itemID,e.commentID,i.body))})}},t.addItemTag=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:(t=(0,r.default)(t,{itemID:e}),function(n){return n(Ae(e,t)),a.default.post(Ye("/"+(t.hashtag?"hashtags":"mentions"))).authBearer(l.default.getToken()).send(t).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(Ve(t||i.text))):n(Le(e,i.body))})})},t.deleteItemTag=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:(t=(0,r.default)(t,{itemID:e,entityType:t.hashtag?"Hashtag":t.entityType,entityID:t.entityID||t.hashtag}),function(n){return n(Oe(e,t)),a.default.delete(Ye("/mentions")).authBearer(l.default.getToken()).send(t).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(Ve(t||i.text))):n(Ne(e,i.body))})})},t.promoteItem=function(e,t,n){return"0"===currentEmployee.employeeID?{type:f}:function(i){return a.default.post(Ye("/streamadmin/promoted/"+e)).authBearer(l.default.getToken()).send({PromotedEndDate:t,PushNotification:n?1:0}).end(function(t,n){t||!n.ok?(l.default.receivedAPIError(t||n.text),i(Ve(t||n.text))):(i(_e(e,n.body)),i(qe()))})}},t.updateItemPromotion=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:function(n){return a.default.put(Ye("/streamadmin/promoted/"+e)).authBearer(l.default.getToken()).send({PromotedEndDate:t}).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(Ve(t||i.text))):(n(_e(e,i.body)),n(qe()))})}},t.demoteItem=function(e){return"0"===currentEmployee.employeeID?{type:f}:function(t){return a.default.delete(Ye("/streamadmin/promoted/"+e)).authBearer(l.default.getToken()).end(function(n,i){n||!i.ok?(l.default.receivedAPIError(n||i.text),t(Ve(n||i.text))):(t(_e(e,i.body)),t(qe()))})}},t.setPublished=function(e,t){return"0"===currentEmployee.employeeID?{type:f}:function(n){return(t?a.default.post(Ye("/streamadmin/published/"+e)):a.default.delete(Ye("/streamadmin/published/"+e))).authBearer(l.default.getToken()).end(function(t,i){t||!i.ok?(l.default.receivedAPIError(t||i.text),n(Ve(t||i.text))):n(be(e,i.body))})}},t.getStreamConfig=function(){return function(e){return a.default.get("/_layouts/15/NexusAPIProxy/StreamConfig.ashx").end(function(t,n){t||!n.ok?(l.default.receivedAPIError(t||n.text),e(de({apiFilterEnabled:!1,presenceEnabled:!1}))):e(de(n.body))})}};var a=d(n(191)),s=n(257),l=d(n(179)),u=n(208),c=n(189);function d(e){return e&&e.__esModule?e:{default:e}}n(216)(a.default);var f=t.USER_ZERO="NOT_IN_DIRECTORY",p=t.GOT_STREAM_CONFIG="GOT_STREAM_CONFIG",m=t.SET_CONTENT_TALL="SET_CONTENT_TALL",h=t.TOGGLE_ITEM_LESS_MODE="TOGGLE_ITEM_LESS_MODE",g=t.TOGGLE_CONTENT_LESS_MODE="TOGGLE_CONTENT_LESS_MODE",y=t.TOGGLE_SEMI_LESS_MODE="TOGGLE_SEMI_LESS_MODE",v=t.TOGGLE_COMMENT_LESS_MODE="TOGGLE_COMMENT_LESS_MODE",E=t.SET_LIST_LESS_MODE="SET_LIST_LESS_MODE",k=t.SET_LIST_MORE_MODE="SET_LIST_MORE_MODE",_=t.REQUEST_ITEMS="REQUEST_ITEMS",b=t.RECEIVE_ITEMS="RECEIVE_ITEMS",I=t.SET_IS_FETCHING="SET_IS_FETCHING",C=t.COULDNT_RECEIVE_ITEMS="COULDNT_RECEIVE_ITEMS",S=t.REQUEST_UPDATED_ITEMS="REQUEST_UPDATED_ITEMS",T=t.RECEIVE_UPDATED_ITEMS="RECEIVE_UPDATED_ITEMS",D=t.SHARED_STREAM_ITEM="SHARED_STREAM_ITEM",w=t.DELETE_ITEM="DELETE_ITEM",M=t.DELETED_ITEM="DELETED_ITEM",P=t.UNDELETE_ITEM="UNDELETE_ITEM",A=t.UNDELETED_ITEM="UNDELETED_ITEM",L=t.ADD_ITEM_LIKE="ADD_ITEM_LIKE",O=t.ADDED_ITEM_LIKE="ADDED_ITEM_LIKE",N=t.DELETE_ITEM_LIKE="DELETE_ITEM_LIKE",R=t.DELETED_ITEM_LIKE="DELETED_ITEM_LIKE",x=t.ADD_ITEM_SUBSCRIPTION="ADD_ITEM_SUBSCRIPTION",U=t.ADDED_ITEM_SUBSCRIPTION="ADDED_ITEM_SUBSCRIPTION",B=t.DELETE_ITEM_SUBSCRIPTION="DELETE_ITEM_SUBSCRIPTION",F=t.DELETED_ITEM_SUBSCRIPTION="DELETED_ITEM_SUBSCRIPTION",j=t.SHOW_ALL_COMMENTS="SHOW_ALL_COMMENTS",H=t.SHOW_NEW_ITEMS="SHOW_NEW_ITEMS",W=t.TOGGLE_VIEW_MENU="TOGGLE_VIEW_MENU",V=t.SET_STREAM_VIEW="SET_STREAM_VIEW",K=t.TOGGLE_TAG_EDITOR="TOGGLE_TAG_EDITOR",q=t.ADDING_ITEM_TAG="ADDING_ITEM_TAG",G=t.ADDED_ITEM_TAG="ADDED_ITEM_TAG",z=t.DELETING_ITEM_TAG="DELETING_ITEM_TAG",Y=t.DELETED_ITEM_TAG="DELETED_ITEM_TAG",X=t.DELETE_COMMENT="DELETE_COMMENT",J=t.DELETED_COMMENT="DELETED_COMMENT",Q=t.SET_IS_COMMENTING="SET_IS_COMMENTING",$=t.ADD_ITEM_COMMENT="ADD_ITEM_COMMENT",Z=t.ADDED_ITEM_COMMENT="ADDED_ITEM_COMMENT",ee=t.UPDATE_ITEM_COMMENT="UPDATE_ITEM_COMMENT",te=t.UPDATED_ITEM_COMMENT="UPDATED_ITEM_COMMENT",ne=t.RESTORE_COMMENT_EDITOR="RESTORE_COMMENT_EDITOR",ie=t.UPDATED_ITEM_PROMOTTION="UPDATED_ITEM_PROMOTION",oe=t.UPDATED_ITEM_PUBLISHED="UPDATED_ITEM_PUBLISHED",re=t.SET_ACTION_ERROR="SET_ACTION_ERROR",ae=t.SET_IS_ONLINE="SET_IS_ONLINE",se=t.SET_WARN_OFFLINE="SET_WARN_OFFLINE",le=t.SET_WARN_BROKEN_USER="SET_WARN_BROKEN_USER",ue=t.SET_DRAFT_STATUS="SET_DRAFT_STATUS",ce=t.SAVED_COMMENT_DRAFT="SAVED_COMMENT_DRAFT";function de(e){return{type:p,config:e}}function fe(e){return{type:_,url:e}}function pe(e,t){return{type:b,url:e,items:t.results}}function me(e){return{type:C,error:e}}function he(e){return{type:I,isFetching:e}}function ge(e,t){return{type:T,url:e,items:t.results}}function ye(e){return{type:w,itemID:e}}function ve(e,t){return{type:M,itemID:e,item:t}}function Ee(e){return{type:P,itemID:e}}function ke(e,t){return{type:A,itemID:e,item:t}}function _e(e,t){return{type:ie,item:t,itemID:e}}function be(e,t){return{type:oe,item:t,itemID:e}}function Ie(e){return{type:L,itemID:e}}function Ce(e,t){return{type:O,itemID:e,item:t}}function Se(e){return{type:N,itemID:e}}function Te(e,t){return{type:R,itemID:e,item:t}}function De(e){return{type:x,itemID:e}}function we(e){return{type:U,itemID:e}}function Me(e){return{type:B,itemID:e}}function Pe(e){return{type:F,itemID:e}}function Ae(e,t){return{type:q,itemID:e,tag:t}}function Le(e,t){return{type:G,itemID:e,item:t}}function Oe(e,t){return{type:z,itemID:e,tag:t}}function Ne(e,t){return{type:Y,itemID:e,item:t}}function Re(e){return{type:X,commentID:e}}function xe(e){return{type:J,commentID:e,receivedAt:Date.now()}}function Ue(e){return{type:$,comment:e}}function Be(e){return{type:ee,comment:e}}function Fe(e,t,n){return{type:te,itemID:e,commentID:t,item:n}}function je(e,t){return{type:ne,itemID:e,commentID:t}}function He(e,t,n){return{type:ue,draftSaveStatus:e,itemID:t,commentID:n}}function We(e){return{type:ce,commentDraft:e}}function Ve(e){return{type:re,error:e}}function Ke(e){return{type:le,showWarning:e}}function qe(){return function(e,t){var n=t(),i=void 0;if(n.filters.length>0&&void 0!==n.filters[0].StreamItem)i=Je(n.filters[0].StreamItem);else{var o=s.ITEMS_PER_PAGE;0!==n.maxItems&&(o=Math.min(n.maxItems,s.ITEMS_PER_PAGE));var r=n.maxItems-n.items.length;r>0&&r<o&&(o=r),i=Xe(n.items.length-1,o,n.streamView,n.filters,n.filterOperation)}return e(fe(i)),a.default.get(Ye(i)).authBearer(l.default.getToken()).withCredentials().end(function(t,n){t||!n.ok?(l.default.receivedAPIError(t||n.text),e(me(t||n.text)),window.setTimeout(function(){return e(he(!1))},2e3)):e(pe(i,n.body))})}}var Ge=function(e,t,n){return a.default.post(Ye("/subscriptions")).authBearer(l.default.getToken()).send({EntityType:"StreamItem",EntityID:e,Type:"notify",Enabled:t?1:-1}).end(function(e,t){e||!t.ok?(l.default.receivedAPIError(e||t.text),dispatch(Ve(e||t.text))):n()})};var ze=void 0;var Ye=t.buildReqUrl=function(e){return apiUrl+e},Xe=function(e,t,n,i,o,r){return"/stream?offset="+e+"&pageSize="+t+"&view="+Qe(n)+$e(i,o)+Ze(r)},Je=t.buildThreadUrl=function(e){return"/stream/"+e},Qe=function(e){switch(e){case"ImFollowing":return"Following";case"MostActive":return"Active";case"Promoted":return"PromotedAdmin";case"Removed":return"DeletedAdmin";case"Published":return"PublishedAdmin";default:return"/pages/streamadministration.aspx"===window.location.pathname.toLowerCase()?"Admin":l.default.isHome()?"HomeAll":"Default"}},$e=function(e,t){var n="";return e.forEach(function(t){switch((0,o.default)(t)[0]){case"BlogPost":var r=t.BlogPost.split("|");n+="&spListID="+r[0]+"&spPostID="+r[1];break;case"BlogCategory":n+="&blogPostCategoryURL="+encodeURIComponent(t.BlogCategory);break;case"Author":n+="&authorID="+encodeURIComponent(e[0].Author);break;default:n+="&mentionID="+(0,o.default)(t)[0]+"|"+encodeURIComponent((0,i.default)(t)[0])}}),e.length>1&&(n+="&andOr="+t),n},Ze=function(e){return null!=e?"&minModDate="+e:""}},189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProfileInfo=t.getCancelUploadFilter=t.getLinkTarget=t.isEditingWebpartPage=t.isEditingWikiPage=t.isWikiPage=t.getQueryStringValue=t.logError=void 0;var i=l(n(186)),o=l(n(96)),r=l(n(191)),a=l(n(204)),s=l(n(179));function l(e){return e&&e.__esModule?e:{default:e}}t.logError=function(e,t){console.error(e),e&&null!=e.status&&401===e.status&&(console.warn("API returned 401. Reloading token."),localStorage.removeItem("apiToken"),s.default.validateToken()),e.message&&0===e.message.indexOf("Request has been terminated")||("undefined"!=typeof newrelic&&newrelic.noticeError(e),r.default.post("https://browserlogger.knowledge-architecture.com/api/log?code=cEjHEuR83JGCrIO4T31PMIvhSJpZhwxfGRc6C95PGXZrYlnBYhtMag==").type("application/json; charset=UTF-8").send(c(e,t)).then(function(e){}).catch(function(e){console.log(e)}))};var u=t.getQueryStringValue=function(e){e=e.toLowerCase();var t=!0,n=!1,i=void 0;try{for(var r,a=(0,o.default)(window.location.search.split(/[?&]/));!(t=(r=a.next()).done);t=!0){var s=r.value.split("=");if(2===s.length&&s[0].toLowerCase()===e)return s[1]}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}return null},c=(t.isWikiPage=function(){return!("undefined"==typeof MSOWebPartPageFormName||!document.forms[MSOWebPartPageFormName]||!document.forms[MSOWebPartPageFormName]._wikiPageMode)},t.isEditingWikiPage=function(){if("undefined"!=typeof MSOWebPartPageFormName&&document.forms[MSOWebPartPageFormName]){var e=document.forms[MSOWebPartPageFormName]._wikiPageMode;return e&&"Edit"===e.value}return!1},t.isEditingWebpartPage=function(){if("undefined"!=typeof MSOWebPartPageFormName&&document.forms[MSOWebPartPageFormName]){var e=document.forms[MSOWebPartPageFormName].MSOLayout_InDesignMode;return e&&"1"===e.value}return!1},t.getLinkTarget=function(e){if("A"===e.nodeName)return e;for(var t=e.parentNode;null!=t;){if("A"===t.nodeName)return t;t=t.parentNode}return null},t.getCancelUploadFilter=function(){return{cancel:!1,loggingOn:!0,onCancelComplete:null,nextCounter:0,returnCounter:0,handle:function(e,t){var n=this;n.cancel||t&&(n.nextCounter++,t(e,function(e,t,i){n.returnCounter++,n.cancel?n.nextCounter==n.returnCounter&&n.onCancelComplete&&n.onCancelComplete():i?i(e):t&&t(e)}))},log:function(e){this.loggingOn&&console.log("cancelUploadFilter: "+e+" nc: "+this.nextCounter+", rc: "+this.returnCounter)}}},function(e,t){var n=(0,i.default)(d(),{url:e.url,error:{name:e.name,message:e.message,fileName:e.fileName,lineNumber:e.lineNumber,columnNumber:e.columnNumber,stack:e.stack},item:t});return e.response&&(n.apiResponse="("+e.status+") "+e.response.statusText,e.response.req&&e.response.req.toJSON&&(n.apiRequest=e.response.req.toJSON())),n}),d=function(){return{clientID:clientID,employeeID:employeeID,url:window.location.href,time:(new Date).getTime(),browser:{name:a.default.name,version:a.default.version}}};t.getProfileInfo=function(){return null!=u("Employee")?(0,i.default)(location,{entityType:"Employee",entityID:u("Employee")}):null!=u("Project")?(0,i.default)(location,{entityType:"Project",entityID:u("Project")}):null!=u("Opportunity")?(0,i.default)(location,{entityType:"Opportunity",entityID:u("Opportunity")}):null!=u("Company")?(0,i.default)(location,{entityType:"Company",entityID:u("Company")}):null!=u("Contact")?(0,i.default)(location,{entityType:"Contact",entityID:u("Contact")}):void 0}},192:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),o=p(n(182)),r=p(n(183)),a=p(n(184)),s=p(n(185)),l=n(177),u=p(l),c=p(n(187)),d=n(179),f=p(d);function p(e){return e&&e.__esModule?e:{default:e}}n(283),f.default.isIE()&&n(284);var m=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleKey=n.handleKey.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentWillMount",value:function(){window.addEventListener("keydown",this.handleKey,!0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKey,!0)}},{key:"handleKey",value:function(e){this.props.onClose&&27===e.keyCode&&this.props.onClose()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.style,o=t.onClose,r=t.title,a=t.titleHelp,s=t.children,l=t.onLeft,f=t.onRight,p=t.hideX,m=t.disableOverlayClick;return c.default.createPortal(u.default.createElement("div",{className:"kamodal-overlay"+(m?" disabled":""),onClick:m?void 0:o},u.default.createElement("div",{className:"kamodal-container "+(n||""),style:i,onClick:function(e){e.stopPropagation()},ref:function(t){return e.box=t}},!p&&u.default.createElement("img",{className:"kamodal-close",src:d.imgRoot+"close_x_sm.svg",title:"Close (Esc)",onClick:o}),r&&u.default.createElement("div",{className:"kamodal-title"},u.default.createElement("span",null,r),a),u.default.createElement("div",{className:"kamodal-content "+(r?"":"notitle")},s)),l&&u.default.createElement("img",{className:"kamodal-left",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),l()}}),f&&u.default.createElement("img",{className:"kamodal-right",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),f()}})),document.body)}}]),t}(l.Component);t.default=m},203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(181)),o=d(n(182)),r=d(n(183)),a=d(n(184)),s=d(n(185)),l=n(177),u=(d(l),d(n(180))),c=d(n(187));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"handleClick",value:function(e){c.default.findDOMNode(this).contains(e.target)||this.props.onClose()}},{key:"componentWillMount",value:function(){var e=this;window.setTimeout(function(){return window.addEventListener("click",e.handleClick,!1)},0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick,!1)}},{key:"render",value:function(){return this.props.children}}]),t}(l.Component);f.proptypes={onClose:u.default.func.isRequired},t.default=f},205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHHMMSS=void 0;var i=c(n(181)),o=c(n(182)),r=c(n(183)),a=c(n(184)),s=c(n(185)),l=n(177),u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return u.default.createElement("span",{className:"ka-duration"},f(this.props.duration))}}]),t}(l.Component);t.default=d;var f=t.toHHMMSS=function(e){var t=Math.ceil(parseFloat(e)),n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),o=t-3600*n-60*i;return o<10&&(o="0"+o),n>0&&i<10&&(i="0"+i),n>0?n+":"+i+":"+o:i+":"+o}},207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEF_VIDEO_WIDTH=576,t.DEF_VIDEO_HEIGHT=324,t.MIN_VIDEO_WIDTH=330,t.MAX_VIDEO_WIDTH=1026},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.draftSaveStatuses={failed:-2,blocked:-1,idle:0,saving:1,saved:2}},209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INT_TITLE_MAX_CHARS=150,t.INT_BODY_MAX_CHARS=15e3,t.INT_STREAM_IMAGE_WIDTH=578,t.INT_STREAM_IMAGE_HEIGHT=800,t.INT_COMMENT_IMAGE_WIDTH=492,t.INT_COMMENT_IMAGE_HEIGHT=800,t.INT_STREAM_LESS_CHARS=164,t.INT_COMMENT_LESS_CHARS=1115,t.INT_WEBPAGE_BODY_CHARS=111,t.INT_MAX_VIDEO_SIZE=5368709120,t.INT_MAX_IMAGE_SIZE=31457280},211:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RE_URL_ONLY=new RegExp("^((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*$","i"),t.RE_URL_END=new RegExp("((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*$","i"),t.RE_URL_ANYWHERE=new RegExp("((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*","i"),t.RE_URL_EVERYWHERE=new RegExp("((https?://)|(www\\.))[\\w-\\._~:/\\?%#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]*","ig"),t.RE_ILLEGAL_HASHTAG=/[^\w&+\/#-]/,t.RE_HASHTAG_EVERYWHERE=/(?:\s|^|&#160;|​)(#[\w&+\/-]*[a-zA-Z_-]+[\w&+\/-]*)/gi,t.RE_FILE_EXTENSION=/(?:\.([^.]+))?$/,t.RE_VID_URL_ONLY=/^https?:\/\/[\w-\._~:\/\?%#\[\]@!\$&'\(\)\*\+,;=]*\/_layouts\/video\/player\.aspx\?id=([0-9a-f-]{36})[\w-\._~:\/\?%#\[\]@!\$&'\(\)\*\+,;=]*?(?:&start=(\d+))*[\w-\._~:\/\?%#\[\]@!\$&'\(\)\*\+,;=]*$/i,t.RE_GIPHY_DIRECT=/^https?:\/\/media\.giphy\.com\/media\/.*\/giphy\.gif$/i,t.RE_GIPHY_PAGE=/^https?:\/\/giphy\.com\/gifs\/.*$/i,t.RE_GIPHY_SHORT=/^https?:\/\/gph\.is\/.*$/i},213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventTypes=void 0;var i=a(n(186));t.trackPostAuthorClick=function(e,t,n){u("Clickthrough",{Post:{ItemID:n.itemID,Promoted:n.promoted?1:0},Target:{Context:"PostAuthor",Url:e,Title:t,RelativeUrl:d(e)}})},t.trackPostLinkClick=function(e,t,n){u("Clickthrough",{Post:{ItemID:n.itemID,Promoted:n.promoted?1:0},Target:{Context:"PostLink",Url:e,Title:t,RelativeUrl:d(e)}})},t.trackPostTagClick=function(e,t,n,i,o){u("Clickthrough",{Post:{ItemID:o.itemID,Promoted:o.promoted?1:0},Target:{Context:"PostTag",Url:e,Title:t,EntityType:n,EntityID:i,RelativeUrl:d(e)}})},t.trackCommentLinkClick=function(e,t,n,i){u("Clickthrough",{Post:{ItemID:n.itemID,Promoted:n.promoted?1:0},Comment:{CommentID:i.commentID},Target:{Context:"CommentLink",Url:e,Title:t,RelativeUrl:d(e)}})},t.trackCommentTagClick=function(e,t,n,i,o,r){u("Clickthrough",{Post:{ItemID:o.itemID,Promoted:o.promoted?1:0},Comment:{CommentID:r.commentID},Target:{Context:"CommentTag",Url:e,Title:t,EntityType:n,EntityID:i,RelativeUrl:d(e)}})},t.trackPostSubitemClick=function(e,t,n,i){u("Clickthrough",{Post:{ItemID:i.itemID,Promoted:i.promoted?1:0},Target:{Context:"PostSubitem",CollectionType:e,CollectionID:t,CollectionMember:n}})},t.trackCommentSubitemClick=function(e,t,n,i,o){u("Clickthrough",{Post:{ItemID:i.itemID,Promoted:i.promoted?1:0},Comment:{CommentID:o.commentID},Target:{Context:"CommentSubitem",CollectionType:e,CollectionID:t,CollectionMember:n}})},t.trackPostImpression=function(e){u("Impression",{Post:{ItemID:e.itemID,Promoted:e.promoted?1:0}})},t.trackPostOpen=function(e){u("Open",{Post:{ItemID:e.itemID,Promoted:e.promoted?1:0}})},t.trackVideoWatch=function(e,t,n,i,o){u("Watch",{Video:{mediaID:e,sessionID:n,chunksWatched:t},Post:i?{ItemID:i.itemID,Promoted:i.promoted?1:0}:void 0,Comment:o?{CommentID:o.commentID}:void 0})};var o=a(n(191)),r=n(189);function a(e){return e&&e.__esModule?e:{default:e}}var s="https://kasa.knowledge-architecture.com/api/spa?code=FLof2z/4dZ7srUY7/mDJsfjmMcwm32jERVCU9b1ChxlzcrV4MR1hHA==",l="https://kasa.knowledge-architecture.com/api/sva?code=dalnU09SW/8eiTkw7vNHiePWIZd6KsdSlzrVLIJALGiRkc3veLA1AA==";function u(e,t){var n={Client:clientID.toLowerCase(),Timestamp:"",User:employeeID,CurrentEmployee:currentEmployee||null,Channel:"Web",Source:"ReactStream",StreamMode:null==(0,r.getQueryStringValue)("ItemID")?localStorage.getItem("moreOrLess")||"less":void 0,StreamView:null==(0,r.getQueryStringValue)("ItemID")?localStorage.getItem("streamView")||"All":void 0,EventType:e,Location:c(),Referrer:{Url:document.referrer,RelativeUrl:d(document.referrer)},UserAgent:{CurrentTime:Date.now(),TimeZone:(new Date).getTimezoneOffset(),ScreenResolution:screen.width+"x"+screen.height,WindowSize:window.innerWidth+"x"+window.innerHeight,UaHeader:window.navigator.userAgent,Version:"16"}},a={Client:clientID.toLowerCase(),User:employeeID,EventType:e,Channel:"Web",Source:"ReactStream",Location:window.location.href,EventData:(0,i.default)(n,t)};o.default.post("Watch"===e?l:s).type("application/json; charset=UTF-8").send(a).then(function(e){}).catch(function(e){})}function c(){var e={Url:window.location.href,RelativeUrl:d(window.location.href),Title:document.title,Community:communityID};return null!=(0,r.getQueryStringValue)("ItemID")?(0,i.default)(e,{EntityType:"Post",EntityID:(0,r.getQueryStringValue)("ItemID")}):null!=(0,r.getQueryStringValue)("Hashtag")?(0,i.default)(e,{EntityType:"Hashtag",EntityID:decodeURIComponent((0,r.getQueryStringValue)("Hashtag"))}):null!=(0,r.getQueryStringValue)("Employee")?(0,i.default)(e,{EntityType:"Employee",EntityID:(0,r.getQueryStringValue)("Employee")}):null!=(0,r.getQueryStringValue)("Project")?(0,i.default)(e,{EntityType:"Project",EntityID:(0,r.getQueryStringValue)("Project")}):null!=(0,r.getQueryStringValue)("Opportunity")?(0,i.default)(e,{EntityType:"Opportunity",EntityID:(0,r.getQueryStringValue)("Opportunity")}):null!=(0,r.getQueryStringValue)("Company")?(0,i.default)(e,{EntityType:"Company",EntityID:(0,r.getQueryStringValue)("Company")}):null!=(0,r.getQueryStringValue)("Contact")?(0,i.default)(e,{EntityType:"Contact",EntityID:(0,r.getQueryStringValue)("Contact")}):window.location.pathname.toLowerCase().endsWith("post.aspx")?(0,i.default)(e,{EntityType:"BlogPost",EntityID:(0,r.getQueryStringValue)("List")+"|"+(0,r.getQueryStringValue)("ID")}):window.location.pathname.toLowerCase().endsWith("category.aspx")?(0,i.default)(e,{EntityType:"BlogCategory",EntityID:window.location.href}):(0,i.default)(e,{EntityType:"Community",EntityID:communityID}),e}function d(e){var t=document.createElement("a");return t.href=e,t.pathname.length>0&&(0!=t.pathname.indexOf("/")&&(t.pathname="/"+t.pathname),-1!==t.pathname.indexOf("/",t.pathname.length-1)&&(t.pathname=t.pathname.substring(0,t.pathname.length-1))),t.hostname.toLowerCase()==window.location.hostname.toLowerCase()?t.pathname.toLowerCase()+t.search.toLowerCase():e.toLowerCase()}t.eventTypes={click:0,watch:1}},214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ALERT_MISSING_TITLE={title:"Oops! You forgot a title.",message:"Please include a title."},t.ALERT_MISSING_TAGS={title:"Oops! You forgot to add tags.",message:"Please add at least one tag."},t.ALERT_TITLE_LENGTH={title:"Title cannot exceed 150 characters.",message:"Please shorten your title."},t.ALERT_MISSING_COMMENT={title:"Oops! You forgot to comment.",message:"Please enter a comment."},t.ALERT_BODY_LENGTH={title:"Post cannot exceed 15,000 characters.",message:"Please shorten your post."},t.ALERT_STILL_UPLOADING={title:"Some files are still uploading.",message:"Please try again soon."},t.ALERT_IMAGE_SIZE={title:"30 MB Size Limit for Images",message:"Please resize or upload a smaller image."},t.ALERT_VIDEO_SIZE={title:"5 GB Size Limit for Videos",message:"Please upload a smaller video."},t.ALERT_DOC_SIZE={title:"250 MB Size Limit for Files",message:"Please upload a smaller file."},t.ALERT_DOC_TYPE={title:"File Type Not Supported",message:'For more information on supported file types, please visit our <a href="https://knowledgearchitecture.zendesk.com/hc/en-us/articles/115003909846-Unsupported-File-Types" class="linkActive" target="_blank">support site</a>.'},t.ALERT_VID_TYPE={title:"File Type Not Supported",message:"Please upload only video files with this tool."},t.ALERT_UPLOAD_FAILED={title:"File Upload Failed",message:"Please try again."},t.ALERT_VIDEO_FAILED={title:"Video Upload Failed",message:"Please try again."},t.OUTAGE_BANNERS={isEditing:{message:"Posting and commenting are temporarily unavailable. Your unfinished work has been saved and will be available once internet connectivity is restored.",dismissible:!1,number:1},notCommenting:{message:"Commenting is temporarily unavailable. Please check your internet connection.",dismissible:!0,number:2},notPosting:{message:"Posting is temporarily unavailable. Please check your internet connection.",dismissible:!0,number:3},brokenUser:{message:"Posting, commenting, and liking is currently unavailable for your user account. Please contact your administrator.",dismissible:!0,number:3}}},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.containsFiles=t.getLinkPeekPos=t.getCollectionMemberID=t.decorateInlineMentions=t.selectionStateAtEnd=t.getEntityRangeAtCursor=t.insertLinkAt=t.newBlogCallback=t.confirmLeaveListener=t.didTextChange=t.populateMissingCollectionIDsInContent=t.jsonContentToContentState=t.formattedContentToContentState=t.removeBrokenAtomicBlocksFromRawContent=t.removeDataUrlsFromRawContent=t.selectLink=t.tryGetLinkSelection=t.insertLink=t.getSelectedLinkUrl=t.getTextSelection=t.removeConfirmLeave=t.addConfirmLeave=t.newEditorState=t.getDecorator=t.adjustTargetBasedOnCursor=t.createSPBlog=t.createWordBlog=void 0;var i=p(n(234)),o=p(n(186));t.findTagEntities=y,t.findLinkEntities=v,t.findPendingHashtags=E;var r=n(220),a=n(662),s=p(n(179)),l=n(211),u=p(n(547)),c=p(n(548)),d=p(n(549)),f=n(325);function p(e){return e&&e.__esModule?e:{default:e}}t.createWordBlog=function(){return newBlogPostOnClient("18faf3ff-2cdd-4f17-9b7c-b11d0116f405",blogOptions.webUrl,blogOptions.webID)},t.createSPBlog=function(){OpenPopUpPage(urlTemplates.communityUrls[communityID]+"/Lists/Posts/NewPost.aspx",_)},t.adjustTargetBasedOnCursor=function(e,t){if(e.isCollapsed()){var n=t.getBlockForKey(e.getAnchorKey());if("atomic"===n.getType()||e.getAnchorOffset()>=n.getLength()/2){var i=t.getKeyAfter(e.getAnchorKey());e=i?new r.SelectionState({anchorKey:i,anchorOffset:0,focusKey:i,focusOffset:0}):null}}return e};var m=t.getDecorator=function(e){return new r.CompositeDecorator([{strategy:y,component:c.default},{strategy:v,component:u.default,props:{onLinkPeek:e}},{strategy:E,component:d.default}])},h=(t.newEditorState=function(e){return r.EditorState.createEmpty(m(e||null))},t.addConfirmLeave=function(){window.addEventListener("beforeunload",k)},t.removeConfirmLeave=function(){window.removeEventListener("beforeunload",k)},t.getTextSelection=function(e,t){var n=e.getSelection();t=t||"\n";var i=n.getStartKey(),o=n.getEndKey(),r=e.getCurrentContent().getBlockMap(),a=!1;return r.skipUntil(function(e){return e.getKey()===i}).takeUntil(function(e){var t=a;return e.getKey()===o&&(a=!0),t}).map(function(e){var t=e.getKey(),r=e.getText(),a=0,s=r.length;return t===i&&(a=n.getStartOffset()),t===o&&(s=n.getEndOffset()),r=r.slice(a,s)}).join(t)},t.getSelectedLinkUrl=function(e){var t=e.getSelection();if(!t.isCollapsed()){var n=e.getCurrentContent(),i=n.getBlockForKey(t.getAnchorKey()).getEntityAt(t.getAnchorOffset()-(!0===t.getIsBackward()?1:0)),o=n.getBlockForKey(t.getFocusKey()).getEntityAt(t.getFocusOffset()-(!0===t.getIsBackward()?0:1));if(null!=i&&i===o)return n.getEntity(i).getData().url}return null},t.insertLink=function(e,t,n){return b(e,e.getSelection(),t,n)},t.tryGetLinkSelection=function(e){var t=I(e);if(null!=t){var n=e.getCurrentContent();if("LINK"===n.getEntity(n.getBlockForKey(t.blockKey).getEntityAt(t.start)).getType()){var i=e.getSelection();return i.merge({anchorOffset:!0===i.getIsBackward()?t.end:t.start,focusOffset:!0===i.getIsBackward()?t.start:t.end})}}return null}),g=(t.selectLink=function(e){var t=h(e);return null!=t?r.EditorState.forceSelection(e,t):e},t.removeDataUrlsFromRawContent=function(e){var t={entityMap:{},blocks:e.blocks};for(var n in e.entityMap){var i=e.entityMap[n];t.entityMap[n]={type:i.type,mutability:i.mutability,data:"Image"===i.data.collectionType?{collectionType:i.data.collectionType,collection:i.data.collection?(0,o.default)({},i.data.collection,{collectionMembers:i.data.collection.collectionMembers?i.data.collection.collectionMembers.map(function(e){return(0,o.default)({},e,{mediaList:e.mediaList?e.mediaList.map(function(e){return(0,o.default)({},e,{dataUrl:void 0})}):void 0})}):void 0}):void 0,files:void 0}:i.data}}return t},t.removeBrokenAtomicBlocksFromRawContent=function(e){return(0,o.default)({},e,{blocks:e.blocks.map(function(t){return"atomic"!==t.type||null!=e.entityMap[t.entityRanges[0].key].data.collection?t:{data:{},depth:0,entityRanges:[],inlineStyleRanges:[],key:t.key,text:"",type:"unstyled"}})})},t.formattedContentToContentState=function(e,t,n,i){if(null!=e){var o=(0,a.stateFromHTML)(e.replace(/<\/div><br>/gi,"<br></div>"));return o=S(o,t,n,i)}return null});t.jsonContentToContentState=function(e,t,n,i,o){var a=r.ContentState.createFromText("");return"string"==typeof e&&(e=JSON.parse(e)),e.forEach(function(e){if(null!=e.html){var s=g(e.html,t,n,i);a=r.ContentState.createFromBlockArray(a.getBlocksAsArray().concat(s.getBlocksAsArray()),a.getEntityMap())}else if(null!=e.collectionID){a.createEntity("StreamCollection","IMMUTABLE",{collection:o.find(function(t){return t.collectionType===e.type&&t.collectionID===e.collectionID}),collectionType:e.type});var l=a.getLastCreatedEntityKey();a=r.AtomicBlockUtils.insertAtomicBlock(r.EditorState.acceptSelection(r.EditorState.createWithContent(a),C(a)),l," ").getCurrentContent()}}),a},t.populateMissingCollectionIDsInContent=function(e,t){e&&t&&e.forEach(function(e){if(e.collection){var n=t.find(function(t){if(t.collectionType===(e.collection.collectionType||e.collection.type)){if((e.collection.collectionID||e.collectionID)===t.collectionID)return!0;if(t.collectionMembers&&t.collectionMembers.length>0){for(var n=function(n){var i=e.collection.collectionMembers[n];if(null==t.collectionMembers.find(function(n){return T(e.collection.collectionType,i)==T(t.collectionType,n)}))return{v:!1}},o=0;o<e.collection.collectionMembers.length;o++){var r=n(o);if("object"===(void 0===r?"undefined":(0,i.default)(r)))return r.v}return!0}}return!1});n&&(e.collectionID=n.collectionID,e.collection.collectionID=n.collectionID,e.collection.collectionMembers.forEach(function(t){t.collectionID=n.collectionID;var i=n.collectionMembers.find(function(i){return T(e.collection.collectionType,t)==T(n.collectionType,i)});i&&(t.mediaCollectionID=i.mediaCollectionID,t.documentID=i.documentID,t.memberData=i.memberData)}))}})},t.didTextChange=function(e,t){return e.getCurrentContent().getPlainText()!==t.getCurrentContent().getPlainText()};function y(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();try{return null!==t&&"TAG"===n.getEntity(t).getType()}catch(e){return console.error(e),!1}},t)}function v(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();try{return null!==t&&"LINK"===n.getEntity(t).getType()}catch(e){return console.error(e),!1}},t)}function E(e,t,n){l.RE_HASHTAG_EVERYWHERE.lastIndex=0;for(var i;i=l.RE_HASHTAG_EVERYWHERE.exec(e.getText());)t(l.RE_HASHTAG_EVERYWHERE.lastIndex-i[1].length,l.RE_HASHTAG_EVERYWHERE.lastIndex)}var k=t.confirmLeaveListener=function(e){return e.returnValue="Your content is still uploading and has not been saved.",e.returnValue},_=t.newBlogCallback=function(){},b=t.insertLinkAt=function(e,t,n,i){var o=e.getCurrentContent();return o=o.createEntity("LINK","IMMUTABLE",{url:i,text:n,target:0===i.indexOf(f.LOCAL_LINK_SCHEME)?void 0:"_blank"}),o=r.Modifier.replaceText(o,t,n,null,o.getLastCreatedEntityKey()),r.EditorState.push(e,o,"apply-entity")},I=t.getEntityRangeAtCursor=function(e){var t=e.getSelection(),n=e.getCurrentContent(),i=t.getAnchorKey(),r=n.getBlockForKey(i),a=r.getEntityAt(t.getAnchorOffset());if(null==a&&null==(a=r.getEntityAt(t.getFocusOffset())))return null;var s={blockKey:i};return r.findEntityRanges(function(e){return e.getEntity()===a},function(e,t){return(0,o.default)(s,{start:e,end:t})}),null!=s.start?s:null},C=t.selectionStateAtEnd=function(e){var t=e.getLastBlock();return new r.SelectionState({anchorKey:t.getKey(),anchorOffset:t.getLength(),focusKey:t.getKey(),focusOffset:t.getLength()})},S=t.decorateInlineMentions=function(e,t,n,i){s.default.entityRegex.lastIndex=0;for(var o=e.getBlockMap().find(function(e){return s.default.entityRegex.test(e.getText())});null!=o;){s.default.entityRegex.lastIndex=0;var a=s.default.entityRegex.exec(o.getText()),l=a[1],u=a[2],c=s.default.getTagForLink(l,u,t,n,i,null);e=e.createEntity("TAG","IMMUTABLE",c),e=r.Modifier.replaceText(e,r.SelectionState.createEmpty(o.getKey()).merge({anchorOffset:a.index,focusOffset:a.index+a[0].length}),c.entityName,null,e.getLastCreatedEntityKey()),s.default.entityRegex.lastIndex=0,o=e.getBlockMap().find(function(e){return s.default.entityRegex.test(e.getText())})}return e},T=t.getCollectionMemberID=function(e,t){switch(e){case"Link":return(t.uRL||t.url)+(t.previewImageOriginalURL||(t.images&&t.images.length>0?t.images[0].src:""));case"Document":return t.fromSharepoint?t.sourceAssetURL||t.sourceAssetUrl:t.documentID;case"Image":return t.mediaList.map(function(e){return e.mediaID}).toString();case"oEmbedContent":return t.oEmbedContentID;case"Video":return t.mediaID}};t.getLinkPeekPos=function(e){var t=e.getBoundingClientRect(),n=t.left+(t.right-t.left)/2;return{top:t.bottom+25,left:n}},t.containsFiles=function(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1}},225:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(177),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){var t=e.title,n=e.children,i=e.backgroundClick;return r.default.createElement("div",{className:"ka-video-modal-overlay",onClick:i},r.default.createElement("div",{className:"ka-video-modal"},r.default.createElement("div",{className:"ka-video-modal-title"},t),r.default.createElement("div",{className:"ka-video-modal-content"},n)))}},226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(177)),o=a(n(180)),r=a(n(190));function a(e){return e&&e.__esModule?e:{default:e}}if(null==s)var s=n(179).static_images;var l=function(e){var t=e.itemID,n=e.isLessMode,o=e.toggleItemLessMode;return i.default.createElement("span",{className:(0,r.default)("ka_streamItemToggle","linkActive","invisible"),onClick:function(e){o(t),e.stopPropagation()}},n?"More":"Less"," ",i.default.createElement("img",{src:n?s.more_caret_cyan_14:s.less_caret_cyan_14}))};l.propTypes={itemID:o.default.number.isRequired,isLessMode:o.default.bool.isRequired,toggleItemLessMode:o.default.func.isRequired},t.default=l},228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(186)),o=r(n(177));function r(e){return e&&e.__esModule?e:{default:e}}if(null==a)var a=n(179).static_images;t.default=function(e){return o.default.createElement("img",{src:a.ajax_loader_32,style:(0,i.default)({position:"absolute",left:"50%",top:"50%"},e.style)})}},232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(181)),o=d(n(182)),r=d(n(183)),a=d(n(184)),s=d(n(185)),l=n(177),u=d(l),c=d(n(328));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n.start=n.start.bind(n),n.end=n.end.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"start",value:function(e){var t=this;window.draggingSubitem=!0,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("Text","kasubitem|"+this.props.blockKey);var n=e.target.querySelector(".ka_subitem"),i=n.classList.contains("selected");n.classList.add("dragging"),n.classList.remove("selected"),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(e.target,0,0),window.setTimeout(function(){t.setState({dragging:!0}),n.classList.remove("dragging"),n.classList.toggle("selected",i)},1)}},{key:"end",value:function(e){delete window.draggingSubitem,this.setState({dragging:!1});e.target.querySelector(".ka_streamImg");this.dragThumb&&document.body.removeChild(this.dragThumb)}},{key:"render",value:function(){return u.default.createElement("div",{draggable:!0,className:this.state.dragging?"ka_draggable dragging":"ka_draggable",onDragStart:this.start,onDragEnd:this.end},u.default.createElement(c.default,null,this.props.children))}}]),t}(l.Component);t.default=f},233:function(e,t,n){(function(i){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e}(t=e.exports=n(986)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var o=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(r=o))}),e.splice(r,0,i)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n(463))},236:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var i=O(n(186)),o=O(n(181)),r=O(n(182)),a=O(n(183)),s=O(n(184)),l=O(n(185)),u=n(177),c=O(u),d=O(n(187)),f=O(n(180)),p=O(n(572)),m=n(179),h=O(m),g=O(n(191)),y=O(n(291)),v=O(n(205)),E=O(n(292)),k=n(261),_=O(k),b=O(n(293)),I=O(n(294)),C=O(n(295)),S=n(207),T=O(n(306)),D=O(n(307)),w=O(n(204)),M=O(n(203)),P=n(189),A=O(n(308)),L=n(188);function O(e){return e&&e.__esModule?e:{default:e}}e.videojs=p.default;var N=n(514).default;n(515),n(309),n(310),n(311),w.default.chrome&&((0,P.isEditingWikiPage)()||(0,P.isEditingWebpartPage)())&&n(312);var R=n(313),x=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={hover:!1,videoMeta:(0,i.default)({duration:e.duration,fileSize:e.fileSize,uploadedAt:e.uploadedAt},e.videoMeta),playerID:e.videoID+"_"+h.default.generateSimpleID(),isResizable:!n.props.disableSizing&&((0,P.isEditingWikiPage)()||(0,P.isEditingWebpartPage)()),transcode:n.props.didUpload?{progress:-1}:void 0,sessionID:(new Date).getTime(),setupMode:!1,savingPosterFromAPI:!1},n.getVideoMeta=n.getVideoMeta.bind(n),n.setVideoSource=n.setVideoSource.bind(n),n.getTranscodeProgress=n.getTranscodeProgress.bind(n),n.titleUpdated=n.titleUpdated.bind(n),n.posterUpdated=n.posterUpdated.bind(n),n.getThumbnails=n.getThumbnails.bind(n),n.isLowRes=n.isLowRes.bind(n),n.onPlayerReady=n.onPlayerReady.bind(n),n.backgroundClick=n.backgroundClick.bind(n),n.setupPlayerPage=n.setupPlayerPage.bind(n),n.setPosterSize=n.setPosterSize.bind(n),n.renderPlayer=n.renderPlayer.bind(n),n.setScriptEditorValue=n.setScriptEditorValue.bind(n),n.getSizeBasedOnParentAndAspect=n.getSizeBasedOnParentAndAspect.bind(n),n.dimensionBox=n.dimensionBox.bind(n),n.isTranscoding=n.isTranscoding.bind(n),n.isInEditor=n.isInEditor.bind(n),n.setStartTime=n.setStartTime.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.timeUpdate=n.timeUpdate.bind(n),n.sendAnalytics=n.sendAnalytics.bind(n),n.startAnalytics=n.startAnalytics.bind(n),n.stopAnalytics=n.stopAnalytics.bind(n),n.setPreviewAtTimeUsingAPI=n.setPreviewAtTimeUsingAPI.bind(n),n.openToBeginning=n.openToBeginning.bind(n),n.chunksWatched=[],n.chunksWatched_all=[],n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"isCloseToInt",value:function(e){return e-Math.floor(e)<=.06||Math.ceil(e)-e<=.06}},{key:"componentDidMount",value:function(){var e=this;if(!this.state.videoMeta||"FAILED"!==this.state.videoMeta.transcodeStatus&&"NOFILEYET"!==this.state.videoMeta.transcodeStatus){this.props.disableThumbnails||p.default.getPlugins(["thumbnails"])||p.default.registerPlugin("thumbnails",T.default);var t={};if("/_layouts/15/video/player.aspx"===window.location.pathname.toLowerCase())t.width=S.DEF_VIDEO_WIDTH;else if(this.props.width)t.width=this.props.width;else if(this.state.videoMeta&&this.state.videoMeta.originalWidth&&this.state.videoMeta.originalHeight)t=this.getSizeBasedOnParentAndAspect();else{var n=h.default.findAncestor(d.default.findDOMNode(this),"ka_block");n?t=this.getSizeBasedOnParentAndAspect(n.clientWidth):(t.width=S.DEF_VIDEO_WIDTH,t.height=S.DEF_VIDEO_HEIGHT)}this.videoNode&&(p.default.addLanguage("en",R),this.player=(0,p.default)(this.videoNode,(0,i.default)(j,t),this.onPlayerReady),this.props.disableThumbnails||this.player.one("play",function(){e.getThumbnails()})),this.state.videoMeta.mediaID&&this.state.videoMeta.transcodeStatus?"FINISHED"===this.state.videoMeta.transcodeStatus?this.setVideoSource():"PRIMARY"===this.state.videoMeta.transcodeStatus?this.setVideoSourceTemp():"FAILED"!==this.state.videoMeta.transcodeStatus&&"FAILED2"!==this.state.videoMeta.transcodeStatus||(0,P.logError)(new Error("Video transcode failed for "+this.state.videoMeta.mediaID)):this.getVideoMeta(),this.isLowRes()&&(this.player.addClass("lowres"),this.setState({lowRes:!0}));var o=this.props.fallbackPoster||window.localStorage.getItem("ka_videoPreview_"+this.props.videoID);if(o&&this.player){this.player.poster(o),this.player.el().querySelector("video").poster="";var r=new Image;r.crossOrigin="use-credentials",r.addEventListener("load",function(){var t=void 0;t=r.width/r.height<4/3?"4:3":r.width+":"+r.height,e.player.aspectRatio(t)}),r.src=o}this.setPosterSize(),this.videoNode&&this.player.one("loadedmetadata",function(){e.setState({duration:e.player.duration(),width:e.player.width(),height:e.player.height()}),h.default.isIE()&&e.setStartTime()}),this.setupPlayerPage(),w.default.chrome&&((0,P.isEditingWikiPage)()||(0,P.isEditingWebpartPage)())&&this.videoNode.setAttribute("controls","true")}}},{key:"setStartTime",value:function(){if(this.props.startTime)this.player.currentTime(this.props.startTime);else if(this.state.videoMeta.memberData){var e=this.state.videoMeta.memberData;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){console.warn("Can't parse memberData.",this.state.videoMeta)}e&&e.startTime&&this.player.currentTime(e.startTime)}}},{key:"componentWillReceiveProps",value:function(e){if(e.width!=this.props.width&&this.player){var t=this.getSizeBasedOnParentAndAspect();this.player.width(t.width),this.player.height(t.height)}}},{key:"getSizeBasedOnParentAndAspect",value:function(e,t,n){(t||(t=10),e)||(e=d.default.findDOMNode(this).parentElement.clientWidth);var i=e;n||(n=this.state.videoMeta);var o=n.originalWidth/n.originalHeight;if(!o&&this.player&&(o=this.player.videoWidth()/this.player.videoHeight()),o||(o=this.props.aspectRatio),!o)return{width:i};o<4/3&&(o=4/3);for(var r=i/o;!this.isCloseToInt(r)&&e-i<t;)r=--i/o;return r=this.isCloseToInt(r)?Math.round(r):(i=e)/o,{width:i,height:r,fluid:!1}}},{key:"componentDidUpdate",value:function(e,t,n){this.setPosterSize()}},{key:"setupPlayerPage",value:function(){var e=this;if("/_layouts/15/video/player.aspx"===window.location.pathname.toLowerCase()){var t=document.getElementById("s4-workspace")||document.body;this.setState({containerStyle:{width:S.DEF_VIDEO_WIDTH,marginLeft:(document.getElementById("s4-bodyContainer").clientWidth-S.DEF_VIDEO_WIDTH)/2,marginTop:(t.clientHeight-S.DEF_VIDEO_HEIGHT-19)/2}}),this.player.one("loadeddata",function(){e.setState({containerStyle:(0,i.default)({},e.state.containerStyle,{marginTop:(t.clientHeight-e.player.el().clientHeight-19)/2})}),window.addEventListener("resize",function(){e.windowResizeTimer_videoCentering&&(window.clearTimeout(e.windowResizeTimer_videoCentering),delete e.windowResizeTimer_videoCentering),e.windowResizeTimer_videoCentering=window.setTimeout(function(){e.player&&!e.player.isFullscreen()&&e.setState({containerStyle:(0,i.default)({},e.state.containerStyle,{marginTop:(t.clientHeight-e.player.el().clientHeight-19)/2})})},100)})})}}},{key:"onPlayerReady",value:function(){var e=this;this.player.posterImage.off(["click","tap"]),this.player.posterImage.on(["click","tap"],this.backgroundClick),h.default.isIE()||this.setStartTime(),this.player.one("play",function(){return e.player.focus()}),this.player.on("play",this.startAnalytics),this.player.on("pause",this.stopAnalytics)}},{key:"timeUpdate",value:function(){var e=Math.floor(this.player.currentTime()/this.player.duration()*100);if(e<100&&!this.chunksWatched_all.some(function(t){return t.chunkIndex===e})){var t={chunkIndex:e,timestamp:(new Date).getTime()};this.chunksWatched.push(t),this.chunksWatched_all.push(t)}}},{key:"sendAnalytics",value:function(){this.props.trackVideoWatch&&this.chunksWatched.length>0&&(this.props.trackVideoWatch(this.props.videoID,this.chunksWatched,this.state.sessionID),this.chunksWatched=[])}},{key:"startAnalytics",value:function(){this.timeUpdate(),this.analyticsWatchTimer=window.setInterval(this.timeUpdate,this.player.duration()/105),this.analyticsSendTimer=window.setInterval(this.sendAnalytics,5e3)}},{key:"stopAnalytics",value:function(){this.analyticsWatchTimer&&(window.clearInterval(this.analyticsWatchTimer),delete this.analyticsWatchTimer),this.analyticsSendTimer&&(window.clearInterval(this.analyticsSendTimer),delete this.analyticsSendTimer),this.sendAnalytics()}},{key:"backgroundClick",value:function(){this.props.onSelect?this.props.onSelect():this.state.isResizable?this.isTranscoding()||this.setState({isSelected:!0}):this.player.paused()?this.player.play():this.player.pause()}},{key:"componentWillUnmount",value:function(){this.stopGettingTranscodeProgress()}},{key:"componentWillUpdate",value:function(e,t){!this.state.hovered&&t.hovered?this.player.addClass("hover"):this.state.hovered&&!t.hovered&&this.player.removeClass("hover")}},{key:"getVideoMeta",value:function(){var e=this;g.default.get(apiUrl+"/video/"+this.props.videoID).set({Authorization:"Bearer "+h.default.getToken()}).withCredentials().then(function(t){var n=t.body.results[0];if(e.setState({videoMeta:(0,i.default)({},e.state.videoMeta,n)}),e.isLowRes(n)&&(e.player.addClass("lowres"),e.setState({lowRes:!0})),!e.props.width&&!e.props.height&&n.originalWidth&&n.originalHeight&&n.originalWidth/n.originalHeight<4/3&&e.player.aspectRatio("4:3"),"FINISHED"===n.transcodeStatus?(e.setVideoSource(),e.state.transcode&&100==e.state.transcode.progress&&(e.setState({setupMode:!0}),e.props.processingEnded&&e.props.processingEnded(e.props.videoID))):"PRIMARY"===n.transcodeStatus?(e.setVideoSourceTemp(),e.state.transcode&&100==e.state.transcode.progress&&(e.setState({setupMode:!0}),e.props.processingEnded&&e.props.processingEnded(e.props.videoID),h.default.logVideoTranscode(e.props.videoID,e.state.videoMeta.fileSize,e.state.videoMeta.duration,(new Date).getTime()-e.state.videoMeta.uploadedAt))):"PENDING"===n.transcodeStatus&&e.state.transcode&&100==e.state.transcode.progress?window.setTimeout(e.getVideoMeta,1e3):(e.startGettingTranscodeProgress(),e.player&&e.state.videoMeta.previewImageFilename&&"NOFILEYET"!==e.state.videoMeta.transcodeStatus&&"PENDING"!==e.state.videoMeta.transcodeStatus&&e.player.poster(apiUrl+"/video/"+e.props.videoID+"/blob"+e.state.videoMeta.previewImageFilename),e.player.el().querySelector("video").poster=""),n.originalWidth&&n.originalHeight){var o=d.default.findDOMNode(e);if(o){var r=h.default.findAncestor(o,"ka_block"),a=void 0;a=r?r.clientWidth:e.player.width();var s=e.getSizeBasedOnParentAndAspect(a,null,n);e.player.width(s.width),e.player.height(s.height),e.player.fluid(!1),e.setState(s)}}e.setPosterSize(n)}).catch(function(e){return(0,P.logError)(e)})}},{key:"stopGettingTranscodeProgress",value:function(){null!=this.progressGetter&&(window.clearInterval(this.progressGetter),this.progressGetter=null)}},{key:"startGettingTranscodeProgress",value:function(){var e=this;this.isInEditor()&&(this.props.processingStarted&&this.props.processingStarted(this.props.videoID),this.player&&this.player.fluid()&&this.player.fluid(!1),this.state.transcode||this.setState({transcode:{progress:-1}}),this.progressGetter=window.setInterval(function(){e.getTranscodeProgress()},3e3))}},{key:"getTranscodeProgress",value:function(){var e=this;g.default.get(apiUrl+"/video/"+this.props.videoID+"/progress").set({Authorization:"Bearer "+h.default.getToken()}).then(function(t){var n=parseInt(t.text);NaN!==n&&(n>0&&n<e.state.transcode.progress&&(n=100),e.setState({transcode:{progress:n}}),100===n&&(window.clearInterval(e.progressGetter),e.progressGetter=null,e.getVideoMeta()))}).catch(function(e){})}},{key:"setVideoSource",value:function(){if(this.player){this.state.videoMeta.previewImageFilename&&(this.player.poster(apiUrl+"/video/"+this.props.videoID+"/blob"+this.state.videoMeta.previewImageFilename),this.player.el().querySelector("video").poster="");var e=[{src:apiUrl+"/video/"+this.props.videoID+"/blob/hls/multi_bitrate_playlist.m3u8",type:"application/x-mpegURL"},{src:apiUrl+"/video/"+this.props.videoID+"/blob/mp4/high.mp4",type:"video/mp4"}];h.default.isIE()||e.unshift({src:apiUrl+"/video/"+this.props.videoID+"/blob/dash/manifest.mpd",type:"application/dash+xml"}),this.player.src(e),this.props.openToBeginning&&this.openToBeginning()}window.localStorage.removeItem("ka_videoPreview_"+this.props.videoID)}},{key:"setVideoSourceTemp",value:function(){this.player&&(this.state.videoMeta.previewImageFilename?(this.player.poster(apiUrl+"/video/"+this.props.videoID+"/blob"+this.state.videoMeta.previewImageFilename),this.player.el().querySelector("video").poster=""):console.warn("previewImageFilename not set yet",this.state.videoMeta),this.player.src([{src:apiUrl+"/video/"+this.props.videoID+"/blob/mp4/low.mp4",type:"video/mp4"}]),this.props.openToBeginning&&this.openToBeginning()),window.localStorage.removeItem("ka_videoPreview_"+this.props.videoID)}},{key:"openToBeginning",value:function(){var e=this;this.player.one("loadeddata",function(){e.player.play(),e.player.pause(),e.player.currentTime(0),window.setTimeout(function(){e.player&&!e.player.paused()&&(e.player.pause(),e.player.currentTime(0))},0)})}},{key:"getThumbnails",value:function(){var e=this;g.default.get(apiUrl+"/video/"+this.props.videoID+"/blob/thumbnails.vtt").responseType("blob").set(h.default.getAuthHeader()).withCredentials().then(function(t){e.player&&(e.player.addRemoteTextTrack({kind:"metadata",label:"thumbnails",src:window.URL.createObjectURL(t.body)},!0),e.player.thumbnails({basePath:apiUrl+"/video/"+e.props.videoID+"/blob",width:200,height:112}))}).catch(function(e){return(0,P.logError)(e)})}},{key:"titleUpdated",value:function(e){this.setState({videoMeta:(0,i.default)({},this.state.videoMeta,{title:e}),posterEditorOpen:this.state.setupMode,titleEditorOpen:!1}),this.props.releaseInputControl&&this.props.releaseInputControl()}},{key:"posterUpdated",value:function(e,t){this.player.poster(e),this.player.el().querySelector("video").poster="",this.setState({setupMode:!1,posterEditorOpen:!1}),t&&this.setState({videoMeta:(0,i.default)({},this.state.videoMeta,{previewImageFilename:t})}),this.player&&-1===this.player.poster().indexOf("/posters/")&&this.player.el().querySelector(".vjs-poster").style.removeProperty("background-size")}},{key:"setPreviewAtTimeUsingAPI",value:function(e){var t=this;this.setState({savingPosterFromAPI:!0,setupMode:!1,posterEditorOpen:!1}),g.default.post((0,L.buildReqUrl)("/video/"+this.props.videoID+"/ffmpegpreview")).query({seconds:e}).authBearer(h.default.getToken()).then(function(e){var n=e.text,i=apiUrl+"/video/"+t.props.videoID+"/blob"+n;t.posterUpdated(i,n),t.setState({savingPosterFromAPI:!1})}).catch(function(e){t.setState({savingPosterFromAPI:!1}),h.default.receivedAPIError(e),t.setState({saving:!1}),alert("Thumbnail failed to save. Please try again.")})}},{key:"isLowRes",value:function(e){return e=e||this.state.videoMeta,this.state.videoMeta&&this.videoNode&&this.state.videoMeta.originalWidth<d.default.findDOMNode(this.videoNode).clientWidth}},{key:"setPosterSize",value:function(e){var t=this;if(e||(e=this.state.videoMeta),this.player&&this.player.poster()){var n=this.player.el().querySelector(".vjs-poster");if(this.state.lowRes&&this.player&&this.player.poster().indexOf("/posters/")>-1)n.style.backgroundSize=e.originalWidth+"px "+e.originalHeight+"px";else{var i=this.state.backgroundAspectRatio;null==i?H(n,function(e){i=e,t.setState({backgroundAspectRatio:i}),W(n,i)}):W(n,i)}}}},{key:"setScriptEditorValue",value:function(e,t){var n=h.default.findAncestor(this.player.el(),"ms-rte-embedcode").getAttribute("inputfield");n||(n=h.default.findAncestor(this.player.el(),"ms-WPBody").getAttribute("webpartid2")+"scriptcontent");var i=(0,k.getShareCode)(this.props.videoID,e,t,this.props.startTime,this.props.duration,this.props.fileSize),o=document.getElementById("aspnetForm"),r=o.querySelector('input[name="'+n+'"]');r||((r=document.createElement("input")).type="hidden",r.name=n,o.appendChild(r)),r.value=i}},{key:"dimensionBox",value:function(){return this.state.dimensionBoxSize?c.default.createElement("div",{className:"ka-resizer-dimensionBox"},this.state.dimensionBoxSize.width," x ",this.state.dimensionBoxSize.height):null}},{key:"isTranscoding",value:function(){return this.state.transcode&&this.state.transcode.progress<100||"NOFILEYET"===this.state.videoMeta.transcodeStatus||"PENDING"===this.state.videoMeta.transcodeStatus}},{key:"isInEditor",value:function(){return this.props.inEditor||(0,P.isEditingWebpartPage)()||(0,P.isEditingWikiPage)()}},{key:"onKeyDown",value:function(e){32!==(e||window.event).keyCode||this.state.titleEditorOpen||this.state.posterEditorOpen||(this.player.paused()?this.player.play():this.player.pause(),e.preventDefault())}},{key:"renderPlayer",value:function(){var e=this,t=this.isInEditor();return this.state.videoMeta&&"FAILED"===this.state.videoMeta.transcodeStatus?c.default.createElement("div",{style:{textAlign:"center",padding:5,background:"lightgrey"}},"Video processing failed.",c.default.createElement("br",null),"Please try uploading your video again."):!t&&this.isTranscoding()?c.default.createElement(D.default,{width:this.props.width}):c.default.createElement("div",{className:this.props.className,style:this.state.containerStyle},c.default.createElement("div",{"data-vjs-player":!0,onClick:this.props.onClick,tabIndex:0,onKeyDown:this.onKeyDown},c.default.createElement("video",{ref:function(t){return e.videoNode=t},id:this.state.playerID,crossOrigin:!this.props.hideCog&&w.default.firefox?void 0:"use-credentials",className:"video-js vjs-big-play-centered"}),c.default.createElement("div",{className:"ka-overlayBG ka-playOverlay",onClick:this.backgroundClick}),c.default.createElement("div",{className:"ka-titleBar ka-playOverlay",onClick:this.backgroundClick},this.state.videoMeta&&c.default.createElement("div",{className:"ka-title",spellCheck:!1},this.state.videoMeta.title||this.state.videoMeta.originalFilename),t&&!this.props.hideCog&&!this.state.setupMode&&(!this.state.transcode||this.state.transcode.progress>=100)&&c.default.createElement(y.default,{videoID:this.props.videoID,width:this.props.width,height:this.props.height,setPlayerHovered:function(t){return e.setState({hovered:t})},openPosterEditor:function(){return e.setState({posterEditorOpen:!0})},openTitleEditor:function(){e.props.requestInputControl&&e.props.requestInputControl(),e.setState({titleEditorOpen:!0})},player:this.player}),!this.state.setupMode&&(!this.state.transcode||this.state.transcode.progress>=100)&&c.default.createElement("div",{className:"ka-titleIcon ka-share",onClick:function(t){t.stopPropagation(),e.props.requestInputControl&&e.props.requestInputControl(),e.setState({shareDialogOpen:!0})}},c.default.createElement("img",{src:m.static_images.share_white_20}))),this.isTranscoding()&&c.default.createElement(E.default,{fileSize:this.state.videoMeta.fileSize,videoDuration:this.state.videoMeta.duration,uploadedAt:this.state.videoMeta.uploadedAt,backgroundClick:this.backgroundClick,progress:this.state.transcode?this.state.transcode.progress:0,inEditor:this.props.inEditor}),this.state.setupMode&&c.default.createElement(b.default,{onClose:function(t){t.stopPropagation(),e.setState({setupMode:!1})},onEdit:function(t){t.stopPropagation(),e.setState({titleEditorOpen:!0}),e.props.requestInputControl&&e.props.requestInputControl()},backgroundClick:this.backgroundClick}),this.state.shareDialogOpen&&c.default.createElement(_.default,{videoID:this.props.videoID,width:this.props.width,height:this.props.height,onClose:function(){e.setState({shareDialogOpen:!1}),e.props.releaseInputControl&&e.props.releaseInputControl()},currentTime:this.props.player?Math.floor(this.props.player.currentTime()):void 0}),this.state.titleEditorOpen&&c.default.createElement(I.default,{onClose:function(){e.setState({titleEditorOpen:!1,setupMode:!1}),e.props.releaseInputControl&&e.props.releaseInputControl()},onTitleUpdated:this.titleUpdated,videoID:this.props.videoID,title:this.state.videoMeta.title,poster:this.state.videoMeta.previewImageFilename,duration:this.state.videoMeta.duration,setupMode:this.state.setupMode}),this.state.posterEditorOpen&&c.default.createElement(C.default,{onClose:function(){return e.setState({posterEditorOpen:!1,setupMode:!1})},posterUpdated:this.posterUpdated,setPreviewAtTimeUsingAPI:this.setPreviewAtTimeUsingAPI,videoID:this.props.videoID,title:this.state.videoMeta.title,previewImageFilename:this.state.videoMeta.previewImageFilename,duration:this.state.videoMeta.duration,setupMode:this.state.setupMode,playerAspectRatio:this.player.el().clientWidth/this.player.el().clientHeight}),this.state.savingPosterFromAPI&&c.default.createElement(A.default,{backgroundClick:this.backgroundClick}),this.state.duration&&c.default.createElement("div",{className:"ka-footerBar ka-playOverlay",onClick:this.backgroundClick},c.default.createElement(v.default,{duration:this.state.duration})),c.default.createElement("div",{className:"ka-videoError"},c.default.createElement("div",{className:"ka-videoErrorTitle"},"This video is currently unavailable."),c.default.createElement("div",{className:"ka-videoErroBody"},"Please try refreshing the page. If the problem persists, contact an administrator."))))}},{key:"render",value:function(){var e=this;return this.state.isResizable?c.default.createElement(M.default,{onClose:function(){return e.setState({isSelected:!1})}},c.default.createElement(N,{className:this.state.isSelected?"ka-video-resizer":void 0,enable:this.state.isSelected?B:U,size:{width:this.state.width,height:this.state.height},handleClasses:F,minWidth:S.MIN_VIDEO_WIDTH,minHeight:this.props.width&&this.props.height?S.MIN_VIDEO_WIDTH/(this.props.width/this.props.height):void 0,maxWidth:S.MAX_VIDEO_WIDTH,maxHeight:this.props.width&&this.props.height?S.MAX_VIDEO_WIDTH/(this.props.width/this.props.height):void 0,lockAspectRatio:!0,onResize:function(t,n,i,o){var r=e.state.width+o.width,a=(e.state.height,o.height,e.getSizeBasedOnParentAndAspect(r,20));e.setState({dimensionBoxSize:a}),e.player.width(a.width),e.player.height(a.height)},onResizeStop:function(t,n,i,o){var r=e.state.width+o.width,a=(e.state.height,o.height,e.getSizeBasedOnParentAndAspect(r,20));e.setState({width:a.width,height:a.height}),e.setScriptEditorValue(a.width,a.height),window.setTimeout(function(){return e.setState({dimensionBoxSize:null})},1e3)}},this.renderPlayer(),this.dimensionBox())):this.renderPlayer()}}]),t}(u.Component),U={top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},B={top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},F={topRight:"ka-video-resizer-handle",bottomRight:"ka-video-resizer-handle",bottomLeft:"ka-video-resizer-handle",topLeft:"ka-video-resizer-handle"},j={autoplay:!1,controls:!0,techOrder:["html5"],html5:{hls:{withCredentials:!0}}},H=function(e,t){var n=e.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2").split(",")[0],i=new Image;i.addEventListener("load",function(){t(i.width/i.height)}),i.src=n},W=function(e,t){var n=t-e.clientWidth/e.clientHeight;n>=-.01&&.01>=n&&0!==n&&(e.style.backgroundSize=e.clientWidth+"px "+e.clientHeight+"px")};x.propTypes={videoID:f.default.string.isRequired,width:f.default.number,height:f.default.number,startTime:f.default.number},t.default=x}).call(this,n(201))},238:function(e,t,n){},239:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviewImageBlob=void 0;var i=y(n(181)),o=y(n(182)),r=y(n(183)),a=y(n(184)),s=y(n(185)),l=n(177),u=y(l),c=y(n(187)),d=y(n(192)),f=y(n(179)),p=y(n(191)),m=(y(n(204)),n(188)),h=n(189),g=n(331);function y(e){return e&&e.__esModule?e:{default:e}}n(511),ArrayBuffer.isView||n(301),String.prototype.startsWith||n(302),String.prototype.endsWith||n(303),String.prototype.includes||n(304),String.prototype.repeat||n(262),Array.prototype.includes||n(305);var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={uploadAttempt:0,progress:0,fileObjectUrl:E(e.file)},n.abortUpload=n.abortUpload.bind(n),n.getUploadTicket=n.getUploadTicket.bind(n),n.setPlayPosition=n.setPlayPosition.bind(n),n.uploadBlob_chunked=n.uploadBlob_chunked.bind(n),n.checkIfWeCanGetAPreviewImage=n.checkIfWeCanGetAPreviewImage.bind(n),n.checkIfVideoUploadIsDone=n.checkIfVideoUploadIsDone.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.props.file&&this.getUploadTicket(this.props.file)}},{key:"componentWillUnmount",value:function(){this.abortUpload()}},{key:"abortUpload",value:function(){this.req&&(this.req.abort(),delete this.req),this.cancelUploadFilter&&(this.cancelUploadFilter.cancel=!0)}},{key:"checkIfWeCanGetAPreviewImage",value:function(e){var t=this,n=c.default.findDOMNode(this.videoNode);n.readyState>=2?k(e,n,this.checkIfVideoUploadIsDone):this.state.cantPlayLocalFile?this.checkIfVideoUploadIsDone(e):(n.addEventListener("loadeddata",function(){return k(e,n,t.checkIfVideoUploadIsDone)}),n.addEventListener("error",function(){return t.checkIfVideoUploadIsDone(e)},!0))}},{key:"checkIfVideoUploadIsDone",value:function(e){this.state.videoUploadDone?this.props.onUploadEnd(this.state.mediaID,this.state.duration):this.setState({previewImageUplaodDone:!0,mediaID:e})}},{key:"getUploadTicket",value:function(e){var t=this;this.state.uploadAttempt<2&&(this.setState({uploadAttempt:this.state.uploadAttempt+1}),this.req=p.default.post(window.apiUrl+"/subitem/uploadticket").set({Authorization:"Bearer "+f.default.getToken()}).send({SubItemType:"Video",OriginalFilename:e.name,MIMEType:e.type,fileSize:e.size,duration:this.videoNode?this.videoNode.duration:void 0}).end(function(n,i){n||!i.ok?(0,h.logError)(n||i.text):(t.checkIfWeCanGetAPreviewImage(i.body.results[0].subItemID),t.uploadBlob_chunked(e,i.body.results[0]))}))}},{key:"uploadBlob",value:function(e,t){var n=this;this.req=p.default.put(t.azureStorageSASURL).set({"x-ms-blob-type":"BlockBlob","x-ms-version":"2017-04-17"}).send(e).on("progress",function(e){n.setState({progress:e.percent}),n.setPlayPosition(e.percent)}).end(function(i,o){n.req=void 0,i||!o.ok?((0,h.logError)(i||o.text),n.abortUpload(),n.props.onUploadFail(e)):n.state.previewImageUplaodDone?n.props.onUploadEnd(t.subItemID,n.videoNode.duration):n.setState({videoUploadDone:!0,mediaID:t.subItemID,duration:n.videoNode.duration})})}},{key:"uploadBlob_chunked",value:function(e,t){var n=this;this.setState({subItemID:t.subItemID});var i=g.StorageURL.newPipeline(new g.AnonymousCredential,{}),o=new g.BlobURL(t.azureStorageSASURL,i),r=g.BlockBlobURL.fromBlobURL(o);this.uploadAborter=g.Aborter.none,(0,g.uploadBrowserDataToBlockBlob)(this.uploadAborter,e,r,{blockSize:4194304,progress:function(t){var i=t.loadedBytes/e.size*100;e.size>104857600&&(i=Math.max(i,2)),n.setState({progress:i}),n.setPlayPosition(i)}}).then(function(e){n.props.onUploadEnd(n.state.subItemID,n.videoNode.duration)}).catch(function(e){"aborted"!==e.status&&console.error(e)})}},{key:"setPlayPosition",value:function(e){this.videoNode&&this.videoNode.duration&&e&&(this.videoNode.currentTime=this.videoNode.duration*(e/100))}},{key:"render",value:function(){var e=this,t=this.props.file;return u.default.createElement(d.default,{title:"Uploading Your Video...",onClose:this.props.onClose,disableOverlayClick:!0},u.default.createElement("br",null),u.default.createElement("div",{style:{position:"relative",background:"black"}},u.default.createElement("video",{width:480,height:270,ref:function(t){return e.videoNode=t},src:this.state.fileObjectUrl,type:t.type,style:{display:"block"},onError:function(t){e.setState({cantPlayLocalFile:!0})}}),u.default.createElement("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"rgba(255,255,255,.5)"}})),u.default.createElement("div",{className:"ka_imgUploadProgress",style:{position:"static",marginTop:5}},u.default.createElement("div",{style:{width:this.state.progress+"%"}})))}}]),t}(l.Component);t.default=v;var E=function(e){try{return URL.createObjectURL(e)}catch(e){return(0,h.logError)(e),null}},k=function(e,t,n){_(t,function(i){p.default.post((0,m.buildReqUrl)("/video/"+e+"/previewimage")).authBearer(f.default.getToken()).attach("itsablob",i,t.currentTime+".png").then(function(t){n(e)}).catch(function(t){f.default.receivedAPIError(t),n(e)})})},_=t.getPreviewImageBlob=function(e,t){var n=document.createElement("canvas");n.width=e.videoWidth,n.height=e.videoHeight,n.getContext("2d").drawImage(e,0,0),n.toBlob(t)}},242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),o=r(n(192));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.title,n=e.message,r=e.confirmText,a=e.denyText,s=e.onConfirm,l=e.onDeny,u=e.onClose,c=e.redConfirm;return i.default.createElement(o.default,{onClose:u,title:t,hideX:!0},i.default.createElement("span",null,n),i.default.createElement("br",null),i.default.createElement("div",{style:{textAlign:"right",marginTop:15}},i.default.createElement("input",{type:"button",className:"ka_button",value:a||"Cancel",onClick:function(){l&&l(),u()}}),i.default.createElement("input",{type:"button",className:"ka_button"+(c?" red":""),value:r,onClick:function(){s&&s(),u()}})))}},244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={ABORTED:-2,FAILED:-1,PENDING:0,UPLOADING:1,UPLOADED:2}},245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),o=r(n(192));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.onClose,n=e.title,r=e.message;return i.default.createElement(o.default,{onClose:t,title:n,hideX:!0},i.default.createElement("span",{dangerouslySetInnerHTML:{__html:r}}),i.default.createElement("br",null),i.default.createElement("div",{style:{textAlign:"right"}},i.default.createElement("input",{type:"button",className:"ka_button",style:{marginTop:15},value:"OK",onClick:t})))}},246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(177),o=l(i),r=l(n(192)),a=n(214),s=n(179);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.onClose,n=e.fileAlerts;return o.default.createElement(r.default,{className:"ka-fileAlert",onClose:t,hideX:!0},u(n.imagesTooLarge,a.ALERT_IMAGE_SIZE),u(n.videosTooLarge,a.ALERT_VIDEO_SIZE),u(n.docsTooLarge,a.ALERT_DOC_SIZE),u(n.filesBlocked,a.ALERT_DOC_TYPE),u(n.fileUploadFailures,a.ALERT_UPLOAD_FAILED),u(n.videoUploadFailures,a.ALERT_VIDEO_FAILED),u(n.blockedVideoFormat,a.ALERT_VID_TYPE),o.default.createElement("div",{style:{textAlign:"right"}},o.default.createElement("input",{type:"button",className:"ka_button",value:"OK",onClick:t})))};var u=function(e,t){if(e&&e.length>0)return o.default.createElement("div",null,o.default.createElement("div",{className:"kamodal-title",style:{marginLeft:0}},t.title),e.map(c),o.default.createElement("span",{className:"kamodal-message",dangerouslySetInnerHTML:{__html:t.message}}))},c=function(e,t){return o.default.createElement("div",{key:t,style:{paddingTop:10}},o.default.createElement("img",{src:s.imgRoot+"yield_red_med.svg",style:{width:23,height:22,verticalAlign:"middle"}}),o.default.createElement("span",{style:{fontWeight:500,marginLeft:10}},e.name),o.default.createElement("span",{style:{fontWeight:500,marginLeft:20}},d(e.size)))},d=function(e){var t="MB";return(e=e/1024/1024)>1024&&(e/=1024,t="GB"),e>1024&&(e/=1024,t="TB"),o.default.createElement(i.Fragment,null,e.toFixed(1)," ",t)}},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(236),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default},254:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(186)),o=g(n(181)),r=g(n(182)),a=g(n(183)),s=g(n(184)),l=g(n(185)),u=n(177),c=(g(u),g(n(204)),g(n(179))),d=g(n(244)),f=g(n(191)),p=n(211),m=n(189),h=n(331);function g(e){return e&&e.__esModule?e:{default:e}}ArrayBuffer.isView||n(301),String.prototype.startsWith||n(302),String.prototype.endsWith||n(303),String.prototype.includes||n(304),String.prototype.repeat||n(262),Array.prototype.includes||n(305);var y=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={uploadAttempt:0,checkAttempt:0},n.checkExists=n.checkExists.bind(n),n.checkExists_doc=n.checkExists_doc.bind(n),n.checkExists_img=n.checkExists_img.bind(n),n.uploadComplete=n.uploadComplete.bind(n),n.uploadBlob_chunked=n.uploadBlob_chunked.bind(n),n.alreadyRecheckedGifAnimation=0,n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.props.file.status===d.default.ABORTED&&(this.props.file.status=d.default.PENDING),this.props.file.status===d.default.PENDING&&this.props.autoStart&&this.getUploadTicket(this.props.file)}},{key:"componentWillReceiveProps",value:function(e){e.file.status===d.default.PENDING&&e.autoStart&&this.getUploadTicket(e.file)}},{key:"componentWillUnmount",value:function(){this.abortUpload(),this.checkerTimeout&&window.clearTimeout(this.checkerTimeout),this.props.uploadProps.onUploadEnd&&this.props.file.uploadStatus===d.default.UPLOADING&&this.props.uploadProps.onUploadEnd((0,i.default)(this.props.file,{status:d.default.ABORTED}))}},{key:"getUploadTicket",value:function(e){var t=this;c.default.validateToken(function(){var n=t.props.uploadProps,o=n.onUploadStart,r=n.onUploadEnd,a=n.getUploadHeader,s=void 0===a?function(){return{}}:a;t.state.uploadAttempt<2&&(t.setState({uploadAttempt:t.state.uploadAttempt+1}),"function"==typeof o&&o((0,i.default)(e,{status:d.default.UPLOADING})),t.req=f.default.post(window.apiUrl+"/subitem/uploadticket").set(s()).send({SubItemType:t.props.subItemType,OriginalFilename:e.name,MIMEType:e.type}).end(function(n,o){n||!o.ok?((0,m.logError)(n||o.text),"function"==typeof r&&(r((0,i.default)(e,{error:n,status:d.default.FAILED})),t.props.removeBlock())):t.uploadBlob_chunked(e,o.body.results[0])}))})}},{key:"uploadBlob",value:function(e,t){var n=this,o=this.props.uploadProps,r=o.onUploadEnd,a=o.onUploadProgress;this.req=f.default.put(t.azureStorageSASURL).set({"x-ms-blob-type":"BlockBlob","x-ms-version":"2017-04-17"}).send(e).on("progress",function(t){"function"==typeof a&&("video"===n.props.subItemType.toLowerCase()?a(t.percent,e):a(.8*t.percent,e))}).end(function(o,a){n.req=void 0,o||!a.ok?((0,m.logError)(o||a.text),"function"==typeof r&&(r((0,i.default)(e,{error:o,status:d.default.FAILED})),n.props.removeBlock())):"video"===n.props.subItemType.toLowerCase()?n.uploadComplete(t,e):n.checkExists(t,e)})}},{key:"uploadBlob_chunked",value:function(e,t){var n=this;this.setState({subItemID:t.subItemID});var i=h.StorageURL.newPipeline(new h.AnonymousCredential,{}),o=new h.BlobURL(t.azureStorageSASURL,i),r=h.BlockBlobURL.fromBlobURL(o);this.uploadAborter=h.Aborter.none,(0,h.uploadBrowserDataToBlockBlob)(this.uploadAborter,e,r,{blockSize:4194304,progress:function(t){var i=t.loadedBytes/e.size*100;e.size>104857600&&(i=Math.max(i,2)),"video"===n.props.subItemType.toLowerCase()?n.props.uploadProps.onUploadProgress(i,e):n.props.uploadProps.onUploadProgress(.8*i,e)}}).then(function(i){"video"===n.props.subItemType.toLowerCase()?n.uploadComplete(t,e):n.checkExists(t,e)}).catch(function(e){"aborted"!==e.status&&console.error(e)})}},{key:"checkExists",value:function(e,t){var n=this;this.checkerTimeout=window.setTimeout(function(){n.checkerTimeout=null,"function"==typeof n.props.uploadProps.onUploadProgress&&n.props.uploadProps.onUploadProgress(n.getPostProcessingProgress(n.state.checkAttempt+1),t),n.setState({checkAttempt:n.state.checkAttempt+1}),"Document"===n.props.subItemType?n.checkExists_doc(e,t):"Image"===n.props.subItemType&&n.checkExists_img(e,t)},1e3)}},{key:"checkExists_doc",value:function(e,t){var n=this;this.req=f.default.head("/_layouts/15/media/exist.ashx").query({type:this.props.subItemType,id:e.subItemID,filename:"Image"!==this.props.subItemType?t.name:void 0,size:"Image"===this.props.subItemType?this.props.imageSize.width+"w"+this.props.imageSize.height+"h":void 0}).end(function(o,r){n.req=void 0,o||!r.ok?((0,m.logError)(o||r.text),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:d.default.FAILED})),n.props.removeBlock())):204===r.status?n.state.checkAttempt<30?n.checkExists(e,t):n.state.uploadAttempt<2?(n.setState({checkAttempt:0}),console.warn("Failed to process uploaded file after 1 attempt. Trying again.",t),n.getUploadTicket(t)):(console.error("Failed to process uploaded file after 2 attempts.",t),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:d.default.FAILED})),n.props.removeBlock())):("function"==typeof n.props.uploadProps.onUploadProgress&&n.props.uploadProps.onUploadProgress(100,t),window.setTimeout(function(){n.uploadComplete(e,t)},1e3))})}},{key:"checkExists_img",value:function(e,t){var n=this;this.req=f.default.head(apiUrl+"/media/"+e.subItemID).set(c.default.getAuthHeader()).query({size:this.props.imageSize.width+"w"+this.props.imageSize.height+"h"}).then(function(o){n.req=void 0,204===o.status?n.state.checkAttempt<30?n.checkExists(e,t):n.state.uploadAttempt<2?(n.setState({checkAttempt:0}),console.warn("Failed to process uploaded file after 1 attempt. Trying again.",t),n.getUploadTicket(t)):(console.error("Failed to process uploaded file after 2 attempts.",t),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:d.default.FAILED})),n.props.removeBlock())):t.name.toLowerCase().indexOf(".gif")>-1&&!o.headers.animatedoriginal&&n.alreadyRecheckedGifAnimation<3?(n.alreadyRecheckedGifAnimation++,n.checkExists(e,t)):("function"==typeof n.props.uploadProps.onUploadProgress&&n.props.uploadProps.onUploadProgress(100,t),window.setTimeout(function(){n.uploadComplete(e,t,"true"===o.headers.animatedoriginal?"anim":void 0)},1e3))}).catch(function(e){(0,m.logError)(e||res.text),"function"==typeof n.props.uploadProps.onUploadEnd&&(n.props.uploadProps.onUploadEnd((0,i.default)(t,{status:d.default.FAILED})),n.props.removeBlock())})}},{key:"uploadComplete",value:function(e,t,n){this.props.swapPendingForCollection(this.props.entityKey,t.index,{collectionType:this.props.subItemType,collectionMembers:[(0,i.default)({memberType:this.props.subItemType},this.getCollectionMemberProps(e,t,n))]}),this.props.uploadProps.onUploadEnd((0,i.default)(t,{status:d.default.UPLOADED}))}},{key:"getPostProcessingProgress",value:function(e){return 80+20/30*e}},{key:"getCollectionMemberProps",value:function(e,t,n){switch(e.subItemType){case"Image":return{mediaList:[{mediaID:e.subItemID,dataUrl:t.dataUrl,mediaType:n}]};case"Video":return{mediaID:e.subItemID,title:t.name};case"Document":return{documentID:e.subItemID,fromSharepoint:!1,title:t.name,documentType:p.RE_FILE_EXTENSION.exec(t.name)[1]};default:throw new Error("Unsupported subItemType returned when requesting upload ticket: "+e.subItemType)}}},{key:"abortUpload",value:function(){this.req&&this.req.abort(),this.uploadAborter&&this.uploadAborter.abort(),this.cancelUploadFilter&&(this.cancelUploadFilter.cancel=!0),this.props.uploadProps.onUploadEnd&&this.props.uploadProps.onUploadEnd((0,i.default)(this.props.file,{status:d.default.ABORTED}))}},{key:"render",value:function(){return this.props.children}}]),t}(u.Component);t.default=y},257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITEMS_PER_PAGE=void 0;var i=d(n(222)),o=d(n(186)),r=n(188),a=d(n(276)),s=d(n(179)),l=n(258),u=n(214),c=n(189);function d(e){return e&&e.__esModule?e:{default:e}}t.ITEMS_PER_PAGE=10;var f={items:(0,a.default)(),newItems:[],updatedItems:[],belowItems:[],deletedItems:[]},p=(0,o.default)({isSPAdmin:!1,isFetching:!0,isThreadView:m(),isListLessMode:!m()&&"less"==(localStorage.getItem("moreOrLess")||"less"),streamView:(0,l.getViewsToShow)(!1,!1).indexOf(h())>-1?h():(0,l.getViewsToShow)(!1,!1)[0],filters:g(),filterOperation:window.streamFilterOperation||"Or",maxItems:window.streamMaxItems||0,isViewMenuOpen:!1,didInvalidate:!1,endOfStream:!1,isOnLine:navigator.onLine},f);function m(){var e=g();return e.length>0&&(e.filter(function(e){return null!=e.StreamItem}).length>0||e.filter(function(e){return null!=e.BlogPost}).length>0)}function h(){return localStorage.getItem("streamView")||"All"}function g(){return void 0===window.streamFilters&&(window.streamFilters=null),null!=window.streamFilters&&window.streamFilters.length>0?window.streamFilters:null!=(0,c.getQueryStringValue)("ItemID")?[{StreamItem:(0,c.getQueryStringValue)("ItemID")}]:null!=(0,c.getQueryStringValue)("Hashtag")?[{Hashtag:decodeURIComponent((0,c.getQueryStringValue)("Hashtag"))}]:null!=(0,c.getQueryStringValue)("Employee")?[{Author:(0,c.getQueryStringValue)("Employee")}]:null!=(0,c.getQueryStringValue)("Project")?[{Project:(0,c.getQueryStringValue)("Project")}]:null!=(0,c.getQueryStringValue)("Opportunity")?[{Opportunity:(0,c.getQueryStringValue)("Opportunity")}]:null!=(0,c.getQueryStringValue)("Company")?[{Company:(0,c.getQueryStringValue)("Company")}]:null!=(0,c.getQueryStringValue)("Contact")?[{Contact:(0,c.getQueryStringValue)("Contact")}]:window.location.pathname.toLowerCase().endsWith("post.aspx")&&!window.location.pathname.toLowerCase().endsWith("newpost.aspx")?[{BlogPost:(0,c.getQueryStringValue)("List").toUpperCase()+"|"+(0,c.getQueryStringValue)("ID")}]:window.location.pathname.toLowerCase().endsWith("category.aspx")?[{BlogCategory:window.location}]:s.default.isHome()?[]:[{Community:communityID}]}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments[1];switch(t.type){case r.GOT_STREAM_CONFIG:return(0,o.default)({},e,t.config);case r.SET_LIST_LESS_MODE:return localStorage.setItem("moreOrLess","less"),(0,o.default)({},e,{isListLessMode:!0,items:(0,a.default)(e.items,t)});case r.SET_LIST_MORE_MODE:return localStorage.setItem("moreOrLess","more"),(0,o.default)({},e,{isListLessMode:!1,items:(0,a.default)(e.items,t)});case r.TOGGLE_VIEW_MENU:return(0,o.default)({},e,{isViewMenuOpen:!e.isViewMenuOpen});case r.SET_STREAM_VIEW:return-1!==l.views_Persistable.indexOf(t.newView)&&localStorage.setItem("streamView",t.newView),(0,o.default)({},e,{isViewMenuOpen:!1,streamView:t.newView},f);case r.SET_IS_ONLINE:return(0,o.default)({},e,{isOnLine:t.isOnLine,warnOffline:!t.isOnLine&&(e.items||[]).find(function(e){return e.commentDrafts&&e.commentDrafts.length>0})?u.OUTAGE_BANNERS.isEditing.number:0});case r.SET_WARN_OFFLINE:return(0,o.default)({},e,{warnOffline:t.showWarning?t.bannerNumber:0});case r.SET_WARN_BROKEN_USER:return(0,o.default)({},e,{warnBrokenUser:t.showWarning});case r.UPDATED_ITEM_PROMOTTION:return(0,o.default)({},e,f);case r.DELETED_ITEM:case r.UNDELETE_ITEM:return e.isThreadView?(0,o.default)({},e,{items:(0,a.default)(e.items,t,e.isListLessMode)}):(0,o.default)({},e,{items:e.items.filter(function(e){return e.itemID!=t.itemID})});case r.REQUEST_ITEMS:return(0,o.default)({},e,{isFetching:!0});case r.RECEIVE_ITEMS:var n=e.items.concat((0,a.default)(t.items,t,e.isListLessMode));return n=s.default.uniqueItems(n),(0,o.default)({},e,{isSPAdmin:s.default.isSPAdmin(),isFetching:!1,endOfStream:0==t.items.length||e.maxItems>0&&n.length>=e.maxItems||e.isThreadView,items:n,receiveError:null});case r.COULDNT_RECEIVE_ITEMS:return(0,o.default)({},e,{receiveError:t.error});case r.SET_IS_FETCHING:return(0,o.default)({},e,{isFetching:t.isFetching});case r.RECEIVE_UPDATED_ITEMS:var c=new Date(s.default.getMaxModDate(e.items,e.newItems,e.updatedItems,e.belowItems,e.deletedItems)),d=t.items.filter(function(e){return e.deleted}),m=t.items.filter(function(t){return!t.deleted&&null!=e.items.find(function(e){return t.itemID===e.itemID})}),h=t.items.filter(function(t){return!t.deleted&&null==e.items.find(function(e){return t.itemID===e.itemID})&&null==e.newItems.find(function(e){return t.itemID===e.itemID})}),g=t.items.filter(function(t){return null!=e.newItems.find(function(e){return t.itemID===e.itemID})}),y=h.filter(function(e){return new Date(e.dateStamp)>c}),v=y.filter(function(e){return"New Blog Post"===e.itemType&&e.author&&e.author.employeeID===currentEmployee.employeeID}),E=y.filter(function(e){return null==v.find(function(t){return e.itemID===t.itemID})}),k=h.filter(function(e){return new Date(e.dateStamp)<c});return(0,o.default)({},e,{items:[].concat((0,i.default)(e.items.filter(function(e){return e.promoted})),(0,i.default)((0,a.default)(v,t).map(function(t){return(0,o.default)({},t,{isLessMode:e.isListLessMode})})),(0,i.default)(e.items.filter(function(e){return!e.promoted}))),newItems:[].concat((0,i.default)(E),(0,i.default)(e.newItems.filter(function(e){return null==d.find(function(t){return e.itemID===t.itemID})}).map(function(e){return g.find(function(t){return e.itemID===t.itemID})||e}))),updatedItems:[].concat((0,i.default)(m),(0,i.default)(e.updatedItems.filter(function(e){return null==m.find(function(t){return e.itemID===t.itemID})&&null==d.find(function(t){return e.itemID===t.itemID})}))),belowItems:[].concat((0,i.default)(e.belowItems.filter(function(e){return null==d.find(function(t){return e.itemID===t.itemID})})),(0,i.default)(k)),deletedItems:[].concat((0,i.default)(d),(0,i.default)(e.deletedItems.filter(function(e){return null==d.find(function(t){return e.itemID===t.itemID})})))});case r.SHARED_STREAM_ITEM:return null==t.item||"null"===t.item?(alert("null stream item returned"),e):(0,o.default)({},e,{items:[].concat((0,i.default)(e.items.filter(function(e){return e.promoted})),(0,i.default)((0,a.default)([t.item],t,e.isListLessMode)),(0,i.default)(e.items.filter(function(e){return!e.promoted})))});case r.SHOW_NEW_ITEMS:var _=(0,a.default)(e.newItems,t).map(function(t){return t.isLessMode=e.isListLessMode,t}),b=_.filter(function(e){return e.promoted}),I=_.filter(function(e){return!e.promoted}),C=e.items.filter(function(e){return e.promoted}),S=e.items.filter(function(e){return!e.promoted}),T=[].concat((0,i.default)(b),(0,i.default)(C),(0,i.default)(I),(0,i.default)(S));return 0!==e.maxItems&&T.splice(e.maxItems),(0,o.default)({},e,{items:T,newItems:[],endOfStream:e.maxItems>0&&T.length>=e.maxItems});case r.SET_ACTION_ERROR:return(0,o.default)({},e,{actionError:t.error});default:return(0,o.default)({},e,{items:(0,a.default)(e.items,t,e.isListLessMode)})}}},258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.views_Persistable=t.getViewsToShow=void 0;var i=s(n(177)),o=s(n(180)),r=s(n(190)),a=s(n(203));function s(e){return e&&e.__esModule?e:{default:e}}if(null==l)var l=n(179).static_images;var u=function(e){var t=e.isListLessMode,n=e.setListLessMode,o=e.setListMoreMode,s=e.isViewMenuOpen,u=e.isThreadView,d=e.isSPAdmin,f=e.apiFilterEnabled,p=e.toggleViewMenu,m=e.currentView,h=e.setView;if(u)return null;var g=c(d,f);return i.default.createElement("div",{style:{margin:"0 15px 14px 5px",textAlign:"center"}},i.default.createElement("ul",{className:(0,r.default)("ka_streamViews","dropdown",s?"open":null)},i.default.createElement("li",null,i.default.createElement("span",{onClick:p},E[m],i.default.createElement("img",{src:l.more_caret_dk_grey_14,style:{marginLeft:5}})),s&&i.default.createElement(a.default,{onClose:p},i.default.createElement("ul",{style:{visibility:"visible"}},g.map(function(e){return e!==m?i.default.createElement("li",{key:e},i.default.createElement("span",{onClick:function(){return h(e)}},E[e])):null}))))),i.default.createElement("div",{className:"ka_streamMoreLess"},i.default.createElement("span",{onClick:function(){n()},className:t?"linkActive":"linkInactive"},"Less")," | ",i.default.createElement("span",{onClick:function(){o()},className:t?"linkInactive":"linkActive"},"More")),i.default.createElement("div",{style:{width:0,clear:"both"}}))},c=t.getViewsToShow=function(e,t){return window.location.pathname.endsWith("StreamAdmin.aspx")?t?m:p:window.location.pathname.endsWith("Topic.aspx")?e?t?v:y:f:"undefined"!=typeof urlTemplates&&"/"===urlTemplates.communityUrls[communityID]?e?t?g:h:d:e?t?v:y:f},d=(t.views_Persistable=["All","ImFollowing"],["All","ImFollowing","MostActive"]),f=["All","MostActive"],p=["All","Promoted","Removed"],m=["All","Promoted","Published","Removed"],h=["All","ImFollowing","MostActive","Promoted","Removed"],g=["All","ImFollowing","MostActive","Promoted","Published","Removed"],y=["All","MostActive","Promoted","Removed"],v=["All","MostActive","Promoted","Published","Removed"],E={All:"All Items",ImFollowing:"I'm Following",MostActive:"Most Active",Promoted:"Promoted",Published:"Published",Removed:"Removed"};u.propTypes={isListLessMode:o.default.bool.isRequired,setListLessMode:o.default.func.isRequired,setListMoreMode:o.default.func.isRequired,isViewMenuOpen:o.default.bool,isThreadView:o.default.bool,toggleViewMenu:o.default.func.isRequired,currentView:o.default.string,setView:o.default.func.isRequired,isSPAdmin:o.default.bool,apiFilterEnabled:o.default.bool},t.default=u},259:function(e,t,n){},261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShareCode=void 0;var i=y(n(181)),o=y(n(182)),r=y(n(183)),a=y(n(184)),s=y(n(185)),l=n(177),u=y(l),c=y(n(187)),d=y(n(180)),f=y(n(192)),p=n(179),m=n(205),h=n(207),g=y(n(499));function y(e){return e&&e.__esModule?e:{default:e}}n(238);var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e)),r=e.width?parseInt(e.width):h.DEF_VIDEO_WIDTH,s=e.height?parseInt(e.height):h.DEF_VIDEO_HEIGHT;return n.state={shareStartChecked:!1,shareStartValue:n.props.currentTime?(0,m.toHHMMSS)(n.props.currentTime):"0:00",shareStartTime:n.props.currentTime||0,shareStartChecked_embed:!1,shareStartValue_embed:n.props.currentTime?(0,m.toHHMMSS)(n.props.currentTime):"0:00",shareStartTime_embed:n.props.currentTime||0,shareWidth:r,shareHeight:s,aspectRatio:r/s},n.getShareUrl=n.getShareUrl.bind(n),n.updateShareWidth=n.updateShareWidth.bind(n),n.updateShareHeight=n.updateShareHeight.bind(n),n.shareWidthKeyDown=n.shareWidthKeyDown.bind(n),n.shareHeightKeyDown=n.shareHeightKeyDown.bind(n),n.shareWidthChanged=n.shareWidthChanged.bind(n),n.shareHeightChanged=n.shareHeightChanged.bind(n),n.startCheckChanged=n.startCheckChanged.bind(n),n.startValueChanged=n.startValueChanged.bind(n),n.startValueBlur=n.startValueBlur.bind(n),n.startCheckChanged_embed=n.startCheckChanged_embed.bind(n),n.startValueChanged_embed=n.startValueChanged_embed.bind(n),n.startValueBlur_embed=n.startValueBlur_embed.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{title:"Share This Video on Your Intranet",titleHelp:u.default.createElement("img",{src:p.static_images.help_dark,width:20,height:20,"data-tip":E}),onClose:this.props.onClose},u.default.createElement("div",{className:"kamodal-subtitle"},"Share in a Post or Comment"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{ref:function(t){return e.shareUrl=t},type:"text",value:this.getShareUrl(),onChange:function(){},style:{width:350},onClick:function(){return e.copyText(e.shareUrl)}}),u.default.createElement("span",{className:"linkActive",style:{marginLeft:10},onClick:function(){return e.copyText(e.shareUrl)}},u.default.createElement("img",{src:p.static_images.link_cyan_16,style:{marginRight:10,verticalAlign:"middle"},width:16,height:20}),"Copy URL")),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{type:"checkbox",checked:this.state.shareStartChecked,onChange:this.startCheckChanged})," Start video at  ",u.default.createElement("input",{type:"text",value:this.state.shareStartValue,onChange:this.startValueChanged,onBlur:this.startValueBlur,className:"ka-little-input"})),u.default.createElement("div",{className:"kamodal-subtitle"},"Embed in a Wiki Page",u.default.createElement("img",{src:p.static_images.help_dark,width:20,height:20,style:{verticalAlign:"middle",marginLeft:10},"data-tip":k})),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("textarea",{ref:function(t){return e.embedCode=t},style:{resize:"vertical",width:350,height:35,overflow:"hidden"},value:this.getShareCode(),onChange:function(){},spellCheck:!1,onClick:function(){return e.copyText(e.embedCode)}}),u.default.createElement("span",{className:"linkActive",style:{marginLeft:10},onClick:function(){return e.copyText(e.embedCode)}},u.default.createElement("img",{src:p.static_images.embed_code_cyan,style:{marginRight:10,verticalAlign:"middle"},width:24,height:24}),"Copy Embed Code")),u.default.createElement("div",{className:"kamodal-block"},"Video Size:  ",u.default.createElement("input",{type:"text",value:this.state.shareWidth,onChange:this.shareWidthChanged,onKeyDown:this.shareWidthKeyDown,className:"ka-little-input"}),"  x  ",u.default.createElement("input",{type:"text",value:this.state.shareHeight,onChange:this.shareHeightChanged,onKeyDown:this.shareHeightKeyDown,className:"ka-little-input"}),"  pixels"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{type:"checkbox",checked:this.state.shareStartChecked_embed,onChange:this.startCheckChanged_embed})," Start video at  ",u.default.createElement("input",{type:"text",value:this.state.shareStartValue_embed,onChange:this.startValueChanged_embed,onBlur:this.startValueBlur_embed,className:"ka-little-input"}))),c.default.createPortal(u.default.createElement(l.Fragment,null,u.default.createElement(g.default,{place:"top",type:"light",effect:"solid",className:"ka-tooltip",scrollHide:!0,html:!0,delayHide:1500})),document.body)," ")}},{key:"getShareUrl",value:function(){var e=window.location.origin+"/_layouts/video/player.aspx?id="+this.props.videoID;return this.state.shareStartChecked&&0!==this.state.shareStartTime&&(e+="&start="+this.state.shareStartTime),e}},{key:"getShareCode",value:function(){return b(this.props.videoID,this.state.shareWidth,this.state.shareHeight,this.state.shareStartChecked_embed?this.state.shareStartTime_embed:void 0)}},{key:"shareWidthChanged",value:function(e){/[^0-9]/.test(e.target.value)||this.updateShareWidth(parseInt(e.target.value))}},{key:"shareWidthKeyDown",value:function(e){switch(e.keyCode){case 38:this.updateShareWidth(this.state.shareWidth+1),e.stopPropagation();break;case 40:this.updateShareWidth(this.state.shareWidth-1),e.stopPropagation()}}},{key:"updateShareWidth",value:function(e){this.setState({shareWidth:e,shareHeight:Math.round(e/this.state.aspectRatio)})}},{key:"shareHeightChanged",value:function(e){/[^0-9]/.test(e.target.value)||this.updateShareHeight(parseInt(e.target.value))}},{key:"shareHeightKeyDown",value:function(e){switch(e.keyCode){case 38:this.updateShareHeight(this.state.shareHeight+1),e.stopPropagation();break;case 40:this.updateShareHeight(this.state.shareHeight-1),e.stopPropagation()}}},{key:"updateShareHeight",value:function(e){this.setState({shareHeight:e,shareWidth:Math.round(e*this.state.aspectRatio)})}},{key:"startCheckChanged",value:function(e){this.setState({shareStartChecked:e.target.checked})}},{key:"startValueChanged",value:function(e){/[^0-9:]/.test(e.target.value)||this.setState({shareStartValue:e.target.value,shareStartChecked:!0,shareStartTime:_(e.target.value)||0})}},{key:"startValueBlur",value:function(e){_(e.target.value)?this.setState({shareStartValue:(0,m.toHHMMSS)(this.state.shareStartTime)}):this.setState({shareStartValue:"0:00"})}},{key:"startCheckChanged_embed",value:function(e){this.setState({shareStartChecked_embed:e.target.checked})}},{key:"startValueChanged_embed",value:function(e){/[^0-9:]/.test(e.target.value)||this.setState({shareStartValue_embed:e.target.value,shareStartChecked_embed:!0,shareStartTime_embed:_(e.target.value)||0})}},{key:"startValueBlur_embed",value:function(e){_(e.target.value)?this.setState({shareStartValue_embed:(0,m.toHHMMSS)(this.state.shareStartTime_embed)}):this.setState({shareStartValue_embed:"0:00"})}},{key:"copyText",value:function(e){e.select(),document.execCommand("Copy")}}]),t}(l.Component),E='Can Synthesis Videos be shared outside our Intranet? Nope! This URL and Embed Code only works within your intranet. Learn more in <a href="https://knowledgearchitecture.zendesk.com/hc/en-us/articles/360015148192-Can-Synthesis-Native-Video-Be-Shared-Outside-Our-Intranet-" target="_blank">this article</a>.',k="To embed this video in a Wiki Page:<br/><br/><span style='font-weight:500'>1.</span> Copy code below.<br/><span style='font-weight:500'>2.</span> Edit your Wiki Page.<br/><span style='font-weight:500'>3.</span> Click on Insert ribbon.<br/><span style='font-weight:500'>4.</span> Click on Embed Code tool.<br/><span style='font-weight:500'>5.</span> Paste in your code and click Insert.",_=function(e){var t=e.split(":");switch(t.length){case 1:return parseInt(t[0])||0;case 2:return 60*(parseInt(t[0])||0)+(parseInt(t[1])||0);case 3:return 60*(parseInt(t[0])||0)*60+60*(parseInt(t[1])||0)+(parseInt(t[2])||0);default:return NaN}},b=function(e,t,n,i,o,r,a){var s='<ka-video id="'+e+'" width="'+(t||h.DEF_VIDEO_WIDTH)+'" height="'+(n||h.DEF_VIDEO_HEIGHT)+'"';return i&&(s+=' start="'+i+'"'),o&&(s+=' duration="'+o+'"'),r&&(s+=' fileSize="'+r+'"'),a&&(s+=' uploaded="'+a+'"'),s+="></ka-video>"};t.getShareCode=b,v.propTypes={currentTime:d.default.number},t.default=v},269:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(186)),o=r(n(177));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=(0,i.default)({},e);return delete t.enabled,1==e.enabled?o.default.createElement("a",t):o.default.createElement("span",t)}},273:function(e,t,n){var i,o=n(993),r=n(681),a=n(995),s=n(996),l=n(997);"undefined"!=typeof ArrayBuffer&&(i=n(998));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=u||c;t.protocol=3;var f=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=o(f),m={type:"error",data:"parser error"},h=n(999);function g(e,t,n){for(var i=new Array(e.length),o=s(e.length,n),r=function(e,n,o){t(n,function(t,n){i[e]=n,o(t,i)})},a=0;a<e.length;a++)r(a,e[a],o)}t.encodePacket=function(e,n,i,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof i&&(o=i,i=null);var r=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var o=e.data,r=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=f[e.type];for(var s=0;s<r.length;s++)a[s+1]=r[s];return i(a.buffer)}(e,n,o);if(void 0!==h&&r instanceof h)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);if(d)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,i)},o.readAsArrayBuffer(e.data)}(e,n,i);var o=new Uint8Array(1);o[0]=f[e.type];var r=new h([o.buffer,e.data]);return i(r)}(e,n,o);if(r&&r.base64)return function(e,n){var i="b"+t.packets[e.type]+e.data.data;return n(i)}(e,o);var a=f[e.type];return void 0!==e.data&&(a+=i?l.encode(String(e.data),{strict:!1}):String(e.data)),o(""+a)},t.encodeBase64Packet=function(e,n){var i,o="b"+t.packets[e.type];if(void 0!==h&&e.data instanceof h){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];n(o+e)},r.readAsDataURL(e.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),l=0;l<a.length;l++)s[l]=a[l];i=String.fromCharCode.apply(null,s)}return o+=btoa(i),n(o)},t.decodePacket=function(e,n,i){if(void 0===e)return m;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(i&&!1===(e=function(e){try{e=l.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return m;var o=e.charAt(0);return Number(o)==o&&p[o]?e.length>1?{type:p[o],data:e.substring(1)}:{type:p[o]}:m}o=new Uint8Array(e)[0];var r=a(e,1);return h&&"blob"===n&&(r=new h([r])),{type:p[o],data:r}},t.decodeBase64Packet=function(e,t){var n=p[e.charAt(0)];if(!i)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=i.decode(e.substr(1));return"blob"===t&&h&&(o=new h([o])),{type:n,data:o}},t.encodePayload=function(e,n,i){"function"==typeof n&&(i=n,n=null);var o=r(e);if(n&&o)return h&&!d?t.encodePayloadAsBlob(e,i):t.encodePayloadAsArrayBuffer(e,i);if(!e.length)return i("0:");g(e,function(e,i){t.encodePacket(e,!!o&&n,!1,function(e){i(null,function(e){return e.length+":"+e}(e))})},function(e,t){return i(t.join(""))})},t.decodePayload=function(e,n,i){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,i);var o;if("function"==typeof n&&(i=n,n=null),""===e)return i(m,0,1);for(var r,a,s="",l=0,u=e.length;l<u;l++){var c=e.charAt(l);if(":"===c){if(""===s||s!=(r=Number(s)))return i(m,0,1);if(s!=(a=e.substr(l+1,r)).length)return i(m,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),m.type===o.type&&m.data===o.data)return i(m,0,1);if(!1===i(o,l+r,u))return}l+=r,s=""}else s+=c}return""!==s?i(m,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var i=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),o=new Uint8Array(i),r=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);n=i.buffer}o[r++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)o[r++]=parseInt(s[a]);o[r++]=255;for(i=new Uint8Array(n),a=0;a<i.length;a++)o[r++]=i[a]}),n(o.buffer)})},t.encodePayloadAsBlob=function(e,n){g(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);e=i.buffer,t[0]=0}var r=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(r.length+1);for(o=0;o<r.length;o++)a[o]=parseInt(r[o]);if(a[r.length]=255,h){var s=new h([t.buffer,a.buffer,e]);n(null,s)}})},function(e,t){return n(new h(t))})},t.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var o=e,r=[];o.byteLength>0;){for(var s=new Uint8Array(o),l=0===s[0],u="",c=1;255!==s[c];c++){if(u.length>310)return i(m,0,1);u+=s[c]}o=a(o,2+u.length),u=parseInt(u);var d=a(o,0,u);if(l)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var f=new Uint8Array(d);d="";for(c=0;c<f.length;c++)d+=String.fromCharCode(f[c])}r.push(d),o=a(o,u)}var p=r.length;r.forEach(function(e,o){i(t.decodePacket(e,n,!0),o,p)})}},276:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(222)),o=u(n(186)),r=n(188),a=u(n(277)),s=u(n(278)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213));function u(e){return e&&e.__esModule?e:{default:e}}var c={isLiking:!1,isAddingComment:!1,showingAllComments:!1,isEditingTags:!1},d=function(e,t){return{isLiking:e.isLiking,isAddingComment:e.isAddingComment,showingAllComments:e.showingAllComments,isEditingTags:e.isEditingTags,isLessMode:void 0!==e.isLessMode?e.isLessMode:t,isContentLessMode:void 0!==e.isContentLessMode?e.isContentLessMode:t,isCommenting:e.isCommenting}},f=function(e,t,n){switch(t.type){case r.DELETE_ITEM:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isRemoving:!0});case r.DELETED_ITEM:case r.UNDELETED_ITEM:return e.itemID!==t.itemID?e:(0,o.default)({},t.item,d(e,n));case r.SET_CONTENT_TALL:return e.itemID!==t.itemID?e:(0,o.default)({},e,{contentIsTall:t.contentIsTall});case r.TOGGLE_ITEM_LESS_MODE:return e.itemID!==t.itemID?e:(e.isContentLessMode&&l.trackPostOpen(e),(0,o.default)({},e,{isLessMode:!e.isLessMode,isContentLessMode:!e.isLessMode}));case r.TOGGLE_CONTENT_LESS_MODE:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isContentLessMode:!e.isContentLessMode});case r.TOGGLE_SEMI_LESS_MODE:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isLessMode:!e.isLessMode});case r.TOGGLE_TAG_EDITOR:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isEditingTags:!e.isEditingTags});case r.SHOW_ALL_COMMENTS:return e.itemID!==t.itemID?e:(0,o.default)({},e,{showingAllComments:!0});case r.SET_LIST_LESS_MODE:return(0,o.default)({},e,{isLessMode:!0,isContentLessMode:!0});case r.SET_LIST_MORE_MODE:return(0,o.default)({},e,{isLessMode:!1,isContentLessMode:!1});case r.ADD_ITEM_LIKE:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isLiking:!0,likes:[].concat((0,i.default)(e.likes||[]),[{author:currentEmployee}])});case r.DELETE_ITEM_LIKE:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isLiking:!0,likes:(e.likes||[]).filter(function(e){return e.author.employeeID.toLowerCase()!=currentEmployee.employeeID.toLowerCase()})});case r.ADDED_ITEM_LIKE:case r.DELETED_ITEM_LIKE:return e.itemID!==t.itemID?e:(0,o.default)({},t.item,d(e,n),{isLiking:!1});case r.ADD_ITEM_SUBSCRIPTION:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isSubscribing:!0,isNotify:1});case r.DELETE_ITEM_SUBSCRIPTION:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isSubscribing:!0,isNotify:0});case r.ADDED_ITEM_SUBSCRIPTION:case r.DELETED_ITEM_SUBSCRIPTION:return e.itemID!==t.itemID?e:(0,o.default)({},e,{isSubscribing:!1});case r.ADDING_ITEM_TAG:return e.itemID!==t.itemID?e:t.tag.hashtag?(0,o.default)({},e,{hashtags:[].concat((0,i.default)(e.hashtags||[]),[(0,o.default)({},t.tag,{deleted:!1})])}):(0,o.default)({},e,{mentions:[].concat((0,i.default)(e.mentions||[]),[(0,o.default)({},t.tag,{deleted:!1,hasProfile:!0})])});case r.DELETING_ITEM_TAG:return e.itemID!==t.itemID?e:t.tag.hashtag?(0,o.default)({},e,{hashtags:e.hashtags.map(function(e){return e.hashtag===t.tag.hashtag?(0,o.default)({},e,{deleted:!0}):e})}):(0,o.default)({},e,{mentions:e.mentions.map(function(e){return e.entityType===t.tag.entityType&&e.entityID==t.tag.entityID?(0,o.default)({},e,{deleted:!0}):e})});case r.ADDED_ITEM_TAG:case r.DELETED_ITEM_TAG:case r.SET_IS_COMMENTING:return e.itemID!==t.itemID?e:null==t.commentID?t.isCommenting?(0,o.default)({},e,{commentDrafts:(0,s.default)(e.commentDrafts,t)}):(0,o.default)({},e,{commentDrafts:[]}):(0,o.default)({},e,{comments:(0,a.default)(e.comments,t)});case r.ADD_ITEM_COMMENT:return e.itemID!==t.comment.itemID?e:(0,o.default)({},e,{isAddingComment:!0,comments:(0,a.default)(e.comments,t),commentDrafts:[],mentions:(e.mentions||[]).concat(t.comment.mentions||[]),hashtags:(e.hashtags||[]).concat(t.comment.hashtags||[]),commentEditorState:t.editorState,restoreCommentEditorState:null});case r.ADDED_ITEM_COMMENT:return e.itemID!==t.itemID?e:(0,o.default)({},t.item,d(e,n),{comments:(0,a.default)(e.comments,t),isAddingComment:!1,commentEditorState:null});case r.UPDATE_ITEM_COMMENT:return e.itemID!==t.comment.itemID?e:(0,o.default)({},e,{comments:(0,a.default)(e.comments,t),mentions:[].concat((0,i.default)(e.mentions||[]),(0,i.default)(t.comment.mentions||[])),hashtags:[].concat((0,i.default)(e.hashtags||[]),(0,i.default)(t.comment.hashtags||[]))});case r.UPDATED_ITEM_COMMENT:return e.itemID!==t.itemID?e:(0,o.default)({},t.item,d(e,n),{comments:(0,a.default)(e.comments,t)});case r.RESTORE_COMMENT_EDITOR:if(e.itemID!==t.itemID)return e;if(null==t.commentID)return(0,o.default)({},e,{restoreCommentEditorState:e.commentEditorState,commentEditorState:null,isAddingComment:!1});if(null!=t.commentID)return(0,o.default)({},e,{comments:(0,a.default)(e.comments,t)});case r.SAVED_COMMENT_DRAFT:return e.itemID!==t.commentDraft.itemID?e:(0,o.default)({},e,{commentDrafts:(0,s.default)(e.commentDrafts,t)});case r.RECEIVE_ITEMS:case r.SHOW_NEW_ITEMS:case r.SHARED_STREAM_ITEM:case r.RECEIVE_UPDATED_ITEMS:return(0,o.default)({},e,{comments:(0,a.default)(e.comments,t)},c,{isLessMode:!(e.commentDrafts&&e.commentDrafts.length>0)&&n,isContentLessMode:n});default:return t.itemID&&t.itemID!==e.itemID?e:(0,o.default)({},e,{comments:(0,a.default)(e.comments,t),commentDrafts:(0,s.default)(e.commentDrafts,t)})}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.map(function(e){return f(e,t,n)})}},277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(186),r=(i=o)&&i.__esModule?i:{default:i},a=n(188);var s={isLessMode:!0,isDraft:!1},l=(0,r.default)({},s,{isLessMode:!0}),u=function(e,t){switch(t.type){case a.RECEIVE_ITEMS:case a.SHOW_NEW_ITEMS:case a.RECEIVE_UPDATED_ITEMS:return(0,r.default)({},e,s);case a.UPDATED_ITEM_COMMENT:return(0,r.default)({},t.item.comments.find(function(e){return e.commentID===t.commentID}),s,{isLessMode:!1});case a.TOGGLE_COMMENT_LESS_MODE:return(0,r.default)({},e,{isLessMode:!e.isLessMode,hasLessMode:!0});case a.SET_IS_COMMENTING:return(0,r.default)({},e,{isCommenting:t.isCommenting});case a.UPDATE_ITEM_COMMENT:return(0,r.default)({},e,{editorState:t.editorState,jsonContent:t.comment.jsonContent,draftJsContent:t.comment.draftJsContent,mentions:t.comment.mentions},s,{isLessMode:!1});case a.RESTORE_COMMENT_EDITOR:return(0,r.default)({},e,{restoreEditorState:c.editorState,editorState:null});default:return e}};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case a.RECEIVE_ITEMS:case a.SHOW_NEW_ITEMS:case a.RECEIVE_UPDATED_ITEMS:return e.map(function(e){return u(e,t)});case a.ADDED_ITEM_COMMENT:var n=e.filter(function(e){return null!=t.item.comments.find(function(t){return e.commentID===t.commentID})}),i=t.item.comments.filter(function(e){return null==n.find(function(t){return e.commentID===t.commentID})}).map(function(e){return(0,r.default)(e,l)});return n.concat(i).map(function(e){return u(e,t)});case a.ADD_ITEM_COMMENT:return(e||[]).concat((0,r.default)({author:currentEmployee,isPending:!0},l,t.comment));case a.UPDATED_ITEM_COMMENT:var o=t.item.comments.find(function(e){return e.commentID===t.commentID});return e.map(function(e){return e.commentID!=t.commentID?e:(0,r.default)({isLessMode:e.isDraft},o)});case a.DELETE_COMMENT:case a.DELETED_COMMENT:return e.filter(function(e){return e.commentID!=t.commentID});default:return e.map(function(e){return e.commentID!=t.commentID?e:u(e,t)})}}},278:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(186),r=(i=o)&&i.__esModule?i:{default:i},a=n(188),s=n(208);var l={isDraft:!0,editCount:0};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case a.SET_IS_COMMENTING:return e.concat((0,r.default)({itemID:t.itemID},l));case a.SET_DRAFT_STATUS:return e.map(function(e,n){return 0===n?(0,r.default)({},e,{draftSaveStatus:t.draftSaveStatus}):e});case a.SAVED_COMMENT_DRAFT:return[(0,r.default)({},e[0],{commentID:t.commentDraft.commentID,editCount:t.commentDraft.editCount,draftSaveStatus:s.draftSaveStatuses.saved,draftJsContent:t.commentDraft.draftJsContent,subitems:t.commentDraft.subitems||t.commentDraft.subItemCollections})];case a.DELETE_COMMENT:case a.DELETED_COMMENT:return e.filter(function(e){return e.commentID!=t.commentID});default:return e}}},279:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSubject=t.getSubjectImageUrl=t.renderFormattedContent=t.renderJsonContent=void 0;var i=D(n(186)),o=D(n(181)),r=D(n(182)),a=D(n(183)),s=D(n(184)),l=D(n(185)),u=n(177),c=D(u),d=D(n(187)),f=D(n(180)),p=D(n(190)),m=D(n(280)),h=D(n(516)),g=D(n(519)),y=D(n(526)),v=D(n(527)),E=D(n(530)),k=D(n(560)),_=n(179),b=D(_),I=n(209),C=D(n(562)),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213)),T=n(189);function D(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={},n.toggleItemLessMode=n.toggleItemLessMode.bind(n),n.trackSubitem=n.trackSubitem.bind(n),n.linkClicked=n.linkClicked.bind(n),n.authorClicked=n.authorClicked.bind(n),e.isThreadView&&e.item&&(document.title=b.default.replaceInlineTagsWithText(e.item.title,e.item.mentions)),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidCatch",value:function(e,t){(0,T.logError)(e,this.props.item),this.setState({error:e})}},{key:"toggleItemLessMode",value:function(e){var t=this;this.props.item.isLessMode||b.default.compensateScrollPosition(d.default.findDOMNode(this).querySelector(".ka_streamItemToggle"),function(){return d.default.findDOMNode(t).querySelector(".ka_streamItemToggle")},function(){return t.props.toggleItemLessMode(e)})}},{key:"trackSubitem",value:function(e,t,n,i,o){"Video"===e&&o===S.eventTypes.watch?S.trackVideoWatch(i.videoID,i.chunksWatched,i.sessionID,this.props.item):S.trackPostSubitemClick(e,t,n,this.props.item)}},{key:"linkClicked",value:function(e,t,n){var i=(0,T.getLinkTarget)(e.target);i&&(i.className.indexOf("ka_mention_link")>-1||i.className.indexOf("ka_hashtag_link")>-1?S.trackPostTagClick(i.href,i.text,t||i.getAttribute("entityType"),n||i.getAttribute("entityID"),this.props.item):i.className.indexOf("ka_authorName")>-1?S.trackPostAuthorClick(i.href,i.text,this.props.item):S.trackPostLinkClick(i.href,i.text,this.props.item))}},{key:"authorClicked",value:function(e){S.trackPostAuthorClick(e.target.href,e.target.text,this.props.item)}},{key:"render",value:function(){var e=this,t=this.props,n=t.item,i=t.presenceEnabled,o=(t.checkContentTall,t.toggleItemLessMode),r=t.toggleTagEditor;if(this.state.error)return M(n.itemID);if(n.isRemoving&&!this.props.isThreadView)return null;if(n.deleted&&!b.default.isSPAdmin()&&n.author.employeeID!==employeeID)return c.default.createElement("div",{style:{textAlign:"center",padding:"30px 0",fontWeight:500}},"This post has been removed from the stream.");void 0===n.contentIsTall?(0,p.default)("ka_streamItemContent","less"):!0===n.contentIsTall&&(0,p.default)("ka_streamItemContent","lessTall");var a=F(n.subjectType,n.subjectID,n.author,n.mentions,n.entityOverride);null===a&&console.error("No subject entity found for item "+n.itemID);var s=a.entityType,l=b.default.getEntityID(a),u=!a.deleted&&(a.hasProfile||null!=b.default.getEntityInDirectory(a)&&"Y"===b.default.getEntityInDirectory(a).toUpperCase()),d=b.default.getEntityName(a),f=a.primaryImageID||a.entityImageID,_=c.default.createElement("img",{className:"imgSubjectImage"+("Employee"===s?" ka_circular":""),src:B(f,s)}),S=c.default.createElement("a",{href:b.default.getProfileUrl(s,l),onClick:this.authorClicked},_),T=c.default.createElement("a",{className:"ka_authorName",href:b.default.getProfileUrl(s,l),onClick:this.authorClicked},d),D={content:null,trimmed:!1};n.jsonContent?D=P(n.jsonContent,n.subitems,n.author,n.mentions,n.hashtags,n.isContentLessMode,"ka_streamItemContent",{width:I.INT_STREAM_IMAGE_WIDTH,height:I.INT_STREAM_IMAGE_HEIGHT},I.INT_STREAM_LESS_CHARS,!0,this.trackSubitem,this.linkClicked):n.formattedContent&&(D=A(n.formattedContent,n.subitems,n.author,n.mentions,n.hashtags,n.isContentLessMode,"New Event"===n.itemType,"ka_streamItemContent",I.INT_STREAM_LESS_CHARS,this.linkClicked));var w=n.isContentLessMode&&(D.trimmed||null!=n.subitems&&n.subitems.length>0&&"Image"===n.subitems[0].collectionType);return c.default.createElement("div",{className:"updatesRow"+(n.promoted?" Promoted":"")+(n.isLessMode?" less":""),onClick:function(e){n.isLessMode&&o(n.itemID)},style:n.isLessMode?{cursor:"pointer"}:null},c.default.createElement("div",{className:"ka_subject"},u?S:_,i&&null!=a.email&&a.email.indexOf("@")>-1&&c.default.createElement("span",{className:"ms-imnSpan ka_streamPresence",style:{display:"none"},dangerouslySetInnerHTML:{__html:'\n                            <a href="#" onclick="IMNImageOnClick(event);return false;" class="ms-imnlink ms-spimn-presenceLink">\n                                <span class=\'ms-spimn-presenceWrapper ms-imnImg ms-spimn-imgSize-10x10\'>\n                                    <img onload=\'KA_IMNRC("'+a.email+"\",this)' name='imnmark' title='' ShowOfflinePawn='0' class='ms-spimn-img ms-spimn-presence-disconnected-10x10x32' src='/_layouts/15/images/spimn.png?rev=23' alt='User Presence' sip='"+a.email+"' id='imn_"+n.itemID+",type=smtp' />\n                                </span>\n                            </a>\n                            "}}),u?T:d,c.default.createElement("span",{className:"ka_streamDate ka_streamItemDate"},n.promoted?"PROMOTED":b.default.formatDateTimeStamp(n.dateStamp))),c.default.createElement("div",{className:"divStreamBody"},c.default.createElement(C.default,{streamItem:n},n.isLessMode?c.default.createElement("span",{className:"ka_streamItemTitle",dangerouslySetInnerHTML:{__html:b.default.replaceInlineTagsWithText(n.title,n.mentions)}}):c.default.createElement("a",{className:"ka_streamItemTitle",href:urlTemplates.threadUrl+"?ItemID="+n.itemID,dangerouslySetInnerHTML:{__html:b.default.replaceInlineTagsWithText(n.title,n.mentions)}})),c.default.createElement("div",{onClick:w?function(){return e.props.toggleContentLessMode(n.itemID)}:void 0,style:w?{cursor:"pointer"}:void 0},D.content,"New Event"===n.itemType&&!n.jsonContent&&n.subitems&&n.subitems.length>0&&n.subitems[0].collectionMembers&&n.subitems[0].collectionMembers.length>0&&n.subitems[0].collectionMembers[0].description&&c.default.createElement("div",{className:"ka_streamItemContent",dangerouslySetInnerHTML:{__html:n.subitems[0].collectionMembers[0].description},key:"text"}),"New Blog Post"===n.itemType&&n.isContentLessMode&&null!=n.subItemImageURL?c.default.createElement("div",{className:"ka_streamLessImg"},c.default.createElement("img",{src:n.subItemImageURL})):null,!n.jsonContent&&c.default.createElement(m.default,{subitemCollections:n.subitems,isLessMode:n.isContentLessMode,imageSize:{width:I.INT_STREAM_IMAGE_WIDTH,height:I.INT_STREAM_IMAGE_HEIGHT},className:"ka_SubItemContainer",trackSubitem:this.trackSubitem})),n.isLessMode?c.default.createElement(h.default,{itemID:n.itemID}):[c.default.createElement(g.default,{itemID:n.itemID,key:"controls",showContentMoreToggle:w}),n.isEditingTags?c.default.createElement(k.default,{className:"ka_streamSubBox",itemID:n.itemID,key:"tags",onClose:function(){return r(n.itemID)}}):null,c.default.createElement(v.default,{itemID:n.itemID,key:"likes"}),c.default.createElement(E.default,{itemID:n.itemID,key:"comments",focusEditor:this.state.focusCommentEditor}),c.default.createElement(y.default,{item:n,showItemModeToggle:!w,toggleItemLessMode:function(){return e.toggleItemLessMode(n.itemID)},tagClicked:this.linkClicked,blogCategories:n.blogCategories,key:"footer"})]))}}]),t}(u.Component),M=function(e){return c.default.createElement("div",{className:"ka_brokenPost"},c.default.createElement("div",{className:"divSubjectImage"},c.default.createElement("img",{src:_.imgRoot+"yield_cyan_lrg.svg"})),c.default.createElement("div",{className:"divStreamBody"},e?c.default.createElement("span",{className:"ka_streamItemTitle"},"Post ",e," Cannot Be Displayed"):c.default.createElement("span",{className:"ka_streamItemTitle"},"This Post Cannot Be Displayed"),c.default.createElement("div",{className:"ka_streamItemContent"},"Please contact an administrator.")))},P=t.renderJsonContent=function(e,t,n,i,o,r,a,s,l,u,d,f){var p=!1,h=void 0,g="string"==typeof e?JSON.parse(e):e,y=null!=g[0].collectionID||null!=g[0].collection;null==t&&g.filter(function(e){return null!=e.collection}).length>0&&(t=g.filter(function(e){return null!=e.collection}).map(function(e){return e.collection}));var v=null!=t&&t.length>0;if(g.forEach(function(e){e.html&&(e.html=b.default.replaceInlineTagsWithLink(e.html,n,i,o))}),r){var E=g.filter(function(e){return void 0===e.collectionID});u&&(E=E.filter(function(e){return""!=b.default.getTextFromHtml(e.html).trim()}));var k=void 0;if(u)k=E.length>0?E.slice(0,1):[];else{var _=g.find(function(e){return void 0!==e.collectionID});if(void 0===_)k=g;else{g.indexOf(_);if(y){k=[];for(var I=1;I<g.length;I++)if(void 0===g[I].collectionID)k.push(g[I]);else if(k.length>0)break}else k=g.slice(0,g.indexOf(_))}}if(k.length!==g.filter(function(e){return void 0===e.collectionID}).length&&(p=!0),E.length>k.length){var C=document.createElement("div"),S=k[k.length-1];C.innerHTML=S.html,N(C),S.html=C.innerHTML}var T=O((g=k).map(function(e){return e.html}).join(""),l,u),D=T.content.trim();p=p||T.trimmed,h=""==D?v?c.default.createElement(m.default,{subitemCollections:t,isLessMode:r,className:"ka_SubItemContainer",imageSize:s,trackSubitem:d}):null:y?[c.default.createElement(m.default,{subitemCollections:t,isLessMode:r,className:"ka_SubItemContainer",imageSize:s,key:"subitem",trackSubitem:d}),c.default.createElement("div",{className:a,dangerouslySetInnerHTML:{__html:D},onClick:f,key:"text"})]:v?[c.default.createElement("div",{className:a+" leadingText",dangerouslySetInnerHTML:{__html:D},onClick:f,key:"text"}),c.default.createElement(m.default,{subitemCollections:t,isLessMode:r,className:"ka_SubItemContainer",imageSize:s,key:"subitem",trackSubitem:d})]:c.default.createElement("div",{className:a+" leadingText",dangerouslySetInnerHTML:{__html:D},onClick:f})}else h=c.default.createElement("div",{className:a},g.map(function(e,n){if(void 0!==e.html)return c.default.createElement("div",{className:0===n?"leadingText":void 0,dangerouslySetInnerHTML:{__html:e.html},key:n,onClick:f});if(t&&void 0!==e.collectionID){0===n&&void 0===e.html&&(a+=" leadingSubItem");var i=t.find(function(t){return t.collectionID===e.collectionID});return c.default.createElement(m.default,{subitemCollections:[i],isLessMode:r,className:r?"ka_SubItemContainer":"",imageSize:s,trackSubitem:d,key:n})}return e.collection&&e.collection.collectionMembers&&e.collection.collectionMembers.length>0?c.default.createElement(m.default,{subitemCollections:[e.collection],isLessMode:r,className:r?"ka_SubItemContainer":"",imageSize:s,trackSubitem:d,key:n}):void 0}));return{content:h,trimmed:p}},A=t.renderFormattedContent=function(e,t,n,i,o,r,a,s,l,u){var d=!1,f=e||"";if(f=b.default.replaceInlineTagsWithLink(f,n,i,o),a&&null!=t&&null!=t[0].collectionMembers&&(f=t[0].collectionMembers[0].description||""),r){var p=O(f,l);f=p.content,d=p.trimmed}return{content:c.default.createElement("div",{className:s+" leadingText",dangerouslySetInnerHTML:{__html:f},onClick:u}),trimmed:d}},L=[" ",".",",","?","!"," "],O=function(e,t,n){var i=0,o=!1,r=!1,a=document.createElement("div");a.innerHTML=e;for(var s=[],l=document.createTreeWalker(a,NodeFilter.SHOW_ALL,null,null),u=void 0;u=l.nextNode();)if(i>=t||r)o=!0,s.push(u);else if("IMG"===u.nodeName||n&&"BR"===u.nodeName)r=!0,o=!0,s.push(u);else if("#text"===u.nodeName){var c=u.nodeValue;if("\n"==c||null==c||""==c)s.push(u);else if(i+c.length>t){o=!0;var d=t-i,f=c.substring(0,d);i+=f.length;for(var p=c.substring(f.length,f.length+1)[0],m=f.length>0?f.slice(-1):"a";f.length>0&&(-1===L.indexOf(p)||L.indexOf(m)>-1);)p=f.slice(-1),m=(f=f.slice(0,-1)).length>0?f.slice(-1):"a";0===f.length?s.push(u):u.nodeValue=f}else i+=c.length}return s.forEach(function(e){return U(e)}),R(a),x(a),e=a.innerHTML.trim(),o&&e.length>0&&(N(a),e=a.innerHTML.trim()),{content:e,trimmed:o}},N=function(e){var t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,null).lastChild();null==t||t.nodeValue.endsWith("&hellip;")||t.nodeValue.endsWith("…")||t.nodeValue.endsWith("...")||("A"!==t.parentNode.nodeName?t.nodeValue=b.default.trimTrailingPunctuation(t.nodeValue)+"…":t.parentNode.parentNode.innerHTML+="…")},R=function(e){for(;1==e.childNodes.length&&("P"===e.childNodes[0].nodeName||"DIV"===e.childNodes[0].nodeName);)e.innerHTML=e.childNodes[0].innerHTML},x=function e(t){for(;t.childNodes.length>0&&"BR"===t.childNodes[t.childNodes.length-1].nodeName;)t.removeChild(t.childNodes[t.childNodes.length-1]);t.childNodes.length>0&&e(t.childNodes[t.childNodes.length-1])},U=function e(t){try{null==t.parentNode?t.innerHTML="":1==t.parentNode.childNodes.lount?e(t.parentNode):t.parentNode.removeChild(t)}catch(e){}},B=t.getSubjectImageUrl=function(e,t){return null!=e?b.default.getImageURL(t,e,50,50,!0):urlTemplates.placeholderUrl+"?id="+t+"&size=50w50h_fxd"},F=t.getSubject=function(e,t,n,o,r){if(r&&"Author"===r&&n)return(0,i.default)(n,{entityType:"Employee"});if(null==e&&null!=n)return(0,i.default)(n,{entityType:"Employee"});if("Employee"===e&&null!=n&&t===n.employeeID)return(0,i.default)(n,{entityType:"Employee"});if(null!=o){var a=o.find(function(n){return n.entityType===e&&b.default.getEntityID(n)===t});if(null!=a)return a}return null};w.propTypes={item:f.default.object.isRequired,presenceEnabled:f.default.bool,isThreadView:f.default.bool,toggleItemLessMode:f.default.func.isRequired,checkContentTall:f.default.func.isRequired,toggleTagEditor:f.default.func.isRequired},t.default=w},280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=v(n(181)),o=v(n(182)),r=v(n(183)),a=v(n(184)),s=v(n(185)),l=n(177),u=v(l),c=v(n(180)),d=v(n(281)),f=v(n(286)),p=v(n(287)),m=v(n(493)),h=v(n(288)),g=v(n(249)),y=n(213);function v(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={alreadyClicked:!1},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.subitemCollections,i=t.isLessMode,o=t.className,r=t.imageSize,a=t.trackSubitem;return n&&n.length>0?(n=n.filter(function(e){return!e.deleted}),i&&n.length>1&&(n=[n[0]]),u.default.createElement("div",{className:o},n.map(function(t,n){if(void 0===t)return"There was an error displaying this item.";var o=t.collectionType,s=t.collectionID;return t.collectionMembers.map(function(t,l){var c=a&&!e.state.alreadyClicked?function(){a(o,s,t,void 0,y.eventTypes.click),e.setState({alreadyClicked:!0})}:void 0;switch(o){case"Image":return u.default.createElement(d.default,{images:t.mediaList,isLessMode:i,imageSize:r,onClick:c,key:n+"."+l});case"oEmbedContent":return u.default.createElement(f.default,{body:t.body,onClick:c,key:n+"."+l});case"Link":return u.default.createElement(p.default,{link:t,isLessMode:i,onClick:c,key:n+"."+l});case"CalendarEvent":return u.default.createElement(m.default,{event:t,onClick:c,key:n+"."+l});case"Document":return u.default.createElement(h.default,{document:t,onClick:c,key:n+"."+l});case"Video":return u.default.createElement(g.default,{videoID:t.mediaID,className:"ka_subitem",videoMeta:t,onClick:function(e){c&&c(),e.stopPropagation()},trackVideoWatch:function(e,n,i){return a(o,s,t,{videoID:e,chunksWatched:n,sessionID:i},y.eventTypes.watch)},key:n+"."+l})}})}))):null}}]),t}(l.Component);E.propTypes={subitemCollections:c.default.array,isLessMode:c.default.bool.isRequired,className:c.default.string},t.default=E},281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(282),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default},282:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processDataUrl=void 0;var i=E(n(206)),o=E(n(181)),r=E(n(182)),a=E(n(183)),s=E(n(184)),l=E(n(185)),u=n(177),c=E(u),d=E(n(180)),f=E(n(581)),p=E(n(190)),m=E(n(332)),h=E(n(492)),g=E(n(179)),y=n(209),v=E(n(285));function E(e){return e&&e.__esModule?e:{default:e}}var k=function(e){return c.default.createElement("button",{type:"button",className:e.className,onClick:e.onClick},c.default.createElement("img",{src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png"}))},_={lazyLoad:!0,nextArrow:c.default.createElement(k,{className:"slick-next"}),prevArrow:c.default.createElement(k,{className:"slick-prev"})},b=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={currentImageIndex:0},n.renderContent=n.renderContent.bind(n),n.hasNext=n.hasNext.bind(n),n.hasPrev=n.hasPrev.bind(n),n.onNext=n.onNext.bind(n),n.onPrev=n.onPrev.bind(n),n.changeModalToMediaID=n.changeModalToMediaID.bind(n),n.imageClick=n.imageClick.bind(n),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"imageUrl",value:function(e,t,n){return n?g.default.getGifURL(e):g.default.getImageURL(null,e,this.props.imageSize.width,t?333:this.props.imageSize.height,!1)}},{key:"hasNext",value:function(){return this.props.images.length>this.state.currentImageIndex+1}},{key:"hasPrev",value:function(){return this.state.currentImageIndex>0}},{key:"onNext",value:function(){this.slider.slickNext(),this.changeModalToMediaID(this.props.images[this.state.currentImageIndex+1].mediaID),this.setState({currentImageIndex:this.state.currentImageIndex+1})}},{key:"onPrev",value:function(){this.slider.slickPrev(),this.changeModalToMediaID(this.props.images[this.state.currentImageIndex-1].mediaID),this.setState({currentImageIndex:this.state.currentImageIndex-1})}},{key:"changeModalToMediaID",value:function(e){if(this.state.mediaModalTarget){var t=document.createElement("img");t.setAttribute("src",this.imageUrl(e,!0)),this.setState({mediaModalTarget:t})}}},{key:"render",value:function(){var e=this;return c.default.createElement("div",{spellCheck:!1,className:"ka_imgOutterBox"},this.renderContent(),this.state.mediaModalTarget&&c.default.createElement(m.default,{isOpened:!0},c.default.createElement(h.default,{target:this.state.mediaModalTarget,onClose:function(){return e.setState({mediaModalTarget:null})},onLeft:this.hasPrev()?this.onPrev:null,onRight:this.hasNext()?this.onNext:null})))}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.images,o=t.isLessMode,r=t.isSelected,a="anim"===n[0].mediaType;return 1==n.length?c.default.createElement("div",{className:"ka_imgBox ka_subitem"+(r?" selected":"")+(a?" gif":""),onClick:a?void 0:function(t){return e.imageClick(I(t.target),n[0],0)}},a?c.default.createElement(v.default,{className:(0,p.default)("ka_streamImg ",o?"less":"more"),src:n[0].dataUrl||this.imageUrl(n[0].mediaID,!1,!1),image:n[0],animSrc:this.imageUrl(n[0].mediaID,!1,!0),onClick:this.props.onClick,handleClick:this.props.handleClick}):c.default.createElement("img",{className:(0,p.default)("ka_streamImg",o?"less":"more"),src:n[0].dataUrl||this.imageUrl(n[0].mediaID,!1),onClick:function(t){return e.imageClick(t.target,n[0],0)},draggable:!1})):o?c.default.createElement("div",{className:"ka_streamSliderPreview"},c.default.createElement("span",{className:"lblViewAllPhotos"},"View all ",n.length," photos"),c.default.createElement("img",{src:this.imageUrl(n[0].mediaID,!1)})):c.default.createElement(f.default,(0,i.default)({ref:function(t){return e.slider=t}},_),n.map(function(t,n){return c.default.createElement("div",{key:n},c.default.createElement("img",{src:t.dataUrl||e.imageUrl(t.mediaID,!0),onClick:function(i){return e.imageClick(i.target,t,n)}}))}))}},{key:"imageClick",value:function(e,t,n){this.props.handleClick&&this.props.handleClick(n,e)||(this.props.onClick&&this.props.onClick(),t.dataUrl||this.props.isLessMode||this.setState({mediaModalTarget:e,currentImageIndex:n}))}}]),t}(u.Component),I=function(e){return"IMG"===e.tagName?e:e.querySelector("img.ka_streamImg")};t.processDataUrl=function(e,t){if(!e)return e;var n=C(function(e){e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var t=atob(e),n=t.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=t.charCodeAt(o);return i.buffer}(e)),i=document.createElement("img");i.addEventListener("load",function(){var e=i.width,o=i.height,r=document.createElement("canvas");if([5,6,7,8].indexOf(n)>-1){var a=o>y.INT_STREAM_IMAGE_WIDTH?o/y.INT_STREAM_IMAGE_WIDTH:1;r.width=o/=a,r.height=e/=a}else{var s=e>y.INT_STREAM_IMAGE_WIDTH?e/y.INT_STREAM_IMAGE_WIDTH:1;r.width=e/=s,r.height=o/=s}var l=r.getContext("2d");switch(n){case 2:l.transform(-1,0,0,1,e,0);break;case 3:l.transform(-1,0,0,-1,e,o);break;case 4:l.transform(1,0,0,-1,0,o);break;case 5:l.transform(0,1,1,0,0,0);break;case 6:l.transform(0,1,-1,0,o,0);break;case 7:l.transform(0,-1,-1,0,o,e);break;case 8:l.transform(0,-1,1,0,0,e);break;default:l.transform(1,0,0,1,0,0)}l.drawImage(i,0,0,e,o),t(r.toDataURL())}),i.src=e};b.propTypes={images:d.default.array.isRequired,isLessMode:d.default.bool.isRequired,isSelected:d.default.bool},t.default=b;var C=function(e){var t=new window.DataView(e);if(65496!=t.getUint16(0,!1))return-2;for(var n=t.byteLength,i=2;i<n;){var o=t.getUint16(i,!1);if(i+=2,65505==o){if(1165519206!=t.getUint32(i+=2,!1))return-1;var r=18761==t.getUint16(i+=6,!1);i+=t.getUint32(i+4,r);var a=t.getUint16(i,r);i+=2;for(var s=0;s<a;s++)if(274==t.getUint16(i+12*s,r))return t.getUint16(i+12*s+8,r)}else{if(65280!=(65280&o))break;i+=t.getUint16(i,!1)}}return-1}},283:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(206)),o=h(n(186)),r=h(n(181)),a=h(n(182)),s=h(n(183)),l=h(n(184)),u=h(n(185)),c=n(177),d=h(c),f=h(n(187)),p=n(179),m=(h(p),n(570));function h(e){return e&&e.__esModule?e:{default:e}}n(259);var g=function(e){function t(e){(0,a.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.state={playing:!1},n.onControlClick=n.onControlClick.bind(n),n.onBackgroundClick=n.onBackgroundClick.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.imgLoaded=n.imgLoaded.bind(n),n.renderGif=n.renderGif.bind(n),n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=f.default.findDOMNode(this.img);e.complete?this.imgLoaded():e.addEventListener("load",this.imgLoaded)}},{key:"onControlClick",value:function(e){e.stopPropagation(),this.props.onClick&&this.props.onClick(),this.setState({playing:!this.state.playing})}},{key:"onBackgroundClick",value:function(e){e.stopPropagation(),this.props.handleClick&&this.props.handleClick(0,this.img)||(this.props.onClick&&this.props.onClick(),this.setState({playing:!this.state.playing}))}},{key:"onKeyDown",value:function(e){32===(e||window.event).keyCode&&(this.setState({playing:!this.state.playing}),e.preventDefault())}},{key:"imgLoaded",value:function(){this.setState({loaded:!0})}},{key:"renderGif",value:function(){var e=this,t=(0,o.default)({},this.props);return delete t.animSrc,delete t.image,delete t.handleClick,delete t.onClick,this.state.playing||this.preLoaded||window.setTimeout(function(){(new Image).src=e.props.animSrc,e.preLoaded=!0},1),d.default.createElement("div",{className:"ka_gif_container",draggable:!1,tabIndex:0,onKeyDown:this.onKeyDown,onClick:this.onBackgroundClick},d.default.createElement("img",(0,i.default)({},t,{src:this.state.playing?this.props.animSrc:this.props.src,draggable:!1,ref:function(t){return e.img=t}})),this.state.loaded?d.default.createElement(c.Fragment,null,this.state.playing?d.default.createElement("img",{className:"ka_gif_play playing",src:p.imgRoot+"GIF_Pause.png",onClick:this.onControlClick,draggable:!1}):d.default.createElement("img",{className:"ka_gif_play paused",src:p.imgRoot+"GIF_Play.png",onClick:this.onControlClick,draggable:!1}),this.state.playing?null:d.default.createElement("div",{className:"ka_gif_label",draggable:!1},"GIF")):null)}},{key:"render",value:function(){var e=this.props.image?this.props.image.mediaID:this.props.src.split("id=")[1].split("&")[0];return d.default.createElement(c.Fragment,null,d.default.createElement(m.ContextMenuTrigger,{id:e,style:{display:"inline-block"},draggable:!1},this.renderGif()),d.default.createElement(m.ContextMenu,{id:e,className:"gifMenu"},d.default.createElement(m.MenuItem,{data:{url:this.props.animSrc,filename:this.props.image?this.props.image.originalFilename:e+".gif"},onClick:y},"Download GIF")))}}]),t}(c.Component),y=function(e,t){e.stopPropagation();var n=document.createElement("a");n.href=t.url,n.download=t.filename,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)};t.default=g},286:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(181)),o=d(n(182)),r=d(n(183)),a=d(n(184)),s=d(n(185)),l=n(177),u=d(l),c=d(n(180));d(n(190));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.mouseOver=!1,n.windowBlurListener=n.windowBlurListener.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.props.onClick&&window.addEventListener("blur",this.windowBlurListener,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("blur",this.windowBlurListener,!1)}},{key:"windowBlurListener",value:function(){this.mouseOver&&this.props.onClick()}},{key:"render",value:function(){var e=this,t=this.props,n=t.body,i=t.isSelected,o=t.isInEditor;return u.default.createElement("div",{className:"ka_oEmbedOutterBox"},u.default.createElement("div",{className:"ka_oEmbedBox ka_subitem"+(i?" selected":""),spellCheck:!1},u.default.createElement("div",{className:"video_wrapper",dangerouslySetInnerHTML:{__html:n},onMouseOver:function(){return e.mouseOver=!0},onMouseOut:function(){return e.mouseOver=!1}}),o&&u.default.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",top:0}})))}}]),t}(l.Component);f.propTypes={body:c.default.string.isRequired,onClick:c.default.func,isSelected:c.default.bool,isInEditor:c.default.bool},t.default=f},287:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(177)),o=l(n(180)),r=n(179),a=l(r),s=n(209);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t=e.link,n=e.isSelected,o=e.onClick,l=e.selectedImageIndex,u=void 0===l?0:l,f=e.onImageChange,p=e.isInEditor,m=void 0!==p&&p,h=t.isSharepoint?null:"_blank",g=document.createElement("div"),y=t.body||"";y=a.default.htmlToText(y),y=a.default.ellipsizeTextAt(y,s.INT_WEBPAGE_BODY_CHARS,!0);return i.default.createElement("a",{className:"ka_streamWebpage ka_subitem"+(n?" selected":""),href:m?void 0:t.url,onClick:o,target:h,spellCheck:!1},t.showEmbedLogo&&window.embedLogoID&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg embedLogo"},i.default.createElement("img",{src:a.default.getImageURL(null,window.embedLogoID,225,1125,!1)})),(!t.showEmbedLogo||!t.showEmbedLogo||!window.embedLogoID)&&t.subItemImageID&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg"+(c(t.subItemImageID)?" embedLogo":"")},i.default.createElement("img",{src:a.default.getImageURL(null,t.subItemImageID,225,1125,!1)})),(!t.showEmbedLogo||!t.showEmbedLogo||!window.embedLogoID)&&t.previewImageOriginalURL&&!t.subItemImageID&&!t.images&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg"+(c(d(t.previewImageOriginalURL))?" embedLogo":"")},i.default.createElement("img",{src:t.previewImageOriginalURL})),t.images&&t.images.length>0&&-1!==u&&i.default.createElement("div",{className:"ka_column ka_streamWebpageImg"+(t.images[u].isSPLogo?" embedLogo":"")},t.images.map(function(e,t){return i.default.createElement("div",{className:t!==u?"queued":void 0,key:t},i.default.createElement("img",{src:e.src}))})),i.default.createElement("div",{className:"ka_column ka_streamWebpageText"},i.default.createElement("span",{className:"ka_streamSubItemTitle"},a.default.decodeHTMLEntities(t.title,g)),y&&i.default.createElement("div",{className:"ka_steamSubItemBody",dangerouslySetInnerHTML:{__html:y}}),t.subtitle&&i.default.createElement("div",{className:"ka_streamSubItemSubtitle"},t.subtitle)),t.images&&t.images.length>0&&i.default.createElement("div",{className:"ka_linkImgPager"},i.default.createElement("img",{src:r.static_images.left_white_7,onClick:function(e){f(-1===u?t.images.length-1:u-1),a.default.stopBubble(e)}}),u>-1?u+1:t.images.length+1," of ",t.images.length+1,i.default.createElement("img",{src:r.static_images.right_white_7,onClick:function(e){f(u===t.images.length-1?-1:u+1),a.default.stopBubble(e)}})),m&&(!t.images||0===t.images.length)&&i.default.createElement("div",{className:"ka_linkImgPager",style:{padding:"6px 10px"}},"No Compatible Images Found"))},c=function(e){if(!e)return!1;var t,n=document.getElementById("ka_suiteBarLogo");return!!n&&(!!(t=d(n.src))&&t.toLowerCase()===e.toLowerCase())},d=function(e){return-1===e.indexOf("id=")||-1===e.indexOf("&size")?null:e.split("id=")[1].split("&size")[0]};u.propTypes={link:o.default.object.isRequired,isInEditor:o.default.bool,isSelected:o.default.bool,onClick:o.default.func,selectedImageIndex:o.default.number,onImageChange:o.default.func},t.default=u},288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(177)),o=a(n(180)),r=a(n(179));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.document,n=t.title,o=t.originalFilename,a=t.sourceAssetURL,s=t.documentType,u=t.documentID,c=t.fromSharepoint,d=t.fileSize,f=t.progress,p=e.isSelected,m=e.onClick,h=void 0;return e.inEditor||(c&&a?h=a:u&&(h="/_layouts/15/documents/proxy.ashx?id="+u+"&name="+o)),i.default.createElement("a",{className:"ka_docBox ka_subitem"+(p?" selected":""),onClick:function(e){return l(e,m)},href:h,target:"_blank",spellCheck:!1},i.default.createElement("img",{src:r.default.getImageURL("Document",s,40)+"?r=0619170747"}),d&&i.default.createElement("div",{className:"ka_docSize",spellCheck:!1},(d/1048576).toFixed(1)," MB"),i.default.createElement("div",{className:"ka_streamSubItemTitle",spellCheck:!1},n||o),"number"==typeof f&&i.default.createElement("div",{className:"ka_docProg"},i.default.createElement("div",{style:{width:f+"%"}})))},l=function(e,t){t&&t(),r.default.stopBubble(e)};s.propTypes={document:o.default.object.isRequired},t.default=s},291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(181)),o=d(n(182)),r=d(n(183)),a=d(n(184)),s=d(n(185)),l=n(177),u=d(l),c=d(n(203));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={menuOpen:!1,shareOpen:!1},n.openMenu=n.openMenu.bind(n),n.closeMenu=n.closeMenu.bind(n),n.openShare=n.openShare.bind(n),n.closeShare=n.closeShare.bind(n),n.openTitleEditor=n.openTitleEditor.bind(n),n.openPosterEditor=n.openPosterEditor.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"openMenu",value:function(e){e.stopPropagation(),this.props.setPlayerHovered(!0),this.setState({menuOpen:!0})}},{key:"closeMenu",value:function(){this.props.setPlayerHovered(!1),this.setState({menuOpen:!1})}},{key:"openShare",value:function(){this.setState({menuOpen:!1}),this.props.openShareDialog()}},{key:"closeShare",value:function(){this.setState({shareOpen:!1}),this.props.setPlayerHovered(!1)}},{key:"openTitleEditor",value:function(){this.setState({menuOpen:!1}),this.props.openTitleEditor()}},{key:"openPosterEditor",value:function(){this.setState({menuOpen:!1}),this.props.openPosterEditor()}},{key:"render",value:function(){return u.default.createElement("div",{className:"ka-titleIcon ka-cog",onClick:function(e){return e.stopPropagation()}},u.default.createElement("span",{onClick:this.openMenu},""),u.default.createElement("div",{className:"ka_calloutMenu"},this.state.menuOpen&&u.default.createElement(c.default,{onClose:this.closeMenu},u.default.createElement("div",null,this.props.openShareDialog&&u.default.createElement("span",{onClick:this.openShare},"Share Video"),this.props.openTitleEditor&&u.default.createElement("span",{onClick:this.openTitleEditor},"Edit Title"),this.props.openPosterEditor&&u.default.createElement("span",{onClick:this.openPosterEditor},"Edit Thumbnail"),u.default.createElement("div",{className:"tri center"},u.default.createElement("div",null))))))}}]),t}(l.Component);t.default=f},292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),o=p(n(182)),r=p(n(183)),a=p(n(184)),s=p(n(185)),l=n(177),u=p(l),c=n(205),d=p(n(228)),f=p(n(225));function p(e){return e&&e.__esModule?e:{default:e}}n(238);var m=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={timeRemaining:k(e.videoDuration,e.fileSize,e.progress,e.uploadedAt),beginningTranscodeEstimate:k(e.videoDuration,e.fileSize,0,null)},n.timer=null,n.startTimer=n.startTimer.bind(n),n.startTimer(),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"startTimer",value:function(){var e=this;this.timer=setInterval(function(){e.setState({timeRemaining:Math.max(e.state.timeRemaining-1,0)})},1e3)}},{key:"componentWillReceiveProps",value:function(e){e.videoDuration&&!this.props.videoDuration&&this.setState({timeRemaining:k(e.videoDuration,e.fileSize,e.progress,e.uploadedAt),beginningTranscodeEstimate:k(e.videoDuration,e.fileSize,0,null)})}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"stopTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"render",value:function(){return u.default.createElement(f.default,{title:(this.state.timeRemaining>0?"Processing":"Finishing")+"  Your Video...",backgroundClick:this.props.backgroundClick},this.state.timeRemaining>0?u.default.createElement(l.Fragment,null,"Estimated Time Remaining: ",u.default.createElement("b",null,(0,c.toHHMMSS)(this.state.timeRemaining)),u.default.createElement("i",{className:"ka_vidTrancode_body"},u.default.createElement("span",{className:"wikiProcessingMessage"},g,E),u.default.createElement("span",{className:"postProcessingMessage"},y,E),u.default.createElement("span",{className:"commentProcessingMessage"},v,E)),u.default.createElement("i",{className:"ka_vidTrancode_helpLink"},"Learn more in ",u.default.createElement("a",{href:h,target:"_blank"},"this article"),".")):u.default.createElement("div",{style:{textAlign:"center",paddingTop:10,marginBottom:25}},u.default.createElement(d.default,{style:{position:"static"}})))}}]),t}(l.Component);t.default=m;var h="https://knowledgearchitecture.zendesk.com/hc/en-us/articles/360015147992-Behind-the-Scenes-of-Synthesis-Native-Video-Uploads",g="Feel free to save your page while your video is processing. Your video will appear as soon as it is finished processing.",y="You can publish your post once your video is finished processing. In the meantime, feel free to save a draft of your post and return to it later.",v="You can post your comment once your video is finished processing. Your draft comment has been saved so you can return to it later.",E=" We’ll send you an e-mail when your video is finished.",k=function(e,t,n,i){if(t=t||0,e){var o=void 0;if(o=e<120&&t<7e7?50:.06*e+t/9e6+60,n>0?o*=1-.01*n:o=o,i)o-=((new Date).getTime()-i)/1e3;return o}return 90}},293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),o=r(n(225));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.onEdit,n=(e.onClose,e.backgroundClick);return i.default.createElement(o.default,{title:"Edit Video Title + Thumbnail",backgroundClick:n},"Make your video more searchable and appealing by giving it a useful Title and Thumbnail.",i.default.createElement("div",{style:{margin:"0 0 20px",textAlign:"right"}},i.default.createElement("div",{className:"ka_button ka_buttonActive",style:{display:"inline-block"},spellCheck:!1,onClick:t},"Next")))}},294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=v(n(181)),o=v(n(182)),r=v(n(183)),a=v(n(184)),s=v(n(185)),l=n(177),u=v(l),c=v(n(187)),d=v(n(192)),f=v(n(205)),p=n(207),m=v(n(191)),h=n(188),g=n(179),y=v(g);function v(e){return e&&e.__esModule?e:{default:e}}n(216)(m.default);var E=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={title:e.title,updatingTitle:!1},n.getButtonText=n.getButtonText.bind(n),n.submitTitle=n.submitTitle.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=c.default.findDOMNode(this.input);e.focus(),e.value="",e.value=this.props.title}},{key:"submitTitle",value:function(){var e=this;if(this.props.title!==this.state.title){var t=this.state.title.trim();t&&(this.setState({updatingTitle:!0}),m.default.put((0,h.buildReqUrl)("/video/"+this.props.videoID+"/title")).authBearer(y.default.getToken()).type("json").send('"'+t+'"').then(function(n){e.props.onTitleUpdated(t)}).catch(function(t){y.default.receivedAPIError(t),e.setState({updatingTitle:!1})}))}else this.props.setupMode?this.props.onTitleUpdated(this.props.title):this.props.onClose()}},{key:"getButtonText",value:function(){return this.state.saving?"Saving...":this.props.setupMode?"Next":"Save"}},{key:"render",value:function(){var e=this;return u.default.createElement(d.default,{title:"Edit Video Title",fixedSize:!1,onClose:this.props.onClose,onKeyDown:function(e){return e.stopPropagation()},disableOverlayClick:!0},u.default.createElement("div",{className:"kamodal-subtitle"},"Preview"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("div",{className:"video-js ka-video-mockPlayer vjs-big-play-centered",style:{width:p.DEF_VIDEO_WIDTH,height:p.DEF_VIDEO_HEIGHT}},u.default.createElement("img",{className:"poster",src:apiUrl+"/video/"+this.props.videoID+"/blob"+this.props.poster}),u.default.createElement("div",{className:"ka-titleBar"},u.default.createElement("span",{className:"ka-title"},this.state.title)),u.default.createElement("button",{className:"vjs-big-play-button","aria-disabled":"true"},u.default.createElement("span",{"aria-hidden":"true",className:"vjs-icon-placeholder"})),u.default.createElement("div",{className:"ka-footerBar"},u.default.createElement(f.default,{duration:this.props.duration})))),u.default.createElement("div",{className:"kamodal-subtitle"},"Title"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("input",{className:"videoTitleInput",ref:function(t){return e.input=t},value:this.state.title,onChange:function(t){e.setState({title:t.target.value})}})),u.default.createElement("div",{className:"kamodal-block"},!this.state.title.trim()&&u.default.createElement("div",{style:{color:"#FF4947",display:"inline-block",marginTop:19}},u.default.createElement("img",{src:g.imgRoot+"Yield_25_Red.png",style:{verticalAlign:"middle"}})," Your video must have a title."),u.default.createElement("div",{className:"ka_button ka_buttonActive"+(this.state.updatingTitle||!this.state.title.trim()?" disabled":""),style:{display:"inline-block",float:"right",marginTop:15},onClick:this.state.updatingTitle?void 0:this.submitTitle,disabled:this.state.updatingTitle},this.getButtonText())))}}]),t}(l.Component);t.default=E},295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=I(n(181)),o=I(n(182)),r=I(n(183)),a=I(n(184)),s=I(n(185)),l=n(177),u=I(l),c=I(n(187)),d=I(n(192)),f=I(n(205)),p=n(207),m=I(n(191)),h=n(188),g=n(179),y=I(g),v=I(n(236)),E=I(n(296)),k=n(239),_=I(n(204)),b=n(189);function I(e){return e&&e.__esModule?e:{default:e}}n(216)(m.default);var C=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={uploadStarted:!1,uploadProgress:0,stills:[],previewImageFilename:e.previewImageFilename},n.chooseThumbFromPC=n.chooseThumbFromPC.bind(n),n.thumbChosenFromPC=n.thumbChosenFromPC.bind(n),n.chooseThumbFromStill=n.chooseThumbFromStill.bind(n),n.chooseThumbFromVideo=n.chooseThumbFromVideo.bind(n),n.saveClicked=n.saveClicked.bind(n),n.getPoster=n.getPoster.bind(n),n.getPosterStyle=n.getPosterStyle.bind(n),n.thumbChosenFromStill=n.thumbChosenFromStill.bind(n),n.thumbHovered=n.thumbHovered.bind(n),n.thumbUnhovered=n.thumbUnhovered.bind(n),n.getButtonText=n.getButtonText.bind(n),n.renderVideo=n.renderVideo.bind(n),n.renderStill=n.renderStill.bind(n),n.resizeStillsContainer=n.resizeStillsContainer.bind(n),n.resizeStillContainer_timer=n.resizeStillContainer_timer.bind(n),n.getStills=n.getStills.bind(n),n.getStills(),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resizeStillContainer_timer,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeStillContainer_timer,!1)}},{key:"getStills",value:function(){var e=this;m.default.get(apiUrl+"/video/"+this.props.videoID+"/blob/thumbs.json").withCredentials().then(function(t){var n=t.body.thumbnails;n.length>100&&(n=y.default.pickFrom(n,100)),n=(n=t.body.savedThumbnails.concat(n)).filter(function(e,t){return n.indexOf(e)===t}),e.setState({stills:n})}).catch(function(e){return(0,b.logError)(e)})}},{key:"chooseThumbFromPC",value:function(){this.setState({activeCategory:"computer"});var e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=this.thumbChosenFromPC,e.style.display="none",y.default.isIE()&&c.default.findDOMNode(this.ieBlows).appendChild(e),e.click()}},{key:"thumbChosenFromPC",value:function(e){var t=this;"image/gif"===e.target.files[0].type.toLowerCase()?alert("GIF is not an accepted format at this time."):-1===e.target.files[0].type.toLowerCase().indexOf("image/")?alert("Oops! You selected "+e.target.files[0].name+" but we need an image."):(this.setState({newPosterUrl:URL.createObjectURL(e.target.files[0]),uploadStarted:!0}),m.default.post((0,h.buildReqUrl)("/video/"+this.props.videoID+"/previewimage")).authBearer(y.default.getToken()).attach("itsafile",e.target.files[0],e.target.files[0].name).on("progress",function(e){return t.setState({uploadProgress:e.percent})}).then(function(e){t.setState({uploadStarted:!1,previewImageFilename:e.body.results[0]})}).catch(function(e){y.default.receivedAPIError(e),t.setState({uploadStarted:!1}),alert("Thumbnail failed to save. Please try again.")}))}},{key:"chooseThumbFromStill",value:function(){this.setState({activeCategory:"stills"}),window.setTimeout(this.resizeStillsContainer,0)}},{key:"chooseThumbFromVideo",value:function(){this.setState({activeCategory:"video"})}},{key:"saveClicked",value:function(){var e=this;if(!this.state.uploadStarted)if("stills"==this.state.activeCategory&&this.state.previewImageFilename)this.setState({saving:!0}),m.default.put(apiUrl+"/video/"+this.props.videoID+"/previewfilename").withCredentials().type("json").send('"'+this.state.previewImageFilename+'"').then(function(t){e.props.posterUpdated(e.state.newPosterUrl,e.state.previewImageFilename)}).catch(function(t){(0,b.logError)(t),e.setState({saving:!1}),alert("Thumbnail failed to save. Please try again.")});else if("computer"===this.state.activeCategory&&this.state.newPosterUrl)this.props.posterUpdated(this.state.newPosterUrl,this.state.previewImageFilename);else if("video"===this.state.activeCategory)if(this.kavideo.player.pause(),this.setState({saving:!0}),_.default.msie||_.default.safari)this.props.setPreviewAtTimeUsingAPI(this.kavideo.player.currentTime());else{var t=this.kavideo.player.el().querySelector("video");(0,k.getPreviewImageBlob)(t,function(t){var n=e.kavideo.player.currentTime()+".png";m.default.post((0,h.buildReqUrl)("/video/"+e.props.videoID+"/previewimage")).query({seconds:e.kavideo.player.currentTime()}).authBearer(y.default.getToken()).attach("itsablob",t,n).on("progress",function(t){return e.setState({uploadProgress:t.percent})}).then(function(i){e.props.posterUpdated(URL.createObjectURL(t),n)}).catch(function(t){y.default.receivedAPIError(t),e.setState({uploadStarted:!1}),alert("Thumbnail failed to save. Please try again.")})})}else this.props.onClose()}},{key:"getPoster",value:function(){return this.state.tempPosterUrl?this.state.tempPosterUrl:this.state.newPosterUrl?this.state.newPosterUrl:apiUrl+"/video/"+this.props.videoID+"/blob"+this.state.previewImageFilename}},{key:"getPosterStyle",value:function(e){return e.indexOf("/tinythumbs/")>-1||e.indexOf("/posters/")>-1?{height:"100%"}:void 0}},{key:"resizeStillsContainer",value:function(){var e=0,t=c.default.findDOMNode(this.modal).querySelector(".kamodal-container");t.childNodes.forEach(function(t){return e+=y.default.outterHeight(t)}),e-=y.default.outterHeight(t.querySelector(".kavideo-stillsContainer"));var n=.9*window.innerHeight-e,i=69*Math.floor(n/69)+27.6;i>n&&i--;var o=Math.min(345,i),r=69*Math.ceil(this.state.stills.length/5),a=Math.max(96.6,Math.min(o,r));this.setState({stillContHeight:a})}},{key:"resizeStillContainer_timer",value:function(){var e=this;"stills"===this.state.activeCategory&&(this.resizeTimer||(this.resizeTimer=window.setTimeout(function(){e.resizeTimer=null,e.resizeStillsContainer()},250)))}},{key:"thumbChosenFromStill",value:function(e){var t=void 0;t=e.length>12&&"/tinythumbs/"===e.substring(0,12)?"/posters/"+e.substring(12):e;var n=apiUrl+"/video/"+this.props.videoID+"/blob"+t;this.setState({newPosterUrl:n,previewImageFilename:t,tempPosterUrl:null})}},{key:"thumbHovered",value:function(e,t){var n=this;if(this.setState({tempPosterUrl:apiUrl+"/video/"+this.props.videoID+"/blob"+e}),e.length>12&&"/tinythumbs/"===e.substring(0,12)){var i="/posters/"+e.substring(12);window.setTimeout(function(){return n.setState({tempPosterUrl:apiUrl+"/video/"+n.props.videoID+"/blob"+i})},0)}}},{key:"thumbUnhovered",value:function(){this.setState({tempPosterUrl:null})}},{key:"getButtonText",value:function(){return this.state.saving?"Saving...":this.state.uploadStarted?"Uploading...":"Save"}},{key:"renderVideo",value:function(){var e=this,t=p.DEF_VIDEO_WIDTH,n=t/this.props.playerAspectRatio;if("video"===this.state.activeCategory)return u.default.createElement(v.default,{videoID:this.props.videoID,videoMeta:this.state.videoMeta,openToBeginning:!0,width:t,height:n,hideCog:!0,disableSizing:!0,disableThumbnails:!0,ref:function(t){return e.kavideo=t}});var i=this.getPoster();return u.default.createElement("div",{className:"video-js ka-video-mockPlayer vjs-big-play-centered",style:{width:t,height:n},ref:function(t){return e.mockPlayer=t}},u.default.createElement("img",{className:"poster",src:i,style:this.getPosterStyle(i)}),u.default.createElement("div",{className:"ka-titleBar"},u.default.createElement("span",{className:"ka-title"},this.props.title)),u.default.createElement("button",{className:"vjs-big-play-button","aria-disabled":"true"},u.default.createElement("span",{"aria-hidden":"true",className:"vjs-icon-placeholder"})),u.default.createElement("div",{className:"ka-footerBar"},u.default.createElement(f.default,{duration:this.props.duration})))}},{key:"renderStill",value:function(e,t){var n=this;return t>0||this.state.stillHeight?u.default.createElement("img",{src:apiUrl+"/video/"+this.props.videoID+"/blob"+e}):u.default.createElement("img",{src:apiUrl+"/video/"+this.props.videoID+"/blob"+e,ref:function(e){return n.firstStill=e},onLoad:this.resizeStillsContainer})}},{key:"render",value:function(){var e=this;return u.default.createElement(d.default,{title:"Edit Video Thumbnail",onClose:this.props.onClose,fixedSize:!1,disableOverlayClick:!0,ref:function(t){return e.modal=t}},u.default.createElement("div",{className:"kamodal-subtitle"},"Preview"),u.default.createElement("div",{className:"kamodal-block"},this.renderVideo()),this.state.uploadStarted&&u.default.createElement("div",{style:{height:0,position:"relative"}},u.default.createElement("div",{className:"ka_imgUploadProgress",style:{position:"absolute"}},u.default.createElement("div",{style:{width:this.state.uploadProgress+"%"}}))),u.default.createElement("div",{className:"kamodal-subtitle"},"Select a new Thumbnail Image"),u.default.createElement("div",{className:"kamodal-block"},u.default.createElement("span",{className:"kavideo-editThumbCategory"+("stills"===this.state.activeCategory?" active":""),onClick:this.chooseThumbFromStill},u.default.createElement("img",{src:g.static_images.image,className:"unhover",style:{width:25,height:25}}),u.default.createElement("img",{src:g.static_images.image_cyan,className:"hover",style:{width:25,height:25}}),"Select from stills."),u.default.createElement("span",{className:"kavideo-editThumbCategory"+("video"===this.state.activeCategory?" active":""),onClick:this.chooseThumbFromVideo},u.default.createElement("img",{src:g.static_images.play_grey_18,className:"unhover"}),u.default.createElement("img",{src:g.static_images.play_cyan_18,className:"hover"}),"Select from video."),u.default.createElement("span",{className:"kavideo-editThumbCategory"+("computer"===this.state.activeCategory?" active":""),onClick:this.chooseThumbFromPC},u.default.createElement("img",{src:g.static_images.upload_16,className:"unhover"}),u.default.createElement("img",{src:g.static_images.upload_16_cyan,className:"hover"}),"Upload from computer.")),"stills"===this.state.activeCategory&&u.default.createElement("div",{className:"kamodal-block"},u.default.createElement(E.default,{className:"kavideo-stillsContainer",style:{height:this.state.stillContHeight}},!this.state.stills.length>0&&u.default.createElement("img",{src:"/_layouts/15/Updates/images/Ajax-loader.gif",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:32,height:32,margin:0}}),this.state.stills.map(function(t,n){return u.default.createElement("div",{onClick:function(){return e.thumbChosenFromStill(t)},onMouseEnter:function(n){return e.thumbHovered(t,n.target)},onMouseLeave:e.thumbUnhovered,className:"still"+(S(e.state.previewImageFilename,t)?" active":""),key:n},u.default.createElement("div",null,e.renderStill(t,n)))}))),u.default.createElement("div",{className:"kamodal-block",style:{overflow:"hidden"}},u.default.createElement("div",{className:"ka_button ka_buttonActive"+(this.state.uploadStarted?" disabled":""),style:{display:"inline-block",float:"right",marginTop:15},onClick:this.saveClicked},this.getButtonText())),u.default.createElement("div",{ref:function(t){return e.ieBlows=t}}))}}]),t}(l.Component);t.default=C;var S=function(e,t){if(e)if(t.length>12&&"/tinythumbs/"===t.substring(0,12)){if(t.substring(12)===e.substring(9))return!0}else if(e===t)return!0;return!1}},296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(206)),o=p(n(181)),r=p(n(182)),a=p(n(183)),s=p(n(184)),l=p(n(185)),u=n(177),c=p(u),d=p(n(187)),f=p(n(500));function p(e){return e&&e.__esModule?e:{default:e}}n(501);var m=function(e){function t(){return(0,r.default)(this,t),(0,s.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){f.default.initEl(d.default.findDOMNode(this.box))}},{key:"render",value:function(){var e=this;return c.default.createElement("div",(0,i.default)({},this.props,{ref:function(t){return e.box=t}}))}}]),t}(u.Component);t.default=m},306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(234),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){var t,n,i,o,u,c,d,f,p,m={width:0,height:0,basePath:e.basePath||""};n=function e(){var t,n,i,o,a;t=Array.prototype.slice.call(arguments);n=t.shift()||{};for(i in t)for(a in o=t[i])o.hasOwnProperty(a)&&("object"===(0,r.default)(o[a])?n[a]=e(n[a],o[a]):n[a]=o[a]);return n}({},m,e);var h=(o=this).textTracks().length;if(0===h)return;p=0;for(;p<h;){var g=o.textTracks()[p];if("metadata"===g.kind&&"thumbnails"===g.label){(f=o.textTracks()[p]).mode="hidden";break}p++}var y=o.controlBar.progressControl;if(-1!==navigator.userAgent.toLowerCase().indexOf("android")){var v=function(){return y.removeClass("fake-active")};y.on("touchstart",function(){return y.addClass("fake-active")}),y.on("touchend",v),y.on("touchcancel",v)}(t=document.createElement("div")).className="vjs-thumbnail-holder";var E=document.createElement("div");E.className="ka-thumbnail-holderInner",t.appendChild(E),(i=document.createElement("img")).className="vjs-thumbnail",E.appendChild(i);var k=document.createElement("div");k.className="ka-video-scrubTime",E.appendChild(k),u=o.duration(),o.on("durationchange",function(e){return u=o.duration()}),o.on("loadedmetadata",function(e){return u=o.duration()}),y.el().appendChild(t),c=function(e){var o,r,c,d,h,g,v,_,b;_=(window.pageXOffset?{x:window.pageXOffset,y:window.pageYOffset}:{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}).x,b=s(y.el()).getBoundingClientRect(),h=(b.width||b.right)+_,d=e.pageX,e.changedTouches&&(d=e.changedTouches[0].pageX),r=d||e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r-=s(y.el()).getBoundingClientRect().left+_,o=Math.floor((r-y.el().offsetLeft)/y.width()*u),k.innerHTML=(0,a.toHHMMSS)(o);var I=f&&f.cues.length;for(p=0;p<I;){var C=f.cues[p];if(C.startTime<=o&&C.endTime>=o){c=l(C.text,m.basePath);break}p++}if(void 0!==c){c.src&&i.src!=c.src&&(i.src=c.src),0===c.w&&(c.w=n.width),0===c.h&&(c.h=n.height),g=c.w-c.x;var S=c.h-c.y+15;E.style.width==g&&E.style.height==c.h+15||(E.style.height=S+"px"),i.style.left=200==g?-c.x+"px":-c.x+(200-g)/2+"px",i.style.top=-c.y+"px",i.style.clip="rect("+c.y+"px,"+c.w+"px,"+c.h+"px,"+c.x+"px)",g=t.offsetWidth,r+(v=g/2)>h?r=h-g:r<v?r=0:r-=v,t.style.left=r+"px"}},y.on("mousemove",c),y.on("touchmove",c),d=function(e){return t.style.left="-10000px"},y.on("mouseleave",d),y.on("touchcancel",d),y.on("touchend",d),o.on("userinactive",d)};var a=n(205);function s(e){return"HTML"!==e.nodeName&&"static"===function(e,t){return function(n){return window.getComputedStyle?window.getComputedStyle(e,t)[n]:e.currentStyle[n]}}(e)("position")?s(e.offsetParent):e}function l(e,t){var n,i,o;if(-1===(i=e.indexOf("#")))return{src:t+e,w:0,h:0,x:0,y:0};if(n=e.substring(0,i),"xywh="!==(o=e.substring(i+1)).substring(0,5))return{src:defaults.basePath+n,w:0,h:0,x:0,y:0};var r=o.substring(5).split(",");return{src:t+n,w:parseInt(r[2]),h:parseInt(r[3]),x:parseInt(r[0]),y:parseInt(r[1])}}},307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(177),r=(i=o)&&i.__esModule?i:{default:i},a=n(207);t.default=function(e){return r.default.createElement("div",{className:"ka_hangTight",style:{width:e.width?parseInt(e.width):a.DEF_VIDEO_WIDTH,height:(e.width?parseInt(e.width):a.DEF_VIDEO_WIDTH)/(16/9)}},r.default.createElement("div",null,r.default.createElement("div",{style:{fontSize:32}},"Hang tight..."),r.default.createElement("div",{style:{fontSize:24,marginTop:50}},"This video will be available shortly.")))}},308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(177)),o=a(n(225)),r=a(n(228));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.backgroundClick;return i.default.createElement(o.default,{title:"Saving Your Thumbnail",backgroundClick:t},"This should take less than a minute.",i.default.createElement("div",{style:{textAlign:"center",paddingTop:15,marginBottom:25}},i.default.createElement(r.default,{style:{position:"static"}})))}},309:function(e,t,n){},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e){e.exports={"A network error caused the media download to fail part-way.":"e1","The media could not be loaded, either because the server or network failed or because the format is not supported.":"e2","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"e3","No compatible source was found for this media.":"e4","The media playback was aborted because too many consecutive download errors occurred.":"e5","You aborted the media playback":"e6"}},314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(206)),o=s(n(186)),r=s(n(177)),a=s(n(180));function s(e){return e&&e.__esModule?e:{default:e}}if(null==l)var l=n(179).static_images;var u=function(e){var t=e.likeStatus,n=(0,o.default)({},e);return delete n.likeStatus,r.default.createElement("img",(0,i.default)({},n,{className:"ka_likeIcon "+(t?"on":"off"),src:t?l.like_on_20:l.like_off_20,style:{width:20,height:20}}))};u.propTypes={likeStatus:a.default.bool},t.default=u},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOCAL_LINK_SCHEME="ka-file://"},326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MIME_VIDEO="video/*,video/mp4,video/x-m4v,video/webm"},327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(552)),o=y(n(206)),r=y(n(186)),a=y(n(181)),s=y(n(182)),l=y(n(183)),u=y(n(184)),c=y(n(185)),d=n(177),f=y(d),p=y(n(187)),m=y(n(180)),h=y(n(179)),g=y(n(190));n(220);function y(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={selectedSuggestion:0,sugArray:_(e.suggestions,e.mentions,e.hashtags)},n.onUpArrow=n.onUpArrow.bind(n),n.onDownArrow=n.onDownArrow.bind(n),n.renderSuggestions=n.renderSuggestions.bind(n),n.renderSearchingFor=n.renderSearchingFor.bind(n),n.sugPosMover=n.sugPosMover.bind(n),n}return(0,c.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=(0,r.default)({},this.props);return delete e.searchingFor,delete e.suggestions,delete e.mentions,delete e.hashtags,delete e.onAddTag,delete e.clearSearch,delete e.suggestionsFor,delete e.usesInputBox,f.default.createElement("div",(0,o.default)({},e,{style:(0,r.default)({},this.props.style,{position:"relative"})}),this.props.children,this.renderSearchingFor(),this.renderSuggestions())}},{key:"componentWillReceiveProps",value:function(e){(0,i.default)(this.props.suggestions)!==(0,i.default)(e.suggestions)&&this.setState({selectedSuggestion:0,sugArray:_(e.suggestions,e.mentions,e.hashtags)}),e.suggestionsFor&&this.props.suggestionsFor!==e.suggestionsFor&&this.setState({sugPos:E(e.suggestionsFor,e.usesInputBox,p.default.findDOMNode(this))})}},{key:"sugPosMover",value:function(){this.props.searchingFor?this.setState({sugPos:E(this.props.searchingFor,this.props.usesInputBox,p.default.findDOMNode(this))}):this.state.sugArray&&this.props.suggestionsFor&&this.setState({sugPos:E(this.props.suggestionsFor,this.props.usesInputBox,p.default.findDOMNode(this))})}},{key:"componentDidMount",value:function(){this.props.usesInputBox||p.default.findDOMNode(this).children[0].addEventListener("scroll",this.sugPosMover,!1)}},{key:"componentWillUnmount",value:function(){this.props.usesInputBox||p.default.findDOMNode(this).children[0].removeEventListener("scroll",this.sugPosMover,!1)}},{key:"onUpArrow",value:function(e){this.state.sugArray&&(e.preventDefault(),this.state.selectedSuggestion>0&&this.setState({selectedSuggestion:this.state.selectedSuggestion-1}))}},{key:"onDownArrow",value:function(e){this.state.sugArray&&(e.preventDefault(),this.state.sugArray.length>this.state.selectedSuggestion+1&&this.setState({selectedSuggestion:this.state.selectedSuggestion+1}))}},{key:"onEscape",value:function(e){this.state.sugArray&&(e.preventDefault(),this.props.clearSearch())}},{key:"onTab",value:function(e){return this.state.sugArray?(e.preventDefault(),I(this.props.clearSearch,this.props.onAddTag,this.state.sugArray[this.state.selectedSuggestion]),"handled"):"not-handled"}},{key:"handleReturn",value:function(e){return this.state.sugArray?(I(this.props.clearSearch,this.props.onAddTag,this.state.sugArray[this.state.selectedSuggestion]),"handled"):"not-handled"}},{key:"renderSuggestions",value:function(){var e=this.state,t=e.sugArray,n=e.selectedSuggestion,i=this.props,o=i.onAddTag,r=i.clearSearch;i.suggestionsFor,i.usesInputBox;if(t)return f.default.createElement("div",{key:"suggestions",className:"ka_tagSuggestionBox",style:this.state.sugPos},t.map(function(e,t){return b(e,n===t,o,r,t)}))}},{key:"renderSearchingFor",value:function(){if(this.props.searchingFor)return f.default.createElement("div",{key:"searchingFor",className:"ka_tagSuggestionBox",style:this.state.sugPos},'Searching for "',this.props.searchingFor,'"')}}]),t}(d.Component),E=function(e,t,n){if(t)return{top:document.activeElement.offsetTop+document.activeElement.clientHeight+5,left:document.activeElement.offsetLeft+5};var i=window.getSelection();if(0===i.rangeCount)return{top:-5e3,left:-5e3};var o=i.getRangeAt(0).cloneRange();o.setStart(i.anchorNode,Math.max(i.anchorOffset-e.length,0));var r=o.getBoundingClientRect(),a=n.getBoundingClientRect();return{top:r.bottom-a.top+5,left:r.left-a.left}},k=["Community","Employee","Company","Project","Contact","Opportunity","Hashtag"],_=function(e,t,n){if(!e)return null;var i=[];return k.forEach(function(o){e[o]&&e[o].results.filter(function(e){return!(t&&null!=t.find(function(t){return t.entityType===e.$type&&t.entityID==T(e)&&!t.deleted})||n&&null!=n.find(function(t){return t.hashtag==e.HashtagID&&!t.deleted}))}).forEach(function(e){return i.push(e)})}),0===i.length?null:i},b=function(e,t,n,i,o){return f.default.createElement("div",{className:(0,g.default)("ka_tagSuggestion",t?"hovered":null),onClick:function(t){I(i,n,e)},key:o},f.default.createElement("div",{style:{width:35,height:35}},f.default.createElement("img",{src:h.default.getImageURL(e.$type,e.PrimaryImageID,35,null,null,e.IsOpportunity),className:"Employee"===e.$type?"ka_circular":null})),f.default.createElement("div",{style:{padding:"0px 0px 0px 3px"}},f.default.createElement("span",{className:"ka_tagSuggestionTitle",dangerouslySetInnerHTML:{__html:C(e)}}),f.default.createElement("div",{className:"ka_tagSuggestionSubTitle",dangerouslySetInnerHTML:{__html:S(e)}})))},I=function(e,t,n){t(D(n)),e()},C=function(e){switch(e.$type){case"Employee":return e.FullName;case"Project":return e.MarketingName;case"Contact":return e.ContactName;case"Company":return e.CompanyName;case"Opportunity":return e.OpportunityName;case"Community":return e.CommunityName;case"Hashtag":return e.HashtagID;default:return e.$type}},S=function(e){switch(e.$type){case"Employee":return e.Title;case"Project":return e.ClientName;case"Contact":return e.CompanyName;case"Company":return e.PrimaryDiscipline;case"Opportunity":return e.ClientName;default:return null}},T=function(e){return e.EmployeeID||e.ProjectID||e.ContactID||e.CompanyID||e.OpportunityID||e.CommunityID||e.HashtagID},D=function(e){return"Hashtag"==e.$type?{hashtag:e.HashtagID,deleted:!1}:{entityType:e.$type,entityID:T(e),entityName:C(e),deleted:!1,hasProfile:!0,isOpportunity:e.IsOpportunity}};v.propTypes={searchingFor:m.default.string,suggestionsFor:m.default.string,suggestions:m.default.object,mentions:m.default.array,hashtags:m.default.array,onAddTag:m.default.func.isRequired,clearSearch:m.default.func.isRequired,usesInputBox:m.default.bool},t.default=v},328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),o=f(n(182)),r=f(n(183)),a=f(n(184)),s=f(n(185)),l=n(177),u=f(l),c=n(220),d=n(223);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={over:!1},n.dragEnter=n.dragEnter.bind(n),n.dragLeave=n.dragLeave.bind(n),n.dragOver=n.dragOver.bind(n),n.counter=0,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"dragEnter",value:function(e){(window.draggingSubitem||(0,d.containsFiles)(e))&&(e.preventDefault(),this.counter++,this.setState({over:!0}))}},{key:"dragLeave",value:function(e){(window.draggingSubitem||(0,d.containsFiles)(e))&&(this.counter--,0===this.counter&&this.setState({over:!1}))}},{key:"dragOver",value:function(e){window.draggingSubitem&&e.preventDefault()}},{key:"render",value:function(){var e="ka_block";return this.state.over&&(e+=" over"),u.default.createElement("div",{className:e,onDragEnter:this.dragEnter,onDragLeave:this.dragLeave,onDrop:this.dragLeave,onDragOver:this.dragOver},this.props.children||u.default.createElement(c.EditorBlock,this.props))}}]),t}(l.Component);t.default=p},329:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),o=f(n(182)),r=f(n(183)),a=f(n(184)),s=f(n(185)),l=n(177),u=f(l),c=f(n(187)),d=f(n(179));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.closeBannerListener=n.closeBannerListener.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"closeBannerListener",value:function(e){this.props.onClose&&this.props.onClose()}},{key:"componentWillMount",value:function(){d.default.dispatchEvent("Close_Banner",null)}},{key:"componentDidMount",value:function(){window.addEventListener("Close_Banner",this.closeBannerListener)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("Close_Banner",this.closeBannerListener)}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.children;return c.default.createPortal(u.default.createElement("div",{className:"ka_outageBannerContainer"+(t?"":" nondismissible")},u.default.createElement("div",{className:"ka_outageBanner"},n,t&&u.default.createElement("span",{onClick:function(e){e.stopPropagation(),t()}},"X"))),document.getElementById("titleAreaRow"))}}]),t}(l.Component);t.default=p},330:function(e,t,n){},472:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLOCK_TYPES=t.HEADER_TYPES=t.INLINE_STYLES=void 0;var i=k(n(235)),o=k(n(240)),r=k(n(206)),a=k(n(181)),s=k(n(182)),l=k(n(183)),u=k(n(184)),c=k(n(185)),d=n(177),f=k(d),p=k(n(187)),m=n(179),h=k(m),g=n(326),y=n(223),v=k(n(203)),E=k(n(550));function k(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={headersOpened:!1},n.menus=[],n.ATTACHMENT_TYPES=n.ATTACHMENT_TYPES.bind(n),n}return(0,c.default)(t,e),(0,l.default)(t,[{key:"onToggleHeaderStyle",value:function(e){this.setState({headersOpened:!1}),e!=this.props.editorState.getCurrentContent().getBlockForKey(this.props.editorState.getSelection().getStartKey()).getType()&&this.props.onToggleBlockType(e)}},{key:"componentDidUpdate",value:function(e,t){var n=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.menus=this.menus.filter(function(e){return null!=e&&null!=e.parentElement}),this.menus.forEach(function(e){e.getBoundingClientRect().bottom>n?e.className+=" inverted":e.className.indexOf("inverted")>-1&&e.parentElement.getBoundingClientRect().bottom+e.clientHeight+25<=n&&(e.className=e.className.replace(" inverted",""))})}},{key:"ATTACHMENT_TYPES",value:function(){return[{icon:"link",hoverIcon:"link_cyan",tooltip:"Link",shortcut:"K",clickHandlerProp:"onEditLink",iconWidth:16},{icon:"camera",hoverIcon:"camera_cyan",tooltip:"Add Images",iconWidth:24,fileHandlerProp:"onImageAttach",accept:"image/*",multiple:!0},{icon:"play",hoverIcon:"play_cyan",tooltip:"Add a Video",iconWidth:18,fileHandlerProp:"onVideoAttach",accept:g.MIME_VIDEO,multiple:!1},{icon:"paperclip",hoverIcon:"paperclip_cyan",tooltip:"Add Files",iconWidth:10,menuOptions:[{icon:"up_arrow",text:"Upload files from your computer",fileHandlerProp:"onDocumentAttach",multiple:!0},{icon:"sharepoint_gray",text:"Insert files from SharePoint",clickHandlerProp:"onBrowseSPDocuments"}]},{icon:"ellipsis",hoverIcon:"ellipsis_cyan",tooltip:"Other Post Options",iconWidth:14,disabled:!blogOptions.enableBlogging||this.props.disableBlogging,menuOptions:[{icon:"sharepoint_gray",text:"Use SharePoint to write a blog post.",onClick:y.createSPBlog,thenClose:!0,disabled:!blogOptions.enableSharePoint},{icon:"word_post_editor",text:"Use Word to write a blog post.",onClick:y.createWordBlog,thenClose:!0,disabled:!blogOptions.enableWord||!h.default.isIE()}]}]}},{key:"render",value:function(){var e=this,t=this.props.editorState.getCurrentInlineStyle(),n=this.props.editorState.getCurrentContent().getBlockForKey(this.props.editorState.getSelection().getStartKey()).getType(),a=I.find(function(e){return e.style===n})||I.find(function(e){return"unstyled"===e.style});return f.default.createElement("div",{className:"KAEditor-controls"},b.map(function(n){return f.default.createElement(E.default,(0,r.default)({key:n.style,active:t.has(n.style)},n,{onToggle:e.props.onToggleInlineStyle,disabled:e.props.readOnly}))}),f.default.createElement("div",{className:"KAEditor-control"},f.default.createElement("span",{className:"KAEditor-styleButton KAEditor-headerButton"+(this.props.readOnly?" disabled":""),onClick:this.props.readOnly?void 0:function(){return e.setState({headersOpened:!e.state.headersOpened})}},a.label),this.state.headersOpened&&f.default.createElement(v.default,{onClose:function(){return e.setState({headersOpened:!1})}},f.default.createElement("div",{className:"KAEditor-menuOptions",ref:function(t){-1===e.menus.indexOf(t)&&e.menus.push(t)}},I.map(function(t){return f.default.createElement("div",{className:"KAEditor-menuOption",onClick:function(){e.props.onToggleBlockType(t.style),e.setState({headersOpened:!1})},key:t.style},f.default.createElement(t.element,null,t.label))}),f.default.createElement("div",{className:"KAEditor-tri"},f.default.createElement("div",null))))),C.map(function(t){return f.default.createElement(E.default,(0,r.default)({key:t.style,active:t.style===n,label:t.label},t,{disabled:e.props.readOnly,onToggle:e.props.onToggleBlockType}))}),!this.props.hideAttachmentControls&&this.ATTACHMENT_TYPES().filter(function(e){return!e.disabled}).map(function(t){var n=t.shortcut?h.default.forOS(" (Ctrl+"+t.shortcut+")"," (⌘"+t.shortcut+")",""):"";return f.default.createElement("span",{className:"KAEditor-control",key:t.icon,title:t.tooltip+n,onMouseEnter:e.props.readOnly?void 0:function(n){return e.setState((0,o.default)({},t.icon+"Hover",!0))},onMouseLeave:e.props.readOnly?void 0:function(n){return e.setState((0,o.default)({},t.icon+"Hover",!1))},onClick:e.props.readOnly?void 0:t.fileHandlerProp?function(){return e[t.icon+"_input"].click()}:e.props[t.clickHandlerProp]||function(n){return e.setState((0,o.default)({},t.icon+"Open",!e.state[t.icon+"Open"]))}},f.default.createElement("img",{src:""+m.imgRoot+t.icon+(e.state[t.icon+"Hover"]?"_cyan":"")+".svg",className:"ka_shareTools"}),t.fileHandlerProp&&e.props[t.fileHandlerProp]&&f.default.createElement("input",{type:"file",ref:function(n){return e[t.icon+"_input"]=n},accept:t.accept,multiple:t.multiple,style:{display:"none"},onClick:function(){var n=p.default.findDOMNode(e[t.icon+"_input"]);n.type="",n.type="file"},onChange:function(n){e.props[t.fileHandlerProp]((0,i.default)(n.target.files).map(function(e){return n.target.files[e]}))},title:t.tooltip+n||" "}),e.state[t.icon+"Open"]&&t.menuOptions&&f.default.createElement(v.default,{onClose:function(){e.setState((0,o.default)({},t.icon+"Hover",!1)),e.setState((0,o.default)({},t.icon+"Open",!1))}},f.default.createElement("div",{className:"KAEditor-menuOptions",style:t.menuPosition,title:"",ref:function(t){-1===e.menus.indexOf(t)&&e.menus.push(t)}},t.menuOptions.filter(function(e){return!e.disabled}).map(function(r){return f.default.createElement("div",{style:{position:"relative"},className:"KAEditor-menuOption",onClick:r.onClick||(r.clickHandlerProp?e.props[r.clickHandlerProp]:void 0)||(r.fileHandlerProp?function(t){t.stopPropagation(),e[r.icon+"_input"].click()}:void 0),onMouseUp:function(){e.setState((0,o.default)({},t.icon+"Hover",!1)),r.thenClose&&window.setTimeout(e.props.onClose,0)},key:r.icon},f.default.createElement("img",{src:""+m.imgRoot+r.icon+".svg"}),f.default.createElement("span",null,r.text),r.fileHandlerProp&&e.props[r.fileHandlerProp]&&f.default.createElement("input",{type:"file",ref:function(t){return e[r.icon+"_input"]=t},accept:r.accept,multiple:r.multiple,style:{display:"none"},onClick:function(t){var n=p.default.findDOMNode(e[r.icon+"_input"]);n.type="",n.type="file"},onChange:function(n){e.props[r.fileHandlerProp]((0,i.default)(n.target.files).map(function(e){return n.target.files[e]})),e.setState((0,o.default)({},t.icon+"Open",!1)),e.setState((0,o.default)({},t.icon+"Hover",!1))},title:t.tooltip+n||" "}))}),f.default.createElement("div",{className:"KAEditor-tri"},f.default.createElement("div",null)))))}))}}]),t}(d.Component);t.default=_;var b=t.INLINE_STYLES=[{icon:"bold",style:"BOLD",tooltip:"Bold",shortcut:"B"},{icon:"italics",style:"ITALIC",tooltip:"Italic",shortcut:"I"}],I=t.HEADER_TYPES=[{label:"Heading 1",style:"header-one",element:"h1"},{label:"Heading 2",style:"header-two",element:"h2"},{label:"Normal",style:"unstyled",element:"div"}],C=t.BLOCK_TYPES=[{icon:"bullets",style:"unordered-list-item",tooltip:"Insert/Remove Bulleted List"},{icon:"outline",style:"ordered-list-item",tooltip:"Insert/Remove Numbered List"},{icon:"quote",style:"blockquote",tooltip:"Quote"}]},473:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(177)),o=a(n(203)),r=n(325);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.linkPeek,n=e.onEdit,a=e.onRemove,s=e.onClose;return i.default.createElement(o.default,{onClose:s},i.default.createElement("div",{className:"ka_linkPeeker"+(t?" active":""),style:t?t.position:void 0},i.default.createElement("a",{href:t?t.url:void 0,style:{cursor:"pointer"},target:t&&0===t.url.indexOf(r.LOCAL_LINK_SCHEME)?void 0:"_blank"},t?t.url.substring(0,35):""),t&&t.url.length>35&&i.default.createElement("span",{style:{color:"#555555"}},"…"),i.default.createElement("span",null," | "),i.default.createElement("span",{onClick:n,className:"button"},"Edit"),i.default.createElement("span",null," | "),i.default.createElement("span",{onClick:a,className:"button"},"Remove"),i.default.createElement("div",{className:"KAEditor-tri"},i.default.createElement("div",null))))}},474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(551),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default},475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),o=f(n(182)),r=f(n(183)),a=f(n(184)),s=f(n(185)),l=n(177),u=f(l),c=f(n(180)),d=f(n(192));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={text:e.text||"",url:e.url||"",isEditing:null!=e.url},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){""!==this.state.text&&""===this.state.url?this.urlInput.focus():this.textInput.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,i=t.onCreate;return u.default.createElement(d.default,{onClose:n,title:(this.state.isEditing?"Edit this":"Add a")+" Text Link"},u.default.createElement("input",{ref:function(t){return e.textInput=t},type:"text",style:{width:400},value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})},placeholder:"Link Text"}),u.default.createElement("br",null),u.default.createElement("input",{ref:function(t){return e.urlInput=t},type:"text",style:{width:400,marginTop:15},value:this.state.url,onChange:function(t){return e.setState({url:t.target.value})},placeholder:"http://"}),u.default.createElement("br",null),u.default.createElement("div",{style:{textAlign:"right"}},u.default.createElement("input",{type:"button",className:"ka_button",style:{marginTop:15},value:this.state.isEditing?"Update":"Create Link",onClick:function(){""==e.state.text?alert("Enter the text to display in the link."):""==e.state.url.trim()?alert("Enter the url to open when the link is clicked."):i(e.state.text,m(e.state.url.trim()))}})))}}]),t}(l.Component),m=function(e){return-1===e.indexOf("://")&&"/"!==e[0]&&-1===e.toLowerCase().indexOf("mailto:")?"http://"+e:e};p.propTypes={onClose:c.default.func.isRequired,onCreate:c.default.func.isRequired},t.default=p},476:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dialogOption=void 0;var i=r(n(177)),o=r(n(192));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.title,n=e.message,r=e.onClose,a=e.optionArray;return i.default.createElement(o.default,{onClose:r,title:t,hideX:!0},n&&[i.default.createElement("span",{key:0},n),i.default.createElement("br",{key:1})],i.default.createElement("div",{style:{textAlign:"right",marginTop:15}},a.map(function(e,t){return i.default.createElement("input",{type:"button",className:"ka_button"+(e.disabled?" disabled":"")+(e.isRed?" red":""),value:e.title,key:t,disabled:e.disabled,onClick:function(){e.action(),r()}})})))};t.dialogOption=function(e,t,n,i){return{title:e,action:t,disabled:n||!1,isRed:i}}},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(186)),o=g(n(181)),r=g(n(182)),a=g(n(183)),s=g(n(184)),l=g(n(185)),u=n(177),c=g(u),d=g(n(180)),f=g(n(192)),p=g(n(191)),m=n(179),h=g(m);function g(e){return e&&e.__esModule?e:{default:e}}if(null==y)var y=n(179).static_images;var v=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={},n.fetchTreeData=n.fetchTreeData.bind(n),n.onNodeClick=n.onNodeClick.bind(n),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){this.fetchTreeData()}},{key:"fetchTreeData",value:function(e){var t=this;p.default.get("/_layouts/15/ShareSomething/browseDocs.ashx").query(e).end(function(n,o){n||!o.ok||o.body.error?h.default.receivedAPIError(n||o.body.error||o.text):null==e?t.setState({tree:o.body}):t.setState({tree:t.state.tree.map(function(e){return k(e,(0,i.default)({},o.body,{expanding:!1,expanded:!0}))})})})}},{key:"onNodeClick",value:function(e,t){if(h.default.stopBubble(e),"File"===t.type)this.props.onChooseFile(E(t));else{var n=void 0;t.expanded?n=(0,i.default)({},t,{expanded:!1}):t.children?n=(0,i.default)({},t,{expanded:!0}):(n=(0,i.default)({},t,{expanding:!0}),this.fetchTreeData(t)),this.setState({tree:this.state.tree.map(function(e){return k(e,n)})})}}},{key:"render",value:function(){var e=this,t=this.props.onClose;return c.default.createElement(f.default,{onClose:t,title:"Insert files from SharePoint",style:{width:620,height:450}},this.state.tree&&this.state.tree.map(function(t){return _(t,e.onNodeClick)}))}}]),t}(u.Component),E=function(e){return{collectionType:"Document",collectionMembers:[{title:e.title,documentType:e.documentType||e.originalFilename.substring(e.originalFilename.lastIndexOf(".")+1),originalFilename:e.originalFilename,sourceAssetUrl:window.location.origin+e.sourceAssetUrl,memberType:"Document",fromSharepoint:!0}]}},k=function e(t,n){return t.type===n.type&&t.id===n.id?(0,i.default)({},t,n):t.children?(0,i.default)({},t,{children:t.children.map(function(t){return e(t,n)})}):t},_=function e(t,n){return c.default.createElement("div",{key:t.id,onClick:function(e){return n(e,t)}},c.default.createElement("div",{className:"ka_treeNode"+(t.inactive?" inactive":"")},function(e){return e.hideCaret||"File"===e.type?c.default.createElement("div",{className:"ka_treeControl"}):e.expanded?c.default.createElement("div",{className:"ka_treeControl"},c.default.createElement("img",{src:m.imgRoot+"caret.svg",style:{width:12}})):c.default.createElement("div",{className:"ka_treeControl"},c.default.createElement("img",{src:m.imgRoot+"caret_closed.svg",style:{width:6}}))}(t),c.default.createElement("img",{src:t.fileIcon||b(t.type),className:"ka_treeIcon"}),c.default.createElement("span",{title:t.title},t.title)),c.default.createElement("div",{className:"ka_treeChildren"},t.expanding&&e(I,function(e){return h.default.stopBubble(e)}),!t.expanding&&(!t.children||0===t.children.length)&&t.expanded&&e(C,function(e){return h.default.stopBubble(e)}),!t.expanding&&t.children&&t.expanded&&t.children.map(function(t){return e(t,n)})))},b=function(e){switch(e){case"Site":return m.imgRoot+"community_sm.svg";case"Folder":return m.imgRoot+"folder.svg"}},I={id:0,hideCaret:!0,inactive:!0,title:"Loading files...",fileIcon:y.spinner_16},C={id:0,hideCaret:!0,inactive:!0,title:"No files in folder",fileIcon:y.yield_16};v.propTypes={onClose:d.default.func.isRequired,onChooseFile:d.default.func.isRequired},t.default=v},478:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(181)),o=m(n(182)),r=m(n(183)),a=m(n(184)),s=m(n(185)),l=n(177),u=m(l),c=m(n(180)),d=m(n(190)),f=m(n(561)),p=m(n(327));function m(e){return e&&e.__esModule?e:{default:e}}if(null==h)var h=n(179).static_images;var g=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={showPlaceholder:!0,taggingHovered:!0},n.clearSearch=n.clearSearch.bind(n),n.searchInputCleared=n.searchInputCleared.bind(n),n.onSearching=n.onSearching.bind(n),n.onSearched=n.onSearched.bind(n),n.onAddTag=n.addTag.bind(n),n.onInputBlur=n.onInputBlur.bind(n),n.onInputFocus=n.onInputFocus.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.focusInput=n.focusInput.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"focusInput",value:function(){this.input.focus()}},{key:"render",value:function(){var e=this,t=this.props.itemID,n=this.props.mentions,i=this.props.hashtags,o=(n||[]).concat(i||[]).filter(function(e){return!e.deleted});return u.default.createElement("div",{className:(0,d.default)(this.props.className,"ka_streamTagEditor"),style:{display:"block"}},u.default.createElement(p.default,{ref:"wrapper",className:"ka_addTagsBox",style:this.props.onClose?{width:487,display:"inline-block"}:{display:"block"},onClick:this.focusInput,searchingFor:this.state.searchingFor,suggestionsFor:this.state.suggestionsFor,suggestions:this.state.suggestions,mentions:n,hashtags:i,onAddTag:function(n){return e.addTag(n,t)},clearSearch:this.clearSearch,usesInputBox:!0,onMouseDown:function(){return e.setState({taggingHovered:!0})},onMouseEnter:function(){return e.setState({taggingHovered:!0})},onMouseLeave:function(){return e.setState({taggingHovered:!1})}},o.map(function(n,i){return u.default.createElement("div",{className:"shareTag",key:i},n.entityName||n.hashtag,u.default.createElement("img",{onClick:function(){return!e.props.readOnly&&y(o)&&e.props.deleteTag(n,t)},className:"btnRemoveTag",title:"Remove tag",src:h.cancel_11}))}),this.state.showPlaceholder&&u.default.createElement("span",{className:"ka_addTagsText"},"+ Add more tags"),u.default.createElement(f.default,{ref:function(t){return e.input=t},className:"ka_addTagPhrase",style:this.state.showPlaceholder?{width:0}:void 0,onAddTag:function(n){return e.addTag(n,t)},onFocus:this.onInputFocus,onBlur:this.onInputBlur,taggingHovered:this.state.taggingHovered,onSearching:this.onSearching,onSearched:this.onSearched,onCleared:this.searchInputCleared,readOnly:this.props.readOnly,onKeyDown:function(t){return e.onKeyDown(t)}})),this.props.onClose&&u.default.createElement("div",{onClick:this.props.onClose,className:(0,d.default)("ka_button","ka_buttonActive","ka_applyStreamTags"),style:{marginLeft:5,display:"inline-block"}},"Done"))}},{key:"onKeyDown",value:function(e){switch(e.keyCode){case 38:this.refs.wrapper.onUpArrow(e);break;case 40:this.refs.wrapper.onDownArrow(e);break;case 9:return this.refs.wrapper.onTab(e);case 27:this.refs.wrapper.onEscape(e);break;case 13:return this.refs.wrapper.handleReturn(e)}}},{key:"clearSearch",value:function(){this.setState({searchingFor:null,suggestionsFor:null,suggestions:null}),this.input.clearInput()}},{key:"searchInputCleared",value:function(){this.setState({searchingFor:null,suggestionsFor:null,suggestions:null})}},{key:"onSearching",value:function(e){this.setState({searchingFor:e,suggestionsFor:e})}},{key:"onSearched",value:function(e){this.setState({suggestions:e})}},{key:"addTag",value:function(e,t){this.props.addTag(e,t),this.clearSearch(),this.input.focus()}},{key:"onInputBlur",value:function(e){this.state.taggingHovered||this.setState({suggestions:null}),""==e.target.value&&this.setState({showPlaceholder:!0})}},{key:"onInputFocus",value:function(e){this.setState({showPlaceholder:!1})}},{key:"componentDidMount",value:function(){this.props.getDefaultMentions&&this.props.getDefaultMentions()}}]),t}(l.Component),y=function(e){return 1!==e.length||(alert("This is the last tag. Please add another before removing this one."),!1)};g.propTypes={mentions:c.default.array,hashtags:c.default.array,addTag:c.default.func.isRequired,deleteTag:c.default.func.isRequired,onClose:c.default.func},t.default=g},479:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),i=0,o=n.length;i<o;i++){var r=n[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},480:function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},492:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keys=__webpack_require__(235),_keys2=_interopRequireDefault(_keys),_extends2=__webpack_require__(206),_extends3=_interopRequireDefault(_extends2),_getPrototypeOf=__webpack_require__(181),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(182),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(183),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(184),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(185),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(177),_react2=_interopRequireDefault(_react),_KAModal=__webpack_require__(192),_KAModal2=_interopRequireDefault(_KAModal),_utils=__webpack_require__(179),_utils2=_interopRequireDefault(_utils),_superagent=__webpack_require__(191),_superagent2=_interopRequireDefault(_superagent),_utils3=__webpack_require__(189);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var MediaModal=function(_Component){function MediaModal(e){(0,_classCallCheck3.default)(this,MediaModal);var t=(0,_possibleConstructorReturn3.default)(this,(MediaModal.__proto__||(0,_getPrototypeOf2.default)(MediaModal)).call(this,e));return t.state={},t.fetchImageDetails=t.fetchImageDetails.bind(t),t}return(0,_inherits3.default)(MediaModal,_Component),(0,_createClass3.default)(MediaModal,[{key:"componentWillMount",value:function(){this.fetchImageDetails(this.props.target)}},{key:"componentWillReceiveProps",value:function(e){this.props.target!=e.target&&this.fetchImageDetails(e.target)}},{key:"componentDidUpdate",value:function(e,t){var n=this;if(null==t.modalHtml&&null!=this.state.modalHtml){var i=this.refs.htmlContainer.getElementsByTagName("IMG")[0];i?i.addEventListener("load",function e(t){n.refs.htmlContainer.style.visibility="visible",t.target.removeEventListener("load",e)},!1):document.querySelector(".kamodal-content > div").style.visibility="visible"}}},{key:"fetchImageDetails",value:function fetchImageDetails(target){var _this3=this;_superagent2.default.get("/_layouts/15/KAMasterPage/imgDetail.ashx").query(imgDetailData(target)).end(function(err,res){err||!res.ok?(0,_utils3.logError)(err||res.text):(_this3.setState({modalHtml:res.text}),window.setTimeout(function(){for(var modalScripts=_this3.refs.htmlContainer.getElementsByTagName("script"),i=0;i<modalScripts.length;i++){var script=modalScripts[i].innerHTML;eval(script)}},1))})}},{key:"render",value:function(){return _react2.default.createElement(_KAModal2.default,(0,_extends3.default)({},this.props,{className:"kamodal_media",hideX:null==this.state.modalHtml}),null==this.state.modalHtml&&_react2.default.createElement("img",{src:"/_layouts/15/Updates/images/Ajax-loader.gif",style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:-1}}),null!=this.state.modalHtml&&_react2.default.createElement("div",{ref:"htmlContainer",style:{visibility:"hidden"},dangerouslySetInnerHTML:{__html:this.state.modalHtml}}))}}]),MediaModal}(_react.Component);exports.default=MediaModal;var imgDetailData=function(e){return e.hasAttribute("ItemID")?{videoItemID:e.getAttribute("ItemID")}:{imageUrl:e.hasAttribute("fullsizeurl")?e.getAttribute("fullsizeurl"):e.getAttribute("src")}},queryString=function(e){return"?"+(0,_keys2.default)(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}},493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(177)),o=s(n(180)),r=s(n(178)),a=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.event,n=e.isSelected,o=e.onClick,a=r.default.utc(t.startTime,"YYYY-MM-DDTHH:mm:ss",!1).local(),s=(r.default.utc(t.endTime,"YYYY-MM-DDTHH:mm:ss",!1).local(),t.url);if(a)return i.default.createElement("div",{className:"ka_calendarBox ka_subitem"+(n?" selected":""),onClick:function(e){return u(e,o)},spellCheck:!1},i.default.createElement("div",{className:"ka_CalIcon"},i.default.createElement("a",{href:s,onClick:function(e){return u(e,o)}},i.default.createElement("div",{className:"ka_CalMonth"},a.format("MMM").toUpperCase()),i.default.createElement("div",{className:"ka_CalDay"},a.format("D")))),i.default.createElement("div",null,i.default.createElement("a",{className:"ka_streamSubItemTitle",href:s,onClick:function(e){return u(e,o)}},a.format("h:mm A")),i.default.createElement("span",{className:"ka_EventLocation"},(t.location||"").replace("{SubItemDateStamp}",a.format("lll"))),t.communityName&&t.listURL&&t.listName&&i.default.createElement("a",{className:"SubItemSubtitle",href:t.listURL,onClick:function(e){return u(e,o)}},t.communityName," ",t.listName)))},u=function(e,t){t&&t(),a.default.stopBubble(e)};l.propTypes={event:o.default.object.isRequired,isSelected:o.default.bool,onClick:o.default.func},t.default=l},494:function(e,t){},510:function(e,t){},516:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(517),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{comments:n.comments,likes:n.likes,isLiking:n.isLiking}},function(e){return{likeItem:function(t){return e((0,r.likeItem)(t))},unlikeItem:function(t){return e((0,r.unlikeItem)(t))},toggleSemiLessMode:function(t){return e((0,r.toggleSemiLessMode)(t))}}})(s.default)},517:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(177)),o=l(n(180)),r=l(n(518)),a=l(n(179)),s=l(n(314));function l(e){return e&&e.__esModule?e:{default:e}}if(null==u)var u=n(179).static_images;var c=function(e){var t=e.itemID,n=e.likes,o=e.isLiking,l=e.comments,c=e.likeItem,d=e.unlikeItem,f=e.toggleSemiLessMode,p=a.default.getLikeStatus(n);return i.default.createElement("div",{className:"ka_streamLessFooter"},i.default.createElement("span",{title:p?"Remove your like from this item":"Like this item",className:"ka_less_btnLike",onClick:function(e){a.default.stopBubble(e),o||(p?d(t):c(t))}},i.default.createElement(s.default,{likeStatus:p}),i.default.createElement("span",null," ",function(e){return null==e||0==e.length?"Like":1==e.length?"1 Like":e.length+" Likes"}(n))),i.default.createElement("span",{className:"ka_less_btnComment",onClick:function(e){a.default.stopBubble(e),f(t)},title:"View comments"},i.default.createElement("img",{src:u.comment_20}),i.default.createElement("span",null," ",function(e){return null==e||0==e.length?"Comment":1==e.length?"1 Comment":e.length+" Comments"}(l))),i.default.createElement(r.default,{itemID:t}))};c.propTypes={itemID:o.default.number.isRequired,likes:o.default.array,isLiking:o.default.bool,comments:o.default.array,likeItem:o.default.func.isRequired,unlikeItem:o.default.func.isRequired,onClickComment:o.default.func},t.default=c},518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(226),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){return{isLessMode:e.items.find(function(e){return e.itemID===t.itemID}).isLessMode}},function(e){return{toggleItemLessMode:function(t,n){e((0,r.toggleItemLessMode)(t,n))}}})(s.default)},519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(198),o=n(188),r=s(n(520)),a=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{itemType:n.itemType,likes:n.likes,isLiking:n.isLiking,likeStatus:a.default.getLikeStatus(n.likes),subscriptionStatus:null!=n.isNotify&&1===n.isNotify,isSubscribing:n.isSubscribing,authorID:null!=n.author?n.author.employeeID:n.authorID,isSPAdmin:e.isSPAdmin,subItemProfileURL:n.subItemProfileURL,deleted:n.deleted,promoted:n.promoted,promotedEndDate:n.promotedEndDate,promotedOrder:n.promotedOrder,apiFilter:n.apiFilter,apiFilterEnabled:e.apiFilterEnabled,title:a.default.replaceInlineTagsWithText(n.title,n.mentions)}},function(e){return{removeItem:function(t){return e((0,o.removeItem)(t))},restoreItem:function(t){return e((0,o.restoreItem)(t))},likeItem:function(t){return e((0,o.likeItem)(t))},unlikeItem:function(t){return e((0,o.unlikeItem)(t))},subscribeToItem:function(t){return e((0,o.subscribeToItem)(t))},unsubscribeFromItem:function(t){return e((0,o.unsubscribeFromItem)(t))},toggleTagEditor:function(t){return e((0,o.toggleTagEditor)(t))},promoteItem:function(t,n,i){return e((0,o.promoteItem)(t,n,i))},updateItemPromotion:function(t,n){return e((0,o.updateItemPromotion)(t,n))},setPublished:function(t,n){return e((0,o.setPublished)(t,n))},demoteItem:function(t){return e((0,o.demoteItem)(t))},toggleContentLessMode:function(t){return e((0,o.toggleContentLessMode)(t))}}})(r.default)},520:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(181)),o=y(n(182)),r=y(n(183)),a=y(n(184)),s=y(n(185)),l=n(177),u=y(l),c=y(n(180)),d=y(n(190)),f=y(n(521)),p=y(n(242)),m=y(n(203)),h=y(n(226)),g=y(n(179));function y(e){return e&&e.__esModule?e:{default:e}}if(null==v)var v=n(179).static_images;var E=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={isMenuOpen:!1,isPromoteOpen:!1},n.toggleMenu=n.toggleMenu.bind(n),n.togglePromoteModal=n.togglePromoteModal.bind(n),n.moreActionsArray=n.moreActionsArray.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.itemID,i=t.itemType,o=t.isLiking,r=t.likeStatus,a=t.subscriptionStatus,s=t.isSubscribing,l=t.authorID,c=t.subItemProfileURL,y=t.promoted,E=t.promotedEndDate,_=t.promoteItem,b=t.updateItemPromotion,I=t.demoteItem,C=t.likeItem,S=t.unlikeItem,T=t.subscribeToItem,D=t.unsubscribeFromItem,w=t.isSPAdmin,M=t.toggleContentLessMode,P=t.showContentMoreToggle;return u.default.createElement("div",{className:"ka_streamItemFooter"},u.default.createElement("span",{className:"linkInactive",title:r?"Remove your like from this item":"Like this item",onClick:o?null:r?function(){return S(n)}:function(){return C(n)}},r?"Unlike":"Like"),"  |  ",a?u.default.createElement("span",{className:"linkInactive",title:"Stop future email notifications.",onClick:function(){return s?null:D(n)}},"Unsubscribe"):u.default.createElement("span",{className:"linkInactive",title:"Start receiving email notifications on this thread.",onClick:function(){return s?null:T(n)}},"Subscribe"),"  |",(l==currentEmployee.employeeID||g.default.isSPAdmin())&&[u.default.createElement("span",{key:0},"  "),k(i,n,c),u.default.createElement("span",{key:2},"  |")],u.default.createElement("span",{className:(0,d.default)("ka_streamActions",this.state.isMenuOpen?"open":null,w&&y?"wide":null)},u.default.createElement("span",{title:"More Actions",onClick:this.toggleMenu},"More Actions ",u.default.createElement("img",{src:v.more_caret_dk_grey_14})),this.state.isMenuOpen&&u.default.createElement(m.default,{onClose:function(){return e.setState({isMenuOpen:!1})}},u.default.createElement("div",null,this.moreActionsArray().map(function(e,t){return u.default.createElement("div",{key:t},e)})))),P&&u.default.createElement(h.default,{itemID:n,isLessMode:!0,toggleItemLessMode:M}),this.state.isPromoteOpen&&u.default.createElement(f.default,{itemID:n,promoted:y,promotedEndDate:y?E:void 0,onClose:this.togglePromoteModal,promoteItem:_,updateItemPromotion:b,demoteItem:I}),this.state.showConfirmRemove&&u.default.createElement(p.default,{title:"Remove Post",message:"Are you sure you want to remove this post and its comments from all activity streams?",confirmText:"Remove",redConfirm:!0,onConfirm:function(){return e.props.removeItem(n)},onClose:function(){return e.setState({showConfirmRemove:!1})}}),this.state.showConfirmRestore&&u.default.createElement(p.default,{title:"Restore Post",message:"Are you sure you want to restore this post and its comments to all activity streams?",confirmText:"Restore",onConfirm:function(){return e.props.restoreItem(n)},onClose:function(){return e.setState({showConfirmRestore:!1})}}),this.state.showConfirmPublish&&u.default.createElement(p.default,{title:"Publish Post",message:"Are you sure you want to make this post available to the Synthesis API?",confirmText:"Publish",onConfirm:function(){return e.props.setPublished(n,!0)},onClose:function(){return e.setState({showConfirmPublish:!1})}}),this.state.showConfirmUnpublish&&u.default.createElement(p.default,{title:"Unpublish Post",message:"Are you sure you want to remove this post from the Synthesis API?",confirmText:"Unpublish",onConfirm:function(){return e.props.setPublished(n,!1)},onClose:function(){return e.setState({showConfirmUnpublish:!1})}}))}},{key:"toggleMenu",value:function(e){this.setState({isMenuOpen:!this.state.isMenuOpen})}},{key:"togglePromoteModal",value:function(){this.setState({isPromoteOpen:!this.state.isPromoteOpen})}},{key:"moreActionsArray",value:function(){var e=this,t=this.props,n=t.itemID,i=t.authorID,o=t.isSPAdmin,r=t.promoted,a=t.apiFilterEnabled,s=t.deleted,l=t.toggleTagEditor,c=t.title,d=urlTemplates.threadUrl+"?ItemID="+n,f=void 0;return f=window.location.origin?""+window.location.origin+d:window.location.protocol+"//"+window.location.hostname+(window.location.port?":":"")+window.location.port+d,[u.default.createElement("a",{href:d,title:"Open the permalink for this thread."},"View"),(i==employeeID||o)&&u.default.createElement("span",{onClick:function(){l(n),e.toggleMenu()},title:"Edit tags for this stream item."},"Edit Tags"),u.default.createElement("a",{href:"mailto:?subject="+encodeURIComponent(c||"Forwarded from Intranet")+"&body="+encodeURIComponent(f),title:"Email a link to this thread.",target:"_blank"},"Email"),o&&!r&&u.default.createElement("span",{onClick:function(){e.togglePromoteModal(),e.toggleMenu()},title:"Promote this item to the home page and all tagged activity streams."},"Promote"),o&&r&&u.default.createElement("span",{onClick:function(){e.togglePromoteModal(),e.toggleMenu()},title:"Edit the promotion date for this item."},"Update Promotion"),o&&a&&0===this.props.apiFilter&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmPublish:!0})}},"Publish"),o&&a&&0!==this.props.apiFilter&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmUnpublish:!0})}},"Unpublish"),(i==employeeID||o)&&!s&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmRemove:!0})},title:"Remove post"},"Remove"),o&&s&&u.default.createElement("span",{onClick:function(){e.toggleMenu(),e.setState({showConfirmRestore:!0})},title:"Restore post"},"Restore")].filter(function(e){return e})}}]),t}(l.Component),k=function(e,t,n){var i=void 0,o=void 0,r=void 0;switch(e){case"New Blog Post":o="Edit this blog post",r=function(e){return _(n.replace("Post.aspx","EditPost.aspx"))};break;case"New Event":o="Edit this calendar event",r=function(e){return _(n.replace("DispForm.aspx","EditForm.aspx"))};break;default:o="Edit this post",i="/_layouts/15/ShareSomething/EditPost.aspx?ItemID="+t}return u.default.createElement("a",{className:"linkInactive",title:o,href:i,onClick:r,key:"edit"},"Edit")},_=function(e){SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){SP.UI.ModalDialog.OpenPopUpPage(e,b)})},b=function(e){SP.UI.DialogResult.cancel};E.propTypes={itemID:c.default.number.isRequired,itemType:c.default.string.isRequired,toggleTagEditor:c.default.func.isRequired,likes:c.default.array,isLiking:c.default.bool,likeStatus:c.default.bool,subscriptionStatus:c.default.bool,isSubscribing:c.default.bool,authorID:c.default.string,isSPAdmin:c.default.bool.isRequired,subItemProfileURL:c.default.string,deleted:c.default.bool.isRequired,promoted:c.default.bool.isRequired,promotedEndDate:c.default.string,promotedOrder:c.default.number,apiFilterEnabled:c.default.bool,apiFilter:c.default.number,title:c.default.string.isRequired,removeItem:c.default.func.isRequired,likeItem:c.default.func.isRequired,unlikeItem:c.default.func.isRequired,subscribeToItem:c.default.func.isRequired,unsubscribeFromItem:c.default.func.isRequired,updateItemPromotion:c.default.func.isRequired,setPublished:c.default.func.isRequired,promoteItem:c.default.func.isRequired},t.default=E},521:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(240)),o=h(n(181)),r=h(n(182)),a=h(n(183)),s=h(n(184)),l=h(n(185)),u=n(177),c=h(u),d=h(n(180)),f=h(n(192)),p=h(n(178));n(95);var m=n(605);function h(e){return e&&e.__esModule?e:{default:e}}n(635);var g=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e)),i=e.promotedEndDate?p.default.utc(e.promotedEndDate,"YYYY-MM-DDTHH:mm:ss",!1).local():null;return n.state={promEndDate:null!=i&&(0,m.isInclusivelyAfterDay)(i,(0,p.default)())?i:(0,p.default)(),promNotify:!1},n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e,t=this,n=this.props,o=n.itemID,r=n.promoted,a=n.onClose,s=n.promoteItem,l=n.updateItemPromotion,u=n.demoteItem;return c.default.createElement(f.default,{onClose:a,title:"Promote this Post",className:"ka_streamPromotePicker"},c.default.createElement("div",null,"Select a date for this promotion to end."),c.default.createElement("br",null),c.default.createElement(m.DayPickerRangeController,{startDate:(0,p.default)(),endDate:this.state.promEndDate,numberOfMonths:1,onDatesChange:function(e){e.startDate;var n=e.endDate;(0,m.isInclusivelyAfterDay)(n,(0,p.default)())&&t.setState({promEndDate:n})},focusedInput:"endDate",onFocusChange:function(e){return t.setState({focusedInput:e})},keepOpenOnDateSelect:!0,isOutsideRange:function(e){return!(0,m.isInclusivelyAfterDay)(e,(0,p.default)())},minimumNights:0,hideKeyboardShortcutsPanel:!0}),c.default.createElement("br",null),c.default.createElement("div",{style:{verticalAlign:"middle"}},r?c.default.createElement("div",{style:{textAlign:"right"}},c.default.createElement("input",{type:"button",className:"ka_button",value:"Update",onClick:function(){l(o,t.state.promEndDate.startOf("day").add(18,"hours").utc().format()),a()}}),c.default.createElement("input",(e={type:"button",className:"ka_button",value:"Demote"},(0,i.default)(e,"className","red"),(0,i.default)(e,"onClick",function(){u(o),a()}),e))):c.default.createElement("div",null,c.default.createElement("input",{type:"checkbox",checked:this.state.promNotify,onChange:function(e){return t.setState({promNotify:e.target.checked})}})," Send an e-mail notification to all users.",c.default.createElement("br",null),c.default.createElement("br",null),c.default.createElement("input",{type:"button",className:"ka_button",value:"Promote",style:{marginTop:0,float:"right"},onClick:function(){null!=t.state.promEndDate&&(s(o,t.state.promEndDate.startOf("day").add(18,"hours").utc().format(),t.state.promNotify),a())}}))))}}]),t}(u.Component);g.propTypes={itemID:d.default.number.isRequired,promoted:d.default.bool.isRequired,promotedEndDate:d.default.string,promotedOrder:d.default.number,promoteItem:d.default.func.isRequired},t.default=g},526:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(177)),o=s(n(180)),r=s(n(226)),a=s(n(179));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.item,n=t.itemID,o=t.isLessMode,s=t.mentions,l=t.hashtags,c=e.showItemModeToggle,d=e.toggleItemLessMode,f=e.blogCategories,p=e.tagClicked,m=null!=s?s.filter(function(e){return!e.deleted}):[],h=null!=l?l.filter(function(e){return!e.deleted}):[];return i.default.createElement("div",null,c&&i.default.createElement(r.default,{itemID:n,isLessMode:o,toggleItemLessMode:d}),i.default.createElement("div",{className:"ka_streamTags"},"Tags: ",a.default.separate(m.map(function(e,t){return e.hasProfile?i.default.createElement("a",{className:"ka_streamTagLink ka_mention_link",href:a.default.getResourceUrl(e.entityType,e.entityID,e.isOpportunity),onClick:function(t){return p(t,e.entityType,e.entityID)},key:t},e.entityName):e.entityName}),", "),m.length>0&&h.length>0?", ":null,a.default.separate(h.map(function(e,t){return i.default.createElement("a",{className:"ka_streamTagLink ka_hashtag_link",href:a.default.getResourceUrl("Hashtag",e.hashtag),onClick:function(t){return p(t,"Hashtag",e.hashtag)},key:t},e.hashtag)}),", ")),null!=f&&f.length>0&&i.default.createElement("div",{className:"ka_streamBlogCategories"},"Categories: ",a.default.separate(f.map(function(e,t){return i.default.createElement("a",{className:"ka_blogcategory_link",href:u(e.urlSlug,e.name),key:t},e.name)}),", ")))},u=function(e,t){return(e+="&name="+encodeURIComponent(t)).startsWith("/")||e.startsWith("http")?e:"/"+e};l.propTypes={item:o.default.object.isRequired,toggleItemLessMode:o.default.func.isRequired,blogCategories:o.default.array},t.default=l},527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(528),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{itemID:t.itemID,likes:n.likes}},function(e){return{likeItem:function(t){e((0,r.likeItem)(t))},unlikeItem:function(t){e((0,r.unlikeItem)(t))}}})(s.default)},528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(181)),o=h(n(182)),r=h(n(183)),a=h(n(184)),s=h(n(185)),l=n(177),u=h(l),c=h(n(180)),d=h(n(190)),f=(h(n(226)),h(n(179))),p=h(n(314)),m=h(n(529));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.itemID,i=t.likes,o=t.likeItem,r=t.unlikeItem,a=f.default.getLikeStatus(i);return null!=i&&i.length>0?u.default.createElement("div",{className:(0,d.default)("ka_streamSubBox","ka_streamLikeCount")},u.default.createElement(p.default,{likeStatus:a,title:a?"Remove your like from this item":"Like this item",onClick:function(e){return a?r(n):o(n)}}),function(){switch(i.length){case 1:return[y(i[0].author,0),u.default.createElement("span",{key:1}," likes this.")];case 2:return[y(i[0].author,0),u.default.createElement("span",{key:1}," and "),y(i[1].author,2),u.default.createElement("span",{key:3}," like this.")];default:return[u.default.createElement("span",{className:"linkInactive",onClick:function(){return e.setState({isViewingLikes:!0})},key:0},i.length," People"),u.default.createElement("span",{key:1}," like this.")]}}(),this.state.isViewingLikes&&u.default.createElement(m.default,{likes:i,onClose:function(){return e.setState({isViewingLikes:!1})}})):null}}]),t}(l.Component),y=function(e,t){return null==e?(console.error("like missing author"),u.default.createElement("span",{key:t},"someone")):"Y"===e.showInCompanyDirectory?u.default.createElement("a",{className:"ka_likeAuthor",href:f.default.getResourceUrl("Employee",e.employeeID),key:t},e.fullName):u.default.createElement("span",{key:t},e.fullName)};g.propTypes={itemID:c.default.number.isRequired,likes:c.default.array,likeItem:c.default.func.isRequired,unlikeItem:c.default.func.isRequired},t.default=g},529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(181)),o=m(n(182)),r=m(n(183)),a=m(n(184)),s=m(n(185)),l=n(177),u=m(l),c=m(n(180)),d=m(n(192)),f=m(n(269)),p=m(n(179));function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.props.likes.sort(function(e,t){return t.likeID-e.likeID}),n={minWidth:400};return t.length>7&&(n.height=500),u.default.createElement(d.default,{onClose:this.props.onClose,style:n,title:"Likes",ref:function(t){return e.modal=t}},t.map(function(e){return e.author?g(e):null}))}}]),t}(l.Component),g=function(e){return u.default.createElement("div",{style:{padding:3,margin:2,whiteSpace:"nowrap"},className:"ka_greyLinks",key:e.likeID},u.default.createElement(f.default,{enabled:!e.author.deleted&&"Y"===e.author.showInCompanyDirectory,href:p.default.getResourceUrl("Employee",e.author.employeeID)},u.default.createElement("img",{src:p.default.getImageURL("Employee",e.author.primaryImageID,50),width:"50px",height:"50px",style:{verticalAlign:"middle",marginRight:5},className:"ka_circular"}),u.default.createElement("span",null,e.author.fullName)))};h.propTypes={likes:c.default.array.isRequired,onClose:c.default.func},t.default=h},530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(531),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{item:n,itemAuthor:n.author,comments:n.comments,commentDrafts:n.commentDrafts,mentions:n.mentions,hashtags:n.hashtags,showingAllComments:n.showingAllComments,isAddingComment:n.isAddingComment,isSPAdmin:e.isSPAdmin}},function(e,t){return{showAllComments:function(t){return e((0,r.showAllComments)(t))},removeComment:function(t){return e((0,r.removeComment)(t))},setIsCommenting:function(n,i){return e((0,r.setIsCommenting)(t.itemID,n,i))},toggleCommentLessMode:function(t){return e((0,r.toggleCommentLessMode)(t))}}})(s.default)},531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=I(n(186)),o=I(n(181)),r=I(n(182)),a=I(n(183)),s=I(n(184)),l=I(n(185)),u=n(177),c=I(u),d=I(n(180)),f=I(n(190)),p=(I(n(226)),I(n(179))),m=I(n(269)),h=I(n(532)),g=(I(n(558)),n(669),I(n(203))),y=I(n(242)),v=n(279),E=n(209),k=I(n(280)),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213)),b=n(189);function I(e){return e&&e.__esModule?e:{default:e}}if(null==C)var C=n(179).static_images;var S=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.toggleDeleteCommentModal=n.toggleDeleteCommentModal.bind(n),n.editComment=n.editComment.bind(n),n.trackSubitem=n.trackSubitem.bind(n),n.state={deleteCommentOpen:!1,deletingComment:0,commentMenuOpen:0,showConfirmRemoveCommentID:0,hoveredComment:0},n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidCatch",value:function(e,t){(0,b.logError)(e,{itemID:this.props.itemID}),this.setState({error:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.itemID,i=t.itemAuthor,o=t.comments,r=t.commentDrafts,a=t.mentions,s=t.hashtags,l=t.showingAllComments,u=(t.isAddingComment,t.isSPAdmin),d=t.showAllComments,f=t.removeComment;if(this.state.error)return c.default.createElement("div",null);var p=r&&r.length>0?r[0]:void 0;return c.default.createElement("div",null,!1,!l&&o&&o.length>2&&this.renderShowAllComments(n,o.length,d,"showAll"),o&&o.slice((!l&&o.length)>2?-2:0).map(function(t,n){return e.renderComment(t,i,a,s,f,u,e.state.deletingComment,e.props.toggleCommentLessMode)}),c.default.createElement(h.default,{itemID:n,key:"newComment",focus:this.props.focusEditor,isCommenting:null!=p,comment:p}),0!==this.state.showConfirmRemoveCommentID&&c.default.createElement(y.default,{title:"Remove Comment",message:"Are you sure you want to remove this comment from the stream?",confirmText:"Remove",redConfirm:!0,onConfirm:function(){return e.props.removeComment(e.state.showConfirmRemoveCommentID)},onClose:function(){return e.setState({showConfirmRemoveCommentID:0,commentMenuOpen:0})}}),!1)}},{key:"linkClicked",value:function(e,t){"A"===e.target.nodeName&&(e.target.className.indexOf("ka_mention_link")>-1||e.target.className.indexOf("ka_hashtag_link")>-1?_.trackCommentTagClick(e.target.href,e.target.text,e.target.getAttribute("entityType"),e.target.getAttribute("entityID"),this.props.item,t):_.trackCommentLinkClick(e.target.href,e.target.text,this.props.item,t))}},{key:"trackSubitem",value:function(e,t,n,i,o,r){"Video"===e&&r===_.eventTypes.watch?_.trackVideoWatch(i.videoID,i.chunksWatched,i.sessionID,this.props.item,o):_.trackCommentSubitemClick(e,t,n,this.props.item,o)}},{key:"renderComment",value:function(e,t,n,o,r,a,s,l){var u=this;if(e.isCommenting||e.restoreEditorState)return c.default.createElement(h.default,{itemID:this.props.itemID,comment:e,focusOnMount:!0,isCommenting:!0,itemAuthor:t,mentions:n,hashtags:o,key:e.commentID});var d=(e.author.employeeID===employeeID||a)&&!e.isPending&&(this.state.hoveredComment===e.commentID||this.state.commentMenuOpen===e.commentID)&&!0,y={};y=e.jsonContent?(0,v.renderJsonContent)(e.jsonContent,e.subitems,t,n,o,e.isLessMode,"ka_streamCommentContent",{width:E.INT_COMMENT_IMAGE_WIDTH,height:E.INT_COMMENT_IMAGE_HEIGHT},E.INT_COMMENT_LESS_CHARS,!1,function(t,n,i,o,r){return u.trackSubitem(t,n,i,o,e,r)},function(t){return u.linkClicked(t,e)}):(0,v.renderFormattedContent)(e.formattedContent,e.subitems,t,n,o,e.isLessMode,!1,"ka_streamCommentContent",E.INT_COMMENT_LESS_CHARS,function(t){return u.linkClicked(t,e)});var _=e.isLessMode&&(y.trimmed||e.subitems&&(e.subitems.filter(function(e){return!e.deleted}).length>1||e.subitems.filter(function(e){return"Image"===e.collectionType&&!e.deleted}).length>0)),b=void 0;return _&&(b=function(){return l(e.commentID)}),c.default.createElement("div",{className:(0,f.default)("ka_streamSubBox","ka_streamComment",e.isPending||e.author.employeeID!==employeeID&&!a?null:"ka_myComment",e.commentID==s?"highlighted":null),style:(0,i.default)({minHeight:35},_?{cursor:"pointer"}:null),key:e.commentID,onClick:b,onMouseEnter:function(){return u.setState({hoveredComment:e.commentID})},onMouseLeave:function(){u.state.hoveredComment===e.commentID&&u.setState({hoveredComment:0})}},c.default.createElement("div",{style:{display:"inline-block",marginRight:12},className:"ka_commentAuthorImage"},c.default.createElement(m.default,{enabled:"Y"===e.author.showInCompanyDirectory,href:p.default.getResourceUrl("Employee",e.author.employeeID)},c.default.createElement("img",{className:"imgSubjectImage ka_circular",src:p.default.getImageURL("Employee",e.author.primaryImageID,50,50,!0)}))),c.default.createElement("div",{style:{display:"inline-block",width:"calc(100% - 62px)",verticalAlign:"top"}},c.default.createElement(m.default,{enabled:"Y"===e.author.showInCompanyDirectory,className:"ka_authorName",href:p.default.getResourceUrl("Employee",e.author.employeeID)},e.author.fullName),d?c.default.createElement("div",{className:"ka_editCommentOptions"},c.default.createElement("img",{src:C.pencil_16,onClick:function(){return u.setState({commentMenuOpen:e.commentID})}}),this.state.commentMenuOpen===e.commentID&&c.default.createElement(g.default,{onClose:function(){u.state.commentMenuOpen===e.commentID&&u.setState({commentMenuOpen:0})}},c.default.createElement("div",null,c.default.createElement("span",{onClick:function(){return u.editComment(e.commentID)}},"Edit"),c.default.createElement("span",{onClick:function(){return u.setState({showConfirmRemoveCommentID:e.commentID})}},"Remove"),c.default.createElement("div",{className:"KAEditor-tri center"},c.default.createElement("div",null))))):c.default.createElement("span",{className:"ka_streamDate"},e.dateStamp?p.default.formatDateTimeStamp(e.dateStamp):"just now"),y.content,!e.jsonContent&&c.default.createElement(k.default,{subitemCollections:e.subitems,isLessMode:e.isLessMode,imageSize:{width:E.INT_COMMENT_IMAGE_WIDTH,height:E.INT_COMMENT_IMAGE_HEIGHT},className:"ka_SubItemContainer",trackSubitem:this.trackSubitem})),"","",!1,_&&c.default.createElement("span",{className:"linkActive ka_comment_more"},"See more..."),!_&&e.hasLessMode&&c.default.createElement("div",{className:"ka_comment_more"},c.default.createElement("span",{className:"linkActive",onClick:function(t){var n=t.target.parentElement.parentElement;p.default.compensateScrollPosition(n,function(){return n},function(){return l(e.commentID)})}},"See less...")))}},{key:"editComment",value:function(e){this.setState({commentMenuOpen:0}),this.props.setIsCommenting(!0,e)}},{key:"confirmRemoveCommentMobile",value:function(e,t){this.toggleDeleteCommentModal(t)}},{key:"renderShowAllComments",value:function(e,t,n,i){return c.default.createElement("div",{className:(0,f.default)("ka_streamSubBox","ka_streamCommentCount"),onClick:function(t){n(e),t.stopPropagation()},key:i},c.default.createElement("span",{className:(0,f.default)("ka_commentIcon","linkInactive")},c.default.createElement("img",{className:"ka_commentIcon",src:C.comment_20}),"Show all ",t," comments"))}},{key:"toggleDeleteCommentModal",value:function(e){this.setState({deleteCommentOpen:!this.state.deleteCommentOpen,deletingComment:e})}},{key:"closeDeleteCommentModal",value:function(e){this.setState({deleteCommentOpen:!1,deletingComment:0})}},{key:"renderPendingComment",value:function(){return c.default.createElement("div",{className:"ka_streamSubBox",style:{minHeight:35,position:"relative"},key:"pendingComment"},c.default.createElement("img",{src:C.ajax_loader_32,style:{position:"absolute",left:"50%"}}))}}]),t}(u.Component);S.propTypes={itemID:d.default.number.isRequired,itemAuthor:d.default.object,comments:d.default.array,mentions:d.default.array,hashtags:d.default.array,showingAllComments:d.default.bool.isRequired,isAddingComment:d.default.bool,isSPAdmin:d.default.bool.isRequired,showAllComments:d.default.func.isRequired,removeComment:d.default.func.isRequired,setIsCommenting:d.default.func.isRequired},t.default=S},532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(533),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){return{restoreCommentEditorState:e.items.find(function(e){return e.itemID===t.itemID}).restoreCommentEditorState,isOnLine:e.isOnLine,warnOffline:e.warnOffline}},function(e,t){return{setIsCommenting:function(t,n,i){return e((0,r.setIsCommenting)(t,n,i))},submitItemComment:function(t,n){e((0,r.submitUpdatedItemComment)(t,n))},submitCommentDraft:function(t){return e((0,r.submitCommentDraft)(t))},setDraftStatus:function(t,n,i){return e((0,r.setDraftStatus)(t,n,i))},setActionError:function(t){return e((0,r.setActionError)(t))},setWarnOffline:function(t,n){return e((0,r.setWarnOffline)(t,n))},setWarnBrokenUser:function(t){return e((0,r.setWarnBrokenUser)(t))},removeComment:function(t){return e((0,r.removeComment)(t))}}})(s.default)},533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=L(n(186)),o=L(n(181)),r=L(n(182)),a=L(n(183)),s=L(n(184)),l=L(n(185)),u=n(177),c=L(u),d=L(n(187)),f=L(n(180)),p=L(n(190)),m=L(n(179)),h=n(223),g=L(n(472)),y=L(n(473)),v=L(n(474)),E=n(214),k=L(n(244)),_=n(209),b=L(n(245)),I=L(n(246)),C=L(n(475)),S=n(476),T=L(S),D=L(n(477)),w=L(n(557)),M=n(220),P=n(208),A=n(189);function L(e){return e&&e.__esModule?e:{default:e}}var O=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));n.onLinkPeek=n.onLinkPeek.bind(n);var i=void 0;return i=e.comment&&e.comment.restoreEditorState?e.comment.restoreEditorState:e.comment?N(e.comment,e.itemAuthor,e.mentions,e.hashtags,n.onLinkPeek):(0,h.newEditorState)(n.onLinkPeek),n.state={editorState:i,fileUploads:[],fileUploadFailures:[],videoUploadFailures:[],videosProcessing:[],showUploadFailures:!1,draftIsDirty:!1,confirmCloseComment:-1},n.submitClicked=n.submitClicked.bind(n),n.onEditorChange=n.onEditorChange.bind(n),n.onEditLink=n.onEditLink.bind(n),n.onRemoveLink=n.onRemoveLink.bind(n),n.onUploadStart=n.onUploadStart.bind(n),n.onUploadEnd=n.onUploadEnd.bind(n),n.renderLinkDialog=n.renderLinkDialog.bind(n),n.isOnLine=n.isOnLine.bind(n),n.newCommentClicked=n.newCommentClicked.bind(n),n.setupDraftSaveTimer=n.setupDraftSaveTimer.bind(n),n.cancelDraftSaveTimer=n.cancelDraftSaveTimer.bind(n),n.submitDraft=n.submitDraft.bind(n),n.cancelHandler=n.cancelHandler.bind(n),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.focusOnMount&&(this.editor.focus(),window.setTimeout(function(){var t=d.default.findDOMNode(e),n=t.clientHeight,i=m.default.getOffsetFromAncestorS4Workspace(t),o=t.clientHeight,r=i+n;r>t.scrollTop+o&&(t.scrollTop=r-o)},0))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.setMaxHeight)}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.props.comment&&(this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saved&&this.props.comment.draftSaveStatus!==P.draftSaveStatuses.failed||window.setTimeout(function(){!n.props.comment||n.props.comment.draftSaveStatus!==P.draftSaveStatuses.saved&&n.props.comment.draftSaveStatus!==P.draftSaveStatuses.failed||n.props.setDraftStatus(P.draftSaveStatuses.idle,n.props.comment.itemID,n.props.comment.commentID)},5e3)),void 0===this.draftSaveTimer&&this.props.comment&&this.props.comment.isDraft&&this.setupDraftSaveTimer()}},{key:"onLinkPeek",value:function(e){this.setState({linkPeek:e})}},{key:"onEditLink",value:function(){this.setState({isLinkDialogOpen:!0,linkPeek:null})}},{key:"onRemoveLink",value:function(){var e=this,t=(0,h.tryGetLinkSelection)(this.state.editorState);if(null!=t){var n=M.RichUtils.toggleLink(this.state.editorState,t,null),i=n.getSelection();n=M.EditorState.acceptSelection(n,i.merge({anchorOffset:i.getFocusOffset()})),this.onEditorChange(n)}this.setState({linkPeek:null}),window.setTimeout(function(){return e.editor.focus()},0)}},{key:"onUploadStart",value:function(e){0===this.state.fileUploads.length&&(0,h.addConfirmLeave)(),this.setState({fileUploads:this.state.fileUploads.concat(e.name)})}},{key:"onUploadEnd",value:function(e,t){if(t)this.props.comment&&this.props.comment.isDraft&&this.submitDraft();else{var n=this.state.fileUploads.filter(function(t){return t!==e.name});this.setState({fileUploads:n});var i=this.state.fileUploadFailures,o=this.state.videoUploadFailures;e.status===k.default.FAILED&&(0===e.type.indexOf("video/")?o.push(e):i.push(e)),(i.length>0||o.length>0)&&this.setState({showUploadFailures:!0}),0===n.length?((0,h.removeConfirmLeave)(),0===i.length&&0===o.length&&(this.state.submitAfterFileUpload?this.submitClicked():this.props.comment&&this.props.comment.isDraft&&this.submitDraft())):this.setState({fileUploadFailures:i,videoUploadFailures:o})}}},{key:"isOnLine",value:function(){return this.props.isOnLine}},{key:"setIsCommenting",value:function(e,t){e||(0,h.removeConfirmLeave)(),this.isOnLine()&&this.props.setIsCommenting(this.props.itemID,e,t)}},{key:"newCommentClicked",value:function(){var e=this;this.props.isCommenting||(m.default.isUserBroken()?this.props.setWarnBrokenUser(!0):this.isOnLine()?(this.setIsCommenting(!0,null),window.setTimeout(function(){return e.editor&&e.editor.focus()},0)):null===document.querySelector(".ka_outageBannerContainer.nondismissible")&&this.props.setWarnOffline(E.OUTAGE_BANNERS.notCommenting.number,!0))}},{key:"cancelHandler",value:function(){return!!(this.props.comment&&this.props.comment.commentID&&this.props.comment.isDraft&&this.isOnLine())&&(this.setState({confirmCloseComment:this.props.comment.commentID}),!0)}},{key:"render",value:function(){var e=this,t=this.props.comment?this.props.comment.commentID:null,n=this.props.comment&&this.props.comment.author?this.props.comment.author.primaryImageID:currentEmployee.primaryImageID,i=0===this.state.fileUploads.length&&this.isOnLine()&&0===this.state.videosProcessing.length&&this.props.comment&&this.props.comment.commentID&&this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saving;return c.default.createElement("div",{className:(0,p.default)("ka_streamSubBox ka_streamNewComment",this.props.isCommenting?null:"closed"),onClick:this.newCommentClicked},c.default.createElement("div",{style:{float:"left"}},c.default.createElement("img",{className:"imgSubjectImage ka_circular",src:m.default.getImageURL("Employee",n,50,50),style:{width:50}})),c.default.createElement("div",{className:"ka_newCommentWrapper"},this.props.isCommenting?c.default.createElement(v.default,{ref:function(t){return e.editor=t},placeholder:this.props.comment&&!this.props.comment.isDraft?"Update this comment...":"Add a comment...",onStartEditing:function(){return e.setIsCommenting(!0,t)},onStopEditing:function(){return e.setIsCommenting(!1,t)},style:{},handleCancel:this.cancelHandler,disableX:!this.isOnLine(),readOnly:!this.isOnLine(),editorState:this.state.editorState,onChange:this.onEditorChange,className:this.props.isCommenting?"open":null,isEditing:this.props.isCommenting,onEditLink:this.onEditLink,imageSize:{width:_.INT_COMMENT_IMAGE_WIDTH,height:_.INT_COMMENT_IMAGE_HEIGHT},uploadProps:{getToken:m.default.getToken,getUploadHeader:function(){return{Authorization:"Bearer "+m.default.getToken()}},onUploadStart:this.onUploadStart,onUploadEnd:this.onUploadEnd,videoProcessingStarted:function(t){return e.setState({videosProcessing:e.state.videosProcessing.concat(t)})},videoProcessingEnded:function(t){return e.setState({videosProcessing:e.state.videosProcessing.filter(function(e){return e!==t})})}}}):c.default.createElement(w.default,{isOnLine:this.isOnLine(),onOpen:function(){e.setIsCommenting(!0,t),window.setTimeout(function(){return e.editor.focus()},0)}})),this.props.isCommenting&&c.default.createElement("div",{className:"ka_commentFooter"},c.default.createElement(g.default,{editorState:this.state.editorState,onToggleInlineStyle:function(t){e.onEditorChange(M.RichUtils.toggleInlineStyle(e.state.editorState,t)),e.setState({draftIsDirty:!0})},onToggleBlockType:function(t){e.onEditorChange(M.RichUtils.toggleBlockType(e.state.editorState,t)),e.setState({draftIsDirty:!0}),window.setTimeout(function(){return e.editor.focus()},0)},readOnly:!this.isOnLine(),onImageAttach:function(t){return e.editor.onSelectFiles(e.state.editorState.getSelection(),t)},onVideoAttach:function(t){return e.editor.onSelectFiles(e.state.editorState.getSelection(),t)},onDocumentAttach:function(t){return e.editor.onSelectFiles(e.state.editorState.getSelection(),t)},onEditLink:this.onEditLink,onBrowseSPDocuments:function(){return e.setState({isDocBrowserOpen:!0})},disableBlogging:!0}),c.default.createElement(y.default,{linkPeek:this.state.linkPeek,onEdit:this.onEditLink,onRemove:this.onRemoveLink,onClose:function(){return e.setState({linkPeek:null})}}),c.default.createElement("span",{className:"ka_draftStatusMsg",style:{marginTop:5}},m.default.draftSaveStatusText(this.props.comment?this.props.comment.draftSaveStatus:P.draftSaveStatuses.idle,this.state.draftIsDirty,this.isOnLine(),this.state.fileUploads.length>0)),c.default.createElement("span",{className:(0,p.default)("ka_button","ka_buttonActive",i?null:"disabled"),style:{display:"inline-block",marginTop:5},onClick:i?this.submitClicked:void 0},this.state.submitAfterFileUpload?"Loading...":this.props.comment&&!this.props.comment.isDraft?"Update":"Comment")),this.state.isLinkDialogOpen&&this.renderLinkDialog(),this.state.isDocBrowserOpen&&c.default.createElement(D.default,{onChooseFile:function(t){e.editor.insertAtomicBlock((0,h.adjustTargetBasedOnCursor)(e.state.editorState.getSelection(),e.state.editorState.getCurrentContent()),t,t.collectionType,null,!0),e.setState({isDocBrowserOpen:!1,draftIsDirty:!0})},onClose:function(){return e.setState({isDocBrowserOpen:!1})}}),this.state.alert&&c.default.createElement(b.default,{onClose:function(){return e.setState({alert:null})},title:this.state.alert.title,message:this.state.alert.message}),this.state.showUploadFailures&&c.default.createElement(I.default,{onClose:function(){return e.setState({showUploadFailures:!1,fileUploadFailures:[],videoUploadFailures:[]})},fileAlerts:{fileUploadFailures:this.state.fileUploadFailures,videoUploadFailures:this.state.videoUploadFailures}}),-1!==this.state.confirmCloseComment&&c.default.createElement(T.default,{title:"Delete Comment",message:"Are you sure you want to delete this comment?",onClose:function(){return e.setState({confirmCloseComment:-1})},optionArray:[(0,S.dialogOption)("Cancel",function(){return e.setState({confirmCloseComment:-1})}),(0,S.dialogOption)("Delete Comment",function(){e.props.removeComment(t),e.editor.onCancel()},!1,!0)]}))}},{key:"renderLinkDialog",value:function(){var e=this,t=(0,h.selectLink)(this.state.editorState);return c.default.createElement(C.default,{text:(0,h.getTextSelection)(t," "),url:(0,h.getSelectedLinkUrl)(t),onCreate:function(n,i){e.onEditorChange((0,h.insertLink)(t,n,i)),e.setState({isLinkDialogOpen:!1,draftIsDirty:!0}),window.setTimeout(function(){return e.editor.focus()},0)},onClose:function(){e.setState({isLinkDialogOpen:!1}),window.setTimeout(function(){return e.editor.focus()},0)}})}},{key:"submitClicked",value:function(e){var t=this;if(void 0!==this.props.comment.commentID&&this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saving&&!(this.state.videosProcessing.length>0))try{if(this.state.fileUploads.length>0)this.setState({submitAfterFileUpload:!0});else if(!this.props.isAddingComment)if(this.editor.hasText()){var n=this.editor.getTags(),o=(n||[]).filter(function(e){return null==e.hashtag}),r=(n||[]).filter(function(e){return null!=e.hashtag}),a=this.editor.getJson();this.props.comment&&(0,h.populateMissingCollectionIDsInContent)(a,this.props.comment.subitems);var s=d.default.findDOMNode(this).parentElement;this.cancelDraftSaveTimer(),m.default.compensateScrollPosition(d.default.findDOMNode(this.editor),function(){var e=s.querySelectorAll(".ka_streamComment");return e[e.length-1]},function(){return t.props.submitItemComment((0,i.default)({},t.props.comment,{itemID:t.props.itemID,jsonContent:a,draftJsContent:(0,h.removeDataUrlsFromRawContent)((0,M.convertToRaw)(t.state.editorState.getCurrentContent())),mentions:o,hashtags:r}),t.state.editorState)}),this.setState({submitAfterFileUpload:!1}),this.editor.onCancel()}else this.setState({alert:E.ALERT_MISSING_COMMENT})}catch(e){(0,A.logError)(e),this.props.setActionError(e)}}},{key:"componentWillReceiveProps",value:function(e){null!=e.restoreCommentEditorState&&null==this.props.restoreCommentEditorState?this.setState({editorState:e.restoreCommentEditorState}):this.props.comment&&this.props.comment.isDraft&&this.props.isOnLine&&!e.isOnLine&&(e.comment&&e.comment.draftJsContent?this.setState({editorState:N(e.comment,e.itemAuthor,e.mentions,e.hashtags,this.onLinkPeek)}):this.setState({editorState:(0,h.newEditorState)(this.onLinkPeek)}))}},{key:"onEditorChange",value:function(e){this.props.comment&&!this.props.comment.isDraft||this.state.draftIsDirty||!(0,h.didTextChange)(this.state.editorState,e)&&e.getCurrentContent().getBlocksAsArray().filter(function(e){return"atomic"===e.getType()}).length===this.state.editorState.getCurrentContent().getBlocksAsArray().filter(function(e){return"atomic"===e.getType()}).length||this.setState({draftIsDirty:!0}),this.setState({editorState:e})}},{key:"setupDraftSaveTimer",value:function(){var e=this;this.setState({draftIsDirty:!1}),this.draftSaveTimer=window.setInterval(function(){e.state.draftIsDirty&&e.submitDraft()},3e3)}},{key:"cancelDraftSaveTimer",value:function(){window.clearInterval(this.draftSaveTimer),delete this.draftSaveTimer}},{key:"submitDraft",value:function(){if(this.props.isCommenting){if(this.props.comment.draftSaveStatus!==P.draftSaveStatuses.saving){var e=this.editor.getTags(),t=(e||[]).filter(function(e){return null==e.hashtag}),n=(e||[]).filter(function(e){return null!=e.hashtag}),o=this.editor.getJson();this.props.comment&&(0,h.populateMissingCollectionIDsInContent)(o,this.props.comment.subitems),this.props.submitCommentDraft((0,i.default)({},this.props.comment,{jsonContent:o,draftJsContent:(0,h.removeDataUrlsFromRawContent)((0,h.removeBrokenAtomicBlocksFromRawContent)((0,M.convertToRaw)(this.state.editorState.getCurrentContent()))),mentions:t,hashtags:n})),this.setState({draftIsDirty:!1})}}else this.cancelDraftSaveTimer()}}]),t}(u.Component),N=function(e,t,n,i,o){var r=void 0;return e.draftJsContent?("string"==typeof e.draftJsContent&&(e.draftJsContent=JSON.parse(e.draftJsContent)),r=(0,M.convertFromRaw)(e.draftJsContent)):e.jsonContent?r=(0,h.jsonContentToContentState)(e.jsonContent,t,n,i,e.subitems):(e.formattedContent||e.subitems)&&(r=R((0,h.formattedContentToContentState)(e.formattedContent,t,n,i),e.subitems)),M.EditorState.createWithContent(r,(0,h.getDecorator)(o))},R=function(e,t){return t&&t.forEach(function(t){e.createEntity("StreamCollection","IMMUTABLE",{collection:t});var n=M.EditorState.createWithContent(e);n=M.EditorState.moveSelectionToEnd(n),n=M.AtomicBlockUtils.insertAtomicBlock(n,e.getLastCreatedEntityKey()," "),e=n.getCurrentContent()}),e};O.propTypes={isCommenting:f.default.bool,isAddingComment:f.default.bool,restoreCommentEditorState:f.default.object,setIsCommenting:f.default.func.isRequired,submitItemComment:f.default.func.isRequired,setActionError:f.default.func.isRequired},t.default=O},547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(177),r=(i=o)&&i.__esModule?i:{default:i},a=n(223);t.default=function(e){var t=e.contentState,n=e.entityKey,i=e.children,o=e.onLinkPeek,s=t.getEntity(n).getData(),l=s.url,u=s.target,c=(s.title,s.text);return r.default.createElement("a",{className:"ka_statusupdate_link",target:u||"_blank",href:l,spellCheck:!1,onClick:function(e){o({position:(0,a.getLinkPeekPos)(e.target),text:c,url:l}),e.stopPropagation()}},i)}},548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),o=r(n(179));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.contentState.getEntity(e.entityKey).getData(),n=t.entityID,r=t.entityType,a=t.hashtag,s=(t.entityName,t.hasProfile),l=void 0===s||s,u=t.isOpportunity,c=void 0!==u&&u;return l?i.default.createElement("a",{className:"ka_inlineTag",target:"_blank",spellCheck:!1,href:o.default.getResourceUrl(r||"Hashtag",n||a,c)},e.children):i.default.createElement("span",null,e.children)}},549:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendingHashtag=void 0;var i,o=n(177),r=(i=o)&&i.__esModule?i:{default:i};t.PendingHashtag=function(e){return r.default.createElement("a",{className:"ka_hashtag_link",spellCheck:!1},e.children)}},550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),o=f(n(182)),r=f(n(183)),a=f(n(184)),s=f(n(185)),l=n(177),u=f(l),c=n(179),d=f(c);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={hovered:!1},n.onToggle=function(e){e.preventDefault(),n.props.onToggle(n.props.style)},n.onMouseOver=function(e){return n.setState({hovered:!0})},n.onMouseOut=function(e){return n.setState({hovered:!1})},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t="KAEditor-control KAEditor-styleButton";if(this.state.active&&(t+=" KAEditor-activeButton"),this.props.disabled&&(t+=" disabled"),this.props.icon){var n=this.props.shortcut?d.default.forOS(" (Ctrl+"+this.props.shortcut+")","(⌘"+this.props.shortcut+")"):"";return u.default.createElement("img",{src:""+c.imgRoot+this.props.icon+(this.props.disabled||!this.state.hovered&&!this.props.active?"":"_cyan")+".svg",className:t,onMouseDown:this.props.disabled?void 0:function(t){return 0===t.button?e.onToggle(t):t.preventDefault()},onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,title:this.props.tooltip+n})}return u.default.createElement("span",{className:t,onMouseDown:this.props.disabled?void 0:this.onToggle,title:this.props.tooltip},this.props.label)}}]),t}(l.Component);t.default=p},551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=H(n(206)),o=H(n(186)),r=H(n(222)),a=H(n(181)),s=H(n(182)),l=H(n(183)),u=H(n(184)),c=H(n(185)),d=n(177),f=H(d),p=H(n(187)),m=H(n(180));n(664),n(665),n(102),n(666);var h=n(220),g=H(n(272)),y=H(n(323)),v=n(667),E=H(n(327)),k=n(179),_=H(k),b=H(n(244)),I=H(n(191)),C=n(282),S=H(n(287)),T=H(n(286)),D=H(n(245)),w=H(n(246)),M=H(n(242)),P=n(211),A=H(n(204)),L=n(223),O=H(n(553)),N=H(n(554)),R=H(n(555)),x=H(n(556)),U=H(n(232)),B=H(n(328)),F=n(209),j=n(189);function H(e){return e&&e.__esModule?e:{default:e}}if(n(216)(I.default),n(668),null==W)var W=n(179).static_images;null==window.blogOptions&&(window.blogOptions={enableBlogging:!1});var V=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={isEditing:"boolean"==typeof e.isEditing&&e.isEditing,taggingFocused:!1,files:[],readOnly:!1},n.focus=n.focus.bind(n),n.blur=n.blur.bind(n),n.onChange=n.onChange.bind(n),n.onCancel=n.onCancel.bind(n),n.cancelClickHandler=n.cancelClickHandler.bind(n),n.clearSearch=n.clearSearch.bind(n),n.onAddTag=n.onAddTag.bind(n),n.onSearching=n.onSearching.bind(n),n.onSearched=n.onSearched.bind(n),n.handleReturn=n.handleReturn.bind(n),n.handleKeyCommand=n.handleKeyCommand.bind(n),n.onTab=n.onTab.bind(n),n.handleFiles=n.handleFiles.bind(n),n.onDrop=n.onDrop.bind(n),n.onDragOver=n.onDragOver.bind(n),n.onDragEnter=n.onDragEnter.bind(n),n.onDragLeave=n.onDragLeave.bind(n),n.handlePastedText=n.handlePastedText.bind(n),n.handlePastedFiles=n.handlePastedFiles.bind(n),n.swapPendingForCollection_image=n.swapPendingForCollection_image.bind(n),n.swapPendingForCollection=n.swapPendingForCollection.bind(n),n.removeBlock=n.removeBlock.bind(n),n.getBlockRenderer=n.getBlockRenderer.bind(n),n.onSelectFiles=n.onSelectFiles.bind(n),n.handleBeforeInput=n.handleBeforeInput.bind(n),n.checkPrecedingUrl=n.checkPrecedingUrl.bind(n),n.dragCounter=0,n.blockRenderMap=h.DefaultDraftBlockRenderMap.set("unordered-list-item",{element:"li",wrapper:f.default.createElement(re,null)}).set("ordered-list-item",{element:"li",wrapper:f.default.createElement(ae,null)}),n}return(0,c.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){if(A.default.msie){var e=p.default.findDOMNode(this.editor).getElementsByClassName("public-DraftEditor-content")[0];e.spellcheck=!0,e.addEventListener("DOMCharacterDataModified",function(e){if(!(e.newValue.length-e.prevValue.length<1)){var t=document.createEvent("Event");t.initEvent("input",e.bubbles,e.cancelable),t.data=e.data,t.inputMethod=e.inputMethod,e.target.parentNode.dispatchEvent(t)}})}}},{key:"focus",value:function(){this.editor.focus()}},{key:"blur",value:function(){this.editor.blur()}},{key:"kaKeyBindingFn",value:function(e){return 75===e.keyCode&&h.KeyBindingUtil.hasCommandModifier(e)?"kaeditor-link":(0,h.getDefaultKeyBinding)(e)}},{key:"handleKeyCommand",value:function(e){var t=this;if("kaeditor-link"===e)return!this.props.disableRichText&&this.props.onEditLink&&this.props.onEditLink(),"handled";if(!this.props.disableRichText){var n=this.props.editorState,i=n.getSelection(),o=n.getCurrentContent(),a=o.getBlockForKey(i.getAnchorKey());if("split-block"===e&&"atomic"===a.getType()){var s=o.getBlockMap(),l=s.toSeq().takeUntil(function(e){return e===a}).toArray(),u=s.toSeq().skipUntil(function(e){return e===a}).rest().toArray(),c=new h.ContentBlock({key:(0,h.genKey)()}),d=[].concat((0,r.default)(l),[c,a],(0,r.default)(u));return this.onChange(h.EditorState.push(n,h.ContentState.createFromBlockArray(d).set("selectionBefore",o.getSelectionBefore()).set("selectionAfter",h.SelectionState.createEmpty(c.getKey())))),"handled"}if(("backspace"===e||"delete"===e)&&i.isCollapsed()&&"atomic"===a.getType()){var f=void 0;if("backspace"===e){var p=o.getBlockBefore(i.getAnchorKey());p&&(f=new h.SelectionState({anchorKey:p.getKey(),anchorOffset:p.getCharacterList().size,focusKey:p.getKey(),focusOffset:p.getCharacterList().size}))}else if("delete"===e){var m=o.getBlockAfter(i.getAnchorKey());m&&(f=new h.SelectionState({anchorKey:m.getKey(),anchorOffset:0,focusKey:m.getKey(),focusOffset:0}))}var g=z(a,n);Y(a,n);return g&&"Video"===g?this.setState({confirmRemoveVideo:function(){return t.removeAtomicBlock(n,a,f)}}):this.removeAtomicBlock(n,a,f),"handled"}if("backspace"===e&&i.isCollapsed()&&0===i.getAnchorOffset()){var y=o.getBlockBefore(i.getAnchorKey());if(null!=y&&"atomic"===y.getType())return 0===a.getCharacterList().size&&null!=o.getBlockAfter(i.getAnchorKey())&&(n=he(n,i.getAnchorKey())),this.onChange(ge(n,y.getKey())),"handled"}else if("delete"===e&&i.isCollapsed()&&i.getAnchorOffset()===a.getCharacterList().size){var v=o.getBlockAfter(i.getAnchorKey());if(null!=v&&"atomic"===v.getType())return 0===a.getCharacterList().size?(this.onChange(he(n,i.getAnchorKey(),h.SelectionState.createEmpty(v.getKey()))),window.setTimeout(function(){return t.selectBlock(v.getKey())},150)):this.selectBlock(v.getKey()),"handled"}var E=h.RichUtils.handleKeyCommand(n,e);if(E)return this.onChange(E),"handled"}return"not-handled"}},{key:"removeAtomicBlock",value:function(e,t,n,i){e=he(this.props.editorState,t.getKey(),n,i),n&&(e=h.EditorState.acceptSelection(e,n)),this.onChange(e)}},{key:"onTab",value:function(e){"handled"!==this.wrapper.onTab(e)&&this.onChange(h.RichUtils.onTab(e,this.props.editorState,4))}},{key:"onChange",value:function(e){var t=this,n=e.getCurrentContent();if(this.props.deleteTag){var i=this.getTags();if(null!=i&&i.length>0){var o=X(n),r=null==o?i[0]:i.find(function(e){return!_.default.tagsContains(o,e)});null!=r&&this.props.deleteTag(r)}}var a=e.getSelection(),s=n.hasText()||a.getHasFocus();if(this.state.isEditing||!s||this.props.readOnly||(this.setState({isEditing:s}),this.props.onStartEditing&&this.props.onStartEditing()),"atomic"!==n.getBlockForKey(a.getAnchorKey()).getType()&&"atomic"===this.props.editorState.getCurrentContent().getBlockForKey(this.props.editorState.getSelection().getAnchorKey()).getType()&&(e=h.EditorState.forceSelection(e,a)),this.props.onChange(e),this.state.taggingFocused||this.setState({suggestions:null,suggestionsFor:null}),this.clearTypeTimer(),a.getHasFocus()&&a.isCollapsed()){var l=ue(e),u=(l||"").trim();if(_.default.validateSearchText(u)){var c=window.setTimeout(function(){return _.default.runTagSearch(u,l,t.onSearching,t.onSearched)},500);this.setState({timer:c,suggestions:null,suggestionsFor:l})}else this.setState({searchingFor:null,suggestions:null,suggestionsFor:null})}else this.clearTypeTimer(),this.setState({searchingFor:null})}},{key:"clearTypeTimer",value:function(){null!=this.state.timer&&(window.clearTimeout(this.state.timer),this.setState({timer:null}))}},{key:"cancelClickHandler",value:function(){this.props.handleCancel&&this.props.handleCancel()||this.props.disableX||this.onCancel()}},{key:"onCancel",value:function(){this.onChange(h.EditorState.push(this.props.editorState,h.ContentState.createFromText(""))),this.setState({isEditing:!1}),this.props.onStopEditing&&this.props.onStopEditing()}},{key:"hasText",value:function(){return this.props.editorState.getCurrentContent().hasText()}},{key:"getText",value:function(){var e=this.props.editorState.getCurrentContent().getPlainText().trim();return""!==e?e:null}},{key:"getEntitizedText",value:function(){var e=ce(this.props.editorState.getCurrentContent()).getPlainText().trim();return""!==e?e:null}},{key:"getHtml",value:function(){return null!==this.getText()?te(this.props.editorState):null}},{key:"getJson",value:function(){var e=this.props.editorState.getCurrentContent(),t=e.getBlocksAsArray();if(t.length>0){for(;t.length>0&&""===t[0].getText().trim()&&"atomic"!==t[0].getType();)t.splice(0,1);for(;t.length>0&&""===t[t.length-1].getText().trim()&&"atomic"!==t[t.length-1].getType();)t.splice(t.length-1,1);for(var n=[];t.length>0;){for(var i=t.splice(0,1),o=i[0].getType();t.length>0&&-1!=ee.indexOf(o)&&t[0].getType()===o;)i.push(t.shift());i.length>1?n.push($(i,e)):n.push(J(i[0],e))}return n}return null}},{key:"getRaw",value:function(){return(0,h.convertToRaw)(this.props.editorState.getCurrentContent())}},{key:"getTags",value:function(){return X(this.props.editorState.getCurrentContent())}},{key:"restoreEditorState",value:function(e){this.onChange(e)}},{key:"onSearching",value:function(e,t){this.setState({searchingFor:e,suggestionsFor:t})}},{key:"onSearched",value:function(e,t){this.setState({suggestions:e,suggestionsFor:t,selectedSuggestion:0})}},{key:"clearSearch",value:function(){this.setState({searchingFor:null,suggestions:null,suggestionsFor:null})}},{key:"selectBlock",value:function(e,t){this.onChange(ge(this.props.editorState,e))}},{key:"handlePastedText",value:function(e,t){var n=this,i=this.props.editorState;if(!this.props.disableRichText&&e&&this.props.onEditLink){if(e=e.trim(),P.RE_VID_URL_ONLY.test(e)){var o=P.RE_VID_URL_ONLY.exec(e),r=o[1],a=o[2];a&&(a=parseInt(a));var s=i.getCurrentContent();s.createEntity("StreamCollection","IMMUTABLE",{collectionType:"Video",collection:{collectionType:"Video",collectionMembers:[{memberType:"Video",mediaID:r,memberData:a?{startTime:a}:void 0}]}});var l=s.getLastCreatedEntityKey(),u=h.AtomicBlockUtils.insertAtomicBlock(i,l," ");return this.onChange(h.EditorState.push(i,u.getCurrentContent(),"insert-fragment")),"handled"}if(P.RE_GIPHY_DIRECT.test(e)){var c=e.substring(0,e.lastIndexOf("/"));return c=c.substring(c.lastIndexOf("/")+1),I.default.get(e).responseType("blob").then(function(e){return n.handlePastedFiles([q(e,c)])}).catch(function(e){return(0,j.logError)(e)}),"handled"}if(P.RE_GIPHY_PAGE.test(e)){var d=e.lastIndexOf("-")>-1?e.substring(e.lastIndexOf("-")+1):e.substring(e.lastIndexOf("/")+1),f="https://media.giphy.com/media/"+d+"/giphy.gif";return I.default.get(f).responseType("blob").then(function(e){return n.handlePastedFiles([q(e,d)])}).catch(function(e){return(0,j.logError)(e)}),"handled"}if(P.RE_GIPHY_SHORT.test(e))return I.default.get("https://api-ssl.bitly.com/v3/expand").query({access_token:"e068abf43b0aae088864a8fb067601f71d9a6c4d",shortUrl:e}).then(function(e){var t=e.body.data.expand[0].long_url,i=t.lastIndexOf("-")>-1?t.substring(t.lastIndexOf("-")+1):t.substring(t.lastIndexOf("/")+1),o="https://media.giphy.com/media/"+i+"/giphy.gif";I.default.get(o).responseType("blob").then(function(e){return n.handlePastedFiles([q(e,i)])}).catch(function(e){return(0,j.logError)(e)})}).catch(function(e){return(0,j.logError)(e)}),"handled";if(P.RE_URL_ONLY.test(e)){this.props.uploadProps.onUploadStart({name:e});var p=i.getCurrentContent();p.createEntity("StreamCollection","IMMUTABLE",{url:e,collectionType:"Link"});var m=p.getLastCreatedEntityKey(),g=h.AtomicBlockUtils.insertAtomicBlock(i,m," ");return this.onChange(h.EditorState.push(i,g.getCurrentContent(),"insert-fragment")),"handled"}P.RE_URL_ANYWHERE.test(e)&&this.linkifyURLsAfterPaste()}return this.props.maxChars&&i.getCurrentContent().getPlainText().length+e.length>this.props.maxChars?(this.setState({alert:this.props.maxCharsAlert}),"handled"):"not-handled"}},{key:"handlePastedFiles",value:function(e){return this.handleFiles((0,L.adjustTargetBasedOnCursor)(this.props.editorState.getSelection(),this.props.editorState.getCurrentContent()),e),"handled"}},{key:"onSelectFiles",value:function(e,t){this.handleFiles((0,L.adjustTargetBasedOnCursor)(e,this.props.editorState.getCurrentContent()),t)}},{key:"handleFiles",value:function(e,t){var n=this;if(this.props.uploadProps){var i=t.filter(function(e){return e.type.match("image.*")}),o=[];i.forEach(function(e){o.push(e)}),o.length>0?o.forEach(function(i){n.loadImageData(i,function(){null==o.find(function(e){return void 0===e.dataUrl})&&n.insertFiles(e,t)})}):this.insertFiles(e,t)}}},{key:"insertFiles",value:function(e,t){var n=this,i={imagesTooLarge:[],docsTooLarge:[],filesBlocked:[],videosTooLarge:[]};t.forEach(function(t,r){t.type.match("image.*")&&"image/svg+xml"!==t.type&&"image/webp"!==t.type?t.size>F.INT_MAX_IMAGE_SIZE?i.imagesTooLarge.push(t):window.setTimeout(function(){n.insertAtomicBlock(e,null,"Image",[(0,o.default)(t,{index:0,status:b.default.PENDING,percent:0,src:null})],0===r)},0):t.type.match("video.*")?t.size>F.INT_MAX_VIDEO_SIZE?i.videosTooLarge.push(t):window.setTimeout(function(){n.insertAtomicBlock(e,null,"Video",[(0,o.default)(K(t),{index:0,status:b.default.PENDING,percent:0,fileObjectUrl:URL.createObjectURL(t)})],0===r)},0):t.size>262144e3?i.docsTooLarge.push(t):-1!==k.fileBlackList.indexOf(P.RE_FILE_EXTENSION.exec(t.name)[1])?i.filesBlocked.push(t):window.setTimeout(function(){n.insertAtomicBlock(e,null,"Document",[(0,o.default)(t,{index:0,status:b.default.PENDING,percent:0})],0===r)},0)}),(i.filesBlocked.length>0||i.docsTooLarge.length>0||i.imagesTooLarge.length>0||i.videosTooLarge.length>0)&&this.setState({fileAlerts:i})}},{key:"onDrop",value:function(e){var t=this;this.dragCounter=0,this.setState({dragOver:!1,dragOverEmpty:!1});var n=this.getBlockKeyForEvent(e);if(e.dataTransfer.files&&e.dataTransfer.files.length>0){for(var i=[],o=0;o<e.dataTransfer.files.length;o++)i.push(e.dataTransfer.files[o]);var r=n?new h.SelectionState({anchorKey:n,anchorOffset:0,focusKey:n,focusOffset:0}):null;this.handleFiles(r,i),e.preventDefault()}else{var a=e.dataTransfer.getData("Text");if(a&&a.length>10&&"kasubitem|"===a.substring(0,10)){var s=a.slice(10),l=this.props.editorState.getCurrentContent();if("atomic"===l.getBlockForKey(s).getType()){e.preventDefault();var u=(l=(0,h.convertFromRaw)((0,h.convertToRaw)(l))).getBlocksAsArray(),c=u.map(function(e){return e.getKey()}),d=c.indexOf(s),f=n?c.indexOf(n):u.length;d<f&&f--,"atomic"===(u=_.default.moveArrayElement(u,d,f))[u.length-1].getType()&&u.push(new h.ContentBlock({key:(0,h.genKey)()})),l=h.ContentState.createFromBlockArray(u,l.getEntityMap()),A.default.chrome&&null!=p.default.findDOMNode(this.editor).querySelector("iframe")?window.setTimeout(function(){t.onChange(ge(h.EditorState.push(t.props.editorState,l,"insert-fragment"),s))},100):this.onChange(ge(h.EditorState.push(this.props.editorState,l,"insert-fragment"),s))}}}this.setState({dragOver:!1})}},{key:"getBlockKeyForEvent",value:function(e){return-1===e.target.className.indexOf("public-DraftEditor-content")?g.default.decode((0,y.default)(e.target)).blockKey:null}},{key:"onDragOver",value:function(e){(window.draggingSubitem||(0,L.containsFiles)(e))&&e.preventDefault()}},{key:"onDragEnter",value:function(e){if(window.draggingSubitem||(0,L.containsFiles)(e)){e.preventDefault(),this.setState({dragOver:!0}),this.dragCounter++;var t=p.default.findDOMNode(this).querySelector(".ka_subitem.selected");t&&t.classList.remove("selected"),e.target.classList.contains("public-DraftEditor-content")&&this.setState({dragOverEmpty:!0})}}},{key:"onDragLeave",value:function(e){(window.draggingSubitem||(0,L.containsFiles)(e))&&(this.dragCounter--,e.target.classList.contains("public-DraftEditor-content")&&this.setState({dragOverEmpty:!1})),0===this.dragCounter&&this.setState({dragOver:!1})}},{key:"loadImageData",value:function(e,t){var n=new FileReader;n.onload=function(){(0,C.processDataUrl)(n.result,function(n){e.dataUrl=n,t()})},n.readAsDataURL(e)}},{key:"insertAtomicBlock",value:function(e,t,n,i,o){var r=G(this.props.editorState,e,o),a=r.getCurrentContent();a.createEntity("StreamCollection","IMMUTABLE",{collection:t,collectionType:n,files:i});var s=a.getLastCreatedEntityKey();r=h.AtomicBlockUtils.insertAtomicBlock(r,s," "),this.onChange(r)}},{key:"swapPendingForCollection_image",value:function(e,t,n){var i=this.props.editorState,r=i.getCurrentContent(),a=r.getEntity(e);null!=a.getData().collection&&(n=_.default.getMostRecent(a.getData().collection,returnedCollection));var s=a.getData().files[t].dataUrl;n.collectionMembers[0].mediaList=n.collectionMembers[0].mediaList.map(function(e){return e.sortOrder===t+1?(0,o.default)(e,{dataUrl:s}):e});var l=r.mergeEntityData(e,{collection:n,files:a.getData().files.filter(function(e){return e.index!=t})}),u=h.EditorState.push(i,l,"insert-fragment");u=h.EditorState.forceSelection(u,u.getSelection()),this.onChange(u)}},{key:"swapPendingForCollection",value:function(e,t,n){var i=this.props.editorState,o=i.getCurrentContent().mergeEntityData(e,{files:void 0,collectionType:void 0,collection:n}),r=h.EditorState.push(i,o,"insert-fragment");r=h.EditorState.forceSelection(r,r.getSelection()),this.onChange(r)}},{key:"removeBlock",value:function(e){this.onChange(he(this.props.editorState,e,null))}},{key:"onAddTag",value:function(e){var t=this;this.clearSearch();var n=this.props.editorState,i=n.getCurrentContent(),o=(i=i.createEntity("TAG","IMMUTABLE",e)).getLastCreatedEntityKey(),r=this.props.editorState.getSelection().getFocusOffset()-ue(this.props.editorState).length;i=h.Modifier.replaceText(i,n.getSelection().set("anchorOffset",r),e.entityName||e.hashtag,null,o),n=h.EditorState.push(this.props.editorState,i,"apply-entity"),this.onChange(n),this.props.addTag&&this.props.addTag(e),window.setTimeout(function(){if(document.getElementById("s4-workspace")){var e=document.getElementById("s4-workspace").scrollTop;t.editor.focus(),document.getElementById("s4-workspace").scrollTop=e}else{var n=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;t.editor.focus(),window.scrollTo(i,n)}},10)}},{key:"getBlockRenderer",value:function(e){var t=this;if("atomic"===e.getType()&&e.getCharacterList().count()>0){var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null==n)return console.warn("Atomic block without an entity"),"undefined"!=typeof newrelic&&newrelic.noticeError(new Error("Atomic block without an entity,"+clientID)),null;var i=n.getEntity(),r=this.props.editorState.getCurrentContent().getEntity(i);if("StreamCollection"===r.getType()){var a=r.getData(),s=this.props.editorState.getSelection().getAnchorKey()===e.getKey(),l=a.collectionType||a.collection.collectionType,u={collection:a.collection,onClick:function(n){return t.selectBlock(e.getKey())},isSelected:s};switch(l){case"Image":return{component:N.default,editable:!1,props:(0,o.default)(u,{handleClick:function(n,i){return t.selectBlock(e.getKey(),i),!0},files:a.files,collectionType:l,entityKey:i,uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection_image,removeBlock:function(){return t.removeBlock(e.getKey())},imageSize:this.props.imageSize})};case"Link":return{component:se,editable:!1,props:(0,o.default)(u,{selectedImageIndex:a.selectedImageIndex,onImageChange:function(e){t.props.editorState.getCurrentContent().mergeEntityData(i,{selectedImageIndex:e}),t.onChange(h.EditorState.forceSelection(t.props.editorState,t.props.editorState.getSelection()))},uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection,url:a.url,entityKey:i})};case"oEmbedContent":return{component:le,editable:!1,props:u};case"Document":return a.files&&a.files.length>0&&null==a.files[0].name?null:{component:O.default,editable:!1,props:(0,o.default)(u,{files:a.files,collectionType:l,entityKey:i,uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection,removeBlock:function(){return t.removeBlock(e.getKey())}})};case"Video":return{component:R.default,editable:!1,props:(0,o.default)(u,{files:a.files,collectionType:l,entityKey:i,uploadProps:this.props.uploadProps,swapPendingForCollection:this.swapPendingForCollection,removeBlock:function(){return t.removeBlock(e.getKey())},requestInputControl:function(){return t.setState({readOnly:!0})},releaseInputControl:function(){return t.setState({readOnly:!1})}})}}}}if("unordered-list-item"!==e.getType()&&"ordered-list-item"!==e.getType()&&!this.props.disableRichText)return{component:B.default}}},{key:"handleBeforeInput",value:function(e){var t=this.props.editorState;return"atomic"===t.getCurrentContent().getBlockForKey(t.getSelection().getAnchorKey()).getType()?"handled":this.props.maxChars&&t.getCurrentContent().getPlainText().length>=this.props.maxChars?(this.setState({alert:this.props.maxCharsAlert}),"handled"):(" "===e&&this.props.onEditLink&&this.checkPrecedingUrl(),"not-handled")}},{key:"handleReturn",value:function(e){return"handled"===this.wrapper.handleReturn(e)?"handled":(this.props.onEditLink&&this.checkPrecedingUrl(),this.props.disableLineBreaks?"handled":"not-handled")}},{key:"linkifyURLsAfterPaste",value:function(){var e=this;window.setTimeout(function(){return e.onChange(me(e.props.editorState,e.props.editorState.getSelection()))},0)}},{key:"checkPrecedingUrl",value:function(){var e=this,t=this.props.editorState.getSelection();fe(this.props.editorState.getCurrentContent(),t)&&window.setTimeout(function(){return e.onChange(pe(e.props.editorState,t,e.props.editorState.getSelection()))},0)}},{key:"render",value:function(){var e=this,t=this.props.editorState,n=("KAEditor-editor "+(this.props.className||"")).trim();this.state.dragOver&&(n+=" dragOver"),this.state.dragOverEmpty&&(n+=" dragOverEmpty"),this.props.disableRichText||(n+=" richText");var i=t.getCurrentContent();return i.hasText()||"unstyled"!==i.getBlockMap().first().getType()&&(n+=" KAEditor-hidePlaceholder"),f.default.createElement("div",null,f.default.createElement(E.default,{ref:function(t){return e.wrapper=t},mentions:this.props.mentions,hashtags:this.props.hashtags,suggestions:this.state.suggestions,searchingFor:this.state.searchingFor,suggestionsFor:this.state.suggestionsFor,onAddTag:this.onAddTag,clearSearch:this.clearSearch,onMouseDown:function(){return e.setState({taggingFocused:!0})},onMouseEnter:function(){return e.setState({taggingFocused:!0})},onMouseLeave:function(){return e.setState({taggingFocused:!1})}},f.default.createElement("div",{className:"KAEditor-root"+(this.props.readOnly?" readonly":""),style:this.props.style,onFocus:function(t){A.default.msie&&t.target.className.indexOf("KAEditor-root")>-1&&e.editor.focus()}},f.default.createElement("div",{className:n,onDrop:this.props.disableRichText||this.state.readOnly?void 0:this.onDrop,onDragOver:this.props.disableRichText||this.state.readOnly?function(e){return e.preventDefault()}:this.onDragOver,onDragEnter:this.props.disableRichText||this.state.readOnly?void 0:this.onDragEnter,onDragLeave:this.props.disableRichText||this.state.readOnly?void 0:this.onDragLeave},f.default.createElement(h.Editor,{ref:function(t){return e.editor=t},blockStyleFn:oe,blockRendererFn:this.getBlockRenderer,blockRenderMap:this.blockRenderMap,customStyleMap:ie,editorState:t,handleBeforeInput:this.handleBeforeInput,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.kaKeyBindingFn,onTab:this.onTab,stripPastedStyles:this.props.stripPastedStyles,onUpArrow:function(t){return e.wrapper.onUpArrow(t)},onDownArrow:function(t){return e.wrapper.onDownArrow(t)},onEscape:function(t){return e.wrapper.onEscape(t)},onBlur:this.props.onBlur,handleReturn:this.handleReturn,handleDroppedFiles:function(){return"handled"},handlePastedText:this.handlePastedText,handlePastedFiles:this.handlePastedFiles,onChange:this.onChange,placeholder:this.props.placeholder,readOnly:this.props.readOnly||this.state.readOnly,spellCheck:!0})),this.state.isEditing&&!this.props.hideX&&f.default.createElement("img",{title:"Cancel",className:"KAEditor-x",onClick:this.cancelClickHandler,src:W.cancel_11})),this.props.draftStatusMsg&&f.default.createElement("span",{className:"ka_draftStatusMsg"},this.props.draftStatusMsg)),this.state.alert&&f.default.createElement(D.default,{onClose:function(){return e.setState({alert:null})},title:this.state.alert.title,message:this.state.alert.message}),this.state.fileAlerts&&f.default.createElement(w.default,{onClose:function(){return e.setState({fileAlerts:null})},fileAlerts:this.state.fileAlerts}),this.state.confirmRemoveVideo&&f.default.createElement(M.default,{title:"Delete Video",message:"Are you sure you want to delete this video?",confirmText:"Delete",redConfirm:!0,onConfirm:function(){e.state.confirmRemoveVideo(),e.setState({confirmRemoveVideo:null})},onClose:function(){return e.setState({confirmRemoveVideo:null})}}))}}]),t}(d.Component),K=function(e){var t=/#|\?/gi;if(t.test(e.name)){var n=e.slice(0,e.size,e.type);return t.lastIndex=0,new File([n],e.name.replace(t,""),{type:e.type})}return e},q=function(e,t){if(void 0!==window.navigator.msSaveBlob){var n=new Blob([e.body],{type:e.type});return n.name=t+".gif",n}return new File([e.body],t+".gif",{type:e.type})},G=function(e,t,n){var i=n?t:e.getSelection(),o=e.getCurrentContent();if(i){var r=!0===i.getIsBackward()?i.anchorKey:i.focusKey,a=o.getKeyBefore(r);if(a)if(n){var s=o.getBlockForKey(a);i=new h.SelectionState({anchorKey:a,focusKey:a,anchorOffset:s.getCharacterList().size,focusOffset:s.getCharacterList().size})}else o.getBlockForKey(i.getAnchorKey()).getLength()>0&&(o=h.Modifier.splitBlock(o,i),e=h.EditorState.push(e,o,"split-block"));else i=new h.SelectionState({anchorKey:r,focusKey:r,anchorOffset:0,focusOffset:0})}else{var l=o.getLastBlock();i=new h.SelectionState({anchorKey:l.getKey(),anchorOffset:l.getCharacterList().size,focusKey:l.getKey(),focusOffset:l.getCharacterList().size})}return h.EditorState.acceptSelection(e,i)},z=function(e,t){var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null!=n){var i=n.getEntity(),o=t.getCurrentContent().getEntity(i);if("StreamCollection"===o.getType()){var r=o.getData();return r.collectionType||r.collection.collectionType}}},Y=function(e,t){var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null!=n){var i=n.getEntity(),o=t.getCurrentContent().getEntity(i);if("StreamCollection"===o.getType())if(null==o.getData().collection)return!0}return!1},X=function(e){var t=[];return e.getBlockMap().forEach(function(n){(0,L.findTagEntities)(n,function(i,o){t.push(e.getEntity(n.getEntityAt(i)).getData())},e)}),0==t.length?null:t},J=function(e,t){switch(e.getType()){case"atomic":var n=e.getCharacterList().find(function(e){return null!=e.getEntity()});if(null==n)return Q;var i=n.getEntity();if(null==i)return Q;var r=t.getEntity(i).getData(),a=r.collection,s=r.selectedImageIndex;if(!a)return Q;if("Link"===a.collectionType){var l=void 0;return a.collectionMembers[0].images&&a.collectionMembers[0].images.length>0&&null!=s&&-1!=s?l=[a.collectionMembers[0].images[s]]:a.collectionMembers[0].images&&a.collectionMembers[0].images.length>0&&null==s&&-1!=s&&(l=[a.collectionMembers[0].images[0]]),{type:a.collectionType,collectionID:a.collectionID,collection:(0,o.default)({},a,{collectionMembers:[(0,o.default)({},a.collectionMembers[0],{images:l,showEmbedLogo:l&&l.length>0&&l[0].isSPLogo})]})}}return"Image"===a.collectionType&&a.collectionMembers.forEach(function(e){return e.mediaList.forEach(function(e){return delete e.dataUrl})}),{type:a.collectionType,collectionID:a.collectionID,collection:a};default:var u=h.ContentState.createFromBlockArray([e]);return u=de(e,t,u),{type:e.getType(),html:te(h.EditorState.createWithContent(u,ne))}}},Q={type:"unstyled",html:"<div></div><br />"},$=function(e,t){var n=h.ContentState.createFromBlockArray(e);return e.forEach(function(e){return n=de(e,t,n)}),{type:Z(e[0].getType()),html:te(h.EditorState.createWithContent(n,ne))}},Z=function(e){switch(e){case"ordered-list-item":return"ordered-list";case"unordered-list-item":return"unordered-list";default:return e}},ee=["ordered-list-item","unordered-list-item"],te=function(e){return(0,v.stateToHTML)(ce(e.getCurrentContent()),{inlineStyles:ie}).replace(/\r?\n|\r/g,"").replace(/<p>/gi,"<div>").replace(/<\/p>/gi,"</div>").replace(/<br><\/div>/gi,"</div><br>").replace(/<br><\/h1>/gi,"</h1><br>").replace(/<br><\/h2>/gi,"</h2><br>")},ne=(0,L.getDecorator)(null),ie={};function oe(e){return e.getType(),null}var re=function(e){function t(){return(0,s.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){return f.default.createElement(B.default,null,f.default.createElement("ul",{className:"public-DraftStyleDefault-ul"},this.props.children))}}]),t}(d.Component),ae=function(e){function t(){return(0,s.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){return f.default.createElement(B.default,null,f.default.createElement("ol",{className:"public-DraftStyleDefault-ol"},this.props.children))}}]),t}(d.Component),se=function(e){var t=e.block,n=e.blockProps;return n.collection?f.default.createElement(U.default,{blockKey:t.getKey()},n.collection.collectionMembers.map(function(e,t){return f.default.createElement(S.default,(0,i.default)({link:e,isInEditor:!0},n,{key:t}))})):f.default.createElement(U.default,{blockKey:t.getKey()},f.default.createElement(x.default,n))},le=function(e){var t=e.block,n=e.blockProps,i=n.collection.collectionMembers,o=n.isSelected,r=n.onClick;return f.default.createElement(U.default,{blockKey:t.getKey()},f.default.createElement(T.default,{body:i[0].body,onClick:r,isSelected:o,isInEditor:!0}))},ue=function(e){var t=e.getSelection(),n=e.getCurrentContent().getBlockForKey(t.focusKey),i=t.getFocusOffset(),o=n.getText().substring(0,i),r=Math.max(o.lastIndexOf("@"),o.lastIndexOf("#"));if(-1===r)return null;if(0!==r&&" "!==o[r-1]&&" "!==o[r-1])return null;for(var a=o.substring(r),s=n.getCharacterList(),l=r;l<s.count()&&l<=i;l++)if(null!=s.get(l).getEntity())return null;return a},ce=function(e){var t=[];return e.getBlockMap().forEach(function(n){(0,L.findTagEntities)(n,function(i,r){t.push((0,o.default)({blockKey:n.getKey(),start:i,end:r},e.getEntity(n.getEntityAt(i)).getData()))},e)}),t.sort(function(e,t){return t.start-e.start}).forEach(function(t){var n=t.blockKey,i=t.start,o=t.end;e=h.Modifier.replaceText(e,new h.SelectionState({anchorKey:n,anchorOffset:i,focusKey:n,focusOffset:o}),"{"+(t.entityType||"Hashtag")+"|"+(t.entityID||t.hashtag)+"}")}),e},de=function(e,t,n){return e.findEntityRanges(function(e){return null!==e.getEntity()},function(i,o){var r=t.getEntity(e.getEntityAt(i)),a=(n=n.createEntity(r.getType(),r.getMutability(),r.getData())).getLastCreatedEntityKey();n=h.Modifier.applyEntity(n,new h.SelectionState({anchorKey:e.getKey(),anchorOffset:i,focusKey:e.getKey(),focusOffset:o}),a)}),n},fe=function(e,t){var n=e.getBlockForKey(t.getAnchorKey());if(!n.getEntityAt(t.getAnchorOffset())){var i=n.getText().substring(0,t.getAnchorOffset());if(P.RE_URL_END.test(i))return i.match(P.RE_URL_END)[0]}return null},pe=function(e,t,n){var i=e.getCurrentContent(),o=fe(i,t);return i=i.createEntity("LINK","IMMUTABLE",{text:o,href:o,url:o,target:"_blank"}),i=h.Modifier.applyEntity(i,new h.SelectionState({anchorKey:t.getAnchorKey(),anchorOffset:t.getAnchorOffset()-o.length,focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset()}),i.getLastCreatedEntityKey()),h.EditorState.acceptSelection(h.EditorState.push(e,i,"apply-entity"),n)},me=function(e,t){for(var n=e.getCurrentContent(),i=void 0,o=void 0;i=n.getBlockMap().find(function(e){for(P.RE_URL_EVERYWHERE.lastIndex=0;o=P.RE_URL_EVERYWHERE.exec(e.getText());)if(null==e.getEntityAt(o.index))return!0;return!1});)n=n.createEntity("LINK","IMMUTABLE",{text:o[0],url:o[0],target:"_blank"}),n=h.Modifier.applyEntity(n,new h.SelectionState({anchorKey:i.getKey(),anchorOffset:o.index,focusKey:i.getKey(),focusOffset:o.index+o[0].length}),n.getLastCreatedEntityKey());return h.EditorState.acceptSelection(h.EditorState.push(e,n,"apply-entity"),t)},he=function(e,t,n,i){n||(n=e.getSelection());var o=e.getCurrentContent();n.getAnchorKey()!==t&&n.getFocusKey()!==t||(n=new h.SelectionState({anchorKey:o.getKeyAfter(t),anchorOffset:0,focusKey:o.getKeyAfter(t),focusOffset:0}));var r=o.getBlockMap().delete(t);return i&&(e=h.EditorState.set(e,{allowUndo:!1})),e=h.EditorState.push(e,o.merge({blockMap:r,selectionAfter:n}),"remove-range"),i&&(e=h.EditorState.set(e,{allowUndo:!0})),e},ge=function(e,t){return _.default.isIE()||document.getSelection().removeAllRanges(),h.EditorState.forceSelection(e,h.SelectionState.createEmpty(t))};V.propTypes={editorState:m.default.object.isRequired,onStartEditing:m.default.func,onStopEditing:m.default.func,onCancel:m.default.func,onChange:m.default.func.isRequired,placeholder:m.default.string,hideX:m.default.bool,addTag:m.default.func,deleteTag:m.default.func,disableRichText:m.default.bool,disableLineBreaks:m.default.bool,style:m.default.object,maxChars:m.default.number,imageWidth:m.default.number,imageHeight:m.default.number},t.default=V},553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(240)),o=g(n(186)),r=g(n(181)),a=g(n(182)),s=g(n(183)),l=g(n(184)),u=g(n(185)),c=n(177),d=g(c),f=g(n(288)),p=n(211),m=g(n(232)),h=g(n(254));function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,a.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.state={},n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props.blockProps,n=t.collection,r=t.files,a=r&&r.length>1&&null==n;return null!=r&&r.length>0?d.default.createElement(m.default,{blockKey:this.props.block.getKey()},r.map(function(t,n){return d.default.createElement(h.default,{subItemType:e.props.blockProps.collectionType,file:t,key:n,autoStart:!a||0===t.index,uploadProps:(0,o.default)({},e.props.blockProps.uploadProps,{onUploadProgress:function(n,o){n&&e.setState((0,i.default)({},t.name,n)),e.props.blockProps.uploadProps.onUploadProgress&&e.props.blockProps.uploadProps.onUploadProgress(n,o)}}),swapPendingForCollection:e.props.blockProps.swapPendingForCollection,removeBlock:e.props.blockProps.removeBlock,entityKey:e.props.blockProps.entityKey},d.default.createElement(f.default,{document:{title:t.name,sourceAssetURL:"hmmm",documentType:p.RE_FILE_EXTENSION.exec(t.name)[1],fileSize:t.size,progress:e.state[t.name]||0},isSelected:e.props.blockProps.isSelected,inEditor:!0,onClick:e.props.blockProps.onClick}))})):null!=n?d.default.createElement(m.default,{blockKey:this.props.block.getKey()},n.collectionMembers.map(function(t,n){return d.default.createElement(f.default,{document:t,isSelected:e.props.blockProps.isSelected,key:n,inEditor:!0,onClick:e.props.blockProps.onClick})})):d.default.createElement("span",{style:{backgroundColor:"red"}},"broken block. see console. ",console.error(this.props.blockProps))}}]),t}(c.Component);t.default=y},554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(240)),o=h(n(186)),r=h(n(181)),a=h(n(182)),s=h(n(183)),l=h(n(184)),u=h(n(185)),c=n(177),d=h(c),f=h(n(281)),p=h(n(232)),m=h(n(254));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.state={},n}return(0,u.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props.blockProps,n=t.collection,r=t.files,a=r&&r.length>1&&null==n;return null!=r&&r.length>0?d.default.createElement(p.default,{blockKey:this.props.block.getKey()},r.map(function(t,n){return d.default.createElement(m.default,{subItemType:e.props.blockProps.collectionType,file:t,key:n,autoStart:!a||0===t.index,imageSize:e.props.blockProps.imageSize,uploadProps:(0,o.default)({},e.props.blockProps.uploadProps,{onUploadProgress:function(n,o){n&&e.setState((0,i.default)({},t.name,n)),e.props.blockProps.uploadProps.onUploadProgress&&e.props.blockProps.uploadProps.onUploadProgress(n,o)}}),swapPendingForCollection:e.props.blockProps.swapPendingForCollection,removeBlock:e.props.blockProps.removeBlock,entityKey:e.props.blockProps.entityKey},d.default.createElement("div",{className:"ka_imgOutterBox"},d.default.createElement("div",{style:{display:"inline-block",position:"relative"},className:"ka_imgBox ka_subitem uploading"+(e.props.blockProps.isSelected?" selected":""),onClick:e.props.blockProps.onClick},d.default.createElement("img",{src:t.dataUrl,className:"ka_streamImg more",draggable:!1}),d.default.createElement("div",{className:"ka_imgUploadProgress"},d.default.createElement("div",{style:{width:(e.state[t.name]||0)+"%"}})))))})):null!=n?d.default.createElement(p.default,{blockKey:this.props.block.getKey()},d.default.createElement(f.default,{images:n.collectionMembers[0].mediaList.sort(function(e,t){return new Date(e.modDate)-new Date(t.modDate)}),isLessMode:!1,isSelected:this.props.blockProps.isSelected,key:"uploaded",handleClick:this.props.blockProps.handleClick,imageSize:this.props.blockProps.imageSize})):d.default.createElement("span",{style:{backgroundColor:"red"}},"broken block. see console. ",console.error(this.props.blockProps))}}]),t}(c.Component);t.default=g},555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(186)),o=g(n(181)),r=g(n(182)),a=g(n(183)),s=g(n(184)),l=g(n(185)),u=n(177),c=g(u),d=g(n(187)),f=g(n(249)),p=n(239),m=g(n(232)),h=g(n(254));function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.state={didUpload:n.props.blockProps.files&&n.props.blockProps.files.length>0},n.props.blockProps.files&&(n.state.file=n.props.blockProps.files[0]),n.setPlayPosition=n.setPlayPosition.bind(n),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"setPlayPosition",value:function(e){this.pendingVid&&this.pendingVid.duration&&(this.pendingVid.currentTime=this.pendingVid.duration*(e/100))}},{key:"componentDidMount",value:function(){var e=this;if((this.kavid||this.pendingVid)&&this.setState({width:d.default.findDOMNode(this.kavid||this.pendingVid).clientWidth}),this.pendingVid){var t=d.default.findDOMNode(this.pendingVid);t.readyState>=2?(0,p.getPreviewImageBlob)(t,function(t){return e.setState({fallbackPoster:URL.createObjectURL(t)})}):t.addEventListener("loadeddata",function(){return(0,p.getPreviewImageBlob)(t,function(t){return e.setState({fallbackPoster:URL.createObjectURL(t)})})})}}},{key:"componentDidUpdate",value:function(){if(this.kavid||this.pendingVid){var e=d.default.findDOMNode(this.kavid||this.pendingVid).parentElement.parentElement.clientWidth;e<this.state.width&&this.setState({width:e})}}},{key:"render",value:function(){var e=this,t=this.props.blockProps,n=t.collection,o=t.files;if(null!=o&&o.length>0){var r=o[0];return c.default.createElement(m.default,{blockKey:this.props.block.getKey()},c.default.createElement(h.default,{subItemType:this.props.blockProps.collectionType,file:r,autoStart:0===r.index,uploadProps:(0,i.default)({},this.props.blockProps.uploadProps,{onUploadProgress:function(t,n){t&&(e.setState({percent:t}),e.setPlayPosition(t)),e.props.blockProps.uploadProps.onUploadProgress&&e.props.blockProps.uploadProps.onUploadProgress(t,n)}}),swapPendingForCollection:function(t,n,i){i.collectionMembers[0].originalWidth=e.state.originalWidth,i.collectionMembers[0].originalHeight=e.state.originalHeight,i.collectionMembers[0].duration=e.state.duration,i.collectionMembers[0].fileSize=r.size,i.collectionMembers[0].uploadedAt=(new Date).getTime(),e.props.blockProps.swapPendingForCollection(t,n,i)},removeBlock:this.props.blockProps.removeBlock,entityKey:this.props.blockProps.entityKey},c.default.createElement("div",{style:{display:"inline-block",position:"relative",width:this.state.width},className:"ka_vidBox ka_subitem uploading"+(this.props.blockProps.isSelected?" selected":""),onClick:this.props.blockProps.onClick},c.default.createElement("video",{src:r.fileObjectUrl,type:r.type,className:"uploadingStreamVid",ref:function(t){return e.pendingVid=t},onLoadedMetadata:function(){e.setState({duration:e.pendingVid.duration,aspectRatio:e.pendingVid.videoWidth/e.pendingVid.videoHeight,originalWidth:e.pendingVid.videoWidth,originalHeight:e.pendingVid.videoHeight})}}),c.default.createElement("div",{className:"ka_imgUploadProgress"},c.default.createElement("div",{style:{width:(this.state.percent||0)+"%"}})))))}if(null!=n){var a=void 0,s=n.collectionMembers[0].memberData;return s&&("string"==typeof s&&(s=JSON.parse(s)),a=s.startTime),c.default.createElement(m.default,{blockKey:this.props.block.getKey()},c.default.createElement("div",{className:"ka_vidBox ka_subitem"+(this.props.blockProps.isSelected?" selected":"")},c.default.createElement(f.default,{videoID:n.collectionMembers[0].mediaID,startTime:a,duration:this.state.duration||n.collectionMembers[0].duration,fileSize:this.state.file?this.state.file.size:n.collectionMembers[0].fileSize,uploadedAt:n.collectionMembers[0].uploadedAt,isSelected:this.props.blockProps.isSelected,onSelect:this.props.blockProps.onClick,processingStarted:this.props.blockProps.uploadProps.videoProcessingStarted,processingEnded:this.props.blockProps.uploadProps.videoProcessingEnded,fallbackPoster:this.state.fallbackPoster,requestInputControl:this.props.blockProps.requestInputControl,releaseInputControl:this.props.blockProps.releaseInputControl,aspectRatio:this.state.aspectRatio,width:this.state.width,ref:function(t){return e.kavid=t},didUpload:this.state.didUpload,inEditor:!0})))}return c.default.createElement("span",{style:{backgroundColor:"red"}},"broken block. see console.",console.error(this.props.blockProps))}}]),t}(u.Component);t.default=y},556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(186)),o=p(n(181)),r=p(n(182)),a=p(n(183)),s=p(n(184)),l=p(n(185)),u=n(177),c=p(u),d=p(n(179)),f=p(n(191));function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return(0,r.default)(this,t),(0,s.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;window.setTimeout(function(){var t=document.createElement("a");t.href=e.props.url;var n=t.host.toLowerCase();n.endsWith(":80")&&(n=n.slice(0,-3));var o=t.protocol;window.location.hostname.toLowerCase()===t.hostname.toLowerCase()?f.default.post("/_layouts/15/ShareSomething/pageScraper3.ashx").query({url:e.props.url}).end(function(t,n){if(t||!n.ok)console.error("failed to get link preview"),d.default.receivedAPIError(t||n.text);else{var o={collectionType:"Link",collectionMembers:[n.body.error?{url:e.props.url,title:decodeURI(e.props.url),isSharepoint:!0,memberType:"Link"}:(0,i.default)({},n.body,{images:n.body.images.filter(function(e){return null==e.error})})]};e.props.swapPendingForCollection(e.props.entityKey,0,o)}e.props.uploadProps.onUploadEnd({name:e.props.url})}):"undefined"==typeof openAssetoEmbedHosts||-1===openAssetoEmbedHosts.indexOf(n)&&-1===openAssetoEmbedHosts.indexOf(o+"//"+n)?-1===t.hostname.indexOf(".")?f.default.post("/_layouts/15/ShareSomething/pageScraper3.ashx").query({url:e.props.url}).end(function(t,n){if(t||!n.ok)console.error("failed to get link preview"),d.default.receivedAPIError(t||n.text);else{var o={collectionType:"Link",collectionMembers:[(0,i.default)({},n.body,{images:n.body.images.filter(function(e){return null==e.error})})]};e.props.swapPendingForCollection(e.props.entityKey,0,o)}e.props.uploadProps.onUploadEnd({name:e.props.url})}):f.default.post(apiUrl+"/subitem/url").query({url:e.props.url}).set({Authorization:"Bearer "+d.default.getToken()}).accept("application/json").end(function(t,n){t||!n.ok?(console.error("failed to get url preview"),d.default.receivedAPIError(t||n.text)):e.props.swapPendingForCollection(e.props.entityKey,0,n.body.results[0]),e.props.uploadProps.onUploadEnd({name:e.props.url})}):f.default.get("/_layouts/15/ShareSomething/getoEmbed.ashx").query({media_url:e.props.url,endpoint_url:t.protocol+"//"+t.host+"/Feed/OEmbed"}).end(function(n,i){var o={collectionType:"Link"};n||!i.ok?(console.error("failed to get OpenAsset preview"),o.collectionMembers=[{memberType:"Link",url:e.props.url,title:d.default.getOaLinkTitle(e.props.url),subtitle:t.host,images:[{src:static_images.openasset_225}]}]):o.collectionMembers=[{memberType:"Link",url:e.props.url,title:i.body.title,subtitle:t.host,subItemData:i.body,images:[{src:i.body.url||i.body.thumbnail_url},{src:static_images.openasset_225}]}],e.props.swapPendingForCollection(e.props.entityKey,0,o),e.props.uploadProps.onUploadEnd({name:e.props.url})})},0)}},{key:"render",value:function(){var e=this.props.url;try{e=decodeURI(this.props.url)}catch(e){console.log("error",e)}return c.default.createElement("a",{className:"ka_subitem ka_streamWebpage"+(this.props.isSelected?" selected":""),onClick:this.props.onClick},c.default.createElement("div",{style:{padding:10}},e))}}]),t}(u.Component);t.default=m},557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(181)),o=d(n(182)),r=d(n(183)),a=d(n(184)),s=d(n(185)),l=n(177),u=d(l),c=(d(n(187)),d(n(180)));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.onOpen,n=e.isOnLine;return u.default.createElement("div",{className:"",onDragEnter:n?t:void 0},u.default.createElement("div",{style:{height:32,paddingTop:10,paddingLeft:5,color:"#9197a3",cursor:"text"}},"Add a comment..."))}}]),t}(l.Component);f.propTypes={onOpen:c.default.func.isRequired},t.default=f},558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),o=f(n(182)),r=f(n(183)),a=f(n(184)),s=f(n(185)),l=n(177),u=f(l),c=f(n(180)),d=f(n(559));function f(e){return e&&e.__esModule?e:{default:e}}n(95);var p=function(e){function t(e){return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.commentID,n=e.removeComment,i=e.onClose;return u.default.createElement(d.default,{onClose:i},u.default.createElement("div",{className:"modalTitle"},"Delete your comment?"),u.default.createElement("div",{style:{paddingTop:10,verticalAlign:"middle"}},u.default.createElement("div",null,u.default.createElement("input",{type:"button",value:"Delete Comment",className:"destructive",onClick:function(){n(t),i()}}),u.default.createElement("input",{type:"button",value:"Cancel",className:"cancel",onClick:function(){i()}}))))}}]),t}(l.Component);p.propTypes={commentID:c.default.number.isRequired,removeComment:c.default.func.isRequired,onClose:c.default.func.isRequired},t.default=p},559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(177),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){var t=e.className,n=e.onClose,i=(e.isOpen,e.children),o=e.onLeft,a=e.onRight;return r.default.createElement("div",{className:"kamobilemodal-overlay",onClick:n},r.default.createElement("div",{className:"kamobilemodal-content "+t,onClick:function(e){e.stopPropagation()}},i),o&&r.default.createElement("img",{className:"kamobilemodal-left",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),o()}}),a&&r.default.createElement("img",{className:"kamobilemodal-right",src:"/_layouts/15/images/KAMasterPage/Right_Arrow_White.png",onClick:function(e){e.stopPropagation(),a()}}))}},560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(478),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){var n=e.items.find(function(e){return e.itemID===t.itemID});return{mentions:n.mentions,hashtags:n.hashtags}},function(e){return{addTag:function(t,n){e((0,r.addItemTag)(n,t))},deleteTag:function(t,n){e((0,r.deleteItemTag)(n,t))}}})(s.default)},561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(181)),o=p(n(182)),r=p(n(183)),a=p(n(184)),s=p(n(185)),l=n(177),u=p(l),c=p(n(180)),d=p(n(179)),f=n(211);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={text:""},n.clearInput=n.clearInput.bind(n),n.onBlur=n.onBlur.bind(n),n.onFocus=n.onFocus.bind(n),n.onChange=n.onChange.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.onKeyPress=n.onKeyPress.bind(n),n.checkForNewHashtag=n.checkForNewHashtag.bind(n),n.submitNewHashtag=n.submitNewHashtag.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this;return u.default.createElement("input",{type:"text",className:this.props.className,ref:function(t){return e.input=t},onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeyDown,onKeyPress:this.onKeyPress,value:this.state.text,style:this.props.style,autoComplete:"off",readOnly:this.props.readOnly})}},{key:"onKeyDown",value:function(e){this.props.onKeyDown&&"handled"===this.props.onKeyDown(e)||9!==e.keyCode&&13!==e.keyCode&&32!==e.keyCode||this.checkForNewHashtag()&&(this.submitNewHashtag(),e.preventDefault())}},{key:"onKeyPress",value:function(e){this.checkForNewHashtag()&&f.RE_ILLEGAL_HASHTAG.test(String.fromCharCode(e.charCode))&&(e.preventDefault(),this.submitNewHashtag())}},{key:"checkForNewHashtag",value:function(){return this.state.text.length>1&&"#"===this.state.text[0]&&!f.RE_ILLEGAL_HASHTAG.test(this.state.text)}},{key:"submitNewHashtag",value:function(){this.props.onAddTag(g(this.state.text))}},{key:"onChange",value:function(e){var t=this;this.props.onChange&&this.props.onChange(e),null!=this.state.timer&&(window.clearTimeout(this.state.timer),this.setState({timer:null})),null!=h&&(h.abort(),h=null);var n=e.target.value;this.setState({text:n});var i=n.trim();if(d.default.validateSearchText(i)){var o=window.setTimeout(function(){return h=d.default.runTagSearch(i,n,t.props.onSearching,t.props.onSearched)},500);this.setState({timer:o})}else this.props.onCleared()}},{key:"onBlur",value:function(e){!this.props.taggingHovered&&this.checkForNewHashtag()&&this.submitNewHashtag(),this.props.onBlur&&this.props.onBlur(e),this.clearInput()}},{key:"onFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"clearInput",value:function(){this.setState({text:""})}},{key:"focus",value:function(){this.input.focus()}}]),t}(l.Component),h=void 0,g=function(e){return{hashtag:e,deleted:!1}};m.propTypes={onAddTag:c.default.func.isRequired,onCleared:c.default.func.isRequired},t.default=m},562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(181)),o=f(n(182)),r=f(n(183)),a=f(n(184)),s=f(n(185)),l=n(177),u=f(l),c=f(n(674)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(213));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.onChange=n.onChange.bind(n),n.state={active:!0},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"onChange",value:function(e){e&&(d.trackPostImpression(this.props.streamItem),this.setState({active:!1}))}},{key:"render",value:function(){return u.default.createElement(c.default,{active:this.state.active,onChange:this.onChange},this.props.children)}}]),t}(l.Component);t.default=p},563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(564),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){return{actionError:e.actionError}},function(e){return{onClose:function(){e((0,r.setActionError)())}}})(s.default)},564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(177)),o=r(n(245));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.actionError,n=e.onClose;return t?i.default.createElement(o.default,{title:"Jinkies! Something seems to have gone wrong...",message:"Give it another try. If this problem persists, please contact an administrator.",onClose:n}):null}},565:function(e,t,n){var i=n(233)("socket.io-parser"),o=n(248),r=n(988),a=n(676),s=n(677);function l(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=l,t.Decoder=d;var u=t.ERROR+'"encode error"';function c(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return u;n+=o}return i("encoded %j as %s",e,n),n}function d(){this.reconstructor=null}function f(e){this.reconPack=e,this.buffers=[]}function p(e){return{type:t.ERROR,data:"parser error: "+e}}l.prototype.encode=function(e,n){(i("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){r.removeBlobs(e,function(e){var n=r.deconstructPacket(e),i=c(n.packet),o=n.buffers;o.unshift(i),t(o)})}(e,n):n([c(e)])},o(d.prototype),d.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return p("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var r="";"-"!==e.charAt(++n)&&(r+=e.charAt(n),n!=e.length););if(r!=Number(r)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(r)}if("/"===e.charAt(n+1))for(o.nsp="";++n;){var s=e.charAt(n);if(","===s)break;if(o.nsp+=s,n===e.length)break}else o.nsp="/";var l=e.charAt(n+1);if(""!==l&&Number(l)==l){for(o.id="";++n;){var s=e.charAt(n);if(null==s||Number(s)!=s){--n;break}if(o.id+=e.charAt(n),n===e.length)break}o.id=Number(o.id)}if(e.charAt(++n)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n)),c=!1!==u&&(o.type===t.ERROR||a(u));if(!c)return p("invalid payload");o.data=u}return i("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new f(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},566:function(e,t,n){var i=n(991);e.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},567:function(e,t,n){var i=n(273),o=n(248);function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=r,o(r.prototype),r.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},568:function(e,t,n){},585:function(e,t,n){var i={"./af":333,"./af.js":333,"./ar":334,"./ar-dz":335,"./ar-dz.js":335,"./ar-kw":336,"./ar-kw.js":336,"./ar-ly":337,"./ar-ly.js":337,"./ar-ma":338,"./ar-ma.js":338,"./ar-sa":339,"./ar-sa.js":339,"./ar-tn":340,"./ar-tn.js":340,"./ar.js":334,"./az":341,"./az.js":341,"./be":342,"./be.js":342,"./bg":343,"./bg.js":343,"./bm":344,"./bm.js":344,"./bn":345,"./bn.js":345,"./bo":346,"./bo.js":346,"./br":347,"./br.js":347,"./bs":348,"./bs.js":348,"./ca":349,"./ca.js":349,"./cs":350,"./cs.js":350,"./cv":351,"./cv.js":351,"./cy":352,"./cy.js":352,"./da":353,"./da.js":353,"./de":354,"./de-at":355,"./de-at.js":355,"./de-ch":356,"./de-ch.js":356,"./de.js":354,"./dv":357,"./dv.js":357,"./el":358,"./el.js":358,"./en-SG":359,"./en-SG.js":359,"./en-au":360,"./en-au.js":360,"./en-ca":361,"./en-ca.js":361,"./en-gb":362,"./en-gb.js":362,"./en-ie":363,"./en-ie.js":363,"./en-il":364,"./en-il.js":364,"./en-nz":365,"./en-nz.js":365,"./eo":366,"./eo.js":366,"./es":367,"./es-do":368,"./es-do.js":368,"./es-us":369,"./es-us.js":369,"./es.js":367,"./et":370,"./et.js":370,"./eu":371,"./eu.js":371,"./fa":372,"./fa.js":372,"./fi":373,"./fi.js":373,"./fo":374,"./fo.js":374,"./fr":375,"./fr-ca":376,"./fr-ca.js":376,"./fr-ch":377,"./fr-ch.js":377,"./fr.js":375,"./fy":378,"./fy.js":378,"./ga":379,"./ga.js":379,"./gd":380,"./gd.js":380,"./gl":381,"./gl.js":381,"./gom-latn":382,"./gom-latn.js":382,"./gu":383,"./gu.js":383,"./he":384,"./he.js":384,"./hi":385,"./hi.js":385,"./hr":386,"./hr.js":386,"./hu":387,"./hu.js":387,"./hy-am":388,"./hy-am.js":388,"./id":389,"./id.js":389,"./is":390,"./is.js":390,"./it":391,"./it-ch":392,"./it-ch.js":392,"./it.js":391,"./ja":393,"./ja.js":393,"./jv":394,"./jv.js":394,"./ka":395,"./ka.js":395,"./kk":396,"./kk.js":396,"./km":397,"./km.js":397,"./kn":398,"./kn.js":398,"./ko":399,"./ko.js":399,"./ku":400,"./ku.js":400,"./ky":401,"./ky.js":401,"./lb":402,"./lb.js":402,"./lo":403,"./lo.js":403,"./lt":404,"./lt.js":404,"./lv":405,"./lv.js":405,"./me":406,"./me.js":406,"./mi":407,"./mi.js":407,"./mk":408,"./mk.js":408,"./ml":409,"./ml.js":409,"./mn":410,"./mn.js":410,"./mr":411,"./mr.js":411,"./ms":412,"./ms-my":413,"./ms-my.js":413,"./ms.js":412,"./mt":414,"./mt.js":414,"./my":415,"./my.js":415,"./nb":416,"./nb.js":416,"./ne":417,"./ne.js":417,"./nl":418,"./nl-be":419,"./nl-be.js":419,"./nl.js":418,"./nn":420,"./nn.js":420,"./pa-in":421,"./pa-in.js":421,"./pl":422,"./pl.js":422,"./pt":423,"./pt-br":424,"./pt-br.js":424,"./pt.js":423,"./ro":425,"./ro.js":425,"./ru":426,"./ru.js":426,"./sd":427,"./sd.js":427,"./se":428,"./se.js":428,"./si":429,"./si.js":429,"./sk":430,"./sk.js":430,"./sl":431,"./sl.js":431,"./sq":432,"./sq.js":432,"./sr":433,"./sr-cyrl":434,"./sr-cyrl.js":434,"./sr.js":433,"./ss":435,"./ss.js":435,"./sv":436,"./sv.js":436,"./sw":437,"./sw.js":437,"./ta":438,"./ta.js":438,"./te":439,"./te.js":439,"./tet":440,"./tet.js":440,"./tg":441,"./tg.js":441,"./th":442,"./th.js":442,"./tl-ph":443,"./tl-ph.js":443,"./tlh":444,"./tlh.js":444,"./tr":445,"./tr.js":445,"./tzl":446,"./tzl.js":446,"./tzm":447,"./tzm-latn":448,"./tzm-latn.js":448,"./tzm.js":447,"./ug-cn":449,"./ug-cn.js":449,"./uk":450,"./uk.js":450,"./ur":451,"./ur.js":451,"./uz":452,"./uz-latn":453,"./uz-latn.js":453,"./uz.js":452,"./vi":454,"./vi.js":454,"./x-pseudo":455,"./x-pseudo.js":455,"./yo":456,"./yo.js":456,"./zh-cn":457,"./zh-cn.js":457,"./zh-hk":458,"./zh-hk.js":458,"./zh-tw":459,"./zh-tw.js":459};function o(e){var t=r(e);return n(t)}function r(e){var t=i[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(i)},o.resolve=r,e.exports=o,o.id=585},675:function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),r=e.indexOf("]");-1!=o&&-1!=r&&(e=e.substring(0,o)+e.substring(o,r).replace(/:/g,";")+e.substring(r,e.length));for(var a=n.exec(e||""),s={},l=14;l--;)s[i[l]]=a[l]||"";return-1!=o&&-1!=r&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},676:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},677:function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||i&&(e instanceof ArrayBuffer||o(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,i="function"==typeof ArrayBuffer,o=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}).call(this,n(464).Buffer)},678:function(e,t,n){var i=n(989),o=n(684),r=n(248),a=n(565),s=n(685),l=n(686),u=n(233)("socket.io-client:manager"),c=n(683),d=n(1004),f=Object.prototype.hasOwnProperty;function p(e,t){if(!(this instanceof p))return new p(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=p,p.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},p.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},p.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},r(p.prototype),p.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},p.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},p.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},p.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},p.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},p.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},p.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},p.prototype.open=p.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var r=s(n,"open",function(){o.onopen(),e&&e()}),a=s(n,"error",function(t){if(u("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()});if(!1!==this._timeout){var l=this._timeout;u("connect attempt will timeout after %d",l);var c=setTimeout(function(){u("connect attempt timed out after %d",l),r.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",l)},l);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(r),this.subs.push(a),this},p.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",l(this,"ondata"))),this.subs.push(s(e,"ping",l(this,"onping"))),this.subs.push(s(e,"pong",l(this,"onpong"))),this.subs.push(s(e,"error",l(this,"onerror"))),this.subs.push(s(e,"close",l(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",l(this,"ondecoded")))},p.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},p.prototype.ondata=function(e){this.decoder.add(e)},p.prototype.ondecoded=function(e){this.emit("packet",e)},p.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},p.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var i=this;n.on("connecting",r),n.on("connect",function(){n.id=i.generateId(e)}),this.autoConnect&&r()}function r(){~c(i.connecting,n)||i.connecting.push(n)}return n},p.prototype.destroy=function(e){var t=c(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},p.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var i=0;i<n.length;i++)t.engine.write(n[i],e.options);t.encoding=!1,t.processPacketQueue()}))},p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},p.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},p.prototype.close=p.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},p.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},679:function(e,t,n){var i=n(566),o=n(992),r=n(1e3),a=n(1001);t.polling=function(e){var t=!1,n=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,l=location.port;l||(l=s?443:80),t=e.hostname!==location.hostname||l!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new i(e)&&!e.forceJSONP)return new o(e);if(!a)throw new Error("JSONP disabled");return new r(e)},t.websocket=a},680:function(e,t,n){var i=n(567),o=n(479),r=n(273),a=n(480),s=n(682),l=n(233)("engine.io-client:polling");e.exports=c;var u=null!=new(n(566))({xdomain:!1}).responseType;function c(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),i.call(this,e)}a(c,i),c.prototype.name="polling",c.prototype.doOpen=function(){this.poll()},c.prototype.pause=function(e){var t=this;function n(){l("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(l("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){l("pre-pause polling complete"),--i||n()})),this.writable||(l("we are currently writing - waiting to pause"),i++,this.once("drain",function(){l("pre-pause writing complete"),--i||n()}))}else n()},c.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},c.prototype.onData=function(e){var t=this;l("polling got data %s",e);r.decodePayload(e,this.socket.binaryType,function(e,n,i){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},c.prototype.doClose=function(){var e=this;function t(){l("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(l("transport open - closing"),t()):(l("transport not open - deferring close"),this.once("open",t))},c.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};r.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},c.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},681:function(e,t,n){(function(t){var i=n(994),o=Object.prototype.toString,r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(i(n)){for(var o=0,s=n.length;o<s;o++)if(e(n[o]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||r&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var l in n)if(Object.prototype.hasOwnProperty.call(n,l)&&e(n[l]))return!0;return!1}}).call(this,n(464).Buffer)},682:function(e,t,n){"use strict";var i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=64,a={},s=0,l=0;function u(e){var t="";do{t=o[e%r]+t,e=Math.floor(e/r)}while(e>0);return t}function c(){var e=u(+new Date);return e!==i?(s=0,i=e):e+"."+u(s++)}for(;l<r;l++)a[o[l]]=l;c.encode=u,c.decode=function(e){var t=0;for(l=0;l<e.length;l++)t=t*r+a[e.charAt(l)];return t},e.exports=c},683:function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},684:function(e,t,n){var i=n(565),o=n(248),r=n(1003),a=n(685),s=n(686),l=n(233)("socket.io-client:socket"),u=n(479),c=n(681);e.exports=p;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=o.prototype.emit;function p(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(p.prototype),p.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},p.prototype.open=p.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},p.prototype.send=function(){var e=r(arguments);return e.unshift("message"),this.emit.apply(this,e),this},p.prototype.emit=function(e){if(d.hasOwnProperty(e))return f.apply(this,arguments),this;var t=r(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:c(t))?i.BINARY_EVENT:i.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},p.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},p.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;l("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},p.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},p.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===i.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},p.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},p.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=r(arguments);l("sending ack %j",o),t.packet({type:c(o)?i.BINARY_ACK:i.ACK,id:e,data:o})}}},p.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(l("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):l("bad ack %s",e.id)},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},p.prototype.compress=function(e){return this.flags.compress=e,this},p.prototype.binary=function(e){return this.flags.binary=e,this}},685:function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},686:function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},743:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(744),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e){return{items:(t=e.items,e.visibilityFilter,t),isFetching:e.isFetching,endOfStream:e.endOfStream,receiveError:e.receiveError,warnBrokenUser:e.warnBrokenUser};var t},function(e){return{fetchItems:function(){return e((0,r.fetchItems)())},setIsOnLine:function(t){e((0,r.setIsOnLine)(t))},setWarnBrokenUser:function(t){return e((0,r.setWarnBrokenUser)(t))}}})(s.default)},744:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=y(n(181)),o=y(n(182)),r=y(n(183)),a=y(n(184)),s=y(n(185)),l=n(177),u=y(l),c=y(n(180)),d=y(n(745)),f=y(n(228)),p=n(179),m=(y(p),y(n(329))),h=n(214),g=n(189);function y(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.state={},n.checkLoadMore=n.checkLoadMore.bind(n),n.updateOnlineStatus=n.updateOnlineStatus.bind(n),window.addEventListener("online",n.updateOnlineStatus),window.addEventListener("offline",n.updateOnlineStatus),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"updateOnlineStatus",value:function(e){this.props.setIsOnLine(navigator.onLine)}},{key:"componentDidCatch",value:function(e,t){(0,g.logError)(e),this.setState({error:e})}},{key:"render",value:function(){var e=this;return this.state.error?u.default.createElement("div",{className:"ka_stream"},E()):u.default.createElement("div",{className:"ka_stream"},this.props.items.map(function(e){return u.default.createElement(d.default,{item:e,key:e.itemID})}),this.props.isFetching&&!this.props.receiveError&&u.default.createElement("div",{style:{position:"relative"}},u.default.createElement(f.default,null)),this.props.warnBrokenUser&&u.default.createElement(m.default,{onClose:h.OUTAGE_BANNERS.brokenUser.dismissible?function(){return e.props.setWarnBrokenUser(!1)}:void 0},h.OUTAGE_BANNERS.brokenUser.message))}},{key:"checkLoadMore",value:function(e,t){!this.props.endOfStream&&!this.props.isFetching&&this.props.streamHolder.getBoundingClientRect().bottom-window.innerHeight<400&&t(),this.props.endOfStream&&this.unregisterScrollListener()}},{key:"componentDidMount",value:function(){this.registerScrollListener()}},{key:"componentWillUnmount",value:function(){this.unregisterScrollListener(),window.removeEventListener("online",this.updateOnlineStatus),window.removeEventListener("offline",this.updateOnlineStatus)}},{key:"registerScrollListener",value:function(){var e=this;(document.getElementById("s4-workspace")||window).addEventListener("scroll",function(t){return e.checkLoadMore(t,e.props.fetchItems)})}},{key:"unregisterScrollListener",value:function(){(document.getElementById("s4-workspace")||window).removeEventListener("scroll",this.checkLoadMore)}}]),t}(l.Component),E=function(){return u.default.createElement("div",{className:"ka_brokenPost"},u.default.createElement("div",{className:"divSubjectImage"},u.default.createElement("img",{src:p.imgRoot+"yield_cyan_lrg.svg"})),u.default.createElement("div",{className:"divStreamBody"},u.default.createElement("span",{className:"ka_streamItemTitle"},"Posts in the Stream Cannot Be Displayed"),u.default.createElement("div",{className:"ka_streamItemContent"},"Please contact an administrator.")))};v.propTypes={items:c.default.arrayOf(c.default.object.isRequired).isRequired,isFetching:c.default.bool.isRequired,fetchItems:c.default.func.isRequired},t.default=v},745:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(279),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e){return{presenceEnabled:e.presenceEnabled,isThreadView:e.isThreadView}},function(e){return{toggleItemLessMode:function(t){return e((0,r.toggleItemLessMode)(t))},checkContentTall:function(t,n){return function(e,t,n){void 0===t.contentIsTall&&0!=n&&(n>39?e((0,r.setContentTall)(t.itemID,!0)):void 0===t.contentIsTall&&e((0,r.setContentTall)(t.itemID,!1)))}(e,t,n)},toggleTagEditor:function(t){return e((0,r.toggleTagEditor)(t))},toggleContentLessMode:function(t){return e((0,r.toggleContentLessMode)(t))}}})(s.default)},978:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(258),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e){return{isListLessMode:e.isListLessMode,isViewMenuOpen:e.isViewMenuOpen,currentView:e.streamView,isThreadView:e.isThreadView,isSPAdmin:e.isSPAdmin,apiFilterEnabled:e.apiFilterEnabled}},function(e,t){return{setListLessMode:function(){return e((0,r.setListLessMode)())},setListMoreMode:function(){return e((0,r.setListMoreMode)())},toggleViewMenu:function(){return e((0,r.toggleViewMenu)())},setView:function(t){e((0,r.setStreamView)(t)),e((0,r.fetchItems)())}}})(s.default)},979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(980),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e){return{newItemCount:e.newItems?e.newItems.length:0}},function(e,t){return{showNewItems:function(){return e((0,r.showNewItems)())},sharedStreamItem:function(t){return e((0,r.sharedStreamItem)(t))}}})(s.default)},980:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(181)),o=d(n(182)),r=d(n(183)),a=d(n(184)),s=d(n(185)),l=n(177),u=(d(l),d(n(180))),c=n(189);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleSharedStreamItem=n.handleSharedStreamItem.bind(n),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){return null}},{key:"componentDidMount",value:function(){window.addEventListener("SharedStreamItem",this.handleSharedStreamItem)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("SharedStreamItem",this.handleSharedStreamItem)}},{key:"handleSharedStreamItem",value:function(e){var t=e.detail;if(t.itemID)this.props.sharedStreamItem(t);else try{throw new Error("SharedStreamItem event triggered with invalid stream item.")}catch(e){(0,c.logError)(e,t)}}}]),t}(l.Component);f.propTypes={newItemCount:u.default.number.isRequired,showNewItems:u.default.func.isRequired,sharedStreamItem:u.default.func.isRequired},t.default=f},981:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(177)),o=s(n(192)),r=n(179),a=s(r);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){localStorage.setItem("browserAlerted",Date.now()),window.location.href=window.location.href};t.default=function(){return a.default.isOldIE()&&(null==localStorage.getItem("browserAlerted")||Date.now()-localStorage.getItem("browserAlerted")>6048e5)?i.default.createElement(o.default,{onClose:l,hideX:!0,style:{padding:10}},i.default.createElement("table",null,i.default.createElement("tr",null,i.default.createElement("td",null,i.default.createElement("img",{src:r.imgRoot+"yield_xl_cyan.svg",style:{width:48,height:48}})),i.default.createElement("td",{style:{paddingLeft:35}},i.default.createElement("div",{className:"kamodal-title",style:{whiteSpace:"nowrap",marginLeft:0,marginRight:0,marginTop:0}},"Please update your browser to Internet Explorer 11"),i.default.createElement("span",null,"Synthesis no longer works properly with earlier versions of Internet Explorer.",i.default.createElement("br",null),"(It’s the browser’s fault.)")))),i.default.createElement("br",null),i.default.createElement("div",{style:{textAlign:"center"}},i.default.createElement("input",{type:"button",className:"ka_button",style:{marginTop:15,paddingLeft:25,paddingRight:25},value:"OK",onClick:l}))):null}},982:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(198),r=n(188),a=n(983),s=(i=a)&&i.__esModule?i:{default:i};t.default=(0,o.connect)(function(e,t){return{warnOffline:e.warnOffline}},function(e){return{setWarnOffline:function(t,n){e((0,r.setWarnOffline)(t,n))}}})(s.default)},983:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(275)),o=p(n(181)),r=p(n(182)),a=p(n(183)),s=p(n(184)),l=p(n(185)),u=n(177),c=p(u),d=p(n(329)),f=n(214);function p(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){return(0,r.default)(this,t),(0,s.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,l.default)(t,e),(0,a.default)(t,[{key:"render",value:function(){var e=this;if(null!=this.props.warnOffline&&this.props.warnOffline>0){var t=(0,i.default)(f.OUTAGE_BANNERS).find(function(t){return t.number===e.props.warnOffline}),n=void 0;return t.dismissible&&(n=function(){return e.props.setWarnOffline(e.props.warnOffline,!1)}),c.default.createElement(d.default,{onClose:n},t.message)}return null}}]),t}(u.Component);t.default=m},984:function(e,t,n){var i=n(985),o=n(565),r=n(678),a=n(233)("socket.io-client");e.exports=t=l;var s=t.managers={};function l(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=i(e),l=o.source,u=o.id,c=o.path,d=s[u]&&c in s[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(a("ignoring socket cache for %s",l),n=r(l,t)):(s[u]||(a("new io instance for %s",l),s[u]=r(l,t)),n=s[u]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=l,t.Manager=n(678),t.Socket=n(684)},985:function(e,t,n){var i=n(675),o=n(233)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=i(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n}},986:function(e,t,n){function i(e){var n;function i(){if(i.enabled){var e=i,o=+new Date,r=o-(n||o);e.diff=r,e.prev=n,e.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var l=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,i){if("%%"===n)return n;l++;var o=t.formatters[i];if("function"==typeof o){var r=a[l];n=o.call(e,r),a.splice(l,1),l--}return n}),t.formatArgs.call(e,a),(i.log||t.log||console.log.bind(console)).apply(e,a)}}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=function(e){var n,i=0;for(n in e)i=(i<<5)-i+e.charCodeAt(n),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),i.destroy=o,"function"==typeof t.init&&t.init(i),t.instances.push(i),i}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var i=("string"==typeof e?e:"").split(/[\s,]+/),o=i.length;for(n=0;n<o;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var r=t.instances[n];r.enabled=t.enabled(r.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(987),t.instances=[],t.names=[],t.skips=[],t.formatters={}},987:function(e,t){var n=1e3,i=60*n,o=60*i,r=24*o,a=365.25*r;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var l,u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*a;case"days":case"day":case"d":return s*r;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*i;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?s(l=e,r,"day")||s(l,o,"hour")||s(l,i,"minute")||s(l,n,"second")||l+" ms":function(e){if(e>=r)return Math.round(e/r)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},988:function(e,t,n){var i=n(676),o=n(677),r=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=function e(t,n){if(!t)return t;if(o(t)){var r={_placeholder:!0,num:n.length};return n.push(t),r}if(i(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],n);return a}if("object"==typeof t&&!(t instanceof Date)){var a={};for(var l in t)a[l]=e(t[l],n);return a}return t}(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(i(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"==typeof t)for(var r in t)t[r]=e(t[r],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,r=e;!function e(l,u,c){if(!l)return l;if(a&&l instanceof Blob||s&&l instanceof File){n++;var d=new FileReader;d.onload=function(){c?c[u]=this.result:r=this.result,--n||t(r)},d.readAsArrayBuffer(l)}else if(i(l))for(var f=0;f<l.length;f++)e(l[f],f,l);else if("object"==typeof l&&!o(l))for(var p in l)e(l[p],p,l)}(r),n||t(r)}},989:function(e,t,n){e.exports=n(990),e.exports.parser=n(273)},990:function(e,t,n){var i=n(679),o=n(248),r=n(233)("engine.io-client:socket"),a=n(683),s=n(273),l=n(675),u=n(479);function c(e,t){if(!(this instanceof c))return new c(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=l(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=l(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=c,c.priorWebsocketSuccess=!1,o(c.prototype),c.protocol=s.protocol,c.Socket=c,c.Transport=n(567),c.transports=n(679),c.parser=n(273),c.prototype.createTransport=function(e){r('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},c.prototype.open=function(){var e;if(this.rememberUpgrade&&c.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},c.prototype.setTransport=function(e){r("setting transport %s",e.name);var t=this;this.transport&&(r("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},c.prototype.probe=function(e){r('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,i=this;function o(){if(i.onlyBinaryUpgrades){var o=!this.supportsBinary&&i.transport.supportsBinary;n=n||o}n||(r('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(r('probe transport "%s" pong',e),i.upgrading=!0,i.emit("upgrading",t),!t)return;c.priorWebsocketSuccess="websocket"===t.name,r('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){n||"closed"!==i.readyState&&(r("changing transport and sending upgrade packet"),f(),i.setTransport(t),t.send([{type:"upgrade"}]),i.emit("upgrade",t),t=null,i.upgrading=!1,i.flush())})}else{r('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,i.emit("upgradeError",a)}}))}function a(){n||(n=!0,f(),t.close(),t=null)}function s(n){var o=new Error("probe error: "+n);o.transport=t.name,a(),r('probe transport "%s" failed because of error: %s',e,n),i.emit("upgradeError",o)}function l(){s("transport closed")}function u(){s("socket closed")}function d(e){t&&e.name!==t.name&&(r('"%s" works - aborting "%s"',e.name,t.name),a())}function f(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",l),i.removeListener("close",u),i.removeListener("upgrading",d)}c.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",l),this.once("close",u),this.once("upgrading",d),t.open()},c.prototype.onOpen=function(){if(r("socket open"),this.readyState="open",c.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){r("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},c.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(r('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else r('packet received with socket readyState "%s"',this.readyState)},c.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},c.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},c.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){r("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},c.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},c.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},c.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(r("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},c.prototype.write=c.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},c.prototype.sendPacket=function(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}},c.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}function t(){e.onClose("forced close"),r("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function i(){e.once("upgrade",n),e.once("upgradeError",n)}return this},c.prototype.onError=function(e){r("socket error %j",e),c.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},c.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){r('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},c.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;n<i;n++)~a(this.transports,e[n])&&t.push(e[n]);return t}},991:function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},992:function(e,t,n){var i=n(566),o=n(680),r=n(248),a=n(480),s=n(233)("engine.io-client:polling-xhr");function l(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=c,a(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new c(e)},u.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),o=this;i.on("success",t),i.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=i},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},r(c.prototype),c.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new i(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},c.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=l:this.xhr.onreadystatechange=l,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete c.requests[this.index],this.xhr=null}},c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},c.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},c.prototype.abort=function(){this.cleanup()},c.requestsCount=0,c.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var d="onpagehide"in self?"pagehide":"unload";addEventListener(d,f,!1)}function f(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}},993:function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},994:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},995:function(e,t){e.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(t<0&&(t+=i),n<0&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var o=new Uint8Array(e),r=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)r[s]=o[a];return r.buffer}},996:function(e,t){function n(){}e.exports=function(e,t,i){var o=!1;return i=i||n,r.count=e,0===e?t():r;function r(e,n){if(r.count<=0)throw new Error("after called too many times");--r.count,e?(o=!0,t(e),t=i):0!==r.count||o||t(null,n)}}},997:function(e,t){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var n,i,o,r=String.fromCharCode;function a(e){for(var t,n,i=[],o=0,r=e.length;o<r;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<r?56320==(64512&(n=e.charCodeAt(o++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),o--):i.push(t);return i}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function l(e,t){return r(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return r(e);var n="";return 0==(4294965248&e)?n=r(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),n=r(e>>12&15|224),n+=l(e,6)):0==(4292870144&e)&&(n=r(e>>18&7|240),n+=l(e,12),n+=l(e,6)),n+=r(63&e|128)}function c(){if(o>=i)throw Error("Invalid byte index");var e=255&n[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(e){var t,r;if(o>i)throw Error("Invalid byte index");if(o==i)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|c())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|c()<<6|c())>=2048)return s(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,i=a(e),o=i.length,r=-1,s="";++r<o;)s+=u(i[r],n);return s},decode:function(e,t){var s=!1!==(t=t||{}).strict;n=a(e),i=n.length,o=0;for(var l,u=[];!1!==(l=d(s));)u.push(l);return function(e){for(var t,n=e.length,i=-1,o="";++i<n;)(t=e[i])>65535&&(o+=r((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=r(t);return o}(u)}}},998:function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<e.length;i++)n[e.charCodeAt(i)]=i;t.encode=function(t){var n,i=new Uint8Array(t),o=i.length,r="";for(n=0;n<o;n+=3)r+=e[i[n]>>2],r+=e[(3&i[n])<<4|i[n+1]>>4],r+=e[(15&i[n+1])<<2|i[n+2]>>6],r+=e[63&i[n+2]];return o%3==2?r=r.substring(0,r.length-1)+"=":o%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(e){var t,i,o,r,a,s=.75*e.length,l=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<l;t+=4)i=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],r=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],d[u++]=i<<2|o>>4,d[u++]=(15&o)<<4|r>>2,d[u++]=(3&r)<<6|63&a;return c}}()},999:function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,i=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=i&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),r=n&&n.prototype.append&&n.prototype.getBlob;function a(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function s(e,t){t=t||{};var i=new n;return a(e).forEach(function(e){i.append(e)}),t.type?i.getBlob(t.type):i.getBlob()}function l(e,t){return new Blob(a(e),t||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,l.prototype=Blob.prototype),e.exports=i?o?Blob:l:r?s:void 0}}]);
//# sourceMappingURL=stream.kaModules.js.map